const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CvQjZp2T.js","assets/react-vendor-B4YHSBsh.js","assets/mui-vendor-DOedHO9w.js","assets/pdf-vendor--DKs459r.js","assets/Auth-DzDFn8mY.js","assets/ProjectView-CdmghoDd.js","assets/Settings-CLG7HV_e.js","assets/Messages-CxWmo1ZW.js","assets/Help-DJea_o2y.js","assets/NotFound-BF-2T1wZ.js"])))=>i.map(i=>d[i]);
var Q$=Object.defineProperty;var lA=n=>{throw TypeError(n)};var J$=(n,e,t)=>e in n?Q$(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Me=(n,e,t)=>J$(n,typeof e!="symbol"?e+"":e,t),Nk=(n,e,t)=>e.has(n)||lA("Cannot "+t);var h=(n,e,t)=>(Nk(n,e,"read from private field"),t?t.call(n):e.get(n)),M=(n,e,t)=>e.has(n)?lA("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),_=(n,e,t,i)=>(Nk(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),j=(n,e,t)=>(Nk(n,e,"access private method"),t);var Ti=(n,e,t,i)=>({set _(r){_(n,e,r,t)},get _(){return h(n,e,i)}});import{a as Z$,e as e4,g as Jf,r as T,f as t4,b as Xr,h as wv,u as jx,i as DR,L as SR,O as ER,j as n4,k as is,N as i4,B as r4}from"./react-vendor-B4YHSBsh.js";import{_ as ta}from"./pdf-vendor--DKs459r.js";import{j as pe,c as rE,a as Qe,k as li,u as oh,G as s4,S as NR,A as Aa,s as lt,I as ut,T as Nt,B as re,b as Yc,d as vt,e as ge,f as cA,C as a4,g as _R,h as Yr,_ as St,i as se,l as Ci,m as Ai,n as Yn,P as D,o as El,p as tr,q as ei,r as lh,t as Ze,v as Cs,F as Ox,w as o4,x as l4,y as pn,z as _k,D as sn,E as c4,H as Lx,J as Hf,K as Dl,L as Fx,M as ch,N as Js,O as It,Q as nu,R as iu,U as CR,V as u4,W as d4,X as Nl,Y as h4,Z as p4,$ as AR,a0 as Ni,a1 as C1,a2 as L0,a3 as pp,a4 as PR,a5 as f4,a6 as m4,a7 as uh,a8 as uA,a9 as dh,aa as pi,ab as g4,ac as Ck,ad as Na,ae as Nm,af as kv,ag as dA,ah as hA,ai as pA,aj as Pr,ak as Zf,al as b4,am as sE,an as Qd,ao as qf,ap as si,aq as TR,ar as fp,as as y4,at as Ak,au as $m,av as fA,aw as mA,ax as Gf,ay as v4,az as aE,aA as oE,aB as xg,aC as F0,aD as IR,aE as lE,aF as Ui,aG as x4,aH as my,aI as ru,aJ as Dn,aK as cE,aL as Vx,aM as uE,aN as dE,aO as V0,aP as w4,aQ as k4,aR as gA,aS as RR,aT as MR,aU as D4,aV as jR,aW as S4,aX as OR,aY as E4,aZ as LR,a_ as N4,a$ as _4,b0 as FR,b1 as hE,b2 as mp,b3 as C4,b4 as A4,b5 as VR,b6 as Ne,b7 as UR,b8 as zR,b9 as BR,ba as pE,bb as fE,bc as gy,bd as hg,be as $R,bf as P4,bg as mE,bh as gE,bi as T4,bj as WR,bk as I4,bl as HR,bm as qR,bn as R4,bo as M4,bp as bA,bq as j4,br as O4,bs as L4,bt as GR,bu as yA,bv as vA,bw as Jd,bx as A1,by as F4,bz as bE,bA as V4,bB as U4,bC as z4,bD as B4,bE as xA,bF as yE,bG as $4,bH as W4,bI as wA,bJ as H4,bK as YR,bL as XR,bM as q4,bN as P1,bO as G4,bP as T1,bQ as KR,bR as U0,bS as QR,bT as Y4,bU as X4,bV as K4,bW as Q4,bX as J4,bY as Z4,bZ as kA,b_ as DA,b$ as eW,c0 as wg,c1 as Ux,c2 as zx,c3 as JR,c4 as ZR,c5 as SA,c6 as tW,c7 as I1,c8 as nW,c9 as iW,ca as rW,cb as sW,cc as aW,cd as oW,ce as lW,cf as cW,cg as uW,ch as dW,ci as hW}from"./mui-vendor-DOedHO9w.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var Pk={exports:{}},Dv={},EA;function pW(){if(EA)return Dv;EA=1;/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return function(){var n=Z$(),e=Symbol.for("react.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen"),y=Symbol.iterator,v="@@iterator";function w(Z){if(Z===null||typeof Z!="object")return null;var Ie=y&&Z[y]||Z[v];return typeof Ie=="function"?Ie:null}var k=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function S(Z){{for(var Ie=arguments.length,Je=new Array(Ie>1?Ie-1:0),Dt=1;Dt<Ie;Dt++)Je[Dt-1]=arguments[Dt];E("error",Z,Je)}}function E(Z,Ie,Je){{var Dt=k.ReactDebugCurrentFrame,nn=Dt.getStackAddendum();nn!==""&&(Ie+="%s",Je=Je.concat([nn]));var gn=Je.map(function(Yt){return String(Yt)});gn.unshift("Warning: "+Ie),Function.prototype.apply.call(console[Z],console,gn)}}var P=!1,A=!1,N=!1,R=!1,V=!1,B;B=Symbol.for("react.module.reference");function L(Z){return!!(typeof Z=="string"||typeof Z=="function"||Z===i||Z===s||V||Z===r||Z===c||Z===u||R||Z===g||P||A||N||typeof Z=="object"&&Z!==null&&(Z.$$typeof===m||Z.$$typeof===p||Z.$$typeof===a||Z.$$typeof===o||Z.$$typeof===l||Z.$$typeof===B||Z.getModuleId!==void 0))}function W(Z,Ie,Je){var Dt=Z.displayName;if(Dt)return Dt;var nn=Ie.displayName||Ie.name||"";return nn!==""?Je+"("+nn+")":Je}function q(Z){return Z.displayName||"Context"}function X(Z){if(Z==null)return null;if(typeof Z.tag=="number"&&S("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof Z=="function")return Z.displayName||Z.name||null;if(typeof Z=="string")return Z;switch(Z){case i:return"Fragment";case t:return"Portal";case s:return"Profiler";case r:return"StrictMode";case c:return"Suspense";case u:return"SuspenseList"}if(typeof Z=="object")switch(Z.$$typeof){case o:var Ie=Z;return q(Ie)+".Consumer";case a:var Je=Z;return q(Je._context)+".Provider";case l:return W(Z,Z.render,"ForwardRef");case p:var Dt=Z.displayName||null;return Dt!==null?Dt:X(Z.type)||"Memo";case m:{var nn=Z,gn=nn._payload,Yt=nn._init;try{return X(Yt(gn))}catch{return null}}}return null}var G=Object.assign,K=0,J,ee,fe,ae,U,he,ie;function $(){}$.__reactDisabledLog=!0;function Y(){{if(K===0){J=console.log,ee=console.info,fe=console.warn,ae=console.error,U=console.group,he=console.groupCollapsed,ie=console.groupEnd;var Z={configurable:!0,enumerable:!0,value:$,writable:!0};Object.defineProperties(console,{info:Z,log:Z,warn:Z,error:Z,group:Z,groupCollapsed:Z,groupEnd:Z})}K++}}function oe(){{if(K--,K===0){var Z={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:G({},Z,{value:J}),info:G({},Z,{value:ee}),warn:G({},Z,{value:fe}),error:G({},Z,{value:ae}),group:G({},Z,{value:U}),groupCollapsed:G({},Z,{value:he}),groupEnd:G({},Z,{value:ie})})}K<0&&S("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var be=k.ReactCurrentDispatcher,xe;function je(Z,Ie,Je){{if(xe===void 0)try{throw Error()}catch(nn){var Dt=nn.stack.trim().match(/\n( *(at )?)/);xe=Dt&&Dt[1]||""}return`
`+xe+Z}}var ze=!1,Ve;{var we=typeof WeakMap=="function"?WeakMap:Map;Ve=new we}function Ae(Z,Ie){if(!Z||ze)return"";{var Je=Ve.get(Z);if(Je!==void 0)return Je}var Dt;ze=!0;var nn=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var gn;gn=be.current,be.current=null,Y();try{if(Ie){var Yt=function(){throw Error()};if(Object.defineProperty(Yt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Yt,[])}catch(gi){Dt=gi}Reflect.construct(Z,[],Yt)}else{try{Yt.call()}catch(gi){Dt=gi}Z.call(Yt.prototype)}}else{try{throw Error()}catch(gi){Dt=gi}Z()}}catch(gi){if(gi&&Dt&&typeof gi.stack=="string"){for(var Ft=gi.stack.split(`
`),zi=Dt.stack.split(`
`),$n=Ft.length-1,Xn=zi.length-1;$n>=1&&Xn>=0&&Ft[$n]!==zi[Xn];)Xn--;for(;$n>=1&&Xn>=0;$n--,Xn--)if(Ft[$n]!==zi[Xn]){if($n!==1||Xn!==1)do if($n--,Xn--,Xn<0||Ft[$n]!==zi[Xn]){var Mr=`
`+Ft[$n].replace(" at new "," at ");return Z.displayName&&Mr.includes("<anonymous>")&&(Mr=Mr.replace("<anonymous>",Z.displayName)),typeof Z=="function"&&Ve.set(Z,Mr),Mr}while($n>=1&&Xn>=0);break}}}finally{ze=!1,be.current=gn,oe(),Error.prepareStackTrace=nn}var Cl=Z?Z.displayName||Z.name:"",vo=Cl?je(Cl):"";return typeof Z=="function"&&Ve.set(Z,vo),vo}function _e(Z,Ie,Je){return Ae(Z,!1)}function ye(Z){var Ie=Z.prototype;return!!(Ie&&Ie.isReactComponent)}function He(Z,Ie,Je){if(Z==null)return"";if(typeof Z=="function")return Ae(Z,ye(Z));if(typeof Z=="string")return je(Z);switch(Z){case c:return je("Suspense");case u:return je("SuspenseList")}if(typeof Z=="object")switch(Z.$$typeof){case l:return _e(Z.render);case p:return He(Z.type,Ie,Je);case m:{var Dt=Z,nn=Dt._payload,gn=Dt._init;try{return He(gn(nn),Ie,Je)}catch{}}}return""}var Re=Object.prototype.hasOwnProperty,et={},Be=k.ReactDebugCurrentFrame;function mt(Z){if(Z){var Ie=Z._owner,Je=He(Z.type,Z._source,Ie?Ie.type:null);Be.setExtraStackFrame(Je)}else Be.setExtraStackFrame(null)}function Xe(Z,Ie,Je,Dt,nn){{var gn=Function.call.bind(Re);for(var Yt in Z)if(gn(Z,Yt)){var Ft=void 0;try{if(typeof Z[Yt]!="function"){var zi=Error((Dt||"React class")+": "+Je+" type `"+Yt+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof Z[Yt]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw zi.name="Invariant Violation",zi}Ft=Z[Yt](Ie,Yt,Dt,Je,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch($n){Ft=$n}Ft&&!(Ft instanceof Error)&&(mt(nn),S("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",Dt||"React class",Je,Yt,typeof Ft),mt(null)),Ft instanceof Error&&!(Ft.message in et)&&(et[Ft.message]=!0,mt(nn),S("Failed %s type: %s",Je,Ft.message),mt(null))}}}var ct=Array.isArray;function tn(Z){return ct(Z)}function on(Z){{var Ie=typeof Symbol=="function"&&Symbol.toStringTag,Je=Ie&&Z[Symbol.toStringTag]||Z.constructor.name||"Object";return Je}}function Oe(Z){try{return Ge(Z),!1}catch{return!0}}function Ge(Z){return""+Z}function ue(Z){if(Oe(Z))return S("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",on(Z)),Ge(Z)}var de=k.ReactCurrentOwner,Pe={key:!0,ref:!0,__self:!0,__source:!0},Le,$e,ht;ht={};function Et(Z){if(Re.call(Z,"ref")){var Ie=Object.getOwnPropertyDescriptor(Z,"ref").get;if(Ie&&Ie.isReactWarning)return!1}return Z.ref!==void 0}function Ut(Z){if(Re.call(Z,"key")){var Ie=Object.getOwnPropertyDescriptor(Z,"key").get;if(Ie&&Ie.isReactWarning)return!1}return Z.key!==void 0}function zt(Z,Ie){if(typeof Z.ref=="string"&&de.current&&Ie&&de.current.stateNode!==Ie){var Je=X(de.current.type);ht[Je]||(S('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',X(de.current.type),Z.ref),ht[Je]=!0)}}function Te(Z,Ie){{var Je=function(){Le||(Le=!0,S("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",Ie))};Je.isReactWarning=!0,Object.defineProperty(Z,"key",{get:Je,configurable:!0})}}function Ue(Z,Ie){{var Je=function(){$e||($e=!0,S("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",Ie))};Je.isReactWarning=!0,Object.defineProperty(Z,"ref",{get:Je,configurable:!0})}}var ke=function(Z,Ie,Je,Dt,nn,gn,Yt){var Ft={$$typeof:e,type:Z,key:Ie,ref:Je,props:Yt,_owner:gn};return Ft._store={},Object.defineProperty(Ft._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(Ft,"_self",{configurable:!1,enumerable:!1,writable:!1,value:Dt}),Object.defineProperty(Ft,"_source",{configurable:!1,enumerable:!1,writable:!1,value:nn}),Object.freeze&&(Object.freeze(Ft.props),Object.freeze(Ft)),Ft};function ot(Z,Ie,Je,Dt,nn){{var gn,Yt={},Ft=null,zi=null;Je!==void 0&&(ue(Je),Ft=""+Je),Ut(Ie)&&(ue(Ie.key),Ft=""+Ie.key),Et(Ie)&&(zi=Ie.ref,zt(Ie,nn));for(gn in Ie)Re.call(Ie,gn)&&!Pe.hasOwnProperty(gn)&&(Yt[gn]=Ie[gn]);if(Z&&Z.defaultProps){var $n=Z.defaultProps;for(gn in $n)Yt[gn]===void 0&&(Yt[gn]=$n[gn])}if(Ft||zi){var Xn=typeof Z=="function"?Z.displayName||Z.name||"Unknown":Z;Ft&&Te(Yt,Xn),zi&&Ue(Yt,Xn)}return ke(Z,Ft,zi,nn,Dt,de.current,Yt)}}var Bt=k.ReactCurrentOwner,dn=k.ReactDebugCurrentFrame;function oi(Z){if(Z){var Ie=Z._owner,Je=He(Z.type,Z._source,Ie?Ie.type:null);dn.setExtraStackFrame(Je)}else dn.setExtraStackFrame(null)}var vn;vn=!1;function cu(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===e}function yh(){{if(Bt.current){var Z=X(Bt.current.type);if(Z)return`

Check the render method of \``+Z+"`."}return""}}function sm(Z){{if(Z!==void 0){var Ie=Z.fileName.replace(/^.*[\\\/]/,""),Je=Z.lineNumber;return`

Check your code at `+Ie+":"+Je+"."}return""}}var am={};function om(Z){{var Ie=yh();if(!Ie){var Je=typeof Z=="string"?Z:Z.displayName||Z.name;Je&&(Ie=`

Check the top-level render call using <`+Je+">.")}return Ie}}function Rn(Z,Ie){{if(!Z._store||Z._store.validated||Z.key!=null)return;Z._store.validated=!0;var Je=om(Ie);if(am[Je])return;am[Je]=!0;var Dt="";Z&&Z._owner&&Z._owner!==Bt.current&&(Dt=" It was passed a child from "+X(Z._owner.type)+"."),oi(Z),S('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',Je,Dt),oi(null)}}function rr(Z,Ie){{if(typeof Z!="object")return;if(tn(Z))for(var Je=0;Je<Z.length;Je++){var Dt=Z[Je];cu(Dt)&&Rn(Dt,Ie)}else if(cu(Z))Z._store&&(Z._store.validated=!0);else if(Z){var nn=w(Z);if(typeof nn=="function"&&nn!==Z.entries)for(var gn=nn.call(Z),Yt;!(Yt=gn.next()).done;)cu(Yt.value)&&Rn(Yt.value,Ie)}}}function vh(Z){{var Ie=Z.type;if(Ie==null||typeof Ie=="string")return;var Je;if(typeof Ie=="function")Je=Ie.propTypes;else if(typeof Ie=="object"&&(Ie.$$typeof===l||Ie.$$typeof===p))Je=Ie.propTypes;else return;if(Je){var Dt=X(Ie);Xe(Je,Z.props,"prop",Dt,Z)}else if(Ie.PropTypes!==void 0&&!vn){vn=!0;var nn=X(Ie);S("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",nn||"Unknown")}typeof Ie.getDefaultProps=="function"&&!Ie.getDefaultProps.isReactClassApproved&&S("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function lm(Z){{for(var Ie=Object.keys(Z.props),Je=0;Je<Ie.length;Je++){var Dt=Ie[Je];if(Dt!=="children"&&Dt!=="key"){oi(Z),S("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",Dt),oi(null);break}}Z.ref!==null&&(oi(Z),S("Invalid attribute `ref` supplied to `React.Fragment`."),oi(null))}}var My={};function cm(Z,Ie,Je,Dt,nn,gn){{var Yt=L(Z);if(!Yt){var Ft="";(Z===void 0||typeof Z=="object"&&Z!==null&&Object.keys(Z).length===0)&&(Ft+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var zi=sm(nn);zi?Ft+=zi:Ft+=yh();var $n;Z===null?$n="null":tn(Z)?$n="array":Z!==void 0&&Z.$$typeof===e?($n="<"+(X(Z.type)||"Unknown")+" />",Ft=" Did you accidentally export a JSX literal instead of a component?"):$n=typeof Z,S("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",$n,Ft)}var Xn=ot(Z,Ie,Je,nn,gn);if(Xn==null)return Xn;if(Yt){var Mr=Ie.children;if(Mr!==void 0)if(Dt)if(tn(Mr)){for(var Cl=0;Cl<Mr.length;Cl++)rr(Mr[Cl],Z);Object.freeze&&Object.freeze(Mr)}else S("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else rr(Mr,Z)}if(Re.call(Ie,"key")){var vo=X(Z),gi=Object.keys(Ie).filter(function(mw){return mw!=="key"}),um=gi.length>0?"{key: someKey, "+gi.join(": ..., ")+": ...}":"{key: someKey}";if(!My[vo+um]){var xh=gi.length>0?"{"+gi.join(": ..., ")+": ...}":"{}";S(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,um,vo,xh,vo),My[vo+um]=!0}}return Z===i?lm(Xn):vh(Xn),Xn}}var fw=cm;Dv.Fragment=i,Dv.jsxDEV=fw}(),Dv}var NA;function fW(){return NA||(NA=1,Pk.exports=pW()),Pk.exports}var b=fW(),Sv={},_A;function mW(){if(_A)return Sv;_A=1;var n=e4();{var e=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Sv.createRoot=function(t,i){e.usingClientEntryPoint=!0;try{return n.createRoot(t,i)}finally{e.usingClientEntryPoint=!1}},Sv.hydrateRoot=function(t,i,r){e.usingClientEntryPoint=!0;try{return n.hydrateRoot(t,i,r)}finally{e.usingClientEntryPoint=!1}}}return Sv}var gW=mW();const bW=Jf(gW);var em=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Zd=typeof window>"u"||"Deno"in globalThis;function Ys(){}function yW(n,e){return typeof n=="function"?n(e):n}function R1(n){return typeof n=="number"&&n>=0&&n!==1/0}function eM(n,e){return Math.max(n+(e||0)-Date.now(),0)}function gp(n,e){return typeof n=="function"?n(e):n}function Da(n,e){return typeof n=="function"?n(e):n}function CA(n,e){const{type:t="all",exact:i,fetchStatus:r,predicate:s,queryKey:a,stale:o}=n;if(a){if(i){if(e.queryHash!==vE(a,e.options))return!1}else if(!kg(e.queryKey,a))return!1}if(t!=="all"){const l=e.isActive();if(t==="active"&&!l||t==="inactive"&&l)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||r&&r!==e.state.fetchStatus||s&&!s(e))}function AA(n,e){const{exact:t,status:i,predicate:r,mutationKey:s}=n;if(s){if(!e.options.mutationKey)return!1;if(t){if(eh(e.options.mutationKey)!==eh(s))return!1}else if(!kg(e.options.mutationKey,s))return!1}return!(i&&e.state.status!==i||r&&!r(e))}function vE(n,e){return((e==null?void 0:e.queryKeyHashFn)||eh)(n)}function eh(n){return JSON.stringify(n,(e,t)=>j1(t)?Object.keys(t).sort().reduce((i,r)=>(i[r]=t[r],i),{}):t)}function kg(n,e){return n===e?!0:typeof n!=typeof e?!1:n&&e&&typeof n=="object"&&typeof e=="object"?Object.keys(e).every(t=>kg(n[t],e[t])):!1}function M1(n,e){if(n===e)return n;const t=PA(n)&&PA(e);if(t||j1(n)&&j1(e)){const i=t?n:Object.keys(n),r=i.length,s=t?e:Object.keys(e),a=s.length,o=t?[]:{};let l=0;for(let c=0;c<a;c++){const u=t?c:s[c];(!t&&i.includes(u)||t)&&n[u]===void 0&&e[u]===void 0?(o[u]=void 0,l++):(o[u]=M1(n[u],e[u]),o[u]===n[u]&&n[u]!==void 0&&l++)}return r===a&&l===r?n:o}return e}function z0(n,e){if(!e||Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(n[t]!==e[t])return!1;return!0}function PA(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function j1(n){if(!TA(n))return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!TA(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function TA(n){return Object.prototype.toString.call(n)==="[object Object]"}function vW(n){return new Promise(e=>{setTimeout(e,n)})}function O1(n,e,t){if(typeof t.structuralSharing=="function")return t.structuralSharing(n,e);if(t.structuralSharing!==!1){try{return M1(n,e)}catch(i){throw console.error(`Structural sharing requires data to be JSON serializable. To fix this, turn off structuralSharing or return JSON-serializable data from your queryFn. [${t.queryHash}]: ${i}`),i}return M1(n,e)}return e}function xW(n,e,t=0){const i=[...n,e];return t&&i.length>t?i.slice(1):i}function wW(n,e,t=0){const i=[e,...n];return t&&i.length>t?i.slice(0,-1):i}var B0=Symbol();function tM(n,e){return n.queryFn===B0&&console.error(`Attempted to invoke queryFn when set to skipToken. This is likely a configuration error. Query hash: '${n.queryHash}'`),!n.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!n.queryFn||n.queryFn===B0?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}var Ou,Yl,kp,hR,kW=(hR=class extends em{constructor(){super();M(this,Ou);M(this,Yl);M(this,kp);_(this,kp,e=>{if(!Zd&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){h(this,Yl)||this.setEventListener(h(this,kp))}onUnsubscribe(){var e;this.hasListeners()||((e=h(this,Yl))==null||e.call(this),_(this,Yl,void 0))}setEventListener(e){var t;_(this,kp,e),(t=h(this,Yl))==null||t.call(this),_(this,Yl,e(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(e){h(this,Ou)!==e&&(_(this,Ou,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof h(this,Ou)=="boolean"?h(this,Ou):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Ou=new WeakMap,Yl=new WeakMap,kp=new WeakMap,hR),xE=new kW,Dp,Xl,Sp,pR,DW=(pR=class extends em{constructor(){super();M(this,Dp,!0);M(this,Xl);M(this,Sp);_(this,Sp,e=>{if(!Zd&&window.addEventListener){const t=()=>e(!0),i=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",i)}}})}onSubscribe(){h(this,Xl)||this.setEventListener(h(this,Sp))}onUnsubscribe(){var e;this.hasListeners()||((e=h(this,Xl))==null||e.call(this),_(this,Xl,void 0))}setEventListener(e){var t;_(this,Sp,e),(t=h(this,Xl))==null||t.call(this),_(this,Xl,e(this.setOnline.bind(this)))}setOnline(e){h(this,Dp)!==e&&(_(this,Dp,e),this.listeners.forEach(i=>{i(e)}))}isOnline(){return h(this,Dp)}},Dp=new WeakMap,Xl=new WeakMap,Sp=new WeakMap,pR),$0=new DW;function L1(){let n,e;const t=new Promise((r,s)=>{n=r,e=s});t.status="pending",t.catch(()=>{});function i(r){Object.assign(t,r),delete t.resolve,delete t.reject}return t.resolve=r=>{i({status:"fulfilled",value:r}),n(r)},t.reject=r=>{i({status:"rejected",reason:r}),e(r)},t}function SW(n){return Math.min(1e3*2**n,3e4)}function nM(n){return(n??"online")==="online"?$0.isOnline():!0}var iM=class extends Error{constructor(n){super("CancelledError"),this.revert=n==null?void 0:n.revert,this.silent=n==null?void 0:n.silent}};function Tk(n){return n instanceof iM}function rM(n){let e=!1,t=0,i=!1,r;const s=L1(),a=v=>{var w;i||(m(new iM(v)),(w=n.abort)==null||w.call(n))},o=()=>{e=!0},l=()=>{e=!1},c=()=>xE.isFocused()&&(n.networkMode==="always"||$0.isOnline())&&n.canRun(),u=()=>nM(n.networkMode)&&n.canRun(),p=v=>{var w;i||(i=!0,(w=n.onSuccess)==null||w.call(n,v),r==null||r(),s.resolve(v))},m=v=>{var w;i||(i=!0,(w=n.onError)==null||w.call(n,v),r==null||r(),s.reject(v))},g=()=>new Promise(v=>{var w;r=k=>{(i||c())&&v(k)},(w=n.onPause)==null||w.call(n)}).then(()=>{var v;r=void 0,i||(v=n.onContinue)==null||v.call(n)}),y=()=>{if(i)return;let v;const w=t===0?n.initialPromise:void 0;try{v=w??n.fn()}catch(k){v=Promise.reject(k)}Promise.resolve(v).then(p).catch(k=>{var N;if(i)return;const S=n.retry??(Zd?0:3),E=n.retryDelay??SW,P=typeof E=="function"?E(t,k):E,A=S===!0||typeof S=="number"&&t<S||typeof S=="function"&&S(t,k);if(e||!A){m(k);return}t++,(N=n.onFail)==null||N.call(n,t,k),vW(P).then(()=>c()?void 0:g()).then(()=>{e?m(k):y()})})};return{promise:s,cancel:a,continue:()=>(r==null||r(),s),cancelRetry:o,continueRetry:l,canStart:u,start:()=>(u()?y():g().then(y),s)}}var EW=n=>setTimeout(n,0);function NW(){let n=[],e=0,t=o=>{o()},i=o=>{o()},r=EW;const s=o=>{e?n.push(o):r(()=>{t(o)})},a=()=>{const o=n;n=[],o.length&&r(()=>{i(()=>{o.forEach(l=>{t(l)})})})};return{batch:o=>{let l;e++;try{l=o()}finally{e--,e||a()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{t=o},setBatchNotifyFunction:o=>{i=o},setScheduler:o=>{r=o}}}var Ei=NW(),Lu,fR,sM=(fR=class{constructor(){M(this,Lu)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),R1(this.gcTime)&&_(this,Lu,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n??(Zd?1/0:5*60*1e3))}clearGcTimeout(){h(this,Lu)&&(clearTimeout(h(this,Lu)),_(this,Lu,void 0))}},Lu=new WeakMap,fR),Ep,Np,Vs,Fu,cr,Og,Vu,ca,Po,mR,_W=(mR=class extends sM{constructor(e){super();M(this,ca);M(this,Ep);M(this,Np);M(this,Vs);M(this,Fu);M(this,cr);M(this,Og);M(this,Vu);_(this,Vu,!1),_(this,Og,e.defaultOptions),this.setOptions(e.options),this.observers=[],_(this,Fu,e.client),_(this,Vs,h(this,Fu).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,_(this,Ep,CW(this.options)),this.state=e.state??h(this,Ep),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=h(this,cr))==null?void 0:e.promise}setOptions(e){this.options={...h(this,Og),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&h(this,Vs).remove(this)}setData(e,t){const i=O1(this.state.data,e,this.options);return j(this,ca,Po).call(this,{data:i,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),i}setState(e,t){j(this,ca,Po).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var i,r;const t=(i=h(this,cr))==null?void 0:i.promise;return(r=h(this,cr))==null||r.cancel(e),t?t.then(Ys).catch(Ys):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(h(this,Ep))}isActive(){return this.observers.some(e=>Da(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===B0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!eM(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(i=>i.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=h(this,cr))==null||t.continue()}onOnline(){var t;const e=this.observers.find(i=>i.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=h(this,cr))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),h(this,Vs).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(h(this,cr)&&(h(this,Vu)?h(this,cr).cancel({revert:!0}):h(this,cr).cancelRetry()),this.scheduleGc()),h(this,Vs).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||j(this,ca,Po).call(this,{type:"invalidate"})}fetch(e,t){var l,c,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(h(this,cr))return h(this,cr).continueRetry(),h(this,cr).promise}if(e&&this.setOptions(e),!this.options.queryFn){const p=this.observers.find(m=>m.options.queryFn);p&&this.setOptions(p.options)}Array.isArray(this.options.queryKey)||console.error("As of v4, queryKey needs to be an Array. If you are using a string like 'repoData', please change it to an Array, e.g. ['repoData']");const i=new AbortController,r=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(_(this,Vu,!0),i.signal)})},s=()=>{const p=tM(this.options,t),m={client:h(this,Fu),queryKey:this.queryKey,meta:this.meta};return r(m),_(this,Vu,!1),this.options.persister?this.options.persister(p,m,this):p(m)},a={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:h(this,Fu),state:this.state,fetchFn:s};r(a),(l=this.options.behavior)==null||l.onFetch(a,this),_(this,Np,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=a.fetchOptions)==null?void 0:c.meta))&&j(this,ca,Po).call(this,{type:"fetch",meta:(u=a.fetchOptions)==null?void 0:u.meta});const o=p=>{var m,g,y,v;Tk(p)&&p.silent||j(this,ca,Po).call(this,{type:"error",error:p}),Tk(p)||((g=(m=h(this,Vs).config).onError)==null||g.call(m,p,this),(v=(y=h(this,Vs).config).onSettled)==null||v.call(y,this.state.data,p,this)),this.scheduleGc()};return _(this,cr,rM({initialPromise:t==null?void 0:t.initialPromise,fn:a.fetchFn,abort:i.abort.bind(i),onSuccess:p=>{var m,g,y,v;if(p===void 0){console.error(`Query data cannot be undefined. Please make sure to return a value other than undefined from your query function. Affected query key: ${this.queryHash}`),o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(p)}catch(w){o(w);return}(g=(m=h(this,Vs).config).onSuccess)==null||g.call(m,p,this),(v=(y=h(this,Vs).config).onSettled)==null||v.call(y,p,this.state.error,this),this.scheduleGc()},onError:o,onFail:(p,m)=>{j(this,ca,Po).call(this,{type:"failed",failureCount:p,error:m})},onPause:()=>{j(this,ca,Po).call(this,{type:"pause"})},onContinue:()=>{j(this,ca,Po).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),h(this,cr).start()}},Ep=new WeakMap,Np=new WeakMap,Vs=new WeakMap,Fu=new WeakMap,cr=new WeakMap,Og=new WeakMap,Vu=new WeakMap,ca=new WeakSet,Po=function(e){const t=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...aM(i.data,this.options),fetchMeta:e.meta??null};case"success":return{...i,data:e.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const r=e.error;return Tk(r)&&r.revert&&h(this,Np)?{...h(this,Np),fetchStatus:"idle"}:{...i,error:r,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=t(this.state),Ei.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),h(this,Vs).notify({query:this,type:"updated",action:e})})},mR);function aM(n,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:nM(e.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function CW(n){const e=typeof n.initialData=="function"?n.initialData():n.initialData,t=e!==void 0,i=t?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var $a,gR,AW=(gR=class extends em{constructor(e={}){super();M(this,$a);this.config=e,_(this,$a,new Map)}build(e,t,i){const r=t.queryKey,s=t.queryHash??vE(r,t);let a=this.get(s);return a||(a=new _W({client:e,queryKey:r,queryHash:s,options:e.defaultQueryOptions(t),state:i,defaultOptions:e.getQueryDefaults(r)}),this.add(a)),a}add(e){h(this,$a).has(e.queryHash)||(h(this,$a).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=h(this,$a).get(e.queryHash);t&&(e.destroy(),t===e&&h(this,$a).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Ei.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return h(this,$a).get(e)}getAll(){return[...h(this,$a).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(i=>CA(t,i))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(i=>CA(e,i)):t}notify(e){Ei.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Ei.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Ei.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},$a=new WeakMap,gR),Wa,Dr,Uu,Ha,Ul,bR,PW=(bR=class extends sM{constructor(e){super();M(this,Ha);M(this,Wa);M(this,Dr);M(this,Uu);this.mutationId=e.mutationId,_(this,Dr,e.mutationCache),_(this,Wa,[]),this.state=e.state||oM(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){h(this,Wa).includes(e)||(h(this,Wa).push(e),this.clearGcTimeout(),h(this,Dr).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){_(this,Wa,h(this,Wa).filter(t=>t!==e)),this.scheduleGc(),h(this,Dr).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){h(this,Wa).length||(this.state.status==="pending"?this.scheduleGc():h(this,Dr).remove(this))}continue(){var e;return((e=h(this,Uu))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var s,a,o,l,c,u,p,m,g,y,v,w,k,S,E,P,A,N,R,V;const t=()=>{j(this,Ha,Ul).call(this,{type:"continue"})};_(this,Uu,rM({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(B,L)=>{j(this,Ha,Ul).call(this,{type:"failed",failureCount:B,error:L})},onPause:()=>{j(this,Ha,Ul).call(this,{type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>h(this,Dr).canRun(this)}));const i=this.state.status==="pending",r=!h(this,Uu).canStart();try{if(i)t();else{j(this,Ha,Ul).call(this,{type:"pending",variables:e,isPaused:r}),await((a=(s=h(this,Dr).config).onMutate)==null?void 0:a.call(s,e,this));const L=await((l=(o=this.options).onMutate)==null?void 0:l.call(o,e));L!==this.state.context&&j(this,Ha,Ul).call(this,{type:"pending",context:L,variables:e,isPaused:r})}const B=await h(this,Uu).start();return await((u=(c=h(this,Dr).config).onSuccess)==null?void 0:u.call(c,B,e,this.state.context,this)),await((m=(p=this.options).onSuccess)==null?void 0:m.call(p,B,e,this.state.context)),await((y=(g=h(this,Dr).config).onSettled)==null?void 0:y.call(g,B,null,this.state.variables,this.state.context,this)),await((w=(v=this.options).onSettled)==null?void 0:w.call(v,B,null,e,this.state.context)),j(this,Ha,Ul).call(this,{type:"success",data:B}),B}catch(B){try{throw await((S=(k=h(this,Dr).config).onError)==null?void 0:S.call(k,B,e,this.state.context,this)),await((P=(E=this.options).onError)==null?void 0:P.call(E,B,e,this.state.context)),await((N=(A=h(this,Dr).config).onSettled)==null?void 0:N.call(A,void 0,B,this.state.variables,this.state.context,this)),await((V=(R=this.options).onSettled)==null?void 0:V.call(R,void 0,B,e,this.state.context)),B}finally{j(this,Ha,Ul).call(this,{type:"error",error:B})}}finally{h(this,Dr).runNext(this)}}},Wa=new WeakMap,Dr=new WeakMap,Uu=new WeakMap,Ha=new WeakSet,Ul=function(e){const t=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Ei.batch(()=>{h(this,Wa).forEach(i=>{i.onMutationUpdate(e)}),h(this,Dr).notify({mutation:this,type:"updated",action:e})})},bR);function oM(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Fo,ua,Lg,yR,TW=(yR=class extends em{constructor(e={}){super();M(this,Fo);M(this,ua);M(this,Lg);this.config=e,_(this,Fo,new Set),_(this,ua,new Map),_(this,Lg,0)}build(e,t,i){const r=new PW({mutationCache:this,mutationId:++Ti(this,Lg)._,options:e.defaultMutationOptions(t),state:i});return this.add(r),r}add(e){h(this,Fo).add(e);const t=Ev(e);if(typeof t=="string"){const i=h(this,ua).get(t);i?i.push(e):h(this,ua).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(h(this,Fo).delete(e)){const t=Ev(e);if(typeof t=="string"){const i=h(this,ua).get(t);if(i)if(i.length>1){const r=i.indexOf(e);r!==-1&&i.splice(r,1)}else i[0]===e&&h(this,ua).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Ev(e);if(typeof t=="string"){const i=h(this,ua).get(t),r=i==null?void 0:i.find(s=>s.state.status==="pending");return!r||r===e}else return!0}runNext(e){var i;const t=Ev(e);if(typeof t=="string"){const r=(i=h(this,ua).get(t))==null?void 0:i.find(s=>s!==e&&s.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Ei.batch(()=>{h(this,Fo).forEach(e=>{this.notify({type:"removed",mutation:e})}),h(this,Fo).clear(),h(this,ua).clear()})}getAll(){return Array.from(h(this,Fo))}find(e){const t={exact:!0,...e};return this.getAll().find(i=>AA(t,i))}findAll(e={}){return this.getAll().filter(t=>AA(e,t))}notify(e){Ei.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return Ei.batch(()=>Promise.all(e.map(t=>t.continue().catch(Ys))))}},Fo=new WeakMap,ua=new WeakMap,Lg=new WeakMap,yR);function Ev(n){var e;return(e=n.options.scope)==null?void 0:e.id}function IA(n){return{onFetch:(e,t)=>{var u,p,m,g,y;const i=e.options,r=(m=(p=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:p.fetchMore)==null?void 0:m.direction,s=((g=e.state.data)==null?void 0:g.pages)||[],a=((y=e.state.data)==null?void 0:y.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const c=async()=>{let v=!1;const w=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(e.signal.aborted?v=!0:e.signal.addEventListener("abort",()=>{v=!0}),e.signal)})},k=tM(e.options,e.fetchOptions),S=async(E,P,A)=>{if(v)return Promise.reject();if(P==null&&E.pages.length)return Promise.resolve(E);const N={client:e.client,queryKey:e.queryKey,pageParam:P,direction:A?"backward":"forward",meta:e.options.meta};w(N);const R=await k(N),{maxPages:V}=e.options,B=A?wW:xW;return{pages:B(E.pages,R,V),pageParams:B(E.pageParams,P,V)}};if(r&&s.length){const E=r==="backward",P=E?IW:RA,A={pages:s,pageParams:a},N=P(i,A);o=await S(A,N,E)}else{const E=n??s.length;do{const P=l===0?a[0]??i.initialPageParam:RA(i,o);if(l>0&&P==null)break;o=await S(o,P),l++}while(l<E)}return o};e.options.persister?e.fetchFn=()=>{var v,w;return(w=(v=e.options).persister)==null?void 0:w.call(v,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=c}}}function RA(n,{pages:e,pageParams:t}){const i=e.length-1;return e.length>0?n.getNextPageParam(e[i],e,t[i],t):void 0}function IW(n,{pages:e,pageParams:t}){var i;return e.length>0?(i=n.getPreviousPageParam)==null?void 0:i.call(n,e[0],e,t[0],t):void 0}var Qn,Kl,Ql,_p,Cp,Jl,Ap,Pp,vR,RW=(vR=class{constructor(n={}){M(this,Qn);M(this,Kl);M(this,Ql);M(this,_p);M(this,Cp);M(this,Jl);M(this,Ap);M(this,Pp);_(this,Qn,n.queryCache||new AW),_(this,Kl,n.mutationCache||new TW),_(this,Ql,n.defaultOptions||{}),_(this,_p,new Map),_(this,Cp,new Map),_(this,Jl,0)}mount(){Ti(this,Jl)._++,h(this,Jl)===1&&(_(this,Ap,xE.subscribe(async n=>{n&&(await this.resumePausedMutations(),h(this,Qn).onFocus())})),_(this,Pp,$0.subscribe(async n=>{n&&(await this.resumePausedMutations(),h(this,Qn).onOnline())})))}unmount(){var n,e;Ti(this,Jl)._--,h(this,Jl)===0&&((n=h(this,Ap))==null||n.call(this),_(this,Ap,void 0),(e=h(this,Pp))==null||e.call(this),_(this,Pp,void 0))}isFetching(n){return h(this,Qn).findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return h(this,Kl).findAll({...n,status:"pending"}).length}getQueryData(n){var t;const e=this.defaultQueryOptions({queryKey:n});return(t=h(this,Qn).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(n){const e=this.defaultQueryOptions(n),t=h(this,Qn).build(this,e),i=t.state.data;return i===void 0?this.fetchQuery(n):(n.revalidateIfStale&&t.isStaleByTime(gp(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(n){return h(this,Qn).findAll(n).map(({queryKey:e,state:t})=>{const i=t.data;return[e,i]})}setQueryData(n,e,t){const i=this.defaultQueryOptions({queryKey:n}),r=h(this,Qn).get(i.queryHash),s=r==null?void 0:r.state.data,a=yW(e,s);if(a!==void 0)return h(this,Qn).build(this,i).setData(a,{...t,manual:!0})}setQueriesData(n,e,t){return Ei.batch(()=>h(this,Qn).findAll(n).map(({queryKey:i})=>[i,this.setQueryData(i,e,t)]))}getQueryState(n){var t;const e=this.defaultQueryOptions({queryKey:n});return(t=h(this,Qn).get(e.queryHash))==null?void 0:t.state}removeQueries(n){const e=h(this,Qn);Ei.batch(()=>{e.findAll(n).forEach(t=>{e.remove(t)})})}resetQueries(n,e){const t=h(this,Qn);return Ei.batch(()=>(t.findAll(n).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...n},e)))}cancelQueries(n,e={}){const t={revert:!0,...e},i=Ei.batch(()=>h(this,Qn).findAll(n).map(r=>r.cancel(t)));return Promise.all(i).then(Ys).catch(Ys)}invalidateQueries(n,e={}){return Ei.batch(()=>(h(this,Qn).findAll(n).forEach(t=>{t.invalidate()}),(n==null?void 0:n.refetchType)==="none"?Promise.resolve():this.refetchQueries({...n,type:(n==null?void 0:n.refetchType)??(n==null?void 0:n.type)??"active"},e)))}refetchQueries(n,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},i=Ei.batch(()=>h(this,Qn).findAll(n).filter(r=>!r.isDisabled()).map(r=>{let s=r.fetch(void 0,t);return t.throwOnError||(s=s.catch(Ys)),r.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(i).then(Ys)}fetchQuery(n){const e=this.defaultQueryOptions(n);e.retry===void 0&&(e.retry=!1);const t=h(this,Qn).build(this,e);return t.isStaleByTime(gp(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(Ys).catch(Ys)}fetchInfiniteQuery(n){return n.behavior=IA(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(Ys).catch(Ys)}ensureInfiniteQueryData(n){return n.behavior=IA(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return $0.isOnline()?h(this,Kl).resumePausedMutations():Promise.resolve()}getQueryCache(){return h(this,Qn)}getMutationCache(){return h(this,Kl)}getDefaultOptions(){return h(this,Ql)}setDefaultOptions(n){_(this,Ql,n)}setQueryDefaults(n,e){h(this,_p).set(eh(n),{queryKey:n,defaultOptions:e})}getQueryDefaults(n){const e=[...h(this,_p).values()],t={};return e.forEach(i=>{kg(n,i.queryKey)&&Object.assign(t,i.defaultOptions)}),t}setMutationDefaults(n,e){h(this,Cp).set(eh(n),{mutationKey:n,defaultOptions:e})}getMutationDefaults(n){const e=[...h(this,Cp).values()],t={};return e.forEach(i=>{kg(n,i.mutationKey)&&Object.assign(t,i.defaultOptions)}),t}defaultQueryOptions(n){if(n._defaulted)return n;const e={...h(this,Ql).queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return e.queryHash||(e.queryHash=vE(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===B0&&(e.enabled=!1),e}defaultMutationOptions(n){return n!=null&&n._defaulted?n:{...h(this,Ql).mutations,...(n==null?void 0:n.mutationKey)&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){h(this,Qn).clear(),h(this,Kl).clear()}},Qn=new WeakMap,Kl=new WeakMap,Ql=new WeakMap,_p=new WeakMap,Cp=new WeakMap,Jl=new WeakMap,Ap=new WeakMap,Pp=new WeakMap,vR),Br,Jt,Fg,Sr,zu,Tp,Zl,ec,Vg,Ip,Rp,Bu,$u,tc,Mp,fn,Wm,F1,V1,U1,z1,B1,$1,W1,lM,xR,MW=(xR=class extends em{constructor(e,t){super();M(this,fn);M(this,Br);M(this,Jt);M(this,Fg);M(this,Sr);M(this,zu);M(this,Tp);M(this,Zl);M(this,ec);M(this,Vg);M(this,Ip);M(this,Rp);M(this,Bu);M(this,$u);M(this,tc);M(this,Mp,new Set);this.options=t,_(this,Br,e),_(this,ec,null),_(this,Zl,L1()),this.options.experimental_prefetchInRender||h(this,Zl).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(h(this,Jt).addObserver(this),MA(h(this,Jt),this.options)?j(this,fn,Wm).call(this):this.updateResult(),j(this,fn,z1).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return H1(h(this,Jt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return H1(h(this,Jt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,j(this,fn,B1).call(this),j(this,fn,$1).call(this),h(this,Jt).removeObserver(this)}setOptions(e){const t=this.options,i=h(this,Jt);if(this.options=h(this,Br).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Da(this.options.enabled,h(this,Jt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");j(this,fn,W1).call(this),h(this,Jt).setOptions(this.options),t._defaulted&&!z0(this.options,t)&&h(this,Br).getQueryCache().notify({type:"observerOptionsUpdated",query:h(this,Jt),observer:this});const r=this.hasListeners();r&&jA(h(this,Jt),i,this.options,t)&&j(this,fn,Wm).call(this),this.updateResult(),r&&(h(this,Jt)!==i||Da(this.options.enabled,h(this,Jt))!==Da(t.enabled,h(this,Jt))||gp(this.options.staleTime,h(this,Jt))!==gp(t.staleTime,h(this,Jt)))&&j(this,fn,F1).call(this);const s=j(this,fn,V1).call(this);r&&(h(this,Jt)!==i||Da(this.options.enabled,h(this,Jt))!==Da(t.enabled,h(this,Jt))||s!==h(this,tc))&&j(this,fn,U1).call(this,s)}getOptimisticResult(e){const t=h(this,Br).getQueryCache().build(h(this,Br),e),i=this.createResult(t,e);return OW(this,i)&&(_(this,Sr,i),_(this,Tp,this.options),_(this,zu,h(this,Jt).state)),i}getCurrentResult(){return h(this,Sr)}trackResult(e,t){return new Proxy(e,{get:(i,r)=>(this.trackProp(r),t==null||t(r),Reflect.get(i,r))})}trackProp(e){h(this,Mp).add(e)}getCurrentQuery(){return h(this,Jt)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=h(this,Br).defaultQueryOptions(e),i=h(this,Br).getQueryCache().build(h(this,Br),t);return i.fetch().then(()=>this.createResult(i,t))}fetch(e){return j(this,fn,Wm).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),h(this,Sr)))}createResult(e,t){var B;const i=h(this,Jt),r=this.options,s=h(this,Sr),a=h(this,zu),o=h(this,Tp),c=e!==i?e.state:h(this,Fg),{state:u}=e;let p={...u},m=!1,g;if(t._optimisticResults){const L=this.hasListeners(),W=!L&&MA(e,t),q=L&&jA(e,i,t,r);(W||q)&&(p={...p,...aM(u.data,e.options)}),t._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:y,errorUpdatedAt:v,status:w}=p;g=p.data;let k=!1;if(t.placeholderData!==void 0&&g===void 0&&w==="pending"){let L;s!=null&&s.isPlaceholderData&&t.placeholderData===(o==null?void 0:o.placeholderData)?(L=s.data,k=!0):L=typeof t.placeholderData=="function"?t.placeholderData((B=h(this,Rp))==null?void 0:B.state.data,h(this,Rp)):t.placeholderData,L!==void 0&&(w="success",g=O1(s==null?void 0:s.data,L,t),m=!0)}if(t.select&&g!==void 0&&!k)if(s&&g===(a==null?void 0:a.data)&&t.select===h(this,Vg))g=h(this,Ip);else try{_(this,Vg,t.select),g=t.select(g),g=O1(s==null?void 0:s.data,g,t),_(this,Ip,g),_(this,ec,null)}catch(L){_(this,ec,L)}h(this,ec)&&(y=h(this,ec),g=h(this,Ip),v=Date.now(),w="error");const S=p.fetchStatus==="fetching",E=w==="pending",P=w==="error",A=E&&S,N=g!==void 0,V={status:w,fetchStatus:p.fetchStatus,isPending:E,isSuccess:w==="success",isError:P,isInitialLoading:A,isLoading:A,data:g,dataUpdatedAt:p.dataUpdatedAt,error:y,errorUpdatedAt:v,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>c.dataUpdateCount||p.errorUpdateCount>c.errorUpdateCount,isFetching:S,isRefetching:S&&!E,isLoadingError:P&&!N,isPaused:p.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:P&&N,isStale:wE(e,t),refetch:this.refetch,promise:h(this,Zl)};if(this.options.experimental_prefetchInRender){const L=X=>{V.status==="error"?X.reject(V.error):V.data!==void 0&&X.resolve(V.data)},W=()=>{const X=_(this,Zl,V.promise=L1());L(X)},q=h(this,Zl);switch(q.status){case"pending":e.queryHash===i.queryHash&&L(q);break;case"fulfilled":(V.status==="error"||V.data!==q.value)&&W();break;case"rejected":(V.status!=="error"||V.error!==q.reason)&&W();break}}return V}updateResult(){const e=h(this,Sr),t=this.createResult(h(this,Jt),this.options);if(_(this,zu,h(this,Jt).state),_(this,Tp,this.options),h(this,zu).data!==void 0&&_(this,Rp,h(this,Jt)),z0(t,e))return;_(this,Sr,t);const i=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,s=typeof r=="function"?r():r;if(s==="all"||!s&&!h(this,Mp).size)return!0;const a=new Set(s??h(this,Mp));return this.options.throwOnError&&a.add("error"),Object.keys(h(this,Sr)).some(o=>{const l=o;return h(this,Sr)[l]!==e[l]&&a.has(l)})};j(this,fn,lM).call(this,{listeners:i()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&j(this,fn,z1).call(this)}},Br=new WeakMap,Jt=new WeakMap,Fg=new WeakMap,Sr=new WeakMap,zu=new WeakMap,Tp=new WeakMap,Zl=new WeakMap,ec=new WeakMap,Vg=new WeakMap,Ip=new WeakMap,Rp=new WeakMap,Bu=new WeakMap,$u=new WeakMap,tc=new WeakMap,Mp=new WeakMap,fn=new WeakSet,Wm=function(e){j(this,fn,W1).call(this);let t=h(this,Jt).fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(Ys)),t},F1=function(){j(this,fn,B1).call(this);const e=gp(this.options.staleTime,h(this,Jt));if(Zd||h(this,Sr).isStale||!R1(e))return;const i=eM(h(this,Sr).dataUpdatedAt,e)+1;_(this,Bu,setTimeout(()=>{h(this,Sr).isStale||this.updateResult()},i))},V1=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(h(this,Jt)):this.options.refetchInterval)??!1},U1=function(e){j(this,fn,$1).call(this),_(this,tc,e),!(Zd||Da(this.options.enabled,h(this,Jt))===!1||!R1(h(this,tc))||h(this,tc)===0)&&_(this,$u,setInterval(()=>{(this.options.refetchIntervalInBackground||xE.isFocused())&&j(this,fn,Wm).call(this)},h(this,tc)))},z1=function(){j(this,fn,F1).call(this),j(this,fn,U1).call(this,j(this,fn,V1).call(this))},B1=function(){h(this,Bu)&&(clearTimeout(h(this,Bu)),_(this,Bu,void 0))},$1=function(){h(this,$u)&&(clearInterval(h(this,$u)),_(this,$u,void 0))},W1=function(){const e=h(this,Br).getQueryCache().build(h(this,Br),this.options);if(e===h(this,Jt))return;const t=h(this,Jt);_(this,Jt,e),_(this,Fg,e.state),this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))},lM=function(e){Ei.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(h(this,Sr))}),h(this,Br).getQueryCache().notify({query:h(this,Jt),type:"observerResultsUpdated"})})},xR);function jW(n,e){return Da(e.enabled,n)!==!1&&n.state.data===void 0&&!(n.state.status==="error"&&e.retryOnMount===!1)}function MA(n,e){return jW(n,e)||n.state.data!==void 0&&H1(n,e,e.refetchOnMount)}function H1(n,e,t){if(Da(e.enabled,n)!==!1){const i=typeof t=="function"?t(n):t;return i==="always"||i!==!1&&wE(n,e)}return!1}function jA(n,e,t,i){return(n!==e||Da(i.enabled,n)===!1)&&(!t.suspense||n.state.status!=="error")&&wE(n,t)}function wE(n,e){return Da(e.enabled,n)!==!1&&n.isStaleByTime(gp(e.staleTime,n))}function OW(n,e){return!z0(n.getCurrentResult(),e)}var nc,ic,$r,Vo,xl,e0,q1,wR,LW=(wR=class extends em{constructor(t,i){super();M(this,xl);M(this,nc);M(this,ic);M(this,$r);M(this,Vo);_(this,nc,t),this.setOptions(i),this.bindMethods(),j(this,xl,e0).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const i=this.options;this.options=h(this,nc).defaultMutationOptions(t),z0(this.options,i)||h(this,nc).getMutationCache().notify({type:"observerOptionsUpdated",mutation:h(this,$r),observer:this}),i!=null&&i.mutationKey&&this.options.mutationKey&&eh(i.mutationKey)!==eh(this.options.mutationKey)?this.reset():((r=h(this,$r))==null?void 0:r.state.status)==="pending"&&h(this,$r).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=h(this,$r))==null||t.removeObserver(this)}onMutationUpdate(t){j(this,xl,e0).call(this),j(this,xl,q1).call(this,t)}getCurrentResult(){return h(this,ic)}reset(){var t;(t=h(this,$r))==null||t.removeObserver(this),_(this,$r,void 0),j(this,xl,e0).call(this),j(this,xl,q1).call(this)}mutate(t,i){var r;return _(this,Vo,i),(r=h(this,$r))==null||r.removeObserver(this),_(this,$r,h(this,nc).getMutationCache().build(h(this,nc),this.options)),h(this,$r).addObserver(this),h(this,$r).execute(t)}},nc=new WeakMap,ic=new WeakMap,$r=new WeakMap,Vo=new WeakMap,xl=new WeakSet,e0=function(){var i;const t=((i=h(this,$r))==null?void 0:i.state)??oM();_(this,ic,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},q1=function(t){Ei.batch(()=>{var i,r,s,a,o,l,c,u;if(h(this,Vo)&&this.hasListeners()){const p=h(this,ic).variables,m=h(this,ic).context;(t==null?void 0:t.type)==="success"?((r=(i=h(this,Vo)).onSuccess)==null||r.call(i,t.data,p,m),(a=(s=h(this,Vo)).onSettled)==null||a.call(s,t.data,null,p,m)):(t==null?void 0:t.type)==="error"&&((l=(o=h(this,Vo)).onError)==null||l.call(o,t.error,p,m),(u=(c=h(this,Vo)).onSettled)==null||u.call(c,void 0,t.error,p,m))}this.listeners.forEach(p=>{p(h(this,ic))})})},wR),cM=T.createContext(void 0),Bx=n=>{const e=T.useContext(cM);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},FW=({client:n,children:e})=>(T.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),pe.jsx(cM.Provider,{value:n,children:e})),uM=T.createContext(!1),VW=()=>T.useContext(uM);uM.Provider;function UW(){let n=!1;return{clearReset:()=>{n=!1},reset:()=>{n=!0},isReset:()=>n}}var zW=T.createContext(UW()),BW=()=>T.useContext(zW);function dM(n,e){return typeof n=="function"?n(...e):!!n}function G1(){}var $W=(n,e)=>{(n.suspense||n.throwOnError||n.experimental_prefetchInRender)&&(e.isReset()||(n.retryOnMount=!1))},WW=n=>{T.useEffect(()=>{n.clearReset()},[n])},HW=({result:n,errorResetBoundary:e,throwOnError:t,query:i,suspense:r})=>n.isError&&!e.isReset()&&!n.isFetching&&i&&(r&&n.data===void 0||dM(t,[n.error,i])),qW=n=>{const e=n.staleTime;n.suspense&&(n.staleTime=typeof e=="function"?(...t)=>Math.max(e(...t),1e3):Math.max(e??1e3,1e3),typeof n.gcTime=="number"&&(n.gcTime=Math.max(n.gcTime,1e3)))},GW=(n,e)=>n.isLoading&&n.isFetching&&!e,YW=(n,e)=>(n==null?void 0:n.suspense)&&e.isPending,OA=(n,e,t)=>e.fetchOptimistic(n).catch(()=>{t.clearReset()});function XW(n,e,t){var p,m,g,y,v;if(typeof n!="object"||Array.isArray(n))throw new Error('Bad argument type. Starting with v5, only the "Object" form is allowed when calling query related functions. Please use the error stack to find the culprit call. More info here: https://tanstack.com/query/latest/docs/react/guides/migrating-to-v5#supports-a-single-signature-one-object');const i=Bx(),r=VW(),s=BW(),a=i.defaultQueryOptions(n);(m=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||m.call(p,a),a.queryFn||console.error(`[${a.queryHash}]: No queryFn was passed as an option, and no default queryFn was found. The queryFn parameter is only optional when using a default queryFn. More info here: https://tanstack.com/query/latest/docs/framework/react/guides/default-query-function`),a._optimisticResults=r?"isRestoring":"optimistic",qW(a),$W(a,s),WW(s);const o=!i.getQueryCache().get(a.queryHash),[l]=T.useState(()=>new e(i,a)),c=l.getOptimisticResult(a),u=!r&&n.subscribed!==!1;if(T.useSyncExternalStore(T.useCallback(w=>{const k=u?l.subscribe(Ei.batchCalls(w)):G1;return l.updateResult(),k},[l,u]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),T.useEffect(()=>{l.setOptions(a)},[a,l]),YW(a,c))throw OA(a,l,s);if(HW({result:c,errorResetBoundary:s,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw c.error;if((y=(g=i.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||y.call(g,a,c),a.experimental_prefetchInRender&&!Zd&&GW(c,r)){const w=o?OA(a,l,s):(v=i.getQueryCache().get(a.queryHash))==null?void 0:v.promise;w==null||w.catch(G1).finally(()=>{l.updateResult()})}return a.notifyOnChangeProps?c:l.trackResult(c)}function KW(n,e){return XW(n,MW)}function hM(n,e){const t=Bx(),[i]=T.useState(()=>new LW(t,n));T.useEffect(()=>{i.setOptions(n)},[i,n]);const r=T.useSyncExternalStore(T.useCallback(a=>i.subscribe(Ei.batchCalls(a)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),s=T.useCallback((a,o)=>{i.mutate(a,o).catch(G1)},[i]);if(r.error&&dM(i.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:s,mutateAsync:r.mutate}}const QW=n=>{const e=n==="light";return rE({palette:{mode:n,primary:{main:"#2563eb",light:"#3b82f6",dark:"#1e40af",contrastText:"#ffffff"},secondary:{main:"#7c3aed",light:"#8b5cf6",dark:"#6d28d9",contrastText:"#ffffff"},error:{main:"#ef4444",light:"#f87171",dark:"#dc2626"},warning:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706"},success:{main:"#10b981",light:"#34d399",dark:"#059669"},info:{main:"#06b6d4",light:"#22d3ee",dark:"#0891b2"},background:{default:e?"#ffffff":"#0f172a",paper:e?"#ffffff":"#1e293b"},text:{primary:e?"#0f172a":"#f1f5f9",secondary:e?"#475569":"#94a3b8"},divider:e?Qe("#94a3b8",.12):Qe("#475569",.12)},typography:{fontFamily:'"Inter", "SF Pro Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',h1:{fontSize:"2.5rem",fontWeight:700,letterSpacing:"-0.02em"},h2:{fontSize:"2rem",fontWeight:600,letterSpacing:"-0.01em"},h3:{fontSize:"1.75rem",fontWeight:600,letterSpacing:"-0.01em"},h4:{fontSize:"1.5rem",fontWeight:600,letterSpacing:"-0.01em"},h5:{fontSize:"1.25rem",fontWeight:600},h6:{fontSize:"1rem",fontWeight:600},subtitle1:{fontSize:"1rem",fontWeight:500},subtitle2:{fontSize:"0.875rem",fontWeight:500},body1:{fontSize:"1rem",lineHeight:1.6},body2:{fontSize:"0.875rem",lineHeight:1.6},button:{textTransform:"none",fontWeight:500,letterSpacing:"0.02em"},caption:{fontSize:"0.75rem",letterSpacing:"0.03em"},overline:{fontSize:"0.75rem",fontWeight:600,letterSpacing:"0.08em",textTransform:"uppercase"}},shape:{borderRadius:8},shadows:["none","0px 1px 2px rgba(0, 0, 0, 0.05)","0px 1px 3px rgba(0, 0, 0, 0.1)","0px 2px 4px rgba(0, 0, 0, 0.1)","0px 3px 6px rgba(0, 0, 0, 0.1)","0px 4px 8px rgba(0, 0, 0, 0.1)","0px 5px 10px rgba(0, 0, 0, 0.1)","0px 6px 12px rgba(0, 0, 0, 0.1)","0px 7px 14px rgba(0, 0, 0, 0.1)","0px 8px 16px rgba(0, 0, 0, 0.1)","0px 9px 18px rgba(0, 0, 0, 0.1)","0px 10px 20px rgba(0, 0, 0, 0.1)","0px 11px 22px rgba(0, 0, 0, 0.1)","0px 12px 24px rgba(0, 0, 0, 0.1)","0px 13px 26px rgba(0, 0, 0, 0.1)","0px 14px 28px rgba(0, 0, 0, 0.1)","0px 15px 30px rgba(0, 0, 0, 0.1)","0px 16px 32px rgba(0, 0, 0, 0.1)","0px 17px 34px rgba(0, 0, 0, 0.1)","0px 18px 36px rgba(0, 0, 0, 0.1)","0px 19px 38px rgba(0, 0, 0, 0.1)","0px 20px 40px rgba(0, 0, 0, 0.1)","0px 21px 42px rgba(0, 0, 0, 0.1)","0px 22px 44px rgba(0, 0, 0, 0.1)","0px 24px 48px rgba(0, 0, 0, 0.15)"],components:{MuiButton:{styleOverrides:{root:{borderRadius:8,padding:"8px 16px",fontWeight:500,boxShadow:"none","&:hover":{boxShadow:"none"}},contained:{"&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"},"&:active":{transform:"translateY(0)"}},outlined:{borderWidth:1.5,"&:hover":{borderWidth:1.5}}}},MuiPaper:{styleOverrides:{root:{backgroundImage:"none"},elevation1:{boxShadow:"0px 1px 3px rgba(0, 0, 0, 0.08)"},elevation2:{boxShadow:"0px 2px 6px rgba(0, 0, 0, 0.08)"},elevation3:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.08)"}}},MuiCard:{styleOverrides:{root:{boxShadow:"0px 1px 3px rgba(0, 0, 0, 0.08)",borderRadius:12,"&:hover":{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.12)"}}}},MuiAppBar:{styleOverrides:{root:{boxShadow:"none",borderBottom:`1px solid ${e?Qe("#94a3b8",.12):Qe("#475569",.12)}`}}},MuiDrawer:{styleOverrides:{paper:{borderRight:`1px solid ${e?Qe("#94a3b8",.12):Qe("#475569",.12)}`}}},MuiListItemButton:{styleOverrides:{root:{borderRadius:8,marginBottom:2,"&.Mui-selected":{backgroundColor:e?Qe("#2563eb",.08):Qe("#3b82f6",.16),"&:hover":{backgroundColor:e?Qe("#2563eb",.12):Qe("#3b82f6",.24)}}}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:e?Qe("#94a3b8",.24):Qe("#475569",.24)},"&:hover fieldset":{borderColor:e?Qe("#94a3b8",.4):Qe("#475569",.4)}}}}},MuiChip:{styleOverrides:{root:{fontWeight:500,borderRadius:6}}},MuiTooltip:{styleOverrides:{tooltip:{backgroundColor:e?"#1e293b":"#0f172a",color:"#f1f5f9",fontSize:"0.75rem",fontWeight:500,padding:"6px 12px",borderRadius:6}}},MuiIconButton:{styleOverrides:{root:{borderRadius:8,"&:hover":{backgroundColor:e?Qe("#94a3b8",.08):Qe("#475569",.08)}}}},MuiTab:{styleOverrides:{root:{textTransform:"none",fontWeight:500,fontSize:"0.875rem",minHeight:48}}},MuiTabs:{styleOverrides:{indicator:{height:3,borderRadius:"3px 3px 0 0"}}},MuiDivider:{styleOverrides:{root:{borderColor:e?Qe("#94a3b8",.12):Qe("#475569",.12)}}}}})},JW={neutral:{50:"#f8f9fa",100:"#f1f3f4",200:"#e8eaed",300:"#dadce0",400:"#bdc1c6",500:"#9aa0a6",600:"#80868b",700:"#5f6368",800:"#3c4043",900:"#202124"},primary:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#1e3a8a",600:"#1e40af",700:"#1d4ed8",800:"#1e3a8a",900:"#1e3a8a"},success:{400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d"},warning:{400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309"},error:{400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c"},dark:{50:"#0a0f1b",100:"#111827",200:"#1f2937",300:"#374151",400:"#4b5563",500:"#6b7280",600:"#9ca3af",700:"#d1d5db",800:"#e5e7eb",900:"#f3f4f6"}},ZW={fontFamily:{primary:'"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", sans-serif'},fontSize:{xs:"0.75rem",sm:"0.875rem",base:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem"},fontWeight:{normal:400,medium:500,semibold:600,bold:700},lineHeight:{tight:1.25,snug:1.375,normal:1.5,relaxed:1.625},letterSpacing:{tight:"-0.025em",normal:"0em",wide:"0.025em",widest:"0.1em"}},eH={base:"0.375rem",md:"0.5rem",lg:"0.75rem",xl:"1rem"},tH={xs:"0 1px 2px rgba(0, 0, 0, 0.05)",sm:"0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06)",base:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",md:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",lg:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",xl:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",interactive:"0 8px 32px rgba(30, 58, 138, 0.15)",panel:"0 4px 20px rgba(0, 0, 0, 0.08)",dark:{xs:"0 1px 2px rgba(0, 0, 0, 0.4)",sm:"0 1px 3px rgba(0, 0, 0, 0.5), 0 1px 2px rgba(0, 0, 0, 0.3)",base:"0 4px 6px -1px rgba(0, 0, 0, 0.5), 0 2px 4px -1px rgba(0, 0, 0, 0.3)",md:"0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.3)",lg:"0 20px 25px -5px rgba(0, 0, 0, 0.5), 0 10px 10px -5px rgba(0, 0, 0, 0.2)",xl:"0 25px 50px -12px rgba(0, 0, 0, 0.6)"}},nH={duration:{instant:"75ms",fastest:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"500ms",slowest:"750ms"},easing:{linear:"linear",ease:"ease",easeIn:"cubic-bezier(0.4, 0, 1, 1)",easeOut:"cubic-bezier(0, 0, 0.2, 1)",easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",smooth:"cubic-bezier(0.25, 0.1, 0.25, 1)",bounce:"cubic-bezier(0.68, -0.55, 0.265, 1.55)",professional:"cubic-bezier(0.16, 1, 0.3, 1)",elegant:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",snappy:"cubic-bezier(0.33, 1.53, 0.69, 0.99)"},transition:{fast:"150ms cubic-bezier(0.4, 0, 0.2, 1)",normal:"200ms cubic-bezier(0.4, 0, 0.2, 1)",colors:"color 150ms cubic-bezier(0.4, 0, 0.2, 1), background-color 150ms cubic-bezier(0.4, 0, 0.2, 1), border-color 150ms cubic-bezier(0.4, 0, 0.2, 1)"}},$x={colors:JW,typography:ZW,borderRadius:eH,shadows:tH,animations:nH},{colors:De,typography:bt,borderRadius:iH,shadows:Ln,animations:Ma}=$x,rH=(n="light")=>{const e=n==="light";return{palette:{mode:n,primary:{main:De.primary[500],light:De.primary[400],dark:De.primary[600],contrastText:"#ffffff",...e?{50:De.primary[50],100:De.primary[100],200:De.primary[200],300:De.primary[300],400:De.primary[400],500:De.primary[500],600:De.primary[600],700:De.primary[700],800:De.primary[800],900:De.primary[900]}:{50:De.primary[900],100:De.primary[800],200:De.primary[700],300:De.primary[600],400:De.primary[500],500:De.primary[400],600:De.primary[300],700:De.primary[200],800:De.primary[100],900:De.primary[50]}},secondary:{main:e?De.neutral[600]:De.neutral[400],light:e?De.neutral[500]:De.neutral[300],dark:e?De.neutral[700]:De.neutral[500],contrastText:e?"#ffffff":De.neutral[900]},success:{main:De.success[500],light:De.success[400],dark:De.success[600],contrastText:"#ffffff"},warning:{main:De.warning[500],light:De.warning[400],dark:De.warning[600],contrastText:"#ffffff"},error:{main:De.error[500],light:De.error[400],dark:De.error[600],contrastText:"#ffffff"},info:{main:De.primary[500],light:De.primary[400],dark:De.primary[600],contrastText:"#ffffff"},background:{default:e?De.neutral[50]:De.neutral[100],paper:e?"#ffffff":De.neutral[200]},text:{primary:e?De.neutral[900]:De.neutral[800],secondary:e?De.neutral[600]:De.neutral[500],disabled:e?De.neutral[500]:De.neutral[400]},divider:e?Qe(De.neutral[900],.08):Qe(De.neutral[600],.12),action:{active:e?De.neutral[700]:De.neutral[600],hover:e?Qe(De.neutral[900],.04):Qe(De.neutral[700],.08),selected:e?Qe(De.primary[500],.08):Qe(De.primary[400],.16),disabled:e?De.neutral[500]:De.neutral[400],disabledBackground:e?Qe(De.neutral[900],.02):Qe(De.neutral[600],.04),focus:e?Qe(De.primary[500],.12):Qe(De.primary[400],.24)},grey:e?{50:De.neutral[50],100:De.neutral[100],200:De.neutral[200],300:De.neutral[300],400:De.neutral[400],500:De.neutral[500],600:De.neutral[600],700:De.neutral[700],800:De.neutral[800],900:De.neutral[900],A100:De.neutral[100],A200:De.neutral[200],A400:De.neutral[400],A700:De.neutral[700]}:{50:De.dark[900],100:De.dark[800],200:De.dark[700],300:De.dark[600],400:De.dark[500],500:De.dark[400],600:De.dark[300],700:De.dark[200],800:De.dark[100],900:De.dark[50],A100:De.dark[800],A200:De.dark[700],A400:De.dark[500],A700:De.dark[200]}},typography:{fontFamily:bt.fontFamily.primary,h1:{fontSize:bt.fontSize["4xl"],fontWeight:bt.fontWeight.bold,lineHeight:bt.lineHeight.tight,letterSpacing:bt.letterSpacing.tight,color:e?De.neutral[900]:De.dark[600]},h2:{fontSize:bt.fontSize["3xl"],fontWeight:bt.fontWeight.bold,lineHeight:bt.lineHeight.tight,letterSpacing:bt.letterSpacing.tight,color:e?De.neutral[900]:De.dark[600]},h3:{fontSize:bt.fontSize["2xl"],fontWeight:bt.fontWeight.semibold,lineHeight:bt.lineHeight.snug,letterSpacing:bt.letterSpacing.normal,color:e?De.neutral[800]:De.dark[600]},h4:{fontSize:bt.fontSize.xl,fontWeight:bt.fontWeight.semibold,lineHeight:bt.lineHeight.snug,letterSpacing:bt.letterSpacing.normal,color:e?De.neutral[800]:De.dark[600]},h5:{fontSize:bt.fontSize.lg,fontWeight:bt.fontWeight.semibold,lineHeight:bt.lineHeight.normal,letterSpacing:bt.letterSpacing.normal,color:e?De.neutral[800]:De.dark[600]},h6:{fontSize:bt.fontSize.base,fontWeight:bt.fontWeight.semibold,lineHeight:bt.lineHeight.normal,letterSpacing:bt.letterSpacing.normal,color:e?De.neutral[800]:De.dark[600]},body1:{fontSize:bt.fontSize.base,fontWeight:bt.fontWeight.normal,lineHeight:bt.lineHeight.relaxed,letterSpacing:bt.letterSpacing.normal,color:e?De.neutral[800]:De.dark[600]},body2:{fontSize:bt.fontSize.sm,fontWeight:bt.fontWeight.normal,lineHeight:bt.lineHeight.normal,letterSpacing:bt.letterSpacing.normal,color:e?De.neutral[700]:De.dark[500]},subtitle1:{fontSize:bt.fontSize.base,fontWeight:bt.fontWeight.medium,lineHeight:bt.lineHeight.normal,letterSpacing:bt.letterSpacing.normal,color:e?De.neutral[800]:De.dark[600]},subtitle2:{fontSize:bt.fontSize.sm,fontWeight:bt.fontWeight.medium,lineHeight:bt.lineHeight.normal,letterSpacing:bt.letterSpacing.wide,color:e?De.neutral[700]:De.dark[500]},caption:{fontSize:bt.fontSize.xs,fontWeight:bt.fontWeight.normal,lineHeight:bt.lineHeight.normal,letterSpacing:bt.letterSpacing.wide,color:e?De.neutral[600]:De.dark[400]},overline:{fontSize:bt.fontSize.xs,fontWeight:bt.fontWeight.medium,lineHeight:bt.lineHeight.normal,letterSpacing:bt.letterSpacing.widest,textTransform:"uppercase",color:e?De.neutral[600]:De.dark[400]},button:{fontSize:bt.fontSize.sm,fontWeight:bt.fontWeight.medium,lineHeight:bt.lineHeight.normal,letterSpacing:bt.letterSpacing.wide,textTransform:"none"}},shape:{borderRadius:parseInt(iH.base.replace("rem",""))*16},spacing:t=>`${.25*t}rem`,shadows:["none",Ln.xs,Ln.sm,Ln.base,Ln.md,Ln.lg,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl,Ln.xl],transitions:{duration:{shortest:parseInt(Ma.duration.instant.replace("ms","")),shorter:parseInt(Ma.duration.fast.replace("ms","")),short:parseInt(Ma.duration.normal.replace("ms","")),standard:parseInt(Ma.duration.slow.replace("ms","")),complex:parseInt(Ma.duration.slower.replace("ms","")),enteringScreen:parseInt(Ma.duration.slow.replace("ms","")),leavingScreen:parseInt(Ma.duration.normal.replace("ms",""))},easing:{easeInOut:Ma.easing.easeInOut,easeOut:Ma.easing.easeOut,easeIn:Ma.easing.easeIn,sharp:"cubic-bezier(0.4, 0, 0.6, 1)"}},zIndex:{mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500}}},sH=(n="light")=>{const e=rH(n);return rE(e)},{colors:Qt,shadows:xn,animations:Ao,borderRadius:rs}=$x,aH=n=>({MuiCssBaseline:{styleOverrides:{"*":{boxSizing:"border-box"},html:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",height:"100%",width:"100%"},body:{height:"100%",width:"100%",margin:0,padding:0,overscrollBehavior:"none",scrollbarWidth:"thin",scrollbarColor:`${n.palette.mode==="dark"?Qt.dark[300]:Qt.neutral[300]} transparent`,"&::-webkit-scrollbar":{width:8,height:8},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{background:n.palette.mode==="dark"?Qt.dark[300]:Qt.neutral[300],borderRadius:4,"&:hover":{background:n.palette.mode==="dark"?Qt.dark[400]:Qt.neutral[400]}},"&::-webkit-scrollbar-corner":{background:"transparent"}},"#root":{height:"100%",width:"100%",display:"flex",flexDirection:"column"},".js-focus-visible :focus:not([data-focus-visible-added])":{outline:"none"}}},MuiAppBar:{styleOverrides:{root:{backgroundColor:n.palette.background.paper,color:n.palette.text.primary,boxShadow:n.palette.mode==="dark"?xn.dark.sm:xn.sm,borderBottom:`1px solid ${n.palette.divider}`,"&.MuiAppBar-positionFixed":{zIndex:n.zIndex.appBar}},colorPrimary:{backgroundColor:n.palette.background.paper,color:n.palette.text.primary}}},MuiButton:{styleOverrides:{root:{borderRadius:parseInt(rs.md.replace("rem",""))*16,textTransform:"none",fontWeight:n.typography.fontWeightMedium,fontSize:n.typography.button.fontSize,lineHeight:1.5,padding:"8px 16px",minHeight:40,transition:Ao.transition.fast,"&:hover":{transform:"translateY(-1px)"},"&:active":{transform:"translateY(0)"},"&:disabled":{transform:"none"}},contained:{boxShadow:n.palette.mode==="dark"?xn.dark.xs:xn.xs,"&:hover":{boxShadow:n.palette.mode==="dark"?xn.dark.sm:xn.sm},"&:active":{boxShadow:n.palette.mode==="dark"?xn.dark.xs:xn.xs}},outlined:{borderWidth:1,"&:hover":{borderWidth:1,backgroundColor:Qe(n.palette.primary.main,.04)}},text:{padding:"6px 8px","&:hover":{backgroundColor:Qe(n.palette.primary.main,.04)}},sizeSmall:{padding:"4px 12px",minHeight:32,fontSize:n.typography.caption.fontSize},sizeLarge:{padding:"12px 24px",minHeight:48,fontSize:n.typography.body1.fontSize}}},MuiCard:{styleOverrides:{root:{backgroundColor:n.palette.background.paper,borderRadius:parseInt(rs.lg.replace("rem",""))*16,boxShadow:n.palette.mode==="dark"?xn.dark.sm:xn.panel,border:`1px solid ${n.palette.divider}`,transition:Ao.transition.normal,"&:hover":{boxShadow:n.palette.mode==="dark"?xn.dark.md:xn.md}}}},MuiPaper:{styleOverrides:{root:{backgroundImage:"none",backgroundColor:n.palette.background.paper},outlined:{borderColor:n.palette.divider,backgroundColor:n.palette.background.paper},elevation1:{boxShadow:n.palette.mode==="dark"?xn.dark.xs:xn.xs},elevation2:{boxShadow:n.palette.mode==="dark"?xn.dark.sm:xn.sm},elevation4:{boxShadow:n.palette.mode==="dark"?xn.dark.base:xn.base},elevation8:{boxShadow:n.palette.mode==="dark"?xn.dark.lg:xn.lg}}},MuiTextField:{styleOverrides:{root:{"& .MuiInputLabel-root":{color:n.palette.text.secondary,fontSize:n.typography.body2.fontSize,fontWeight:n.typography.fontWeightMedium},"& .MuiInputLabel-root.Mui-focused":{color:n.palette.primary.main}}}},MuiOutlinedInput:{styleOverrides:{root:{borderRadius:parseInt(rs.md.replace("rem",""))*16,backgroundColor:n.palette.background.paper,transition:Ao.transition.fast,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:n.palette.text.secondary},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:n.palette.primary.main,borderWidth:2,boxShadow:`0 0 0 3px ${Qe(n.palette.primary.main,.08)}`},"&.Mui-error .MuiOutlinedInput-notchedOutline":{borderColor:n.palette.error.main,"&:focus-within":{boxShadow:`0 0 0 3px ${Qe(n.palette.error.main,.08)}`}}},notchedOutline:{borderColor:n.palette.divider,transition:Ao.transition.fast},input:{padding:"12px 14px",fontSize:n.typography.body1.fontSize,lineHeight:n.typography.body1.lineHeight,"&::placeholder":{color:n.palette.text.disabled,opacity:1}},sizeSmall:{"& .MuiOutlinedInput-input":{padding:"8px 12px"}}}},MuiSelect:{styleOverrides:{root:{borderRadius:parseInt(rs.md.replace("rem",""))*16},icon:{color:n.palette.text.secondary,transition:Ao.transition.fast,"&.Mui-disabled":{color:n.palette.text.disabled}}}},MuiMenu:{styleOverrides:{paper:{borderRadius:parseInt(rs.lg.replace("rem",""))*16,boxShadow:n.palette.mode==="dark"?xn.dark.lg:xn.lg,border:`1px solid ${n.palette.divider}`,marginTop:4,minWidth:200},list:{padding:8}}},MuiMenuItem:{styleOverrides:{root:{borderRadius:parseInt(rs.base.replace("rem",""))*16,margin:"2px 0",padding:"8px 12px",fontSize:n.typography.body2.fontSize,transition:Ao.transition.fast,"&:hover":{backgroundColor:Qe(n.palette.primary.main,.04)},"&.Mui-selected":{backgroundColor:Qe(n.palette.primary.main,.08),"&:hover":{backgroundColor:Qe(n.palette.primary.main,.12)}}}}},MuiDialog:{styleOverrides:{paper:{borderRadius:parseInt(rs.xl.replace("rem",""))*16,boxShadow:n.palette.mode==="dark"?xn.dark.xl:xn.interactive,border:`1px solid ${n.palette.divider}`,backgroundImage:"none"},paperWidthSm:{maxWidth:480},paperWidthMd:{maxWidth:720},paperWidthLg:{maxWidth:960}}},MuiDialogTitle:{styleOverrides:{root:{padding:"24px 24px 16px",fontSize:n.typography.h5.fontSize,fontWeight:n.typography.fontWeightSemiBold,color:n.palette.text.primary}}},MuiDialogContent:{styleOverrides:{root:{padding:"0 24px",color:n.palette.text.primary}}},MuiDialogActions:{styleOverrides:{root:{padding:"16px 24px 24px",gap:8}}},MuiTabs:{styleOverrides:{root:{borderBottom:`1px solid ${n.palette.divider}`,minHeight:48},indicator:{height:3,borderRadius:"3px 3px 0 0",backgroundColor:n.palette.primary.main},flexContainer:{gap:8}}},MuiTab:{styleOverrides:{root:{textTransform:"none",fontSize:n.typography.body2.fontSize,fontWeight:n.typography.fontWeightMedium,color:n.palette.text.secondary,padding:"12px 16px",minHeight:48,transition:Ao.transition.fast,"&:hover":{color:n.palette.text.primary,backgroundColor:Qe(n.palette.primary.main,.04)},"&.Mui-selected":{color:n.palette.primary.main,fontWeight:n.typography.fontWeightSemiBold}}}},MuiTableContainer:{styleOverrides:{root:{borderRadius:parseInt(rs.lg.replace("rem",""))*16,border:`1px solid ${n.palette.divider}`,overflow:"hidden"}}},MuiTable:{styleOverrides:{root:{borderCollapse:"separate",borderSpacing:0}}},MuiTableHead:{styleOverrides:{root:{backgroundColor:n.palette.mode==="dark"?Qt.dark[100]:Qt.neutral[50]}}},MuiTableCell:{styleOverrides:{root:{borderBottomColor:n.palette.divider,padding:"16px",fontSize:n.typography.body2.fontSize,lineHeight:n.typography.body2.lineHeight},head:{backgroundColor:"inherit",color:n.palette.text.primary,fontWeight:n.typography.fontWeightSemiBold,fontSize:n.typography.body2.fontSize,borderBottomWidth:2,borderBottomColor:n.palette.divider},body:{color:n.palette.text.primary,"&:last-child":{paddingRight:24}}}},MuiTableRow:{styleOverrides:{root:{transition:Ao.transition.fast,"&:hover":{backgroundColor:Qe(n.palette.primary.main,.02)},"&:last-child td":{borderBottom:"none"}},head:{"&:hover":{backgroundColor:"transparent"}}}},MuiChip:{styleOverrides:{root:{borderRadius:parseInt(rs.md.replace("rem",""))*16,fontSize:n.typography.caption.fontSize,fontWeight:n.typography.fontWeightMedium,height:28,"& .MuiChip-label":{padding:"0 8px"}},filled:{backgroundColor:n.palette.mode==="dark"?Qt.dark[200]:Qt.neutral[100],color:n.palette.text.primary,"&:hover":{backgroundColor:n.palette.mode==="dark"?Qt.dark[300]:Qt.neutral[200]}},outlined:{borderColor:n.palette.divider,backgroundColor:"transparent","&:hover":{backgroundColor:Qe(n.palette.text.primary,.04)}}}},MuiAlert:{styleOverrides:{root:{borderRadius:parseInt(rs.lg.replace("rem",""))*16,border:"1px solid transparent","& .MuiAlert-icon":{marginRight:12,padding:0,opacity:1},"& .MuiAlert-message":{padding:0,color:"inherit"}},standardSuccess:{backgroundColor:Qe(Qt.success[500],.1),borderColor:Qe(Qt.success[500],.2),color:n.palette.mode==="dark"?Qt.success[400]:Qt.success[700]},standardError:{backgroundColor:Qe(Qt.error[500],.1),borderColor:Qe(Qt.error[500],.2),color:n.palette.mode==="dark"?Qt.error[400]:Qt.error[700]},standardWarning:{backgroundColor:Qe(Qt.warning[500],.1),borderColor:Qe(Qt.warning[500],.2),color:n.palette.mode==="dark"?Qt.warning[400]:Qt.warning[700]},standardInfo:{backgroundColor:Qe(Qt.primary[500],.1),borderColor:Qe(Qt.primary[500],.2),color:n.palette.mode==="dark"?Qt.primary[400]:Qt.primary[700]}}},MuiDivider:{styleOverrides:{root:{borderColor:n.palette.divider,opacity:1},withChildren:{"&::before, &::after":{borderColor:n.palette.divider}}}},MuiTooltip:{styleOverrides:{tooltip:{backgroundColor:n.palette.mode==="dark"?Qt.dark[800]:Qt.neutral[800],color:n.palette.mode==="dark"?Qt.dark[100]:"#ffffff",fontSize:n.typography.caption.fontSize,padding:"8px 12px",borderRadius:parseInt(rs.md.replace("rem",""))*16,boxShadow:n.palette.mode==="dark"?xn.dark.lg:xn.lg,maxWidth:300},arrow:{color:n.palette.mode==="dark"?Qt.dark[800]:Qt.neutral[800]}}},MuiBackdrop:{styleOverrides:{root:{backgroundColor:Qe(n.palette.common.black,.5),backdropFilter:"blur(4px)"}}},MuiDrawer:{styleOverrides:{paper:{backgroundColor:n.palette.background.paper,borderColor:n.palette.divider,borderWidth:1},paperAnchorLeft:{borderRight:`1px solid ${n.palette.divider}`,borderLeft:"none"},paperAnchorRight:{borderLeft:`1px solid ${n.palette.divider}`,borderRight:"none"}}},MuiList:{styleOverrides:{root:{padding:"8px 0"}}},MuiListItem:{styleOverrides:{root:{paddingTop:4,paddingBottom:4,"&.Mui-selected":{backgroundColor:Qe(n.palette.primary.main,.08),borderRadius:parseInt(rs.base.replace("rem",""))*16,margin:"2px 8px","&:hover":{backgroundColor:Qe(n.palette.primary.main,.12)}}}}},MuiListItemButton:{styleOverrides:{root:{borderRadius:parseInt(rs.base.replace("rem",""))*16,margin:"2px 8px",transition:Ao.transition.fast,"&:hover":{backgroundColor:Qe(n.palette.primary.main,.04)},"&.Mui-selected":{backgroundColor:Qe(n.palette.primary.main,.08),"&:hover":{backgroundColor:Qe(n.palette.primary.main,.12)}}}}},MuiListItemText:{styleOverrides:{primary:{fontSize:n.typography.body2.fontSize,fontWeight:n.typography.fontWeightMedium,color:n.palette.text.primary},secondary:{fontSize:n.typography.caption.fontSize,color:n.palette.text.secondary}}},MuiSwitch:{styleOverrides:{root:{width:52,height:32,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(20px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:n.palette.primary.main,opacity:1,border:0}},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:28,height:28,boxShadow:n.palette.mode==="dark"?xn.dark.sm:xn.sm},"& .MuiSwitch-track":{borderRadius:16,backgroundColor:n.palette.mode==="dark"?Qt.dark[300]:Qt.neutral[300],opacity:1,transition:n.transitions.create(["background-color"],{duration:500})}}}}}),{animations:LA}=$x,oH={fadeIn:li`
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  `,fadeOut:li`
    from {
      opacity: 1;
    }
    to {
      opacity: 0;
    }
  `,scaleIn:li`
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  `,scaleOut:li`
    from {
      opacity: 1;
      transform: scale(1);
    }
    to {
      opacity: 0;
      transform: scale(0.95);
    }
  `,slideInUp:li`
    from {
      opacity: 0;
      transform: translateY(24px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  `,slideInDown:li`
    from {
      opacity: 0;
      transform: translateY(-24px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  `,slideInLeft:li`
    from {
      opacity: 0;
      transform: translateX(-24px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  `,slideInRight:li`
    from {
      opacity: 0;
      transform: translateX(24px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  `,pulse:li`
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  `,shimmer:li`
    0% {
      background-position: -200px 0;
    }
    100% {
      background-position: calc(200px + 100%) 0;
    }
  `,spin:li`
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  `,lift:li`
    from {
      transform: translateY(0) scale(1);
    }
    to {
      transform: translateY(-2px) scale(1.02);
    }
  `,drawerSlideIn:li`
    from {
      transform: translateX(-100%);
    }
    to {
      transform: translateX(0);
    }
  `,drawerSlideOut:li`
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(-100%);
    }
  `,modalFadeIn:li`
    from {
      opacity: 0;
      transform: scale(0.9) translateY(-8px);
    }
    to {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
  `,modalFadeOut:li`
    from {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
    to {
      opacity: 0;
      transform: scale(0.9) translateY(-8px);
    }
  `,notificationSlideIn:li`
    from {
      opacity: 0;
      transform: translateX(100%);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  `,notificationSlideOut:li`
    from {
      opacity: 1;
      transform: translateX(0);
    }
    to {
      opacity: 0;
      transform: translateX(100%);
    }
  `,progressIndeterminate:li`
    0% {
      left: -35%;
      right: 100%;
    }
    60% {
      left: 100%;
      right: -90%;
    }
    100% {
      left: 100%;
      right: -90%;
    }
  `,typingDot:li`
    0%, 60%, 100% {
      transform: translateY(0);
      opacity: 0.4;
    }
    30% {
      transform: translateY(-10px);
      opacity: 1;
    }
  `},Sa=(n,e="normal",t="easeInOut",i="0ms")=>`${Array.isArray(n)?n.join(", "):n} ${LA.duration[e]} ${LA.easing[t]} ${i}`;Sa(["transform","box-shadow"]),Sa("transform"),Sa(["box-shadow","background-color"]),Sa(["border-color","box-shadow"]),Sa("background-color");Sa("transform","fast"),Sa(["transform","background-color"],"normal"),Sa(["color","border-color"],"fast"),Sa(["background-color","color"],"fast"),Sa(["border-color","box-shadow","background-color"],"fast"),Sa(["transform","box-shadow"],"normal");const FA={keyframes:oH},VA=(n="light")=>{const e=sH(n);return rE({...e,components:{...e.components,...aH(e)}})};VA("light"),VA("dark");const{colors:dt,animations:vu}=$x,lH=()=>{const n=oh(),e=n.palette.mode==="dark";return b.jsxDEV(s4,{styles:{":root":{"--color-primary-50":dt.primary[50],"--color-primary-100":dt.primary[100],"--color-primary-200":dt.primary[200],"--color-primary-300":dt.primary[300],"--color-primary-400":dt.primary[400],"--color-primary-500":dt.primary[500],"--color-primary-600":dt.primary[600],"--color-primary-700":dt.primary[700],"--color-primary-800":dt.primary[800],"--color-primary-900":dt.primary[900],"--color-neutral-50":e?dt.dark[900]:dt.neutral[50],"--color-neutral-100":e?dt.dark[800]:dt.neutral[100],"--color-neutral-200":e?dt.dark[700]:dt.neutral[200],"--color-neutral-300":e?dt.dark[600]:dt.neutral[300],"--color-neutral-400":e?dt.dark[500]:dt.neutral[400],"--color-neutral-500":e?dt.dark[400]:dt.neutral[500],"--color-neutral-600":e?dt.dark[300]:dt.neutral[600],"--color-neutral-700":e?dt.dark[200]:dt.neutral[700],"--color-neutral-800":e?dt.dark[100]:dt.neutral[800],"--color-neutral-900":e?dt.dark[50]:dt.neutral[900],"--color-success":dt.success[500],"--color-warning":dt.warning[500],"--color-error":dt.error[500],"--duration-fast":vu.duration.fast,"--duration-normal":vu.duration.normal,"--duration-slow":vu.duration.slow,"--easing-ease-in-out":vu.easing.easeInOut,"--easing-ease-out":vu.easing.easeOut,"--shadow-sm":e?"0 1px 3px rgba(0, 0, 0, 0.4)":"0 1px 3px rgba(0, 0, 0, 0.1)","--shadow-md":e?"0 10px 15px -3px rgba(0, 0, 0, 0.4)":"0 10px 15px -3px rgba(0, 0, 0, 0.1)","--shadow-lg":e?"0 20px 25px -5px rgba(0, 0, 0, 0.4)":"0 20px 25px -5px rgba(0, 0, 0, 0.1)","--shadow-interactive":"0 8px 32px rgba(37, 99, 235, 0.15)","--shadow-panel":"0 4px 20px rgba(0, 0, 0, 0.08)"},"*":{boxSizing:"border-box",margin:0,padding:0},"*::before, *::after":{boxSizing:"border-box"},html:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",height:"100%",width:"100%",fontSize:"16px",lineHeight:1.5,fontFamily:n.typography.fontFamily,WebkitTextSizeAdjust:"100%",textRendering:"optimizeLegibility",WebkitFontFeatureSettings:'"kern" 1',fontFeatureSettings:'"kern" 1'},body:{height:"100%",width:"100%",margin:0,padding:0,backgroundColor:n.palette.background.default,color:n.palette.text.primary,fontFamily:n.typography.fontFamily,fontSize:n.typography.body1.fontSize,lineHeight:n.typography.body1.lineHeight,overscrollBehavior:"none",scrollbarWidth:"thin",scrollbarColor:`${e?dt.dark[300]:dt.neutral[300]} transparent`,"&::-webkit-scrollbar":{width:8,height:8,backgroundColor:"transparent"},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-thumb":{backgroundColor:e?dt.dark[300]:dt.neutral[300],borderRadius:4,border:"2px solid transparent",backgroundClip:"padding-box","&:hover":{backgroundColor:e?dt.dark[400]:dt.neutral[400]},"&:active":{backgroundColor:e?dt.dark[500]:dt.neutral[500]}},"&::-webkit-scrollbar-corner":{backgroundColor:"transparent"}},"#root":{height:"100vh",width:"100vw",display:"flex",flexDirection:"column",overflow:"hidden"},"*:focus-visible":{outline:`2px solid ${dt.primary[500]}`,outlineOffset:2,borderRadius:4},".js-focus-visible :focus:not([data-focus-visible-added])":{outline:"none"},a:{color:dt.primary[500],textDecoration:"none",transition:vu.transition.colors,"&:hover":{color:dt.primary[600],textDecoration:"underline"},"&:focus-visible":{outline:`2px solid ${dt.primary[500]}`,outlineOffset:2,borderRadius:2}},"h1, h2, h3, h4, h5, h6":{fontWeight:n.typography.fontWeightSemiBold,lineHeight:1.25,color:n.palette.text.primary,margin:0},p:{margin:0,lineHeight:1.6,color:n.palette.text.primary,"& + p":{marginTop:"1rem"}},"ul, ol":{margin:0,paddingLeft:"1.5rem","& li":{margin:"0.25rem 0",lineHeight:1.5}},table:{borderCollapse:"collapse",borderSpacing:0,width:"100%","& th, & td":{textAlign:"left",padding:"0.75rem",borderBottom:`1px solid ${n.palette.divider}`},"& th":{fontWeight:n.typography.fontWeightSemiBold,backgroundColor:e?dt.dark[100]:dt.neutral[50],color:n.palette.text.primary}},"input, textarea, select":{fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",margin:0},button:{fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",margin:0,cursor:"pointer","&:disabled":{cursor:"not-allowed"}},"::selection":{backgroundColor:`${dt.primary[500]}20`,color:n.palette.text.primary},"::-moz-selection":{backgroundColor:`${dt.primary[500]}20`,color:n.palette.text.primary},".drag-over":{backgroundColor:`${dt.primary[500]}08`,borderColor:dt.primary[500],"&::after":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:`${dt.primary[500]}04`,pointerEvents:"none"}},".loading-shimmer":{background:`linear-gradient(90deg, 
            ${e?dt.dark[200]:dt.neutral[100]} 25%, 
            ${e?dt.dark[100]:dt.neutral[50]} 50%, 
            ${e?dt.dark[200]:dt.neutral[100]} 75%
          )`,backgroundSize:"200px 100%",animation:`${FA.keyframes.shimmer} 1.5s infinite linear`},".loading-pulse":{animation:`${FA.keyframes.pulse} 2s ${vu.easing.easeInOut} infinite`},".sr-only":{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:0},".truncate":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},".line-clamp-2":{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,overflow:"hidden"},".line-clamp-3":{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:3,overflow:"hidden"},img:{maxWidth:"100%",height:"auto",display:"block"},"pre, code":{fontFamily:n.typography.fontFamily,fontSize:"0.875em",backgroundColor:e?dt.dark[100]:dt.neutral[100],color:n.palette.text.primary,borderRadius:4},code:{padding:"0.125rem 0.25rem"},pre:{padding:"1rem",overflow:"auto",lineHeight:1.5,"& code":{padding:0,backgroundColor:"transparent"}},"@media print":{"*":{textShadow:"none !important",boxShadow:"none !important"},"a, a:visited":{textDecoration:"underline"},"pre, blockquote":{border:`1px solid ${dt.neutral[400]}`,pageBreakInside:"avoid"},thead:{display:"table-header-group"},"tr, img":{pageBreakInside:"avoid"},img:{maxWidth:"100% !important"},"p, h2, h3":{orphans:3,widows:3},"h2, h3":{pageBreakAfter:"avoid"}},"@media (prefers-contrast: high)":{"*:focus-visible":{outline:"3px solid currentColor",outlineOffset:3}},"@media (prefers-reduced-motion: reduce)":{"*":{animationDuration:"0.01ms !important",animationIterationCount:"1 !important",transitionDuration:"0.01ms !important",scrollBehavior:"auto !important"}}}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/theme/GlobalStyles.tsx",lineNumber:12,columnNumber:5},void 0)},cH=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ta(async()=>{const{default:i}=await Promise.resolve().then(()=>tm);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)};class kE extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class uH extends kE{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class UA extends kE{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class zA extends kE{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Y1;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Y1||(Y1={}));var dH=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(i.next(u))}catch(p){a(p)}}function l(u){try{c(i.throw(u))}catch(p){a(p)}}function c(u){u.done?s(u.value):r(u.value).then(o,l)}c((i=i.apply(n,e||[])).next())})};class hH{constructor(e,{headers:t={},customFetch:i,region:r=Y1.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=cH(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var i;return dH(this,void 0,void 0,function*(){try{const{headers:r,method:s,body:a}=t;let o={},{region:l}=t;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;a&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const p=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:u}).catch(v=>{throw new uH(v)}),m=p.headers.get("x-relay-error");if(m&&m==="true")throw new UA(p);if(!p.ok)throw new zA(p);let g=((i=p.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),y;return g==="application/json"?y=yield p.json():g==="application/octet-stream"?y=yield p.blob():g==="text/event-stream"?y=p:g==="multipart/form-data"?y=yield p.formData():y=yield p.text(),{data:y,error:null,response:p}}catch(r){return{data:null,error:r,response:r instanceof zA||r instanceof UA?r.context:void 0}}})}}var Ii={},jh={},Oh={},Lh={},Fh={},Vh={},pH=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Yf=pH();const fH=Yf.fetch,pM=Yf.fetch.bind(Yf),fM=Yf.Headers,mH=Yf.Request,gH=Yf.Response,tm=Object.freeze(Object.defineProperty({__proto__:null,Headers:fM,Request:mH,Response:gH,default:pM,fetch:fH},Symbol.toStringTag,{value:"Module"})),bH=t4(tm);var Nv={},BA;function mM(){if(BA)return Nv;BA=1,Object.defineProperty(Nv,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Nv.default=n,Nv}var $A;function gM(){if($A)return Vh;$A=1;var n=Vh&&Vh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Vh,"__esModule",{value:!0});const e=n(bH),t=n(mM());class i{constructor(s){var a,o;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(a=s.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=s.signal,this.isMaybeSingle=(o=s.isMaybeSingle)!==null&&o!==void 0?o:!1,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,a){return this.headers=new Headers(this.headers),this.headers.set(s,a),this}then(s,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,p,m,g;let y=null,v=null,w=null,k=c.status,S=c.statusText;if(c.ok){if(this.method!=="HEAD"){const N=await c.text();N===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?v=N:v=JSON.parse(N))}const P=(p=this.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),A=(m=c.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");P&&A&&A.length>1&&(w=parseInt(A[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(y={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,w=null,k=406,S="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const P=await c.text();try{y=JSON.parse(P),Array.isArray(y)&&c.status===404&&(v=[],y=null,k=200,S="OK")}catch{c.status===404&&P===""?(k=204,S="No Content"):y={message:P}}if(y&&this.isMaybeSingle&&(!((g=y==null?void 0:y.details)===null||g===void 0)&&g.includes("0 rows"))&&(y=null,k=200,S="OK"),y&&this.shouldThrowOnError)throw new t.default(y)}return{error:y,data:v,count:w,status:k,statusText:S}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,p,m;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(p=c==null?void 0:c.stack)!==null&&p!==void 0?p:""}`,hint:"",code:`${(m=c==null?void 0:c.code)!==null&&m!==void 0?m:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,a)}returns(){return this}overrideTypes(){return this}}return Vh.default=i,Vh}var WA;function bM(){if(WA)return Fh;WA=1;var n=Fh&&Fh.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Fh,"__esModule",{value:!0});const e=n(gM());class t extends e.default{select(r){let s=!1;const a=(r??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:s=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${r}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:s,referencedTable:a=s}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${r}`),this}range(r,s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${r}`),this.url.searchParams.set(c,`${s-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:s=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var u;const p=[r?"analyze":null,s?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),m=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${m}"; options=${p};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return Fh.default=t,Fh}var HA;function DE(){if(HA)return Lh;HA=1;var n=Lh&&Lh.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Lh,"__esModule",{value:!0});const e=n(bM());class t extends e.default{eq(r,s){return this.url.searchParams.append(r,`eq.${s}`),this}neq(r,s){return this.url.searchParams.append(r,`neq.${s}`),this}gt(r,s){return this.url.searchParams.append(r,`gt.${s}`),this}gte(r,s){return this.url.searchParams.append(r,`gte.${s}`),this}lt(r,s){return this.url.searchParams.append(r,`lt.${s}`),this}lte(r,s){return this.url.searchParams.append(r,`lte.${s}`),this}like(r,s){return this.url.searchParams.append(r,`like.${s}`),this}likeAllOf(r,s){return this.url.searchParams.append(r,`like(all).{${s.join(",")}}`),this}likeAnyOf(r,s){return this.url.searchParams.append(r,`like(any).{${s.join(",")}}`),this}ilike(r,s){return this.url.searchParams.append(r,`ilike.${s}`),this}ilikeAllOf(r,s){return this.url.searchParams.append(r,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(r,s){return this.url.searchParams.append(r,`ilike(any).{${s.join(",")}}`),this}is(r,s){return this.url.searchParams.append(r,`is.${s}`),this}in(r,s){const a=Array.from(new Set(s)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(r,`in.(${a})`),this}contains(r,s){return typeof s=="string"?this.url.searchParams.append(r,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(r,`cs.{${s.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(s)}`),this}containedBy(r,s){return typeof s=="string"?this.url.searchParams.append(r,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(r,`cd.{${s.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(s)}`),this}rangeGt(r,s){return this.url.searchParams.append(r,`sr.${s}`),this}rangeGte(r,s){return this.url.searchParams.append(r,`nxl.${s}`),this}rangeLt(r,s){return this.url.searchParams.append(r,`sl.${s}`),this}rangeLte(r,s){return this.url.searchParams.append(r,`nxr.${s}`),this}rangeAdjacent(r,s){return this.url.searchParams.append(r,`adj.${s}`),this}overlaps(r,s){return typeof s=="string"?this.url.searchParams.append(r,`ov.${s}`):this.url.searchParams.append(r,`ov.{${s.join(",")}}`),this}textSearch(r,s,{config:a,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const c=a===void 0?"":`(${a})`;return this.url.searchParams.append(r,`${l}fts${c}.${s}`),this}match(r){return Object.entries(r).forEach(([s,a])=>{this.url.searchParams.append(s,`eq.${a}`)}),this}not(r,s,a){return this.url.searchParams.append(r,`not.${s}.${a}`),this}or(r,{foreignTable:s,referencedTable:a=s}={}){const o=a?`${a}.or`:"or";return this.url.searchParams.append(o,`(${r})`),this}filter(r,s,a){return this.url.searchParams.append(r,`${s}.${a}`),this}}return Lh.default=t,Lh}var qA;function yM(){if(qA)return Oh;qA=1;var n=Oh&&Oh.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Oh,"__esModule",{value:!0});const e=n(DE());class t{constructor(r,{headers:s={},schema:a,fetch:o}){this.url=r,this.headers=new Headers(s),this.schema=a,this.fetch=o}select(r,{head:s=!1,count:a}={}){const o=s?"HEAD":"GET";let l=!1;const c=(r??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:s,defaultToNull:a=!0}={}){var o;const l="POST";if(s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const c=r.reduce((u,p)=>u.concat(Object.keys(p)),[]);if(c.length>0){const u=[...new Set(c)].map(p=>`"${p}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(r,{onConflict:s,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){var c;const u="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),o&&this.headers.append("Prefer",`count=${o}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const p=r.reduce((m,g)=>m.concat(Object.keys(g)),[]);if(p.length>0){const m=[...new Set(p)].map(g=>`"${g}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}update(r,{count:s}={}){var a;const o="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:r}={}){var s;const a="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return Oh.default=t,Oh}var GA;function yH(){if(GA)return jh;GA=1;var n=jh&&jh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(jh,"__esModule",{value:!0});const e=n(yM()),t=n(DE());class i{constructor(s,{headers:a={},schema:o,fetch:l}={}){this.url=s,this.headers=new Headers(a),this.schemaName=o,this.fetch=l}from(s){const a=new URL(`${this.url}/${s}`);return new e.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new i(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,a={},{head:o=!1,get:l=!1,count:c}={}){var u;let p;const m=new URL(`${this.url}/rpc/${s}`);let g;o||l?(p=o?"HEAD":"GET",Object.entries(a).filter(([v,w])=>w!==void 0).map(([v,w])=>[v,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([v,w])=>{m.searchParams.append(v,w)})):(p="POST",g=a);const y=new Headers(this.headers);return c&&y.set("Prefer",`count=${c}`),new t.default({method:p,url:m,headers:y,schema:this.schemaName,body:g,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return jh.default=i,jh}var YA;function vH(){if(YA)return Ii;YA=1;var n=Ii&&Ii.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.PostgrestError=Ii.PostgrestBuilder=Ii.PostgrestTransformBuilder=Ii.PostgrestFilterBuilder=Ii.PostgrestQueryBuilder=Ii.PostgrestClient=void 0;const e=n(yH());Ii.PostgrestClient=e.default;const t=n(yM());Ii.PostgrestQueryBuilder=t.default;const i=n(DE());Ii.PostgrestFilterBuilder=i.default;const r=n(bM());Ii.PostgrestTransformBuilder=r.default;const s=n(gM());Ii.PostgrestBuilder=s.default;const a=n(mM());return Ii.PostgrestError=a.default,Ii.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:s.default,PostgrestError:a.default},Ii}var xH=vH();const wH=Jf(xH),{PostgrestClient:kH,PostgrestQueryBuilder:Ioe,PostgrestFilterBuilder:Roe,PostgrestTransformBuilder:Moe,PostgrestBuilder:joe,PostgrestError:Ooe}=wH;class DH{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const SH="2.15.1",EH=`realtime-js/${SH}`,NH="1.0.0",X1=1e4,_H=1e3,CH=100;var pg;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(pg||(pg={}));var vi;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(vi||(vi={}));var ka;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(ka||(ka={}));var K1;(function(n){n.websocket="websocket"})(K1||(K1={}));var Tu;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Tu||(Tu={}));class AH{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),i=new TextDecoder;return this._decodeBroadcast(e,t,i)}_decodeBroadcast(e,t,i){const r=t.getUint8(1),s=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=i.decode(e.slice(a,a+r));a=a+r;const l=i.decode(e.slice(a,a+s));a=a+s;const c=JSON.parse(i.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class vM{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Cn;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Cn||(Cn={}));const XA=(n,e,t={})=>{var i;const r=(i=t.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(e).reduce((s,a)=>(s[a]=PH(a,n,e,r),s),{})},PH=(n,e,t,i)=>{const r=e.find(o=>o.name===n),s=r==null?void 0:r.type,a=t[n];return s&&!i.includes(s)?xM(s,a):Q1(a)},xM=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return MH(e,t)}switch(n){case Cn.bool:return TH(e);case Cn.float4:case Cn.float8:case Cn.int2:case Cn.int4:case Cn.int8:case Cn.numeric:case Cn.oid:return IH(e);case Cn.json:case Cn.jsonb:return RH(e);case Cn.timestamp:return jH(e);case Cn.abstime:case Cn.date:case Cn.daterange:case Cn.int4range:case Cn.int8range:case Cn.money:case Cn.reltime:case Cn.text:case Cn.time:case Cn.timestamptz:case Cn.timetz:case Cn.tsrange:case Cn.tstzrange:return Q1(e);default:return Q1(e)}},Q1=n=>n,TH=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},IH=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},RH=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},MH=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let s;const a=n.slice(1,t);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>xM(e,o))}return n},jH=n=>typeof n=="string"?n.replace(" ","T"):n,wM=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Ik{constructor(e,t,i={},r=X1){this.channel=e,this.event=t,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var KA;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(KA||(KA={}));class fg{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fg.syncState(this.state,r,s,a),this.pendingDiffs.forEach(l=>{this.state=fg.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(i.diff,{},r=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=fg.syncDiff(this.state,r,s,a),o())}),this.onJoin((r,s,a)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:s,newPresences:a})}),this.onLeave((r,s,a)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,r){const s=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(s,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const p=s[c];if(p){const m=u.map(w=>w.presence_ref),g=p.map(w=>w.presence_ref),y=u.filter(w=>g.indexOf(w.presence_ref)<0),v=p.filter(w=>m.indexOf(w.presence_ref)<0);y.length>0&&(o[c]=y),v.length>0&&(l[c]=v)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},i,r)}static syncDiff(e,t,i,r){const{joins:s,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const p=e[o].map(g=>g.presence_ref),m=u.filter(g=>p.indexOf(g.presence_ref)<0);e[o].unshift(...m)}i(o,u,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(p=>p.presence_ref);c=c.filter(p=>u.indexOf(p.presence_ref)<0),e[o]=c,r(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const r=e[i];return"metas"in r?t[i]=r.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[i]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var QA;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(QA||(QA={}));var mg;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(mg||(mg={}));var jo;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(jo||(jo={}));class SE{constructor(e,t={config:{}},i){this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=vi.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ik(this,ka.join,this.params,this.timeout),this.rejoinTimer=new vM(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=vi.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=vi.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=vi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=vi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=vi.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ka.reply,{},(r,s)=>{this._trigger(this._replyEventName(s),r)}),this.presence=new fg(this),this.broadcastEndpointURL=wM(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var i,r;if(this.socket.isConnected()||this.socket.connect(),this.state==vi.closed){const{config:{broadcast:s,presence:a,private:o}}=this.params,l=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(m=>m.filter))!==null&&r!==void 0?r:[],c=!!this.bindings[mg.PRESENCE]&&this.bindings[mg.PRESENCE].length>0,u={},p={broadcast:s,presence:Object.assign(Object.assign({},a),{enabled:c}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(jo.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(jo.CLOSED)),this.updateJoinPayload(Object.assign({config:p},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:m})=>{var g;if(this.socket.setAuth(),m===void 0){e==null||e(jo.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,v=(g=y==null?void 0:y.length)!==null&&g!==void 0?g:0,w=[];for(let k=0;k<v;k++){const S=y[k],{filter:{event:E,schema:P,table:A,filter:N}}=S,R=m&&m[k];if(R&&R.event===E&&R.schema===P&&R.table===A&&R.filter===N)w.push(Object.assign(Object.assign({},S),{id:R.id}));else{this.unsubscribe(),this.state=vi.errored,e==null||e(jo.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,e&&e(jo.SUBSCRIBED);return}}).receive("error",m=>{this.state=vi.errored,e==null||e(jo.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(jo.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===vi.joined&&e===mg.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,i)}async send(e,t={}){var i,r;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=c.body)===null||r===void 0?void 0:r.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=vi.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ka.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new Ik(this,ka.leave,{},e),i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=vi.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const r=new AbortController,s=setTimeout(()=>r.abort(),i),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(s),a}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Ik(this,e,t,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>CH){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var r,s;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=ka;if(i&&[o,l,c,u].indexOf(a)>=0&&i!==this._joinRef())return;let m=this._onMessage(a,t,i);if(t&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(g=>{var y,v,w;return((y=g.filter)===null||y===void 0?void 0:y.event)==="*"||((w=(v=g.filter)===null||v===void 0?void 0:v.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===a}).map(g=>g.callback(m,i)):(s=this.bindings[a])===null||s===void 0||s.filter(g=>{var y,v,w,k,S,E;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in g){const P=g.id,A=(y=g.filter)===null||y===void 0?void 0:y.event;return P&&((v=t.ids)===null||v===void 0?void 0:v.includes(P))&&(A==="*"||(A==null?void 0:A.toLocaleLowerCase())===((w=t.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const P=(S=(k=g==null?void 0:g.filter)===null||k===void 0?void 0:k.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return P==="*"||P===((E=t==null?void 0:t.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===a}).map(g=>{if(typeof m=="object"&&"ids"in m){const y=m.data,{schema:v,table:w,commit_timestamp:k,type:S,errors:E}=y;m=Object.assign(Object.assign({},{schema:v,table:w,commit_timestamp:k,eventType:S,new:{},old:{},errors:E}),this._getPayloadRecords(y))}g.callback(m,i)})}_isClosed(){return this.state===vi.closed}_isJoined(){return this.state===vi.joined}_isJoining(){return this.state===vi.joining}_isLeaving(){return this.state===vi.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const r=e.toLocaleLowerCase(),s={type:r,filter:t,callback:i};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var s;return!(((s=r.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===i&&SE.isEqual(r.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ka.close,{},e)}_onError(e){this._on(ka.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=vi.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=XA(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=XA(e.columns,e.old_record)),t}}const JA=()=>{},_v={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},OH=[1e3,2e3,5e3,1e4],LH=1e4,FH=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class VH{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=X1,this.transport=null,this.heartbeatIntervalMs=_v.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=JA,this.ref=0,this.reconnectTimer=null,this.logger=JA,this.conn=null,this.sendBuffer=[],this.serializer=new AH,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let s;return r?s=r:typeof fetch>"u"?s=(...a)=>ta(async()=>{const{default:o}=await Promise.resolve().then(()=>tm);return{default:o}},void 0).then(({default:o})=>o(...a)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...a)=>s(...a)},!(!((i=t==null?void 0:t.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${K1.websocket}`,this.httpEndpoint=wM(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=DH.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:NH}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case pg.connecting:return Tu.Connecting;case pg.open:return Tu.Open;case pg.closing:return Tu.Closing;default:return Tu.Closed}}isConnected(){return this.connectionState()===Tu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,r=this.getChannels().find(s=>s.topic===i);if(r)return r;{const s=new SE(`realtime:${e}`,t,this);return this.channels.push(s),s}}push(e){const{topic:t,event:i,payload:r,ref:s}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${i} (${s})`,r),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(_H,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},_v.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:r,payload:s,ref:a}=t,o=a?`(${a})`:"",l=s.status||"";this.log("receive",`${l} ${i} ${r} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(i)).forEach(c=>c._trigger(r,s,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ka.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${i}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([FH],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(i=>{const r={access_token:t,version:EH};t&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(ka.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new vM(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},_v.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,r,s,a,o,l,c;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e==null?void 0:e.timeout)!==null&&i!==void 0?i:X1,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:_v.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(o=e==null?void 0:e.reconnectAfterMs)!==null&&o!==void 0?o:u=>OH[u-1]||LH,this.encode=(l=e==null?void 0:e.encode)!==null&&l!==void 0?l:(u,p)=>p(JSON.stringify(u)),this.decode=(c=e==null?void 0:e.decode)!==null&&c!==void 0?c:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class EE extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Si(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class UH extends EE{constructor(e,t,i){super(e),this.name="StorageApiError",this.status=t,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class J1 extends EE{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var zH=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(i.next(u))}catch(p){a(p)}}function l(u){try{c(i.throw(u))}catch(p){a(p)}}function c(u){u.done?s(u.value):r(u.value).then(o,l)}c((i=i.apply(n,e||[])).next())})};const kM=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ta(async()=>{const{default:i}=await Promise.resolve().then(()=>tm);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},BH=()=>zH(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ta(()=>Promise.resolve().then(()=>tm),void 0)).Response:Response}),Z1=n=>{if(Array.isArray(n))return n.map(t=>Z1(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const r=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[r]=Z1(i)}),e},$H=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var hh=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(i.next(u))}catch(p){a(p)}}function l(u){try{c(i.throw(u))}catch(p){a(p)}}function c(u){u.done?s(u.value):r(u.value).then(o,l)}c((i=i.apply(n,e||[])).next())})};const Rk=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),WH=(n,e,t)=>hh(void 0,void 0,void 0,function*(){const i=yield BH();n instanceof i&&!(t!=null&&t.noResolveJson)?n.json().then(r=>{const s=n.status||500,a=(r==null?void 0:r.statusCode)||s+"";e(new UH(Rk(r),s,a))}).catch(r=>{e(new J1(Rk(r),r))}):e(new J1(Rk(n),n))}),HH=(n,e,t,i)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!i?r:($H(i)?(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(i)):r.body=i,e!=null&&e.duplex&&(r.duplex=e.duplex),Object.assign(Object.assign({},r),t))};function by(n,e,t,i,r,s){return hh(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,HH(e,i,r,s)).then(l=>{if(!l.ok)throw l;return i!=null&&i.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>WH(l,o,i))})})}function W0(n,e,t,i){return hh(this,void 0,void 0,function*(){return by(n,"GET",e,t,i)})}function Ua(n,e,t,i,r){return hh(this,void 0,void 0,function*(){return by(n,"POST",e,i,r,t)})}function eD(n,e,t,i,r){return hh(this,void 0,void 0,function*(){return by(n,"PUT",e,i,r,t)})}function qH(n,e,t,i){return hh(this,void 0,void 0,function*(){return by(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),i)})}function DM(n,e,t,i,r){return hh(this,void 0,void 0,function*(){return by(n,"DELETE",e,i,r,t)})}var xr=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(i.next(u))}catch(p){a(p)}}function l(u){try{c(i.throw(u))}catch(p){a(p)}}function c(u){u.done?s(u.value):r(u.value).then(o,l)}c((i=i.apply(n,e||[])).next())})};const GH={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ZA={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class YH{constructor(e,t={},i,r){this.url=e,this.headers=t,this.bucketId=i,this.fetch=kM(r)}uploadOrUpdate(e,t,i,r){return xr(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},ZA),r);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&i instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",i)):typeof FormData<"u"&&i instanceof FormData?(s=i,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=i,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),r!=null&&r.headers&&(o=Object.assign(Object.assign({},o),r.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),p=yield(e=="PUT"?eD:Ua)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:p.Id,fullPath:p.Key},error:null}}catch(s){if(Si(s))return{data:null,error:s};throw s}})}upload(e,t,i){return xr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,i)})}uploadToSignedUrl(e,t,i,r){return xr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:ZA.upsert},r),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&i instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",i)):typeof FormData<"u"&&i instanceof FormData?(l=i,l.append("cacheControl",c.cacheControl)):(l=i,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const p=yield eD(this.fetch,o.toString(),l,{headers:u});return{data:{path:s,fullPath:p.Key},error:null}}catch(l){if(Si(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return xr(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e);const r=Object.assign({},this.headers);t!=null&&t.upsert&&(r["x-upsert"]="true");const s=yield Ua(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new EE("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(i){if(Si(i))return{data:null,error:i};throw i}})}update(e,t,i){return xr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,i)})}move(e,t,i){return xr(this,void 0,void 0,function*(){try{return{data:yield Ua(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(Si(r))return{data:null,error:r};throw r}})}copy(e,t,i){return xr(this,void 0,void 0,function*(){try{return{data:{path:(yield Ua(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(Si(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,i){return xr(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),s=yield Ua(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const a=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(r){if(Si(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,i){return xr(this,void 0,void 0,function*(){try{const r=yield Ua(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(r){if(Si(r))return{data:null,error:r};throw r}})}download(e,t){return xr(this,void 0,void 0,function*(){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield W0(this.fetch,`${this.url}/${r}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Si(o))return{data:null,error:o};throw o}})}info(e){return xr(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const i=yield W0(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Z1(i),error:null}}catch(i){if(Si(i))return{data:null,error:i};throw i}})}exists(e){return xr(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield qH(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(Si(i)&&i instanceof J1){const r=i.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:i}}throw i}})}getPublicUrl(e,t){const i=this._getFinalPath(e),r=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&r.push(s);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&r.push(l);let c=r.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${i}${c}`)}}}remove(e){return xr(this,void 0,void 0,function*(){try{return{data:yield DM(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Si(t))return{data:null,error:t};throw t}})}list(e,t,i){return xr(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},GH),t),{prefix:e||""});return{data:yield Ua(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(Si(r))return{data:null,error:r};throw r}})}listV2(e,t){return xr(this,void 0,void 0,function*(){try{const i=Object.assign({},e);return{data:yield Ua(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},t),error:null}}catch(i){if(Si(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const XH="2.11.0",KH={"X-Client-Info":`storage-js/${XH}`};var Uh=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(i.next(u))}catch(p){a(p)}}function l(u){try{c(i.throw(u))}catch(p){a(p)}}function c(u){u.done?s(u.value):r(u.value).then(o,l)}c((i=i.apply(n,e||[])).next())})};class QH{constructor(e,t={},i,r){const s=new URL(e);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},KH),t),this.fetch=kM(i)}listBuckets(){return Uh(this,void 0,void 0,function*(){try{return{data:yield W0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Si(e))return{data:null,error:e};throw e}})}getBucket(e){return Uh(this,void 0,void 0,function*(){try{return{data:yield W0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Si(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Uh(this,void 0,void 0,function*(){try{return{data:yield Ua(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(Si(i))return{data:null,error:i};throw i}})}updateBucket(e,t){return Uh(this,void 0,void 0,function*(){try{return{data:yield eD(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(Si(i))return{data:null,error:i};throw i}})}emptyBucket(e){return Uh(this,void 0,void 0,function*(){try{return{data:yield Ua(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Si(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Uh(this,void 0,void 0,function*(){try{return{data:yield DM(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Si(t))return{data:null,error:t};throw t}})}}class JH extends QH{constructor(e,t={},i,r){super(e,t,i,r)}from(e){return new YH(this.url,this.headers,e,this.fetch)}}const ZH="2.56.0";let Hm="";typeof Deno<"u"?Hm="deno":typeof document<"u"?Hm="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Hm="react-native":Hm="node";const e6={"X-Client-Info":`supabase-js-${Hm}/${ZH}`},t6={headers:e6},n6={schema:"public"},i6={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},r6={};var s6=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(i.next(u))}catch(p){a(p)}}function l(u){try{c(i.throw(u))}catch(p){a(p)}}function c(u){u.done?s(u.value):r(u.value).then(o,l)}c((i=i.apply(n,e||[])).next())})};const a6=n=>{let e;return n?e=n:typeof fetch>"u"?e=pM:e=fetch,(...t)=>e(...t)},o6=()=>typeof Headers>"u"?fM:Headers,l6=(n,e,t)=>{const i=a6(t),r=o6();return(s,a)=>s6(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:n;let c=new r(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),i(s,Object.assign(Object.assign({},a),{headers:c}))})};var c6=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(i.next(u))}catch(p){a(p)}}function l(u){try{c(i.throw(u))}catch(p){a(p)}}function c(u){u.done?s(u.value):r(u.value).then(o,l)}c((i=i.apply(n,e||[])).next())})};function u6(n){return n.endsWith("/")?n:n+"/"}function d6(n,e){var t,i;const{db:r,auth:s,realtime:a,global:o}=n,{db:l,auth:c,realtime:u,global:p}=e,m={db:Object.assign(Object.assign({},l),r),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},p),o),{headers:Object.assign(Object.assign({},(t=p==null?void 0:p.headers)!==null&&t!==void 0?t:{}),(i=o==null?void 0:o.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>c6(this,void 0,void 0,function*(){return""})};return n.accessToken?m.accessToken=n.accessToken:delete m.accessToken,m}const SM="2.71.1",Qh=30*1e3,tD=3,Mk=tD*Qh,h6="http://localhost:9999",p6="supabase.auth.token",f6={"X-Client-Info":`gotrue-js/${SM}`},nD="X-Supabase-Api-Version",EM={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},m6=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,g6=10*60*1e3;class NE extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function Tt(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class b6 extends NE{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function y6(n){return Tt(n)&&n.name==="AuthApiError"}class NM extends NE{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class su extends NE{constructor(e,t,i,r){super(e,i,r),this.name=t,this.status=i}}class zl extends su{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function v6(n){return Tt(n)&&n.name==="AuthSessionMissingError"}class Cv extends su{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Av extends su{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Pv extends su{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function x6(n){return Tt(n)&&n.name==="AuthImplicitGrantRedirectError"}class eP extends su{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class iD extends su{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function jk(n){return Tt(n)&&n.name==="AuthRetryableFetchError"}class tP extends su{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class rD extends su{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const H0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),nP=` 	
\r=`.split(""),w6=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<nP.length;e+=1)n[nP[e].charCodeAt(0)]=-2;for(let e=0;e<H0.length;e+=1)n[H0[e].charCodeAt(0)]=e;return n})();function iP(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(H0[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(H0[i]),e.queuedBits-=6}}function _M(n,e,t){const i=w6[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function rP(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},s=a=>{S6(a,i,t)};for(let a=0;a<n.length;a+=1)_M(n.charCodeAt(a),r,s);return e.join("")}function k6(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function D6(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const r=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}k6(i,e)}}function S6(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function E6(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};for(let r=0;r<n.length;r+=1)_M(n.charCodeAt(r),t,i);return new Uint8Array(e)}function N6(n){const e=[];return D6(n,t=>e.push(t)),new Uint8Array(e)}function _6(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};return n.forEach(r=>iP(r,t,i)),iP(null,t,i),e.join("")}function C6(n){return Math.round(Date.now()/1e3)+n}function A6(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const oa=()=>typeof window<"u"&&typeof document<"u",xu={tested:!1,writable:!1},CM=()=>{if(!oa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(xu.tested)return xu.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),xu.tested=!0,xu.writable=!0}catch{xu.tested=!0,xu.writable=!1}return xu.writable};function P6(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,s)=>{e[s]=r})}catch{}return t.searchParams.forEach((i,r)=>{e[r]=i}),e}const AM=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ta(async()=>{const{default:i}=await Promise.resolve().then(()=>tm);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},T6=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Jh=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},wu=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Fl=async(n,e)=>{await n.removeItem(e)};class Wx{constructor(){this.promise=new Wx.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Wx.promiseConstructor=Promise;function Ok(n){const e=n.split(".");if(e.length!==3)throw new rD("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!m6.test(e[i]))throw new rD("JWT not in base64url format");return{header:JSON.parse(rP(e[0])),payload:JSON.parse(rP(e[1])),signature:E6(e[2]),raw:{header:e[0],payload:e[1]}}}async function I6(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function R6(n,e){return new Promise((i,r)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await n(s);if(!e(s,null,a)){i(a);return}}catch(a){if(!e(s,a)){r(a);return}}})()})}function M6(n){return("0"+n.toString(16)).substr(-2)}function j6(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let r="";for(let s=0;s<56;s++)r+=t.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(e),Array.from(e,M6).join("")}async function O6(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(i);return Array.from(r).map(s=>String.fromCharCode(s)).join("")}async function L6(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await O6(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function zh(n,e,t=!1){const i=j6();let r=i;t&&(r+="/PASSWORD_RECOVERY"),await Jh(n,`${e}-code-verifier`,r);const s=await L6(i);return[s,i===s?"plain":"s256"]}const F6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function V6(n){const e=n.headers.get(nD);if(!e||!e.match(F6))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function U6(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function z6(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const B6=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Bh(n){if(!B6.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Lk(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function sP(n){return JSON.parse(JSON.stringify(n))}var $6=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};const _u=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),W6=[502,503,504];async function aP(n){var e;if(!T6(n))throw new iD(_u(n),0);if(W6.includes(n.status))throw new iD(_u(n),n.status);let t;try{t=await n.json()}catch(s){throw new NM(_u(s),s)}let i;const r=V6(n);if(r&&r.getTime()>=EM["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new tP(_u(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new zl}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new tP(_u(t),n.status,t.weak_password.reasons);throw new b6(_u(t),n.status||500,i)}const H6=(n,e,t,i)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),t))};async function Gt(n,e,t,i){var r;const s=Object.assign({},i==null?void 0:i.headers);s[nD]||(s[nD]=EM["2024-01-01"].name),i!=null&&i.jwt&&(s.Authorization=`Bearer ${i.jwt}`);const a=(r=i==null?void 0:i.query)!==null&&r!==void 0?r:{};i!=null&&i.redirectTo&&(a.redirect_to=i.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await q6(n,e,t+o,{headers:s,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(l):{data:Object.assign({},l),error:null}}async function q6(n,e,t,i,r,s){const a=H6(e,i,r,s);let o;try{o=await n(t,Object.assign({},a))}catch(l){throw console.error(l),new iD(_u(l),0)}if(o.ok||await aP(o),i!=null&&i.noResolveJson)return o;try{return await o.json()}catch(l){await aP(l)}}function To(n){var e;let t=null;K6(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=C6(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function oP(n){const e=To(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function ql(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function G6(n){return{data:n,error:null}}function Y6(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:s}=n,a=$6(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function X6(n){return n}function K6(n){return n.access_token&&n.refresh_token&&n.expires_in}const Fk=["global","local","others"];var Q6=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};class J6{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=AM(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Fk[0]){if(Fk.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fk.join(", ")}`);try{return await Gt(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(Tt(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await Gt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ql})}catch(i){if(Tt(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=Q6(e,["options"]),r=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(r.new_email=i==null?void 0:i.newEmail,delete r.newEmail),await Gt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:Y6,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Tt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Gt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ql})}catch(t){if(Tt(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,r,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Gt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(s=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:""},xform:X6});if(u.error)throw u.error;const p=await u.json(),m=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,g=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return g.length>0&&(g.forEach(y=>{const v=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(y.split(";")[1].split("=")[1]);c[`${w}Page`]=v}),c.total=parseInt(m)),{data:Object.assign(Object.assign({},p),c),error:null}}catch(c){if(Tt(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Bh(e);try{return await Gt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ql})}catch(t){if(Tt(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Bh(e);try{return await Gt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ql})}catch(i){if(Tt(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){Bh(e);try{return await Gt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ql})}catch(i){if(Tt(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){Bh(e.userId);try{const{data:t,error:i}=await Gt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:i}}catch(t){if(Tt(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Bh(e.userId),Bh(e.id);try{return{data:await Gt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Tt(t))return{data:null,error:t};throw t}}}function lP(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function Z6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const $h={debug:!!(globalThis&&CM()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class PM extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class eq extends PM{}async function tq(n,e,t){$h.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),$h.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){$h.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{$h.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw $h.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new eq(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if($h.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Z6();const nq={url:h6,storageKey:p6,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:f6,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function cP(n,e,t){return await t()}const Wh={};class Dg{constructor(e){var t,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Dg.nextInstanceID,Dg.nextInstanceID+=1,this.instanceID>0&&oa()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},nq),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new J6({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=AM(r.fetch),this.lock=r.lock||cP,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:oa()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=tq:this.lock=cP,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:CM()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=lP(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=lP(this.memoryStorage)),oa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Wh[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Wh[this.storageKey]=Object.assign(Object.assign({},Wh[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Wh[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Wh[this.storageKey]=Object.assign(Object.assign({},Wh[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${SM}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=P6(window.location.href);let i="none";if(this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce"),oa()&&this.detectSessionInUrl&&i!=="none"){const{data:r,error:s}=await this._getSessionFromURL(t,i);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),x6(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Tt(t)?{error:t}:{error:new NM("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,r;try{const s=await Gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:To}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Tt(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,i,r;try{let s;if("email"in e){const{email:u,password:p,options:m}=e;let g=null,y=null;this.flowType==="pkce"&&([g,y]=await zh(this.storage,this.storageKey)),s=await Gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:u,password:p,data:(t=m==null?void 0:m.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:g,code_challenge_method:y},xform:To})}else if("phone"in e){const{phone:u,password:p,options:m}=e;s=await Gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:p,data:(i=m==null?void 0:m.data)!==null&&i!==void 0?i:{},channel:(r=m==null?void 0:m.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:To})}else throw new Av("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Tt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:a,options:o}=e;t=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:oP})}else if("phone"in e){const{phone:s,password:a,options:o}=e;t=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:oP})}else throw new Av("You must provide either an email or phone number and a password");const{data:i,error:r}=t;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Cv}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(t){if(Tt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,i,r,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,i,r,s,a,o,l,c,u,p,m,g;let y,v;if("message"in e)y=e.message,v=e.signature;else{const{chain:w,wallet:k,statement:S,options:E}=e;let P;if(oa())if(typeof k=="object")P=k;else{const N=window;if("solana"in N&&typeof N.solana=="object"&&("signIn"in N.solana&&typeof N.solana.signIn=="function"||"signMessage"in N.solana&&typeof N.solana.signMessage=="function"))P=N.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!(E!=null&&E.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=k}const A=new URL((t=E==null?void 0:E.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in P&&P.signIn){const N=await P.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},E==null?void 0:E.signInWithSolana),{version:"1",domain:A.host,uri:A.href}),S?{statement:S}:null));let R;if(Array.isArray(N)&&N[0]&&typeof N[0]=="object")R=N[0];else if(N&&typeof N=="object"&&"signedMessage"in N&&"signature"in N)R=N;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)y=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),v=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in P)||typeof P.signMessage!="function"||!("publicKey"in P)||typeof P!="object"||!P.publicKey||!("toBase58"in P.publicKey)||typeof P.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${A.host} wants you to sign in with your Solana account:`,P.publicKey.toBase58(),...S?["",S,""]:[""],"Version: 1",`URI: ${A.href}`,`Issued At: ${(r=(i=E==null?void 0:E.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((s=E==null?void 0:E.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${E.signInWithSolana.notBefore}`]:[],...!((a=E==null?void 0:E.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${E.signInWithSolana.expirationTime}`]:[],...!((o=E==null?void 0:E.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${E.signInWithSolana.chainId}`]:[],...!((l=E==null?void 0:E.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${E.signInWithSolana.nonce}`]:[],...!((c=E==null?void 0:E.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${E.signInWithSolana.requestId}`]:[],...!((p=(u=E==null?void 0:E.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||p===void 0)&&p.length?["Resources",...E.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const N=await P.signMessage(new TextEncoder().encode(y),"utf8");if(!N||!(N instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=N}}try{const{data:w,error:k}=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:_6(v)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:To});if(k)throw k;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new Cv}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:k})}catch(w){if(Tt(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(e){const t=await wu(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(t??"").split("/");try{const{data:s,error:a}=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:To});if(await Fl(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Cv}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:r??null}),error:a})}catch(s){if(Tt(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:t,provider:i,token:r,access_token:s,nonce:a}=e,o=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:To}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Cv}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(Tt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,i,r,s,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await zh(this.storage,this.storageKey));const{error:p}=await Gt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await Gt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Av("You must provide either an email or phone number.")}catch(o){if(Tt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,i;try{let r,s;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,s=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:a,error:o}=await Gt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:To});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(r){if(Tt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,i,r;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await zh(this.storage,this.storageKey)),await Gt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:G6})}catch(s){if(Tt(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new zl;const{error:r}=await Gt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(Tt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:r,options:s}=e,{error:a}=await Gt(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:i,type:r,options:s}=e,{data:a,error:o}=await Gt(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Av("You must provide either an email or phone number and a type")}catch(t){if(Tt(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await wu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<Mk:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const a=await wu(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=Lk()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Gt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ql}):await this._useSession(async t=>{var i,r,s;const{data:a,error:o}=t;if(o)throw o;return!(!((i=a.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new zl}:await Gt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0,xform:ql})})}catch(t){if(Tt(t))return v6(t)&&(await this._removeSession(),await Fl(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:r,error:s}=i;if(s)throw s;if(!r.session)throw new zl;const a=r.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await zh(this.storage,this.storageKey));const{data:c,error:u}=await Gt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:ql});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(i){if(Tt(i))return{data:{user:null},error:i};throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new zl;const t=Date.now()/1e3;let i=t,r=!0,s=null;const{payload:a}=Ok(e.access_token);if(a.exp&&(i=a.exp,r=i<=t),r){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(Tt(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(i=a.session)!==null&&i!==void 0?i:void 0}if(!(e!=null&&e.refresh_token))throw new zl;const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Tt(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!oa())throw new Pv("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Pv(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new eP("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Pv("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new eP("No code detected.");const{data:S,error:E}=await this._exchangeCodeForSession(e.code);if(E)throw E;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:S.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:r,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!s||!o||!a||!c)throw new Pv("No session defined in URL");const u=Math.round(Date.now()/1e3),p=parseInt(o);let m=u+p;l&&(m=parseInt(l));const g=m-u;g*1e3<=Qh&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${p}s`);const y=m-p;u-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,m,u):u-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,m,u);const{data:v,error:w}=await this._getUser(s);if(w)throw w;const k={provider_token:i,provider_refresh_token:r,access_token:s,expires_in:p,expires_at:m,refresh_token:a,token_type:c,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:k,redirectType:e.type},error:null}}catch(i){if(Tt(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await wu(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:r,error:s}=t;if(s)return{error:s};const a=(i=r.session)===null||i===void 0?void 0:i.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(y6(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Fl(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=A6(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,r;try{const{data:{session:s},error:a}=t;if(a)throw a;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,t={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await zh(this.storage,this.storageKey,!0));try{return await Gt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(Tt(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Tt(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:i,error:r}=await this._useSession(async s=>{var a,o,l,c,u;const{data:p,error:m}=s;if(m)throw m;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Gt(this.fetch,"GET",g,{headers:this.headers,jwt:(u=(c=p.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(r)throw r;return oa()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:e.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(Tt(i))return{data:{provider:e.provider,url:null},error:i};throw i}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,r;const{data:s,error:a}=t;if(a)throw a;return await Gt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(i=s.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(Tt(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await R6(async r=>(r>0&&await I6(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await Gt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:To})),(r,s)=>{const a=200*Math.pow(2,r);return s&&jk(s)&&Date.now()+a-i<Qh})}catch(i){if(this._debug(t,"error",i),Tt(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),oa()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=await wu(this.storage,this.storageKey);if(r&&this.userStorage){let a=await wu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:r.user},await Jh(this.userStorage,this.storageKey+"-user",a)),r.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:Lk()}else if(r&&!r.user&&!r.user){const a=await wu(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(r.user=a.user,await Fl(this.storage,this.storageKey+"-user"),await Jh(this.storage,this.storageKey,r)):r.user=Lk()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),r!==null&&await this._removeSession();return}const s=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Mk;if(this._debug(i,`session has${s?"":" not"} expired with margin of ${Mk}s`),s){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),jk(a)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(r.access_token);!o&&(a!=null&&a.user)?(r.user=a.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(i,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(i,"error",r),console.error(r);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new zl;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Wx;const{data:s,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!s.session)throw new zl;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(r,"error",s),Tt(s)){const a={session:null,error:s};return jk(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(s),s}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,i=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await Jh(this.userStorage,this.storageKey+"-user",{user:t.user});const r=Object.assign({},t);delete r.user;const s=sP(r);await Jh(this.storage,this.storageKey,s)}else{const r=sP(t);await Jh(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await Fl(this.storage,this.storageKey),await Fl(this.storage,this.storageKey+"-code-verifier"),await Fl(this.storage,this.storageKey+"-user"),this.userStorage&&await Fl(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&oa()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Qh);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-e)/Qh);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Qh}ms, refresh threshold is ${tD} ticks`),r<=tD&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof PM)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!oa()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const r=[`provider=${encodeURIComponent(t)}`];if(i!=null&&i.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[s,a]=await zh(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});r.push(o.toString())}if(i!=null&&i.queryParams){const s=new URLSearchParams(i.queryParams);r.push(s.toString())}return i!=null&&i.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:r,error:s}=t;return s?{data:null,error:s}:await Gt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(Tt(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,r;const{data:s,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await Gt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(i=s==null?void 0:s.session)===null||i===void 0?void 0:i.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(Tt(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:s}=t;if(s)return{data:null,error:s};const{data:a,error:o}=await Gt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(Tt(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:s}=t;return s?{data:null,error:s}:await Gt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(Tt(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?{data:null,error:i}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const i=(e==null?void 0:e.factors)||[],r=i.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=i.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:i,totp:r,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,i;const{data:{session:r},error:s}=e;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Ok(r.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((i=(t=r.user.factors)===null||t===void 0?void 0:t.filter(p=>p.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(o=>o.kid===e);if(i)return i;const r=Date.now();if(i=this.jwks.keys.find(o=>o.kid===e),i&&this.jwks_cached_at+g6>r)return i;const{data:s,error:a}=await Gt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=r,i=s.keys.find(o=>o.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:g,error:y}=await this.getSession();if(y||!g.session)return{data:null,error:y};i=g.session.access_token}const{header:r,payload:s,signature:a,raw:{header:o,payload:l}}=Ok(i);t!=null&&t.allowExpired||U6(s.exp);const c=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!c){const{error:g}=await this.getUser(i);if(g)throw g;return{data:{claims:s,header:r,signature:a},error:null}}const u=z6(r.alg),p=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,p,a,N6(`${o}.${l}`)))throw new rD("Invalid JWT signature");return{data:{claims:s,header:r,signature:a},error:null}}catch(i){if(Tt(i))return{data:null,error:i};throw i}}}Dg.nextInstanceID=0;const iq=Dg;class rq extends iq{constructor(e){super(e)}}var sq=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(i.next(u))}catch(p){a(p)}}function l(u){try{c(i.throw(u))}catch(p){a(p)}}function c(u){u.done?s(u.value):r(u.value).then(o,l)}c((i=i.apply(n,e||[])).next())})};class aq{constructor(e,t,i){var r,s,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=u6(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:n6,realtime:r6,auth:Object.assign(Object.assign({},i6),{storageKey:c}),global:t6},p=d6(i??{},u);this.storageKey=(r=p.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=p.global.headers)!==null&&s!==void 0?s:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(m,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=p.auth)!==null&&a!==void 0?a:{},this.headers,p.global.fetch),this.fetch=l6(t,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new kH(new URL("rest/v1",l).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new JH(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new hH(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},i={}){return this.rest.rpc(e,t,i)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return sq(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(t=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,storageKey:s,flowType:a,lock:o,debug:l},c,u){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new rq({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),c),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,flowType:a,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new VH(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,i)=>{this._handleTokenChanged(t,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(e,t,i){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const _E=(n,e,t)=>new aq(n,e,t);function oq(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}oq()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const CE="https://swtkpfpyjjkkemmvkhmz.supabase.co",lq="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN3dGtwZnB5ampra2VtbXZraG16Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUzMDM5NTIsImV4cCI6MjA2MDg3OTk1Mn0.8herIfBAFOFUXro03pQxiS4Htnljavfncz-FvPj3sGw";console.log("Connecting to Supabase:",CE);const cq=()=>{if(globalThis.__supabaseClient)return globalThis.__supabaseClient;const n=_E(CE,lq,{auth:{persistSession:!0,autoRefreshToken:!0,storageKey:"clarity-hub-auth"}});return globalThis.__supabaseClient=n,n},Zn=cq(),uq="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN3dGtwZnB5ampra2VtbXZraG16Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0NTMwMzk1MiwiZXhwIjoyMDYwODc5OTUyfQ.Jp8Vhvs-rvVvjx0L0wEtm4Cblh-DTjoXExjNWNIaV_M";_E(CE,uq,{auth:{persistSession:!1}});const uP=n=>{let e;const t=new Set,i=(c,u)=>{const p=typeof c=="function"?c(e):c;if(!Object.is(p,e)){const m=e;e=u??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(g=>g(e,m))}},r=()=>e,o={setState:i,getState:r,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=n(i,r,o);return o},dq=n=>n?uP(n):uP,hq=n=>n;function pq(n,e=hq){const t=Xr.useSyncExternalStore(n.subscribe,()=>e(n.getState()),()=>e(n.getInitialState()));return Xr.useDebugValue(t),t}const fq=n=>{const e=dq(n),t=i=>pq(e,i);return Object.assign(t,e),t},TM=n=>fq,dP={APP_VERSION:"0.0.0",BASE_URL:"/",DEV:!0,MODE:"production",PROD:!1,SSR:!1,VITE_ALLOW_LOCAL_STORAGE_FALLBACK:"true",VITE_API_BASE_URL:"http://localhost:3000/api",VITE_APP_NAME:"Legal Case Tracker",VITE_APP_VERSION:"1.0.0",VITE_DEV_PORT:"3000",VITE_GEMINI_API_KEY:"AIzaSyBoHxMRLlqSzCzvVpeuw06SUqmkj4eNzm8",VITE_HMR_PORT:"3001",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN3dGtwZnB5ampra2VtbXZraG16Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUzMDM5NTIsImV4cCI6MjA2MDg3OTk1Mn0.8herIfBAFOFUXro03pQxiS4Htnljavfncz-FvPj3sGw",VITE_SUPABASE_URL:"https://swtkpfpyjjkkemmvkhmz.supabase.co",VITE_TINYMCE_API_KEY:"q6pu1qv40eyr40jy40uf09aic0zax3jbmtuufeonppzbxmpkSUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN3dGtwZnB5ampra2VtbXZraG16Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0NTMwMzk1MiwiZXhwIjoyMDYwODc5OTUyfQ.T6gJ5P2Lfc5f_HCxD5P7JFBzJGtFhiRPiv6M7bR6eB0",VITE_USER_NODE_ENV:"development"},sD=new Map,Tv=n=>{const e=sD.get(n);return e?Object.fromEntries(Object.entries(e.stores).map(([t,i])=>[t,i.getState()])):{}},mq=(n,e,t)=>{if(n===void 0)return{type:"untracked",connection:e.connect(t)};const i=sD.get(t.name);if(i)return{type:"tracked",store:n,...i};const r={connection:e.connect(t),stores:{}};return sD.set(t.name,r),{type:"tracked",store:n,...r}},gq=(n,e={})=>(t,i,r)=>{const{enabled:s,anonymousActionType:a,store:o,...l}=e;let c;try{c=(s??(dP?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!c)return n(t,i,r);const{connection:u,...p}=mq(o,c,l);let m=!0;r.setState=(v,w,k)=>{const S=t(v,w);if(!m)return S;const E=k===void 0?{type:a||"anonymous"}:typeof k=="string"?{type:k}:k;return o===void 0?(u==null||u.send(E,i()),S):(u==null||u.send({...E,type:`${o}/${E.type}`},{...Tv(l.name),[o]:r.getState()}),S)};const g=(...v)=>{const w=m;m=!1,t(...v),m=w},y=n(r.setState,i,r);if(p.type==="untracked"?u==null||u.init(y):(p.stores[p.store]=r,u==null||u.init(Object.fromEntries(Object.entries(p.stores).map(([v,w])=>[v,v===p.store?y:w.getState()])))),r.dispatchFromDevtools&&typeof r.dispatch=="function"){let v=!1;const w=r.dispatch;r.dispatch=(...k)=>{(dP?"production":void 0)!=="production"&&k[0].type==="__setState"&&!v&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),v=!0),w(...k)}}return u.subscribe(v=>{var w;switch(v.type){case"ACTION":if(typeof v.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Vk(v.payload,k=>{if(k.type==="__setState"){if(o===void 0){g(k.state);return}Object.keys(k.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const S=k.state[o];if(S==null)return;JSON.stringify(r.getState())!==JSON.stringify(S)&&g(S);return}r.dispatchFromDevtools&&typeof r.dispatch=="function"&&r.dispatch(k)});case"DISPATCH":switch(v.payload.type){case"RESET":return g(y),o===void 0?u==null?void 0:u.init(r.getState()):u==null?void 0:u.init(Tv(l.name));case"COMMIT":if(o===void 0){u==null||u.init(r.getState());return}return u==null?void 0:u.init(Tv(l.name));case"ROLLBACK":return Vk(v.state,k=>{if(o===void 0){g(k),u==null||u.init(r.getState());return}g(k[o]),u==null||u.init(Tv(l.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Vk(v.state,k=>{if(o===void 0){g(k);return}JSON.stringify(r.getState())!==JSON.stringify(k[o])&&g(k[o])});case"IMPORT_STATE":{const{nextLiftedState:k}=v.payload,S=(w=k.computedStates.slice(-1)[0])==null?void 0:w.state;if(!S)return;g(o===void 0?S:S[o]),u==null||u.send(null,k);return}case"PAUSE_RECORDING":return m=!m}return}}),y},IM=gq,Vk=(n,e)=>{let t;try{t=JSON.parse(n)}catch(i){console.error("[zustand devtools middleware] Could not parse the received json",i)}t!==void 0&&e(t)};function bq(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(r))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const aD=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return aD(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return aD(i)(t)}}}},yq=(n,e)=>(t,i,r)=>{let s={storage:bq(()=>localStorage),partialize:v=>v,version:0,merge:(v,w)=>({...w,...v}),...e},a=!1;const o=new Set,l=new Set;let c=s.storage;if(!c)return n((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...v)},i,r);const u=()=>{const v=s.partialize({...i()});return c.setItem(s.name,{state:v,version:s.version})},p=r.setState;r.setState=(v,w)=>{p(v,w),u()};const m=n((...v)=>{t(...v),u()},i,r);r.getInitialState=()=>m;let g;const y=()=>{var v,w;if(!c)return;a=!1,o.forEach(S=>{var E;return S((E=i())!=null?E:m)});const k=((w=s.onRehydrateStorage)==null?void 0:w.call(s,(v=i())!=null?v:m))||void 0;return aD(c.getItem.bind(c))(s.name).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==s.version){if(s.migrate){const E=s.migrate(S.state,S.version);return E instanceof Promise?E.then(P=>[!0,P]):[!0,E]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,S.state];return[!1,void 0]}).then(S=>{var E;const[P,A]=S;if(g=s.merge(A,(E=i())!=null?E:m),t(g,!0),P)return u()}).then(()=>{k==null||k(g,void 0),g=i(),a=!0,l.forEach(S=>S(g))}).catch(S=>{k==null||k(void 0,S)})};return r.persist={setOptions:v=>{s={...s,...v},v.storage&&(c=v.storage)},clearStorage:()=>{c==null||c.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>y(),hasHydrated:()=>a,onHydrate:v=>(o.add(v),()=>{o.delete(v)}),onFinishHydration:v=>(l.add(v),()=>{l.delete(v)})},s.skipHydration||y(),g||m},RM=yq,hP=n=>Symbol.iterator in n,pP=n=>"entries"in n,fP=(n,e)=>{const t=n instanceof Map?n:new Map(n.entries()),i=e instanceof Map?e:new Map(e.entries());if(t.size!==i.size)return!1;for(const[r,s]of t)if(!Object.is(s,i.get(r)))return!1;return!0},vq=(n,e)=>{const t=n[Symbol.iterator](),i=e[Symbol.iterator]();let r=t.next(),s=i.next();for(;!r.done&&!s.done;){if(!Object.is(r.value,s.value))return!1;r=t.next(),s=i.next()}return!!r.done&&!!s.done};function xq(n,e){return Object.is(n,e)?!0:typeof n!="object"||n===null||typeof e!="object"||e===null?!1:!hP(n)||!hP(e)?fP({entries:()=>Object.entries(n)},{entries:()=>Object.entries(e)}):pP(n)&&pP(e)?fP(n,e):vq(n,e)}const q0=20,G0=60,Y0=20,MM=200,jM=320,OM=200;TM()(IM(RM(n=>({leftPanelWidth:0,centerPanelWidth:0,rightPanelWidth:0,leftPanelPercentage:q0,centerPanelPercentage:G0,rightPanelPercentage:Y0,minLeftPanelWidth:MM,minCenterPanelWidth:jM,minRightPanelWidth:OM,setPanelSizes:(e,t,i)=>{const r=e+t+i;n({leftPanelWidth:e,centerPanelWidth:t,rightPanelWidth:i,leftPanelPercentage:e/r*100,centerPanelPercentage:t/r*100,rightPanelPercentage:i/r*100})},setPanelPercentages:(e,t,i)=>{n({leftPanelPercentage:e,centerPanelPercentage:t,rightPanelPercentage:i})},resetPanelSizes:()=>{n({leftPanelPercentage:q0,centerPanelPercentage:G0,rightPanelPercentage:Y0})}}),{name:"clarity-hub-panel-state",partialize:n=>({leftPanelWidth:n.leftPanelWidth,centerPanelWidth:n.centerPanelWidth,rightPanelWidth:n.rightPanelWidth,leftPanelPercentage:n.leftPanelPercentage,centerPanelPercentage:n.centerPanelPercentage,rightPanelPercentage:n.rightPanelPercentage,minLeftPanelWidth:n.minLeftPanelWidth,minCenterPanelWidth:n.minCenterPanelWidth,minRightPanelWidth:n.minRightPanelWidth})})));const wq=n=>({leftPanelWidth:0,centerPanelWidth:0,rightPanelWidth:0,leftPanelPercentage:q0,centerPanelPercentage:G0,rightPanelPercentage:Y0,minLeftPanelWidth:MM,minCenterPanelWidth:jM,minRightPanelWidth:OM,setPanelSizes:(e,t,i)=>{const r=e+t+i;n({leftPanelWidth:e,centerPanelWidth:t,rightPanelWidth:i,leftPanelPercentage:e/r*100,centerPanelPercentage:t/r*100,rightPanelPercentage:i/r*100})},setPanelPercentages:(e,t,i)=>{n({leftPanelPercentage:e,centerPanelPercentage:t,rightPanelPercentage:i})},resetPanelSizes:()=>{n({leftPanelPercentage:q0,centerPanelPercentage:G0,rightPanelPercentage:Y0})}}),mP={searchTerm:"",fileTypes:[],tags:[],entities:[],authors:[],evidenceStatus:[],dateFrom:null,dateTo:null,searchType:"combined",includePrivileged:!1,includeWorkProduct:!1,exactMatch:!1,caseSensitive:!1},We=TM()(IM(RM((...n)=>({...wq(...n),user:null,setUser:e=>n[0]({user:e}),themeMode:"light",toggleTheme:()=>n[0](e=>({themeMode:e.themeMode==="light"?"dark":"light"})),selectedProjectId:null,projects:[],setSelectedProject:e=>n[0](t=>{if(e&&e!==t.selectedProjectId){const i=t.files.filter(s=>s.project_id===e),r=i.length>0?i[0].id:null;return{selectedProjectId:e,selectedFileId:r}}return{selectedProjectId:e}}),setProjects:e=>n[0]({projects:e}),addProject:e=>n[0](t=>({projects:[...t.projects,e]})),updateProject:(e,t)=>n[0](i=>({projects:i.projects.map(r=>r.id===e?{...r,...t}:r)})),deleteProject:e=>n[0](t=>({projects:t.projects.filter(i=>i.id!==e),selectedProjectId:t.selectedProjectId===e?null:t.selectedProjectId})),selectedFileId:null,files:[],setSelectedFile:e=>n[0]({selectedFileId:e}),setFiles:e=>n[0]({files:e}),addFile:e=>n[0](t=>({files:[...t.files,e]})),addFileToProject:(e,t)=>n[0](i=>({files:[...i.files,{...t,project_id:e}]})),updateFile:(e,t)=>n[0](i=>({files:i.files.map(r=>r.id===e?{...r,...t}:r)})),deleteFile:e=>n[0](t=>{var i;return{files:t.files.filter(r=>r.id!==e),selectedFileId:t.selectedFileId===e?null:t.selectedFileId,linkActivation:((i=t.linkActivation)==null?void 0:i.fileId)===e?null:t.linkActivation}}),linkActivation:null,setLinkActivation:e=>n[0]({linkActivation:e}),searchFilters:mP,setSearchFilters:e=>n[0](t=>({searchFilters:{...t.searchFilters,...e}})),resetSearchFilters:()=>n[0]({searchFilters:mP}),isLeftPanelOpen:!0,isRightPanelOpen:!0,isSuggestionPanelOpen:!1,toggleLeftPanel:()=>n[0](e=>({isLeftPanelOpen:!e.isLeftPanelOpen})),toggleRightPanel:()=>n[0](e=>({isRightPanelOpen:!e.isRightPanelOpen})),toggleSuggestionPanel:()=>n[0](e=>({isSuggestionPanelOpen:!e.isSuggestionPanelOpen})),legalCases:[],selectedLegalCaseId:null,legalContacts:[],legalTasks:[],legalNotes:[],legalTimeline:[],evidenceRecords:[],legalDeadlines:[],documentTemplates:[],exhibits:[],citationHistory:[],selectedExhibitId:null,exhibitLinkActivation:null,setLegalCases:e=>n[0]({legalCases:e}),addLegalCase:e=>n[0](t=>({legalCases:[...t.legalCases,e]})),updateLegalCase:(e,t)=>n[0](i=>({legalCases:i.legalCases.map(r=>r.id===e?{...r,...t}:r)})),deleteLegalCase:e=>n[0](t=>({legalCases:t.legalCases.filter(i=>i.id!==e),selectedLegalCaseId:t.selectedLegalCaseId===e?null:t.selectedLegalCaseId})),setSelectedLegalCase:e=>n[0]({selectedLegalCaseId:e}),setLegalContacts:e=>n[0]({legalContacts:e}),addLegalContact:e=>n[0](t=>({legalContacts:[...t.legalContacts,e]})),updateLegalContact:(e,t)=>n[0](i=>({legalContacts:i.legalContacts.map(r=>r.id===e?{...r,...t}:r)})),deleteLegalContact:e=>n[0](t=>({legalContacts:t.legalContacts.filter(i=>i.id!==e)})),setLegalTasks:e=>n[0]({legalTasks:e}),addLegalTask:e=>n[0](t=>({legalTasks:[...t.legalTasks,e]})),updateLegalTask:(e,t)=>n[0](i=>({legalTasks:i.legalTasks.map(r=>r.id===e?{...r,...t}:r)})),deleteLegalTask:e=>n[0](t=>({legalTasks:t.legalTasks.filter(i=>i.id!==e)})),setLegalNotes:e=>n[0]({legalNotes:e}),addLegalNote:e=>n[0](t=>({legalNotes:[...t.legalNotes,e]})),updateLegalNote:(e,t)=>n[0](i=>({legalNotes:i.legalNotes.map(r=>r.id===e?{...r,...t}:r)})),deleteLegalNote:e=>n[0](t=>({legalNotes:t.legalNotes.filter(i=>i.id!==e)})),setLegalTimeline:e=>n[0]({legalTimeline:e}),addLegalTimelineEvent:e=>n[0](t=>({legalTimeline:[...t.legalTimeline,e]})),updateLegalTimelineEvent:(e,t)=>n[0](i=>({legalTimeline:i.legalTimeline.map(r=>r.id===e?{...r,...t}:r)})),deleteLegalTimelineEvent:e=>n[0](t=>({legalTimeline:t.legalTimeline.filter(i=>i.id!==e)})),setEvidenceRecords:e=>n[0]({evidenceRecords:e}),addEvidenceRecord:e=>n[0](t=>({evidenceRecords:[...t.evidenceRecords,e]})),updateEvidenceRecord:(e,t)=>n[0](i=>({evidenceRecords:i.evidenceRecords.map(r=>r.id===e?{...r,...t}:r)})),deleteEvidenceRecord:e=>n[0](t=>({evidenceRecords:t.evidenceRecords.filter(i=>i.id!==e)})),addChainOfCustodyEntry:(e,t)=>n[0](i=>({evidenceRecords:i.evidenceRecords.map(r=>r.id===e?{...r,chain_of_custody:[...r.chain_of_custody,t]}:r)})),setLegalDeadlines:e=>n[0]({legalDeadlines:e}),addLegalDeadline:e=>n[0](t=>({legalDeadlines:[...t.legalDeadlines,e]})),updateLegalDeadline:(e,t)=>n[0](i=>({legalDeadlines:i.legalDeadlines.map(r=>r.id===e?{...r,...t}:r)})),deleteLegalDeadline:e=>n[0](t=>({legalDeadlines:t.legalDeadlines.filter(i=>i.id!==e)})),setDocumentTemplates:e=>n[0]({documentTemplates:e}),addDocumentTemplate:e=>n[0](t=>({documentTemplates:[...t.documentTemplates,e]})),updateDocumentTemplate:(e,t)=>n[0](i=>({documentTemplates:i.documentTemplates.map(r=>r.id===e?{...r,...t}:r)})),deleteDocumentTemplate:e=>n[0](t=>({documentTemplates:t.documentTemplates.filter(i=>i.id!==e)})),setExhibits:e=>n[0]({exhibits:e}),addExhibit:e=>n[0](t=>({exhibits:[...t.exhibits,e]})),updateExhibit:(e,t)=>n[0](i=>({exhibits:i.exhibits.map(r=>r.id===e?{...r,...t}:r)})),deleteExhibit:e=>n[0](t=>({exhibits:t.exhibits.filter(i=>i.id!==e),selectedExhibitId:t.selectedExhibitId===e?null:t.selectedExhibitId})),setSelectedExhibit:e=>n[0]({selectedExhibitId:e}),assignFileToExhibit:(e,t,i=!1)=>n[0](r=>{const s=r.exhibits.find(a=>a.exhibit_id===t);if(s&&!s.files.find(o=>o.file_id===e)){const o={id:crypto.randomUUID(),file_id:e,exhibit_id:t,is_primary:i,created_at:new Date().toISOString()};return{exhibits:r.exhibits.map(l=>l.id===s.id?{...l,files:[...l.files,o]}:l)}}return{}}),removeFileFromExhibit:(e,t)=>n[0](i=>({exhibits:i.exhibits.map(r=>r.exhibit_id===t?{...r,files:r.files.filter(s=>s.file_id!==e)}:r)})),createExhibitFromFile:(e,t,i)=>n[0](r=>{const s=r.files.find(a=>a.id===e);if(s&&!r.exhibits.find(a=>a.exhibit_id===t)){const a={id:crypto.randomUUID(),exhibit_id:t,project_id:s.project_id,title:i||`Exhibit ${t}`,exhibit_type:s.file_type.includes("image")?"photo":s.file_type.includes("video")?"video":s.file_type.includes("audio")?"audio":"document",is_key_evidence:!1,files:[{id:crypto.randomUUID(),file_id:e,exhibit_id:t,is_primary:!0,created_at:new Date().toISOString()}],created_at:new Date().toISOString(),updated_at:new Date().toISOString(),owner_id:s.owner_id};return{exhibits:[...r.exhibits,a],files:r.files.map(o=>o.id===e?{...o,exhibit_id:t}:o)}}return{}}),detectExhibitIdFromFilename:e=>{const t=[/^(\d+[A-Z])/i,/^(\d+-[A-Z])/i,/^(\d+\s*[A-Z])/i];for(const i of t){const r=e.match(i);if(r)return r[1].replace(/[-\s]/g,"").toUpperCase()}return null},getNextExhibitId:()=>{const t=n[0]().exhibits.map(s=>s.exhibit_id);let i=1,r="A";for(;t.includes(`${i}${r}`);)r==="Z"?(i++,r="A"):r=String.fromCharCode(r.charCodeAt(0)+1);return`${i}${r}`},setCitationHistory:e=>n[0]({citationHistory:e}),addCitationToHistory:e=>n[0](t=>{const i=t.citationHistory.findIndex(r=>r.exhibit_reference===e.exhibit_reference);return i>=0?{citationHistory:t.citationHistory.map((r,s)=>s===i?{...r,last_accessed:new Date().toISOString(),access_count:r.access_count+1}:r)}:{citationHistory:[...t.citationHistory,e]}}),setExhibitLinkActivation:e=>n[0]({exhibitLinkActivation:e}),navigateToExhibit:(e,t="general")=>n[0](i=>{const r=i.exhibits.find(s=>s.exhibit_id===e);if(r&&r.files.length>0){const s=r.files.find(o=>o.is_primary)||r.files[0],a=i.files.find(o=>o.id===s.file_id);if(a){const[o,l]=e.split(":"),c=l?parseInt(l,10):void 0,u={type:"citation",fileId:a.id,exhibitId:r.exhibit_id,exhibitReference:e,targetPage:c,timestamp:Date.now(),navigationType:t==="editor"?"citation_click":"exhibit_click",sourceContext:t},p={id:crypto.randomUUID(),exhibit_id:r.exhibit_id,exhibit_reference:e,target_file_id:a.id,target_page:c,last_accessed:new Date().toISOString(),access_count:1};return{selectedFileId:a.id,exhibitLinkActivation:u,linkActivation:u,citationHistory:[...i.citationHistory.filter(m=>m.exhibit_reference!==e),p]}}}return{}}),getExhibitByReference:e=>{const t=n[0](),[i]=e.split(":");return t.exhibits.find(r=>r.exhibit_id===i)||null},getFilesByExhibit:e=>{const t=n[0](),i=t.exhibits.find(r=>r.exhibit_id===e);return i?i.files.map(r=>t.files.find(s=>s.id===r.file_id)).filter(Boolean):[]},getExhibitFiles:e=>{const i=n[0]().exhibits.find(r=>r.exhibit_id===e);return(i==null?void 0:i.files)||[]},generateCitationReference:(e,t)=>t?`${e}:${t}`:e}),{name:"clarity-hub-storage",partialize:n=>({themeMode:n.themeMode,selectedProjectId:n.selectedProjectId,isLeftPanelOpen:n.isLeftPanelOpen,isRightPanelOpen:n.isRightPanelOpen})})));function kq(n){return We(n,xq)}const Uk="kareem.hassanein@gmail.com",LM=T.createContext(void 0),Dq=({children:n})=>{const[e,t]=T.useState(null),[i,r]=T.useState(null),[s,a]=T.useState(!1),o=We(y=>y.setUser);T.useEffect(()=>{window.DEMO_MODE&&(r({id:"00000000-0000-0000-0000-000000000000",email:"demo@example.com",user_metadata:{avatar_url:"https://ui-avatars.com/api/?name=Demo+User&background=0D8ABC&color=fff",full_name:"Demo User"}}),a(!1),console.log("Demo user set in AuthContext"))},[]);const l=T.useCallback(async(y,v)=>{var k,S;const w=await Zn.auth.signInWithPassword({email:y,password:v});return!w.error&&w.data.user&&y===Uk&&(console.log("Admin signed in, ensuring store is synced"),o({id:w.data.user.id,email:w.data.user.email||"",avatar_url:(k=w.data.user.user_metadata)==null?void 0:k.avatar_url,full_name:((S=w.data.user.user_metadata)==null?void 0:S.full_name)||"Admin User",is_admin:!0})),w},[o]),c=T.useCallback((y,v)=>Zn.auth.signUp({email:y,password:v}),[]),u=T.useCallback(()=>Zn.auth.signOut(),[]),p=T.useCallback(y=>Zn.auth.resetPasswordForEmail(y,{redirectTo:`${window.location.origin}/reset-password`}),[]),m=T.useCallback(y=>{r(y)},[]);T.useEffect(()=>{let y=!0;Zn.auth.getSession().then(({data:w,error:k})=>{var E,P;if(!y)return;if(k){console.error("getSession error:",k.message);const A={id:"00000000-0000-0000-0000-000000000000",email:"demo@example.com",avatar_url:"https://ui-avatars.com/api/?name=Demo+User&background=0D8ABC&color=fff",full_name:"Demo User",is_admin:!1};o(A),r(A),a(!1);return}const S=w.session;if(t(S),r((S==null?void 0:S.user)??null),S!=null&&S.user){const A=S.user.email===Uk;o({id:S.user.id,email:S.user.email||"",avatar_url:(E=S.user.user_metadata)==null?void 0:E.avatar_url,full_name:((P=S.user.user_metadata)==null?void 0:P.full_name)||(A?"Admin User":""),is_admin:A})}else{const A={id:"00000000-0000-0000-0000-000000000000",email:"demo@example.com",avatar_url:"https://ui-avatars.com/api/?name=Demo+User&background=0D8ABC&color=fff",full_name:"Demo User",is_admin:!1};o(A),r(A)}a(!1)}).catch(w=>{console.error("Error getting session:",w);const k={id:"00000000-0000-0000-0000-000000000000",email:"demo@example.com",avatar_url:"https://ui-avatars.com/api/?name=Demo+User&background=0D8ABC&color=fff",full_name:"Demo User",is_admin:!1};o(k),r(k),y&&a(!1)});const{data:{subscription:v}}=Zn.auth.onAuthStateChange(async(w,k)=>{var S,E,P;if(y){if(console.log("Auth state changed:",w,(S=k==null?void 0:k.user)==null?void 0:S.id),t(k),k!=null&&k.user){console.log("Setting user in store:",k.user.id);const A=k.user.email===Uk;r(k.user),o({id:k.user.id,email:k.user.email||"",avatar_url:(E=k.user.user_metadata)==null?void 0:E.avatar_url,full_name:((P=k.user.user_metadata)==null?void 0:P.full_name)||(A?"Admin User":""),is_admin:A})}else if(w==="SIGNED_OUT"){const A={id:"00000000-0000-0000-0000-000000000000",email:"demo@example.com",avatar_url:"https://ui-avatars.com/api/?name=Demo+User&background=0D8ABC&color=fff",full_name:"Demo User",is_admin:!1};r(A),o(A),console.log("Created demo user after sign out")}else{const A={id:"00000000-0000-0000-0000-000000000000",email:"demo@example.com",avatar_url:"https://ui-avatars.com/api/?name=Demo+User&background=0D8ABC&color=fff",full_name:"Demo User",is_admin:!1};r(A),o(A),console.log("Created demo user by default")}a(!1)}});return()=>{y=!1,v.unsubscribe()}},[o]);const g=T.useMemo(()=>({session:e,user:i,loading:s,signIn:l,signUp:c,signOut:u,resetPassword:p,setUserManually:m}),[e,i,s,l,c,u,p,m]);return b.jsxDEV(LM.Provider,{value:g,children:n},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/contexts/AuthContext.tsx",lineNumber:236,columnNumber:10},void 0)},AE=()=>{const n=T.useContext(LM);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},Sq="https://swtkpfpyjjkkemmvkhmz.supabase.co",Eq="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN3dGtwZnB5ampra2VtbXZraG16Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUzMDM5NTIsImV4cCI6MjA2MDg3OTk1Mn0.8herIfBAFOFUXro03pQxiS4Htnljavfncz-FvPj3sGw",rt=_E(Sq,Eq),oD=(n,e)=>e.some(t=>n instanceof t);let gP,bP;function Nq(){return gP||(gP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _q(){return bP||(bP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lD=new WeakMap,zk=new WeakMap,Hx=new WeakMap;function Cq(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Xd(n.result)),r()},a=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",a)});return Hx.set(e,n),e}function Aq(n){if(lD.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),r()},a=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});lD.set(n,e)}let cD={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return lD.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xd(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function FM(n){cD=n(cD)}function Pq(n){return _q().includes(n)?function(...e){return n.apply(uD(this),e),Xd(this.request)}:function(...e){return Xd(n.apply(uD(this),e))}}function Tq(n){return typeof n=="function"?Pq(n):(n instanceof IDBTransaction&&Aq(n),oD(n,Nq())?new Proxy(n,cD):n)}function Xd(n){if(n instanceof IDBRequest)return Cq(n);if(zk.has(n))return zk.get(n);const e=Tq(n);return e!==n&&(zk.set(n,e),Hx.set(e,n)),e}const uD=n=>Hx.get(n);function VM(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const a=indexedDB.open(n,e),o=Xd(a);return i&&a.addEventListener("upgradeneeded",l=>{i(Xd(a.result),l.oldVersion,l.newVersion,Xd(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const Iq=["get","getKey","getAll","getAllKeys","count"],Rq=["put","add","delete","clear"],Bk=new Map;function yP(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Bk.get(e))return Bk.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=Rq.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Iq.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,r?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),r&&l.done]))[0]};return Bk.set(e,s),s}FM(n=>({...n,get:(e,t,i)=>yP(e,t)||n.get(e,t,i),has:(e,t)=>!!yP(e,t)||n.has(e,t)}));const Mq=["continue","continuePrimaryKey","advance"],vP={},dD=new WeakMap,UM=new WeakMap,jq={get(n,e){if(!Mq.includes(e))return n[e];let t=vP[e];return t||(t=vP[e]=function(...i){dD.set(this,UM.get(this)[e](...i))}),t}};async function*Oq(...n){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...n)),!e)return;e=e;const t=new Proxy(e,jq);for(UM.set(t,e),Hx.set(t,uD(e));e;)yield t,e=await(dD.get(t)||e.continue()),dD.delete(t)}function xP(n,e){return e===Symbol.asyncIterator&&oD(n,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&oD(n,[IDBIndex,IDBObjectStore])}FM(n=>({...n,get(e,t,i){return xP(e,t)?Oq:n.get(e,t,i)},has(e,t){return xP(e,t)||n.has(e,t)}}));let $l=null;const zM=async()=>{try{if($l)return $l;$l=VM("clarity-file-sync",1,{upgrade(r,s,a,o){if(console.log(`Upgrading IndexedDB from version ${s} to ${a}`),!r.objectStoreNames.contains("unsynced-files")){console.log("Creating unsynced-files store");const l=r.createObjectStore("unsynced-files",{keyPath:"id",autoIncrement:!0});console.log("Creating indexes for unsynced-files store"),l.createIndex("by-status","status"),l.createIndex("by-projectId","projectId"),l.createIndex("by-timestamp","timestamp")}if(!r.objectStoreNames.contains("fallback-storage")){console.log("Creating fallback-storage store");const l=r.createObjectStore("fallback-storage",{keyPath:"id"});console.log("Creating indexes for fallback-storage store"),l.createIndex("by-path","path",{unique:!0}),l.createIndex("by-projectId","projectId"),l.createIndex("by-type","fileType"),l.createIndex("by-uploadStatus","uploadStatus")}},blocked(){console.warn("IndexedDB upgrade blocked - another tab has the database open")},blocking(){console.warn("IndexedDB is blocking a newer version from being opened")},terminated(){console.error("IndexedDB connection was terminated abnormally"),$l=null}});const t=await $l;console.log("IndexedDB initialized successfully for file sync");const i=Array.from(t.objectStoreNames);if(console.log("Available stores:",i.join(", ")),i.includes("unsynced-files"))try{const r=t.transaction("unsynced-files","readonly"),s=r.objectStore("unsynced-files"),a=Array.from(s.indexNames);console.log("Available indexes for unsynced-files:",a.join(", ")),await r.done}catch(r){console.error("Error checking indexes:",r)}return t}catch(n){return console.error("Error initializing IndexedDB:",n),$l=null,null}},Lq=()=>($l||zM(),$l);console.log("Storage initialization requested...");if(typeof window<"u"){console.log("Initializing local storage in browser environment...");try{localStorage.setItem("USE_FALLBACK_STORAGE","true"),console.log("Fallback storage enabled for demo mode"),zM().then(()=>console.log("IndexedDB initialized for fallback storage")).catch(n=>console.error("IndexedDB initialization failed:",n))}catch(n){console.error("Failed to enable fallback storage:",n)}}class Fq{constructor(){this.dbPromise=null,this.DB_NAME="fallback-storage",this.DB_VERSION=2}async initDB(){return this.dbPromise||(this.dbPromise=VM(this.DB_NAME,this.DB_VERSION,{upgrade(e,t,i,r){if(t<1){const s=e.createObjectStore("files",{keyPath:"id"});s.createIndex("by-path","path",{unique:!0}),s.createIndex("by-project","projectId",{unique:!1})}t<2&&(t===1&&r.objectStore("files").createIndex("by-sync-status","synced",{unique:!1}),e.createObjectStore("versions",{keyPath:"id"}).createIndex("by-file-id","fileId",{unique:!1}))}})),this.dbPromise}async uploadFile(e,t,i,r,s,a={}){try{const o=await this.initDB(),l=crypto.randomUUID(),c=`${e}/${t}`,u=Date.now(),p=await this.getFileByPath(c),m=i instanceof File?i:new Blob([i]);if(p){console.log("Updating existing file in local storage:",p.path),await this.createFileVersion(p.id,p.file);const g={...p,file:m,contentType:i instanceof File?i.type:"application/octet-stream",size:(i instanceof File,i.size),lastModified:u,metadata:{...p.metadata,...a,updateTimestamp:u},synced:!1};await o.put("files",g);const y=URL.createObjectURL(m);return{path:c,id:p.id,publicUrl:y}}else{const g={id:l,path:c,file:m,contentType:i instanceof File?i.type:"application/octet-stream",name:i instanceof File?i.name:t.split("/").pop()||"file",size:(i instanceof File,i.size),uploadDate:u,lastModified:u,projectId:r,userId:s,metadata:{...a,originalFileName:i instanceof File?i.name:t.split("/").pop(),uploadTimestamp:u},synced:!1};await o.put("files",g),console.log("File stored locally:",g.path);const y=URL.createObjectURL(m);return{path:c,id:l,publicUrl:y}}}catch(o){throw console.error("Error storing file locally:",o),new Error("Failed to store file locally")}}async createFileVersion(e,t){try{const i=await this.initDB(),r=crypto.randomUUID(),s={id:r,fileId:e,blob:t,createdAt:Date.now(),size:t.size};return await i.put("versions",s),console.log(`Created version ${r} for file ${e}`),r}catch(i){throw console.error("Error creating file version:",i),new Error("Failed to create file version")}}async getFileVersions(e){try{return(await(await this.initDB()).transaction("versions").store.index("by-file-id").getAll(e)).sort((s,a)=>a.createdAt-s.createdAt)}catch(t){return console.error("Error getting file versions:",t),[]}}async restoreFileVersion(e){try{const t=await this.initDB(),i=await t.get("versions",e);if(!i)throw new Error("Version not found");const r=await t.get("files",i.fileId);if(!r)throw new Error("File not found");await this.createFileVersion(r.id,r.file);const s={...r,file:i.blob,size:i.blob.size,lastModified:Date.now(),synced:!1,metadata:{...r.metadata,restoredFromVersion:e,restoredAt:Date.now()}};return await t.put("files",s),!0}catch(t){return console.error("Error restoring file version:",t),!1}}async getFile(e,t){try{const i=await this.getFileByPath(`${e}/${t}`);return i?i.file:null}catch(i){return console.error("Error retrieving file from local storage:",i),null}}async getFileByPath(e){try{return await(await this.initDB()).transaction("files").store.index("by-path").get(e)}catch(t){return console.error("Error getting file by path:",t),null}}async getFileUrl(e,t){try{const i=await this.getFile(e,t);return i?URL.createObjectURL(i):null}catch(i){return console.error("Error creating URL for local file:",i),null}}async deleteFile(e,t){try{const i=await this.initDB(),r=`${e}/${t}`,a=await i.transaction("files","readwrite").store.index("by-path").get(r);if(!a)return!1;const o=i.transaction(["files","versions"],"readwrite"),c=await o.objectStore("versions").index("by-file-id").getAllKeys(a.id);for(const u of c)await o.objectStore("versions").delete(u);return await o.objectStore("files").delete(a.id),await o.done,!0}catch(i){return console.error("Error deleting file from local storage:",i),!1}}async listProjectFiles(e){try{return await(await this.initDB()).transaction("files").store.index("by-project").getAll(e)}catch(t){return console.error("Error listing project files:",t),[]}}async getUnsyncedFiles(){try{const e=await Lq();if(!e)return console.error("Failed to get IndexedDB instance"),[];try{const t=e.transaction("unsynced-files","readonly"),i=t.objectStore("unsynced-files");if(!i.indexNames.contains("by-status"))return console.warn("Missing by-status index, fallback to get all records"),await i.getAll();const s=await i.index("by-status").getAll("pending");return await t.done,s}catch(t){return console.error("Error getting unsynced files:",t),[]}}catch(e){return console.error("Error getting unsynced files:",e),[]}}async markFileSynced(e){try{const t=await this.initDB(),i=await t.get("files",e);return i?(await t.put("files",{...i,synced:!0}),!0):!1}catch(t){return console.error("Error marking file as synced:",t),!1}}async getAllFiles(){try{return await(await this.initDB()).getAll("files")}catch(e){return console.error("Error getting all files:",e),[]}}async clearAll(){try{const e=await this.initDB();return await e.clear("files"),await e.clear("versions"),!0}catch(e){return console.error("Error clearing storage:",e),!1}}}const Sg=new Fq,Vq="https://swtkpfpyjjkkemmvkhmz.supabase.co";let Es=!1;const Uq={AVATARS:"avatars",FILES:"files",THUMBNAILS:"thumbnails"},wP=3,Hh={};(async function(){try{if(window.DEMO_MODE){console.log("Demo mode detected, enabling fallback storage"),Es=!0;return}const{data:e,error:t}=await rt.storage.from("files").list("",{limit:1});t?(console.warn("Supabase storage connection test failed, enabling fallback mode:",t),Es=!0):(console.log("Supabase storage connection test succeeded"),Es=!1)}catch(e){console.warn("Supabase connection error, enabling fallback mode:",e),Es=!0}})();const kP=()=>Es,zq=async()=>{try{const{data:n,error:e}=await rt.storage.from("files").list("",{limit:1});return e?(console.warn("Supabase storage still unavailable:",e),!1):(console.log("Supabase storage connection restored"),Es=!1,!0)}catch(n){return console.error("Error resetting fallback mode:",n),!1}},BM=(n,e)=>{if(Es||window.DEMO_MODE)return console.warn("[storageService] Fallback mode active - use getFileUrl() for proper async handling"),"";if(!e||!n)return"";const t=e.startsWith("/")?e.substring(1):e;return`${Vq}/storage/v1/object/public/${n}/${t}`},DP=(n,e)=>{const t={path:n,versionId:e,timestamp:Date.now()};return Hh[n]||(Hh[n]=[]),Hh[n].unshift(t),Hh[n].length>5&&(Hh[n]=Hh[n].slice(0,5)),t},t0=async(n,e,t,i)=>{var r;try{const{onProgress:s,upsert:a=!0,cacheControl:o="3600",retryCount:l=0,createVersion:c=!0}=i||{};if(Es||window.DEMO_MODE){console.log("Using local fallback for uploadFile (fallback mode or demo)");const p=e.split("/"),m=p.length>1?p[1]:"unknown-project";let g="demo-user-123";try{const{data:w}=await rt.auth.getUser();g=((r=w==null?void 0:w.user)==null?void 0:r.id)||"demo-user-123"}catch{console.warn("Could not get user ID, using demo user")}s&&(s({loaded:t.size*.1,total:t.size}),setTimeout(()=>{s({loaded:t.size*.5,total:t.size})},150),setTimeout(()=>{s({loaded:t.size*.9,total:t.size})},300));const y=await Sg.uploadFile(n,e,t,m,g);s&&s({loaded:t.size,total:t.size});const v=crypto.randomUUID();return c&&DP(e,v),{path:y.path,publicUrl:y.publicUrl,versionId:v}}const u=p=>{var g,y,v,w,k,S,E;let m=(p==null?void 0:p.message)||"Unknown error occurred";return console.error("STORAGE ERROR DETAILS:",JSON.stringify(p,null,2)),(g=p==null?void 0:p.message)!=null&&g.includes("new row violates row-level security policy")&&(m="Permission denied: Your account does not have permissions to upload files",console.error("RLS policy violation during file upload. Details:",p)),(y=p==null?void 0:p.message)!=null&&y.includes("exceeded storage quota")&&(m="Storage quota exceeded. Please free up some space before uploading."),((v=p==null?void 0:p.message)!=null&&v.includes("The bucket you're trying to upload to doesn't exist")||(w=p==null?void 0:p.message)!=null&&w.includes("Bucket not found"))&&(m=`Storage bucket "${n}" doesn't exist. Please check your bucket configuration.`,console.error(`Bucket "${n}" not found. Available buckets should be: ${Object.values(Uq).join(", ")}`)),((k=p==null?void 0:p.message)!=null&&k.includes("invalid signature")||(S=p==null?void 0:p.message)!=null&&S.includes("JWT")||(E=p==null?void 0:p.message)!=null&&E.includes("auth")||(p==null?void 0:p.statusCode)==="401"||(p==null?void 0:p.status)===401||(p==null?void 0:p.status)===400)&&(m="Authorization failed. Please log in again or try refreshing the page.",console.error("JWT/Auth error during upload:",p),Es=!0),{message:m,originalError:p}};console.log(`Uploading file to ${n}/${e}`,{fileName:t.name,fileSize:t.size,fileType:t.type,upsert:a,retryCount:l});try{const{data:p,error:m}=await rt.storage.from(n).upload(e,t,{cacheControl:o,upsert:a,onUploadProgress:s?y=>{y.total&&s({loaded:y.loaded,total:y.total})}:void 0});if(m)throw m;console.log("File uploaded successfully",{path:p.path});const g=crypto.randomUUID();return c&&DP(e,g),{...p,publicUrl:BM(n,p.path),versionId:g}}catch(p){const m=u(p);if(console.error("Upload failed:",m.message),l<wP){console.log(`Retrying upload (${l+1}/${wP})...`);const g=Math.pow(2,l)*1e3;return await new Promise(y=>setTimeout(y,g)),t0(n,e,t,{...i,retryCount:l+1})}return Es=!0,t0(n,e,t,{...i,retryCount:0})}}catch(s){if(console.error("Error uploading file:",s),!Es)return Es=!0,t0(n,e,t,{...i,retryCount:0});throw s}},Loe=async()=>{if(!Es)return!0;if(!await zq())return!1;const e=await Sg.getAllFiles();if(!e.length)return!0;console.log(`Syncing ${e.length} files to Supabase...`);let t=0;for(const i of e)try{const{bucket:r,path:s}=Bq(i.path),{error:a}=await rt.storage.from(r).upload(s,i.file,{upsert:!0});if(a)throw a;t++,await Sg.markFileSynced(i.id)}catch(r){console.error(`Failed to sync file ${i.path}:`,r)}return console.log(`Synced ${t}/${e.length} files to Supabase`),t===e.length},Bq=n=>{const e=n.split("/"),t=e[0],i=e.slice(1).join("/");return{bucket:t,path:i}},$M=T.createContext(void 0),PE=()=>{const n=T.useContext($M);if(n===void 0)throw new Error("useNotification must be used within a NotificationProvider");return n},$q=({children:n})=>{const[e,t]=T.useState({open:!1,message:"",type:"info",duration:4e3}),i=(a,o="info",l=4e3)=>{const c=typeof a=="string"?a:typeof a=="object"&&(a!=null&&a.message)?String(a.message):String(a);t({open:!0,message:c,type:o,duration:l})},r=()=>{t(a=>({...a,open:!1}))},s=(a,o)=>{o!=="clickaway"&&r()};return b.jsxDEV($M.Provider,{value:{showNotification:i,hideNotification:r},children:[n,b.jsxDEV(NR,{open:e.open,autoHideDuration:e.duration,onClose:s,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:b.jsxDEV(Aa,{onClose:()=>r(),severity:e.type,variant:"filled",sx:{width:"100%"},children:e.message},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/contexts/NotificationContext.tsx",lineNumber:86,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/contexts/NotificationContext.tsx",lineNumber:80,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/contexts/NotificationContext.tsx",lineNumber:78,columnNumber:5},void 0)},Wq=lt(ut)(({spinning:n,theme:e})=>({transition:n?"transform 1s linear infinite":"none",transform:n?"rotate(360deg)":"none",animation:n?"spin 1.5s linear infinite":"none","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}})),Hq=({variant:n="icon",showCount:e=!0,color:t="primary",size:i="medium"})=>{const[r,s]=T.useState("idle"),[a,o]=T.useState(0),[l,c]=T.useState(null),{showNotification:u}=PE();T.useEffect(()=>{const y=async()=>{if(kP()){const w=await Sg.getAllFiles();o(w.length)}else{const w=await Sg.getUnsyncedFiles();o(w.length)}};y();const v=setInterval(y,3e4);return()=>clearInterval(v)},[]),T.useEffect(()=>{const y=()=>{s(navigator.onLine?"idle":"offline")};window.addEventListener("online",y),window.addEventListener("offline",y),y();const v=setInterval(()=>{if(navigator.onLine){const w=Math.floor(Math.random()*3);o(k=>k+w)}},3e4);return()=>{window.removeEventListener("online",y),window.removeEventListener("offline",y),clearInterval(v)}},[]);const p=()=>{if(r==="offline"){u("You are currently offline. Changes will sync when you reconnect.","warning");return}if(a===0){u("Already up to date","info");return}s("syncing"),setTimeout(()=>{Math.random()>.1?(s("success"),c(new Date),o(0),u("Changes synced successfully","success"),setTimeout(()=>{s("idle")},3e3)):(s("error"),u("Failed to sync changes. Please try again.","error"),setTimeout(()=>{s("idle")},3e3))},1500)},m=()=>{switch(r){case"idle":return a>0?`${a} pending change${a!==1?"s":""} to sync`:"All changes synced";case"syncing":return"Syncing changes...";case"success":return`Last synced: ${l==null?void 0:l.toLocaleTimeString()}`;case"error":return"Sync failed. Click to retry.";case"offline":return"Currently offline. Changes will sync when you reconnect.";default:return"Sync status"}},g=()=>{switch(r){case"syncing":return b.jsxDEV(Yr,{size:24,color:"inherit"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:166,columnNumber:16},void 0);case"success":return b.jsxDEV(_R,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:168,columnNumber:16},void 0);case"error":return b.jsxDEV(cA,{color:"error"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:170,columnNumber:16},void 0);case"offline":return b.jsxDEV(a4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:172,columnNumber:16},void 0);default:return b.jsxDEV(cA,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:174,columnNumber:16},void 0)}};return a===0&&!kP()?null:n==="icon"?b.jsxDEV(Nt,{title:m(),children:b.jsxDEV(re,{children:b.jsxDEV(Yc,{badgeContent:e&&a>0?a:0,color:"error",overlap:"circular",invisible:!e||a===0,children:b.jsxDEV(Wq,{color:t,onClick:p,size:i,spinning:r==="syncing"?1:0,disabled:r==="syncing",children:g()},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:194,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:188,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:187,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:186,columnNumber:7},void 0):b.jsxDEV(Nt,{title:m(),children:b.jsxDEV(re,{children:b.jsxDEV(vt,{variant:"outlined",color:t,onClick:p,disabled:r==="syncing",startIcon:g(),size:i,children:[r==="syncing"?"Syncing...":"Sync",e&&a>0&&b.jsxDEV(ge,{component:"span",variant:"caption",sx:{ml:1,bgcolor:"error.main",color:"error.contrastText",borderRadius:"50%",width:18,height:18,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:a},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:223,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:213,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:212,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/AutoSyncButton.tsx",lineNumber:211,columnNumber:5},void 0)},_m=(n,e)=>n.length!==e.length?!1:e.every(t=>n.includes(t)),qq=({openTo:n,defaultOpenTo:e,views:t,defaultViews:i})=>{const r=t??i;let s;if(n!=null)s=n;else if(r.includes(e))s=e;else if(r.length>0)s=r[0];else throw new Error("MUI X: The `views` prop must contain at least one view.");return{views:r,openTo:s}},X0=(n,e,t)=>{let i=e;return i=n.setHours(i,n.getHours(t)),i=n.setMinutes(i,n.getMinutes(t)),i=n.setSeconds(i,n.getSeconds(t)),i=n.setMilliseconds(i,n.getMilliseconds(t)),i},Eg=({date:n,disableFuture:e,disablePast:t,maxDate:i,minDate:r,isDateDisabled:s,utils:a,timezone:o})=>{const l=X0(a,a.date(void 0,o),n);t&&a.isBefore(r,l)&&(r=l),e&&a.isAfter(i,l)&&(i=l);let c=n,u=n;for(a.isBefore(n,r)&&(c=r,u=null),a.isAfter(n,i)&&(u&&(u=i),c=null);c||u;){if(c&&a.isAfter(c,i)&&(c=null),u&&a.isBefore(u,r)&&(u=null),c){if(!s(c))return c;c=a.addDays(c,1)}if(u){if(!s(u))return u;u=a.addDays(u,-1)}}return null},Gq=(n,e)=>n.isValid(e)?e:null,SP=(n,e,t)=>e==null||!n.isValid(e)?t:e,Yq=(n,e,t)=>!n.isValid(e)&&e!=null&&!n.isValid(t)&&t!=null?!0:n.isEqual(e,t),TE=(n,e)=>{const i=[n.startOfYear(e)];for(;i.length<12;){const r=i[i.length-1];i.push(n.addMonths(r,1))}return i},WM=(n,e,t)=>t==="date"?n.startOfDay(n.date(void 0,e)):n.date(void 0,e),Xq=["year","month","day"],EP=n=>Xq.includes(n),IE=(n,{format:e,views:t},i)=>{if(e!=null)return e;const r=n.formats;return _m(t,["year"])?r.year:_m(t,["month"])?r.month:_m(t,["day"])?r.dayOfMonth:_m(t,["month","year"])?`${r.month} ${r.year}`:_m(t,["day","month"])?`${r.month} ${r.dayOfMonth}`:i?/en/.test(n.getCurrentLocaleCode())?r.normalDateWithWeekday:r.normalDate:r.keyboardDate},Kq=(n,e)=>{const t=n.startOfWeek(e);return[0,1,2,3,4,5,6].map(i=>n.addDays(t,i))},Qq=["hours","minutes","seconds"],Jq=n=>Qq.includes(n),NP=(n,e)=>e.getHours(n)*3600+e.getMinutes(n)*60+e.getSeconds(n),Zq=(n,e)=>(t,i)=>n?e.isAfter(t,i):NP(t,e)>NP(i,e),po={year:1,month:2,day:3,hours:4,minutes:5,seconds:6,milliseconds:7},e8=n=>Math.max(...n.map(e=>po[e.type]??1)),Cm=(n,e,t)=>{if(e===po.year)return n.startOfYear(t);if(e===po.month)return n.startOfMonth(t);if(e===po.day)return n.startOfDay(t);let i=t;return e<po.minutes&&(i=n.setMinutes(i,0)),e<po.seconds&&(i=n.setSeconds(i,0)),e<po.milliseconds&&(i=n.setMilliseconds(i,0)),i},t8=({props:n,utils:e,granularity:t,timezone:i,getTodayDate:r})=>{let s=r?r():Cm(e,t,WM(e,i));n.minDate!=null&&e.isAfterDay(n.minDate,s)&&(s=Cm(e,t,n.minDate)),n.maxDate!=null&&e.isBeforeDay(n.maxDate,s)&&(s=Cm(e,t,n.maxDate));const a=Zq(n.disableIgnoringDatePartForTimeValidation??!1,e);return n.minTime!=null&&a(n.minTime,s)&&(s=Cm(e,t,n.disableIgnoringDatePartForTimeValidation?n.minTime:X0(e,s,n.minTime))),n.maxTime!=null&&a(s,n.maxTime)&&(s=Cm(e,t,n.disableIgnoringDatePartForTimeValidation?n.maxTime:X0(e,s,n.maxTime))),s},RE=(n,e)=>{const t=n.formatTokenMap[e];if(t==null)throw new Error([`MUI X: The token "${e}" is not supported by the Date and Time Pickers.`,"Please try using another token or open an issue on https://github.com/mui/mui-x/issues/new/choose if you think it should be supported."].join(`
`));return typeof t=="string"?{type:t,contentType:t==="meridiem"?"letter":"digit",maxLength:void 0}:{type:t.sectionType,contentType:t.contentType,maxLength:t.maxLength}},qx=(n,e)=>{const t=[],i=n.date(void 0,"default"),r=n.startOfWeek(i),s=n.endOfWeek(i);let a=r;for(;n.isBefore(a,s);)t.push(a),a=n.addDays(a,1);return t.map(o=>n.formatByString(o,e))},HM=(n,e,t,i)=>{switch(t){case"month":return TE(n,n.date(void 0,e)).map(r=>n.formatByString(r,i));case"weekDay":return qx(n,i);case"meridiem":{const r=n.date(void 0,e);return[n.startOfDay(r),n.endOfDay(r)].map(s=>n.formatByString(s,i))}default:return[]}},_P="s",n8=["0","1","2","3","4","5","6","7","8","9"],i8=n=>{const e=n.date(void 0);return n.formatByString(n.setSeconds(e,0),_P)==="0"?n8:Array.from({length:10}).map((i,r)=>n.formatByString(n.setSeconds(e,r),_P))},th=(n,e)=>{if(e[0]==="0")return n;const t=[];let i="";for(let r=0;r<n.length;r+=1){i+=n[r];const s=e.indexOf(i);s>-1&&(t.push(s.toString()),i="")}return t.join("")},ME=(n,e)=>e[0]==="0"?n:n.split("").map(t=>e[Number(t)]).join(""),CP=(n,e)=>{const t=th(n,e);return t!==" "&&!Number.isNaN(Number(t))},jE=(n,e)=>Number(n).toString().padStart(e,"0"),qM=(n,e,t,i,r)=>{if(r.type!=="day"&&r.contentType==="digit-with-letter")throw new Error([`MUI X: The token "${r.format}" is a digit format with letter in it.'
             This type of format is only supported for 'day' sections`].join(`
`));if(r.type==="day"&&r.contentType==="digit-with-letter"){const a=n.setDate(t.longestMonth,e);return n.formatByString(a,r.format)}let s=e.toString();return r.hasLeadingZerosInInput&&(s=jE(s,r.maxLength)),ME(s,i)},OE=(n,e,t)=>{let i=n.value||n.placeholder;const r=e==="non-input"?n.hasLeadingZerosInFormat:n.hasLeadingZerosInInput;return e==="non-input"&&n.hasLeadingZerosInInput&&!n.hasLeadingZerosInFormat&&(i=Number(th(i,t)).toString()),["input-rtl","input-ltr"].includes(e)&&n.contentType==="digit"&&!r&&i.length===1&&(i=`${i}‎`),e==="input-rtl"&&(i=`⁨${i}⁩`),i},AP=(n,e,t,i)=>{if(RE(n,t).type==="weekDay")throw new Error("changeSectionValueFormat doesn't support week day formats");return n.formatByString(n.parse(e,t),i)},r8=(n,e)=>n.formatByString(n.date(void 0,"system"),e).length===4,GM=(n,e,t,i)=>{if(e!=="digit")return!1;const r=n.date(void 0,"default");switch(t){case"year":return n.lib==="dayjs"&&i==="YY"?!0:n.formatByString(n.setYear(r,1),i).startsWith("0");case"month":return n.formatByString(n.startOfYear(r),i).length>1;case"day":return n.formatByString(n.startOfMonth(r),i).length>1;case"weekDay":return n.formatByString(n.startOfWeek(r),i).length>1;case"hours":return n.formatByString(n.setHours(r,1),i).length>1;case"minutes":return n.formatByString(n.setMinutes(r,1),i).length>1;case"seconds":return n.formatByString(n.setSeconds(r,1),i).length>1;default:throw new Error("Invalid section type")}},s8=(n,e,t)=>{const i=e.some(l=>l.type==="day"),r=[],s=[];for(let l=0;l<e.length;l+=1){const c=e[l];i&&c.type==="weekDay"||(r.push(c.format),s.push(OE(c,"non-input",t)))}const a=r.join(" "),o=s.join(" ");return n.parse(o,a)},a8=n=>n.map(e=>`${e.startSeparator}${e.value||e.placeholder}${e.endSeparator}`).join(""),o8=(n,e,t)=>{const r=n.map(s=>{const a=OE(s,t?"input-rtl":"input-ltr",e);return`${s.startSeparator}${a}${s.endSeparator}`}).join("");return t?`⁦${r}⁩`:r},l8=(n,e,t)=>{const i=n.date(void 0,t),r=n.endOfYear(i),s=n.endOfDay(i),{maxDaysInMonth:a,longestMonth:o}=TE(n,i).reduce((l,c)=>{const u=n.getDaysInMonth(c);return u>l.maxDaysInMonth?{maxDaysInMonth:u,longestMonth:c}:l},{maxDaysInMonth:0,longestMonth:null});return{year:({format:l})=>({minimum:0,maximum:r8(n,l)?9999:99}),month:()=>({minimum:1,maximum:n.getMonth(r)+1}),day:({currentDate:l})=>({minimum:1,maximum:n.isValid(l)?n.getDaysInMonth(l):a,longestMonth:o}),weekDay:({format:l,contentType:c})=>{if(c==="digit"){const u=qx(n,l).map(Number);return{minimum:Math.min(...u),maximum:Math.max(...u)}}return{minimum:1,maximum:7}},hours:({format:l})=>{const c=n.getHours(s);return th(n.formatByString(n.endOfDay(i),l),e)!==c.toString()?{minimum:1,maximum:Number(th(n.formatByString(n.startOfDay(i),l),e))}:{minimum:0,maximum:c}},minutes:()=>({minimum:0,maximum:n.getMinutes(s)}),seconds:()=>({minimum:0,maximum:n.getSeconds(s)}),meridiem:()=>({minimum:0,maximum:1}),empty:()=>({minimum:0,maximum:0})}};let PP=!1;const TP=(n,e)=>{if(!PP){const t=["empty"];["date","date-time"].includes(e)&&t.push("weekDay","day","month","year"),["time","date-time"].includes(e)&&t.push("hours","minutes","seconds","meridiem");const i=n.find(r=>!t.includes(r.type));i&&(console.warn(`MUI X: The field component you are using is not compatible with the "${i.type}" date section.`,`The supported date sections are ["${t.join('", "')}"]\`.`),PP=!0)}},c8=(n,e,t,i)=>{switch(e.type){case"year":return n.setYear(i,n.getYear(t));case"month":return n.setMonth(i,n.getMonth(t));case"weekDay":{let r=n.formatByString(t,e.format);e.hasLeadingZerosInInput&&(r=jE(r,e.maxLength));const s=qx(n,e.format),a=s.indexOf(r),l=s.indexOf(e.value)-a;return n.addDays(t,l)}case"day":return n.setDate(i,n.getDate(t));case"meridiem":{const r=n.getHours(t)<12,s=n.getHours(i);return r&&s>=12?n.addHours(i,-12):!r&&s<12?n.addHours(i,12):i}case"hours":return n.setHours(i,n.getHours(t));case"minutes":return n.setMinutes(i,n.getMinutes(t));case"seconds":return n.setSeconds(i,n.getSeconds(t));default:return i}},IP={year:1,month:2,day:3,weekDay:4,hours:5,minutes:6,seconds:7,meridiem:8,empty:9},RP=(n,e,t,i,r)=>[...t].sort((s,a)=>IP[s.type]-IP[a.type]).reduce((s,a)=>!r||a.modified?c8(n,a,e,s):s,i),u8=()=>navigator.userAgent.toLowerCase().includes("android"),d8=(n,e)=>{const t={};if(!e)return n.forEach((l,c)=>{const u=c===0?null:c-1,p=c===n.length-1?null:c+1;t[c]={leftIndex:u,rightIndex:p}}),{neighbors:t,startIndex:0,endIndex:n.length-1};const i={},r={};let s=0,a=0,o=n.length-1;for(;o>=0;){a=n.findIndex((l,c)=>{var u;return c>=s&&((u=l.endSeparator)==null?void 0:u.includes(" "))&&l.endSeparator!==" / "}),a===-1&&(a=n.length-1);for(let l=a;l>=s;l-=1)r[l]=o,i[o]=l,o-=1;s=a+1}return n.forEach((l,c)=>{const u=r[c],p=u===0?null:i[u-1],m=u===n.length-1?null:i[u+1];t[c]={leftIndex:p,rightIndex:m}}),{neighbors:t,startIndex:i[0],endIndex:i[n.length-1]}},hD=(n,e)=>{if(n==null)return null;if(n==="all")return"all";if(typeof n=="string"){const t=e.findIndex(i=>i.type===n);return t===-1?null:t}return n},h8=["value","referenceDate"],mo={emptyValue:null,getTodayValue:WM,getInitialReferenceValue:n=>{let{value:e,referenceDate:t}=n,i=St(n,h8);return i.utils.isValid(e)?e:t??t8(i)},cleanValue:Gq,areValuesEqual:Yq,isSameError:(n,e)=>n===e,hasError:n=>n!=null,defaultErrorState:null,getTimezone:(n,e)=>n.isValid(e)?n.getTimezone(e):null,setTimezone:(n,e,t)=>t==null?null:n.setTimezone(t,e)},p8={updateReferenceValue:(n,e,t)=>n.isValid(e)?e:t,getSectionsFromValue:(n,e)=>e(n),getV7HiddenInputValueFromSections:a8,getV6InputValueFromSections:o8,parseValueStr:(n,e,t)=>t(n.trim(),e),getDateFromSection:n=>n,getDateSectionsFromValue:n=>n,updateDateInValue:(n,e,t)=>t,clearDateSections:n=>n.map(e=>se({},e,{value:""}))};function f8(n){return Ci("MuiPickersToolbar",n)}Ai("MuiPickersToolbar",["root","title","content"]);const m8=["localeText"],K0=T.createContext(null);K0.displayName="MuiPickersAdapterContext";const YM=function(e){const{localeText:t}=e,i=St(e,m8),{utils:r,localeText:s}=T.useContext(K0)??{utils:void 0,localeText:void 0},a=Yn({props:i,name:"MuiLocalizationProvider"}),{children:o,dateAdapter:l,dateFormats:c,dateLibInstance:u,adapterLocale:p,localeText:m}=a,g=T.useMemo(()=>se({},m,s,t),[m,s,t]),y=T.useMemo(()=>{if(!l)return r||null;const k=new l({locale:p,formats:c,instance:u});if(!k.isMUIAdapter)throw new Error(["MUI X: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/quickstart/#installation"].join(`
`));return k},[l,p,c,u,r]),v=T.useMemo(()=>y?{minDate:y.date("1900-01-01T00:00:00.000"),maxDate:y.date("2099-12-31T00:00:00.000")}:null,[y]),w=T.useMemo(()=>({utils:y,defaultDates:v,localeText:g}),[v,y,g]);return pe.jsx(K0.Provider,{value:w,children:o})};YM.propTypes={adapterLocale:D.any,children:D.node,dateAdapter:D.func,dateFormats:D.shape({dayOfMonth:D.string,dayOfMonthFull:D.string,fullDate:D.string,fullTime12h:D.string,fullTime24h:D.string,hours12h:D.string,hours24h:D.string,keyboardDate:D.string,keyboardDateTime12h:D.string,keyboardDateTime24h:D.string,meridiem:D.string,minutes:D.string,month:D.string,monthShort:D.string,normalDate:D.string,normalDateWithWeekday:D.string,seconds:D.string,shortDate:D.string,weekday:D.string,weekdayShort:D.string,year:D.string}),dateLibInstance:D.any,localeText:D.object};const XM=T.createContext(()=>!0);function g8(){return T.useContext(XM)}const KM=T.createContext(null);function QM(){return T.useContext(KM)}const LE=T.createContext(null),nm=()=>{const n=T.useContext(LE);if(n==null)throw new Error("MUI X: The `usePickerContext` hook can only be called inside the context of a Picker component");return n},JM=T.createContext(null),ZM=T.createContext({ownerState:{isPickerDisabled:!1,isPickerReadOnly:!1,isPickerValueEmpty:!1,isPickerOpen:!1,pickerVariant:"desktop",pickerOrientation:"portrait"},rootRefObject:{current:null},labelId:void 0,dismissViews:()=>{},hasUIView:!0,getCurrentViewMode:()=>"UI",triggerElement:null,viewContainerRole:null,defaultActionBarActions:[],onPopperExited:void 0});function ej(n){const{contextValue:e,actionsContextValue:t,privateContextValue:i,fieldPrivateContextValue:r,isValidContextValue:s,localeText:a,children:o}=n;return pe.jsx(LE.Provider,{value:e,children:pe.jsx(JM.Provider,{value:t,children:pe.jsx(ZM.Provider,{value:i,children:pe.jsx(KM.Provider,{value:r,children:pe.jsx(XM.Provider,{value:s,children:pe.jsx(YM,{localeText:a,children:o})})})})})})}const ir=()=>T.useContext(ZM);function tj(){const{ownerState:n}=ir(),e=El();return T.useMemo(()=>se({},n,{toolbarDirection:e?"rtl":"ltr"}),[n,e])}const b8=["children","className","classes","toolbarTitle","hidden","titleId","classes","landscapeDirection"],y8=n=>ei({root:["root"],title:["title"],content:["content"]},f8,n),v8=lt("div",{name:"MuiPickersToolbar",slot:"Root"})(({theme:n})=>({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",padding:n.spacing(2,3),variants:[{props:{pickerOrientation:"landscape"},style:{height:"auto",maxWidth:160,padding:16,justifyContent:"flex-start",flexWrap:"wrap"}}]})),x8=lt("div",{name:"MuiPickersToolbar",slot:"Content",shouldForwardProp:n=>lh(n)&&n!=="landscapeDirection"})({display:"flex",flexWrap:"wrap",width:"100%",flex:1,justifyContent:"space-between",alignItems:"center",flexDirection:"row",variants:[{props:{pickerOrientation:"landscape"},style:{justifyContent:"flex-start",alignItems:"flex-start",flexDirection:"column"}},{props:{pickerOrientation:"landscape",landscapeDirection:"row"},style:{flexDirection:"row"}}]}),w8=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiPickersToolbar"}),{children:r,className:s,classes:a,toolbarTitle:o,hidden:l,titleId:c,landscapeDirection:u}=i,p=St(i,b8),m=tj(),g=y8(a);return l?null:pe.jsxs(v8,se({ref:t,className:tr(g.root,s),ownerState:m},p,{children:[pe.jsx(ge,{color:"text.secondary",variant:"overline",id:c,className:g.title,children:o}),pe.jsx(x8,{className:g.content,ownerState:m,landscapeDirection:u,children:r})]}))}),k8=n=>({components:{MuiLocalizationProvider:{defaultProps:{localeText:se({},n)}}}}),nj={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"Open previous view",openNextView:"Open next view",calendarViewSwitchingButtonAriaLabel:n=>n==="year"?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",startDate:"Start date",startTime:"Start time",endDate:"End date",endTime:"End time",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",nextStepButtonLabel:"Next",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",timeRangePickerToolbarTitle:"Select time range",clockLabelText:(n,e)=>`Select ${n}. ${e?`Selected time is ${e}`:"No time selected"}`,hoursClockNumberText:n=>`${n} hours`,minutesClockNumberText:n=>`${n} minutes`,secondsClockNumberText:n=>`${n} seconds`,selectViewText:n=>`Select ${n}`,calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:n=>`Week ${n}`,calendarWeekNumberText:n=>`${n}`,openDatePickerDialogue:n=>n?`Choose date, selected date is ${n}`:"Choose date",openTimePickerDialogue:n=>n?`Choose time, selected time is ${n}`:"Choose time",openRangePickerDialogue:n=>n?`Choose range, selected range is ${n}`:"Choose range",fieldClearLabel:"Clear",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:n=>"Y".repeat(n.digitAmount),fieldMonthPlaceholder:n=>n.contentType==="letter"?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:n=>n.contentType==="letter"?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa",year:"Year",month:"Month",day:"Day",weekDay:"Week day",hours:"Hours",minutes:"Minutes",seconds:"Seconds",meridiem:"Meridiem",empty:"Empty"},D8=nj;k8(nj);const ph=()=>{const n=T.useContext(K0);if(n===null)throw new Error(["MUI X: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join(`
`));if(n.utils===null)throw new Error(["MUI X: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join(`
`));const e=T.useMemo(()=>se({},D8,n.localeText),[n.localeText]);return T.useMemo(()=>se({},n,{localeText:e}),[n,e])},jn=()=>ph().utils,S8=()=>ph().defaultDates,Gx=n=>{const e=jn(),t=T.useRef(void 0);return t.current===void 0&&(t.current=e.date(void 0,n)),t.current},au=()=>ph().localeText;function E8(n){return Ci("MuiDatePickerToolbar",n)}Ai("MuiDatePickerToolbar",["root","title"]);const pD=["disablePast","disableFuture","minDate","maxDate","shouldDisableDate","shouldDisableMonth","shouldDisableYear"],fD=["disablePast","disableFuture","minTime","maxTime","shouldDisableTime","minutesStep","ampm","disableIgnoringDatePartForTimeValidation"],ij=["minDateTime","maxDateTime"],N8=[...pD,...fD,...ij],rj=n=>N8.reduce((e,t)=>(n.hasOwnProperty(t)&&(e[t]=n[t]),e),{}),_8=["value","defaultValue","referenceDate","format","formatDensity","onChange","timezone","onError","shouldRespectLeadingZeros","selectedSections","onSelectedSectionsChange","unstableFieldRef","unstableStartFieldRef","unstableEndFieldRef","enableAccessibleFieldDOMStructure","disabled","readOnly","dateSeparator","autoFocus","focused"],sj=(n,e)=>T.useMemo(()=>{const t=se({},n),i={},r=s=>{t.hasOwnProperty(s)&&(i[s]=t[s],delete t[s])};return _8.forEach(r),e==="date"?pD.forEach(r):e==="time"?fD.forEach(r):e==="date-time"&&(pD.forEach(r),fD.forEach(r),ij.forEach(r)),{forwardedProps:t,internalProps:i}},[n,e]),C8=({utils:n,format:e})=>{let t=10,i=e,r=n.expandFormat(e);for(;r!==i;)if(i=r,r=n.expandFormat(i),t-=1,t<0)throw new Error("MUI X: The format expansion seems to be in an infinite loop. Please open an issue with the format passed to the component.");return r},A8=({utils:n,expandedFormat:e})=>{const t=[],{start:i,end:r}=n.escapedCharacters,s=new RegExp(`(\\${i}[^\\${r}]*\\${r})+`,"g");let a=null;for(;a=s.exec(e);)t.push({start:a.index,end:s.lastIndex-1});return t},P8=(n,e,t,i)=>{switch(t.type){case"year":return e.fieldYearPlaceholder({digitAmount:n.formatByString(n.date(void 0,"default"),i).length,format:i});case"month":return e.fieldMonthPlaceholder({contentType:t.contentType,format:i});case"day":return e.fieldDayPlaceholder({format:i});case"weekDay":return e.fieldWeekDayPlaceholder({contentType:t.contentType,format:i});case"hours":return e.fieldHoursPlaceholder({format:i});case"minutes":return e.fieldMinutesPlaceholder({format:i});case"seconds":return e.fieldSecondsPlaceholder({format:i});case"meridiem":return e.fieldMeridiemPlaceholder({format:i});default:return i}},T8=({utils:n,date:e,shouldRespectLeadingZeros:t,localeText:i,localizedDigits:r,now:s,token:a,startSeparator:o})=>{if(a==="")throw new Error("MUI X: Should not call `commitToken` with an empty token");const l=RE(n,a),c=GM(n,l.contentType,l.type,a),u=t?c:l.contentType==="digit",p=n.isValid(e);let m=p?n.formatByString(e,a):"",g=null;if(u)if(c)g=m===""?n.formatByString(s,a).length:m.length;else{if(l.maxLength==null)throw new Error(`MUI X: The token ${a} should have a 'maxLength' property on it's adapter`);g=l.maxLength,p&&(m=ME(jE(th(m,r),g),r))}return se({},l,{format:a,maxLength:g,value:m,placeholder:P8(n,i,l,a),hasLeadingZerosInFormat:c,hasLeadingZerosInInput:u,startSeparator:o,endSeparator:"",modified:!1})},I8=n=>{var g;const{utils:e,expandedFormat:t,escapedParts:i}=n,r=e.date(void 0),s=[];let a="";const o=Object.keys(e.formatTokenMap).sort((y,v)=>v.length-y.length),l=/^([a-zA-Z]+)/,c=new RegExp(`^(${o.join("|")})*$`),u=new RegExp(`^(${o.join("|")})`),p=y=>i.find(v=>v.start<=y&&v.end>=y);let m=0;for(;m<t.length;){const y=p(m),v=y!=null,w=(g=l.exec(t.slice(m)))==null?void 0:g[1];if(!v&&w!=null&&c.test(w)){let k=w;for(;k.length>0;){const S=u.exec(k)[1];k=k.slice(S.length),s.push(T8(se({},n,{now:r,token:S,startSeparator:a}))),a=""}m+=w.length}else{const k=t[m];v&&(y==null?void 0:y.start)===m||(y==null?void 0:y.end)===m||(s.length===0?a+=k:(s[s.length-1].endSeparator+=k,s[s.length-1].isEndFormatSeparator=!0)),m+=1}}return s.length===0&&a.length>0&&s.push({type:"empty",contentType:"letter",maxLength:null,format:"",value:"",placeholder:"",hasLeadingZerosInFormat:!1,hasLeadingZerosInInput:!1,startSeparator:a,endSeparator:"",modified:!1}),s},R8=({isRtl:n,formatDensity:e,sections:t})=>t.map(i=>{const r=s=>{let a=s;return n&&a!==null&&a.includes(" ")&&(a=`⁩${a}⁦`),e==="spacious"&&["/",".","-"].includes(a)&&(a=` ${a} `),a};return i.startSeparator=r(i.startSeparator),i.endSeparator=r(i.endSeparator),i}),MP=n=>{let e=C8(n);n.isRtl&&n.enableAccessibleFieldDOMStructure&&(e=e.split(" ").reverse().join(" "));const t=A8(se({},n,{expandedFormat:e})),i=I8(se({},n,{expandedFormat:e,escapedParts:t}));return R8(se({},n,{sections:i}))},FE=()=>T.useContext(LE),M8=()=>{const n=T.useContext(JM);if(n==null)throw new Error(["MUI X: The `usePickerActionsContext` can only be called in fields that are used as a slot of a Picker component"].join(`
`));return n},j8=["toolbarFormat","toolbarPlaceholder","className","classes"],O8=n=>ei({root:["root"],title:["title"]},E8,n),L8=lt(w8,{name:"MuiDatePickerToolbar",slot:"Root"})({}),F8=lt(ge,{name:"MuiDatePickerToolbar",slot:"Title"})({variants:[{props:{pickerOrientation:"landscape"},style:{margin:"auto 16px auto auto"}}]}),aj=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiDatePickerToolbar"}),{toolbarFormat:r,toolbarPlaceholder:s="––",className:a,classes:o}=i,l=St(i,j8),c=jn(),{value:u,views:p,orientation:m}=nm(),g=au(),y=tj(),v=O8(o),w=T.useMemo(()=>{if(!c.isValid(u))return s;const k=IE(c,{format:r,views:p},!0);return c.formatByString(u,k)},[u,r,s,c,p]);return pe.jsx(L8,se({ref:t,toolbarTitle:g.datePickerToolbarTitle,className:tr(v.root,a)},l,{children:pe.jsx(F8,{variant:"h4",align:m==="landscape"?"left":"center",ownerState:y,className:v.title,children:w})}))});aj.propTypes={classes:D.object,className:D.string,hidden:D.bool,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),titleId:D.string,toolbarFormat:D.string,toolbarPlaceholder:D.node};const yy=({props:n,value:e,timezone:t,adapter:i})=>{if(e===null)return null;const{shouldDisableDate:r,shouldDisableMonth:s,shouldDisableYear:a,disablePast:o,disableFuture:l,minDate:c,maxDate:u}=n,p=i.utils.date(void 0,t);switch(!0){case!i.utils.isValid(e):return"invalidDate";case!!(r&&r(e)):return"shouldDisableDate";case!!(s&&s(e)):return"shouldDisableMonth";case!!(a&&a(e)):return"shouldDisableYear";case!!(l&&i.utils.isAfterDay(e,p)):return"disableFuture";case!!(o&&i.utils.isBeforeDay(e,p)):return"disablePast";case!!(c&&i.utils.isBeforeDay(e,c)):return"minDate";case!!(u&&i.utils.isAfterDay(e,u)):return"maxDate";default:return null}};yy.valueManager=mo;function oj(n){const{props:e,validator:t,value:i,timezone:r,onError:s}=n,a=ph(),o=T.useRef(t.valueManager.defaultErrorState),l=t({adapter:a,value:i,timezone:r,props:e}),c=t.valueManager.hasError(l);T.useEffect(()=>{s&&!t.valueManager.isSameError(l,o.current)&&s(l,i),o.current=l},[t,s,l,i]);const u=Ze(p=>t({adapter:a,value:p,timezone:r,props:e}));return{validationError:l,hasValidationError:c,getValidationErrorForNewValue:u}}function V8(n={}){const{enableAccessibleFieldDOMStructure:e=!0}=n;return T.useMemo(()=>({valueType:"date",validator:yy,internal_valueManager:mo,internal_fieldValueManager:p8,internal_enableAccessibleFieldDOMStructure:e,internal_useApplyDefaultValuesToFieldInternalProps:z8,internal_useOpenPickerButtonAriaLabel:U8}),[e])}function U8(n){const e=jn(),t=au();return T.useMemo(()=>{const i=e.isValid(n)?e.format(n,"fullDate"):null;return t.openDatePickerDialogue(i)},[n,t,e])}function z8(n){const e=jn(),t=vy(n);return T.useMemo(()=>se({},n,t,{format:n.format??e.formats.keyboardDate}),[n,t,e])}function vy(n){const e=jn(),t=S8();return T.useMemo(()=>({disablePast:n.disablePast??!1,disableFuture:n.disableFuture??!1,minDate:SP(e,n.minDate,t.minDate),maxDate:SP(e,n.maxDate,t.maxDate)}),[n.minDate,n.maxDate,n.disableFuture,n.disablePast,e,t])}function lj(n,e){const t=Yn({props:n,name:e}),i=vy(t),r=T.useMemo(()=>{var s;return((s=t.localeText)==null?void 0:s.toolbarTitle)==null?t.localeText:se({},t.localeText,{datePickerToolbarTitle:t.localeText.toolbarTitle})},[t.localeText]);return se({},t,i,{localeText:r},qq({views:t.views,openTo:t.openTo,defaultViews:["year","day"],defaultOpenTo:"day"}),{slots:se({toolbar:aj},t.slots)})}function B8(n){return Ci("MuiPickerPopper",n)}Ai("MuiPickerPopper",["root","paper"]);function $8(n,e){return Array.isArray(e)?e.every(t=>n.indexOf(t)!==-1):n.indexOf(e)!==-1}const W8=n=>{setTimeout(n,0)},pr=(n=document)=>{const e=n.activeElement;return e?e.shadowRoot?pr(e.shadowRoot):e:null},H8="@media (pointer: fine)",q8=["PaperComponent","ownerState","children","paperSlotProps","paperClasses","onPaperClick","onPaperTouchStart"],G8=n=>ei({root:["root"],paper:["paper"]},B8,n),Y8=lt(c4,{name:"MuiPickerPopper",slot:"Root"})(({theme:n})=>({zIndex:n.zIndex.modal})),X8=lt(sn,{name:"MuiPickerPopper",slot:"Paper"})({outline:0,transformOrigin:"top center",variants:[{props:({popperPlacement:n})=>["top","top-start","top-end"].includes(n),style:{transformOrigin:"bottom center"}}]});function K8(n,e){return e.documentElement.clientWidth<n.clientX||e.documentElement.clientHeight<n.clientY}function Q8(n,e){const t=T.useRef(!1),i=T.useRef(!1),r=T.useRef(null),s=T.useRef(!1);T.useEffect(()=>{if(!n)return;function l(){s.current=!0}return document.addEventListener("mousedown",l,!0),document.addEventListener("touchstart",l,!0),()=>{document.removeEventListener("mousedown",l,!0),document.removeEventListener("touchstart",l,!0),s.current=!1}},[n]);const a=Ze(l=>{if(!s.current)return;const c=i.current;i.current=!1;const u=_k(r.current);if(!r.current||"clientX"in l&&K8(l,u))return;if(t.current){t.current=!1;return}let p;l.composedPath?p=l.composedPath().indexOf(r.current)>-1:p=!u.documentElement.contains(l.target)||r.current.contains(l.target),!p&&!c&&e(l)}),o=()=>{i.current=!0};return T.useEffect(()=>{if(n){const l=_k(r.current),c=()=>{t.current=!0};return l.addEventListener("touchstart",a),l.addEventListener("touchmove",c),()=>{l.removeEventListener("touchstart",a),l.removeEventListener("touchmove",c)}}},[n,a]),T.useEffect(()=>{if(n){const l=_k(r.current);return l.addEventListener("click",a),()=>{l.removeEventListener("click",a),i.current=!1}}},[n,a]),[r,o,o]}const J8=T.forwardRef((n,e)=>{const{PaperComponent:t,ownerState:i,children:r,paperSlotProps:s,paperClasses:a,onPaperClick:o,onPaperTouchStart:l}=n,c=St(n,q8),u=pn({elementType:t,externalSlotProps:s,additionalProps:{tabIndex:-1,elevation:8,ref:e},className:a,ownerState:i});return pe.jsx(t,se({},c,u,{onClick:p=>{var m;o(p),(m=u.onClick)==null||m.call(u,p)},onTouchStart:p=>{var m;l(p),(m=u.onTouchStart)==null||m.call(u,p)},ownerState:i,children:r}))});function Z8(n){const e=Yn({props:n,name:"MuiPickerPopper"}),{children:t,placement:i="bottom-start",slots:r,slotProps:s,classes:a}=e,{open:o,popupRef:l,reduceAnimations:c}=nm(),{dismissViews:u,getCurrentViewMode:p,onPopperExited:m,triggerElement:g,viewContainerRole:y}=ir();T.useEffect(()=>{function ee(fe){o&&fe.key==="Escape"&&u()}return document.addEventListener("keydown",ee),()=>{document.removeEventListener("keydown",ee)}},[u,o]);const v=T.useRef(null);T.useEffect(()=>{y==="tooltip"||p()==="field"||(o?v.current=pr(document):v.current&&v.current instanceof HTMLElement&&setTimeout(()=>{v.current instanceof HTMLElement&&v.current.focus()}))},[o,y,p]);const w=G8(a),{ownerState:k,rootRefObject:S}=ir(),E=se({},k,{popperPlacement:i}),P=Ze(()=>{y==="tooltip"?W8(()=>{var ee,fe;(ee=S.current)!=null&&ee.contains(pr(document))||(fe=l.current)!=null&&fe.contains(pr(document))||u()}):u()}),[A,N,R]=Q8(o,P),V=T.useRef(null),B=Cs(V,l),L=Cs(B,A),W=ee=>{ee.key==="Escape"&&(ee.stopPropagation(),u())},q=(r==null?void 0:r.desktopTransition)??c?Ox:o4,X=(r==null?void 0:r.desktopTrapFocus)??l4,G=(r==null?void 0:r.desktopPaper)??X8,K=(r==null?void 0:r.popper)??Y8,J=pn({elementType:K,externalSlotProps:s==null?void 0:s.popper,additionalProps:{transition:!0,role:y??void 0,open:o,placement:i,anchorEl:g,onKeyDown:W},className:w.root,ownerState:E});return pe.jsx(K,se({},J,{children:({TransitionProps:ee})=>pe.jsx(X,se({open:o,disableAutoFocus:!0,disableRestoreFocus:!0,disableEnforceFocus:y==="tooltip",isEnabled:()=>!0},s==null?void 0:s.desktopTrapFocus,{children:pe.jsx(q,se({},ee,s==null?void 0:s.desktopTransition,{onExited:fe=>{var ae,U,he;m==null||m(),(U=(ae=s==null?void 0:s.desktopTransition)==null?void 0:ae.onExited)==null||U.call(ae,fe),(he=ee==null?void 0:ee.onExited)==null||he.call(ee)},children:pe.jsx(J8,{PaperComponent:G,ownerState:E,ref:L,onPaperClick:N,onPaperTouchStart:R,paperClasses:w.paper,paperSlotProps:s==null?void 0:s.desktopPaper,children:t})}))}))}))}const e9="@media (prefers-reduced-motion: reduce)",bp=typeof navigator<"u"&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),jP=bp&&bp[1]?parseInt(bp[1],10):null,OP=bp&&bp[2]?parseInt(bp[2],10):null,t9=jP&&jP<10||OP&&OP<13||!1;function cj(n){const e=Lx(e9,{defaultMatches:!1});return n??(e||t9)}const uj={hasNextStep:!1,hasSeveralSteps:!1,goToNextStep:()=>{},areViewsInSameStep:()=>!0};function n9(n){const{steps:e,isViewMatchingStep:t,onStepChange:i}=n;return r=>{if(e==null)return uj;const s=e.findIndex(o=>t(r.view,o)),a=s===-1||s===e.length-1?null:e[s+1];return{hasNextStep:a!=null,hasSeveralSteps:e.length>1,goToNextStep:()=>{a!=null&&i(se({},r,{step:a}))},areViewsInSameStep:(o,l)=>{const c=e.find(p=>t(o,p)),u=e.find(p=>t(l,p));return c===u}}}}let $k=!1;function dj({onChange:n,onViewChange:e,openTo:t,view:i,views:r,autoFocus:s,focusedView:a,onFocusedViewChange:o,getStepNavigation:l}){$k||(i!=null&&!r.includes(i)&&(console.warn(`MUI X: \`view="${i}"\` is not a valid prop.`,`It must be an element of \`views=["${r.join('", "')}"]\`.`),$k=!0),i==null&&t!=null&&!r.includes(t)&&(console.warn(`MUI X: \`openTo="${t}"\` is not a valid prop.`,`It must be an element of \`views=["${r.join('", "')}"]\`.`),$k=!0));const c=T.useRef(t),u=T.useRef(r),p=T.useRef(r.includes(t)?t:r[0]),[m,g]=Hf({name:"useViews",state:"view",controlled:i,default:p.current}),y=T.useRef(s?m:null),[v,w]=Hf({name:"useViews",state:"focusedView",controlled:a,default:y.current}),k=l?l({setView:g,view:m,defaultView:p.current,views:r}):uj;T.useEffect(()=>{(c.current&&c.current!==t||u.current&&u.current.some(B=>!r.includes(B)))&&(g(r.includes(t)?t:r[0]),u.current=r,c.current=t)},[t,g,m,r]);const S=r.indexOf(m),E=r[S-1]??null,P=r[S+1]??null,A=Ze((B,L)=>{w(L?B:W=>B===W?null:W),o==null||o(B,L)}),N=Ze(B=>{A(B,!0),B!==m&&(g(B),e&&e(B))}),R=Ze(()=>{P&&N(P)}),V=Ze((B,L,W)=>{const q=L==="finish",X=W?r.indexOf(W)<r.length-1:!!P;n(B,q&&X?"partial":L,W);let K=null;if(W!=null&&W!==m?K=W:q&&(K=m),K==null)return;const J=r[r.indexOf(K)+1];J==null||!k.areViewsInSameStep(K,J)||N(J)});return se({},k,{view:m,setView:N,focusedView:v,setFocusedView:A,nextView:P,previousView:E,defaultView:r.includes(t)?t:r[0],goToNextView:R,setValueAndGoToNextView:V})}function LP(){return typeof window>"u"?"portrait":window.screen&&window.screen.orientation&&window.screen.orientation.angle?Math.abs(window.screen.orientation.angle)===90?"landscape":"portrait":window.orientation&&Math.abs(Number(window.orientation))===90?"landscape":"portrait"}function i9(n,e){const[t,i]=T.useState(LP);return Dl(()=>{const r=()=>{i(LP())};return window.addEventListener("orientationchange",r),()=>{window.removeEventListener("orientationchange",r)}},[]),$8(n,["hours","minutes","seconds"])?"portrait":e??t}const FP=new Set;function r9(n,e="warning"){const t=Array.isArray(n)?n.join(`
`):n;FP.has(t)||(FP.add(t),e==="error"?console.error(t):console.warn(t))}const xy=({name:n,timezone:e,value:t,defaultValue:i,referenceDate:r,onChange:s,valueManager:a})=>{const o=jn(),[l,c]=Hf({name:n,state:"value",controlled:t,default:i??a.emptyValue}),u=T.useMemo(()=>a.getTimezone(o,l),[o,a,l]),p=Ze(v=>u==null?v:a.setTimezone(o,u,v)),m=T.useMemo(()=>e||u||(r?o.getTimezone(r):"default"),[e,u,r,o]),g=T.useMemo(()=>a.setTimezone(o,m,l),[a,o,m,l]),y=Ze((v,...w)=>{const k=p(v);c(k),s==null||s(k,...w)});return{value:g,handleValueChange:y,timezone:m}};function s9(n){const{props:e,valueManager:t,validator:i}=n,{value:r,defaultValue:s,onChange:a,referenceDate:o,timezone:l,onAccept:c,closeOnSelect:u,open:p,onOpen:m,onClose:g}=e,{current:y}=T.useRef(s),{current:v}=T.useRef(r!==void 0),{current:w}=T.useRef(p!==void 0),k=jn();e.renderInput!=null&&r9(["MUI X: The `renderInput` prop has been removed in version 6.0 of the Date and Time Pickers.","You can replace it with the `textField` component slot in most cases.","For more information, please have a look at the migration guide (https://mui.com/x/migration/migration-pickers-v5/#input-renderer-required-in-v5)."]),T.useEffect(()=>{v!==(r!==void 0)&&console.error([`MUI X: A component is changing the ${v?"":"un"}controlled value of a Picker to be ${v?"un":""}controlled.`,"Elements should not switch from uncontrolled to controlled (or vice versa).","Decide between using a controlled or uncontrolled valuefor the lifetime of the component.","The nature of the state is determined during the first render. It's considered controlled if the value is not `undefined`.","More info: https://fb.me/react-controlled-components"].join(`
`))},[r]),T.useEffect(()=>{!v&&y!==s&&console.error(["MUI X: A component is changing the defaultValue of an uncontrolled Picker after being initialized. To suppress this warning opt to use a controlled value."].join(`
`))},[JSON.stringify(y)]);const{timezone:S,value:E,handleValueChange:P}=xy({name:"a picker component",timezone:l,value:r,defaultValue:y,referenceDate:o,onChange:a,valueManager:t}),[A,N]=T.useState(()=>({open:!1,lastExternalValue:E,clockShallowValue:void 0,lastCommittedValue:E,hasBeenModifiedSinceMount:!1})),{getValidationErrorForNewValue:R}=oj({props:e,validator:i,timezone:S,value:E,onError:e.onError}),V=Ze(q=>{const X=typeof q=="function"?q(A.open):q;w||N(G=>se({},G,{open:X})),X&&m&&m(),X||g==null||g()}),B=Ze((q,X)=>{const{changeImportance:G="accept",skipPublicationIfPristine:K=!1,validationError:J,shortcut:ee,shouldClose:fe=G==="accept"}=X??{};let ae,U;!K&&!v&&!A.hasBeenModifiedSinceMount?(ae=!0,U=G==="accept"):(ae=!t.areValuesEqual(k,q,E),U=G==="accept"&&!t.areValuesEqual(k,q,A.lastCommittedValue)),N($=>se({},$,{clockShallowValue:ae?void 0:$.clockShallowValue,lastCommittedValue:U?E:$.lastCommittedValue,hasBeenModifiedSinceMount:!0}));let he=null;const ie=()=>(he||(he={validationError:J??R(q)},ee&&(he.shortcut=ee)),he);ae&&P(q,ie()),U&&c&&c(q,ie()),fe&&V(!1)});E!==A.lastExternalValue&&N(q=>se({},q,{lastExternalValue:E,clockShallowValue:void 0,hasBeenModifiedSinceMount:!0}));const L=Ze((q,X="partial")=>{if(X==="shallow"){N(G=>se({},G,{clockShallowValue:q,hasBeenModifiedSinceMount:!0}));return}B(q,{changeImportance:X==="finish"&&u?"accept":"set"})});T.useEffect(()=>{if(w){if(p===void 0)throw new Error("You must not mix controlling and uncontrolled mode for `open` prop");N(q=>se({},q,{open:p}))}},[w,p]);const W=T.useMemo(()=>t.cleanValue(k,A.clockShallowValue===void 0?E:A.clockShallowValue),[k,t,A.clockShallowValue,E]);return{timezone:S,state:A,setValue:B,setValueFromView:L,setOpen:V,value:E,viewValue:W}}const a9=["className","sx"],hj=({ref:n,props:e,valueManager:t,valueType:i,variant:r,validator:s,onPopperExited:a,autoFocusView:o,rendererInterceptor:l,localeText:c,viewContainerRole:u,getStepNavigation:p})=>{const{views:m,view:g,openTo:y,onViewChange:v,viewRenderers:w,reduceAnimations:k,orientation:S,disableOpenPicker:E,closeOnSelect:P,disabled:A,readOnly:N,formatDensity:R,enableAccessibleFieldDOMStructure:V,selectedSections:B,onSelectedSectionsChange:L,format:W,label:q,autoFocus:X,name:G}=e,{className:K,sx:J}=e,ee=St(e,a9),fe=Fx(),ae=jn(),U=ph(),he=cj(k),ie=i9(m,S),{current:$}=T.useRef(y??null),[Y,oe]=T.useState(null),be=T.useRef(null),xe=T.useRef(null),je=T.useRef(null),ze=Cs(n,je),{timezone:Ve,state:we,setOpen:Ae,setValue:_e,setValueFromView:ye,value:He,viewValue:Re}=s9({props:e,valueManager:t,validator:s}),{view:et,setView:Be,defaultView:mt,focusedView:Xe,setFocusedView:ct,setValueAndGoToNextView:tn,goToNextStep:on,hasNextStep:Oe,hasSeveralSteps:Ge}=dj({view:g,views:m,openTo:y,onChange:ye,onViewChange:v,autoFocus:o,getStepNavigation:p}),ue=Ze(()=>_e(t.emptyValue)),de=Ze(()=>_e(t.getTodayValue(ae,Ve,i))),Pe=Ze(()=>_e(He)),Le=Ze(()=>_e(we.lastCommittedValue,{skipPublicationIfPristine:!0})),$e=Ze(()=>{_e(He,{skipPublicationIfPristine:!0})}),{hasUIView:ht,viewModeLookup:Et,timeViewsCount:Ut}=T.useMemo(()=>m.reduce((Rn,rr)=>{const vh=w[rr]==null?"field":"UI";return Rn.viewModeLookup[rr]=vh,vh==="UI"&&(Rn.hasUIView=!0,Jq(rr)&&(Rn.timeViewsCount+=1)),Rn},{hasUIView:!1,viewModeLookup:{},timeViewsCount:0}),[w,m]),zt=Et[et],Te=Ze(()=>zt),[Ue,ke]=T.useState(zt==="UI"?et:null);Ue!==et&&Et[et]==="UI"&&ke(et),Dl(()=>{zt==="field"&&we.open&&(Ae(!1),setTimeout(()=>{var Rn,rr;(Rn=xe==null?void 0:xe.current)==null||Rn.setSelectedSections(et),(rr=xe==null?void 0:xe.current)==null||rr.focusField(et)}))},[et]),Dl(()=>{if(!we.open)return;let Rn=et;zt==="field"&&Ue!=null&&(Rn=Ue),Rn!==mt&&Et[Rn]==="UI"&&Et[mt]==="UI"&&(Rn=mt),Rn!==et&&Be(Rn),ct(Rn,!0)},[we.open]);const ot=T.useMemo(()=>({isPickerValueEmpty:t.areValuesEqual(ae,He,t.emptyValue),isPickerOpen:we.open,isPickerDisabled:e.disabled??!1,isPickerReadOnly:e.readOnly??!1,pickerOrientation:ie,pickerVariant:r}),[ae,t,He,we.open,ie,r,e.disabled,e.readOnly]),Bt=T.useMemo(()=>E||!ht?"hidden":A||N?"disabled":"enabled",[E,ht,A,N]),dn=Ze(on),oi=T.useMemo(()=>P&&!Ge?[]:["cancel","nextOrAccept"],[P,Ge]),vn=T.useMemo(()=>({setValue:_e,setOpen:Ae,clearValue:ue,setValueToToday:de,acceptValueChanges:Pe,cancelValueChanges:Le,setView:Be,goToNextStep:dn}),[_e,Ae,ue,de,Pe,Le,Be,dn]),cu=T.useMemo(()=>se({},vn,{value:He,timezone:Ve,open:we.open,views:m,view:Ue,initialView:$,disabled:A??!1,readOnly:N??!1,autoFocus:X??!1,variant:r,orientation:ie,popupRef:be,reduceAnimations:he,triggerRef:oe,triggerStatus:Bt,hasNextStep:Oe,fieldFormat:W??"",name:G,label:q,rootSx:J,rootRef:ze,rootClassName:K}),[vn,He,ze,r,ie,he,A,N,W,K,G,q,J,Bt,Oe,Ve,we.open,Ue,m,$,X]),yh=T.useMemo(()=>({dismissViews:$e,ownerState:ot,hasUIView:ht,getCurrentViewMode:Te,rootRefObject:je,labelId:fe,triggerElement:Y,viewContainerRole:u,defaultActionBarActions:oi,onPopperExited:a}),[$e,ot,ht,Te,fe,Y,u,oi,a]),sm=T.useMemo(()=>({formatDensity:R,enableAccessibleFieldDOMStructure:V,selectedSections:B,onSelectedSectionsChange:L,fieldRef:xe}),[R,V,B,L,xe]);return{providerProps:{localeText:c,contextValue:cu,privateContextValue:yh,actionsContextValue:vn,fieldPrivateContextValue:sm,isValidContextValue:Rn=>{const rr=s({adapter:U,value:Rn,timezone:Ve,props:e});return!t.hasError(rr)}},renderCurrentView:()=>{if(Ue==null)return null;const Rn=w[Ue];if(Rn==null)return null;const rr=se({},ee,{views:m,timezone:Ve,value:Re,onChange:tn,view:Ue,onViewChange:Be,showViewSwitcher:Ut>1,timeViewsCount:Ut},u==="tooltip"?{focusedView:null,onFocusedViewChange:()=>{}}:{focusedView:Xe,onFocusedViewChange:ct});return l?pe.jsx(l,{viewRenderers:w,popperView:Ue,rendererProps:rr}):Rn(rr)},ownerState:ot}};function pj(n){return Ci("MuiPickersLayout",n)}const ku=Ai("MuiPickersLayout",["root","landscape","contentWrapper","toolbar","actionBar","tabs","shortcuts"]),o9=["actions"],l9=lt(ch,{name:"MuiPickersLayout",slot:"ActionBar"})({});function fj(n){const{actions:e}=n,t=St(n,o9),i=au(),{clearValue:r,setValueToToday:s,acceptValueChanges:a,cancelValueChanges:o,goToNextStep:l,hasNextStep:c}=nm();if(e==null||e.length===0)return null;const u=e==null?void 0:e.map(p=>{switch(p){case"clear":return pe.jsx(vt,{onClick:r,children:i.clearButtonLabel},p);case"cancel":return pe.jsx(vt,{onClick:o,children:i.cancelButtonLabel},p);case"accept":return pe.jsx(vt,{onClick:a,children:i.okButtonLabel},p);case"today":return pe.jsx(vt,{onClick:s,children:i.todayButtonLabel},p);case"next":return pe.jsx(vt,{onClick:l,children:i.nextStepButtonLabel},p);case"nextOrAccept":return c?pe.jsx(vt,{onClick:l,children:i.nextStepButtonLabel},p):pe.jsx(vt,{onClick:a,children:i.okButtonLabel},p);default:return null}});return pe.jsx(l9,se({},t,{children:u}))}fj.propTypes={actions:D.arrayOf(D.oneOf(["accept","cancel","clear","next","nextOrAccept","today"]).isRequired),disableSpacing:D.bool,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object])};const c9=T.memo(fj),Ng=36,Yx=2,Xx=320,u9=280,VE=336,d9=["items","changeImportance"],h9=["getValue"],p9=lt(nu,{name:"MuiPickersLayout",slot:"Shortcuts"})({});function mj(n){const{items:e,changeImportance:t="accept"}=n,i=St(n,d9),{setValue:r}=M8(),s=g8();if(e==null||e.length===0)return null;const a=e.map(o=>{let{getValue:l}=o,c=St(o,h9);const u=l({isValid:s});return se({},c,{label:c.label,onClick:()=>{r(u,{changeImportance:t,shortcut:c})},disabled:!s(u)})});return pe.jsx(p9,se({dense:!0,sx:[{maxHeight:VE,maxWidth:200,overflow:"auto"},...Array.isArray(i.sx)?i.sx:[i.sx]]},i,{children:a.map(o=>pe.jsx(Js,{children:pe.jsx(It,se({},o))},o.id??o.label))}))}mj.propTypes={changeImportance:D.oneOf(["accept","set"]),className:D.string,component:D.elementType,dense:D.bool,disablePadding:D.bool,items:D.arrayOf(D.shape({getValue:D.func.isRequired,id:D.string,label:D.string.isRequired})),style:D.object,subheader:D.node,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object])};const f9=["ownerState"];function m9(n){return n.view!==null}const g9=(n,e)=>{const{pickerOrientation:t}=e;return ei({root:["root",t==="landscape"&&"landscape"],contentWrapper:["contentWrapper"],toolbar:["toolbar"],actionBar:["actionBar"],tabs:["tabs"],landscape:["landscape"],shortcuts:["shortcuts"]},pj,n)},b9=n=>{const{ownerState:e,defaultActionBarActions:t}=ir(),{view:i}=nm(),r=El(),{children:s,slots:a,slotProps:o,classes:l}=n,c=T.useMemo(()=>se({},e,{layoutDirection:r?"rtl":"ltr"}),[e,r]),u=g9(l,c),p=(a==null?void 0:a.actionBar)??c9,m=pn({elementType:p,externalSlotProps:o==null?void 0:o.actionBar,additionalProps:{actions:t},className:u.actionBar,ownerState:c}),g=St(m,f9),y=pe.jsx(p,se({},g)),v=a==null?void 0:a.toolbar,w=pn({elementType:v,externalSlotProps:o==null?void 0:o.toolbar,className:u.toolbar,ownerState:c}),k=m9(w)&&v?pe.jsx(v,se({},w)):null,S=s,E=a==null?void 0:a.tabs,P=i&&E?pe.jsx(E,se({className:u.tabs},o==null?void 0:o.tabs)):null,A=(a==null?void 0:a.shortcuts)??mj,N=pn({elementType:A,externalSlotProps:o==null?void 0:o.shortcuts,className:u.shortcuts,ownerState:c}),R=i&&A?pe.jsx(A,se({},N)):null;return{toolbar:k,content:S,tabs:P,actionBar:y,shortcuts:R,ownerState:c}},y9=(n,e)=>{const{pickerOrientation:t}=e;return ei({root:["root",t==="landscape"&&"landscape"],contentWrapper:["contentWrapper"]},pj,n)},v9=lt("div",{name:"MuiPickersLayout",slot:"Root"})({display:"grid",gridAutoColumns:"max-content auto max-content",gridAutoRows:"max-content auto max-content",[`& .${ku.actionBar}`]:{gridColumn:"1 / 4",gridRow:3},variants:[{props:{pickerOrientation:"landscape"},style:{[`& .${ku.toolbar}`]:{gridColumn:1,gridRow:"2 / 3"},[`.${ku.shortcuts}`]:{gridColumn:"2 / 4",gridRow:1}}},{props:{pickerOrientation:"landscape",layoutDirection:"rtl"},style:{[`& .${ku.toolbar}`]:{gridColumn:3}}},{props:{pickerOrientation:"portrait"},style:{[`& .${ku.toolbar}`]:{gridColumn:"2 / 4",gridRow:1},[`& .${ku.shortcuts}`]:{gridColumn:1,gridRow:"2 / 3"}}},{props:{pickerOrientation:"portrait",layoutDirection:"rtl"},style:{[`& .${ku.shortcuts}`]:{gridColumn:3}}}]}),x9=lt("div",{name:"MuiPickersLayout",slot:"ContentWrapper"})({gridColumn:"2 / 4",gridRow:2,display:"flex",flexDirection:"column"}),UE=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiPickersLayout"}),{toolbar:r,content:s,tabs:a,actionBar:o,shortcuts:l,ownerState:c}=b9(i),{orientation:u,variant:p}=nm(),{sx:m,className:g,classes:y}=i,v=y9(y,c);return pe.jsxs(v9,{ref:t,sx:m,className:tr(v.root,g),ownerState:c,children:[u==="landscape"?l:r,u==="landscape"?r:l,pe.jsx(x9,{className:v.contentWrapper,ownerState:c,children:p==="desktop"?pe.jsxs(T.Fragment,{children:[s,a]}):pe.jsxs(T.Fragment,{children:[a,s]})}),o]})});UE.propTypes={children:D.node,classes:D.object,className:D.string,slotProps:D.object,slots:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object])};function zE(n){const{ownerState:e}=ir(),t=El();return T.useMemo(()=>se({},e,{isFieldDisabled:n.disabled??!1,isFieldReadOnly:n.readOnly??!1,isFieldRequired:n.required??!1,fieldDirection:t?"rtl":"ltr"}),[e,n.disabled,n.readOnly,n.required,t])}const w9=iu(pe.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),k9=iu(pe.jsx("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"ArrowLeft"),D9=iu(pe.jsx("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"ArrowRight"),S9=iu(pe.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}),"Calendar");iu(pe.jsxs(T.Fragment,{children:[pe.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),pe.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Clock");iu(pe.jsx("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}),"DateRange");iu(pe.jsxs(T.Fragment,{children:[pe.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),pe.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Time");const E9=iu(pe.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");function N9(n){return Ci("MuiPickersTextField",n)}Ai("MuiPickersTextField",["root","focused","disabled","error","required"]);function _9(n){return Ci("MuiPickersInputBase",n)}const yp=Ai("MuiPickersInputBase",["root","focused","disabled","error","notchedOutline","sectionContent","sectionBefore","sectionAfter","adornedStart","adornedEnd","input","activeBar"]);function C9(n){return Ci("MuiPickersSectionList",n)}const Am=Ai("MuiPickersSectionList",["root","section","sectionContent"]),A9=["slots","slotProps","elements","sectionListRef","classes"],gj=lt("div",{name:"MuiPickersSectionList",slot:"Root"})({direction:"ltr /*! @noflip */",outline:"none"}),bj=lt("span",{name:"MuiPickersSectionList",slot:"Section"})({}),yj=lt("span",{name:"MuiPickersSectionList",slot:"SectionSeparator"})({whiteSpace:"pre"}),vj=lt("span",{name:"MuiPickersSectionList",slot:"SectionContent"})({outline:"none"}),P9=n=>ei({root:["root"],section:["section"],sectionContent:["sectionContent"]},C9,n);function xj(n){const{slots:e,slotProps:t,element:i,classes:r}=n,{ownerState:s}=ir(),a=(e==null?void 0:e.section)??bj,o=pn({elementType:a,externalSlotProps:t==null?void 0:t.section,externalForwardedProps:i.container,className:r.section,ownerState:s}),l=(e==null?void 0:e.sectionContent)??vj,c=pn({elementType:l,externalSlotProps:t==null?void 0:t.sectionContent,externalForwardedProps:i.content,additionalProps:{suppressContentEditableWarning:!0},className:r.sectionContent,ownerState:s}),u=(e==null?void 0:e.sectionSeparator)??yj,p=pn({elementType:u,externalSlotProps:t==null?void 0:t.sectionSeparator,externalForwardedProps:i.before,ownerState:se({},s,{separatorPosition:"before"})}),m=pn({elementType:u,externalSlotProps:t==null?void 0:t.sectionSeparator,externalForwardedProps:i.after,ownerState:se({},s,{separatorPosition:"after"})});return pe.jsxs(a,se({},o,{children:[pe.jsx(u,se({},p)),pe.jsx(l,se({},c)),pe.jsx(u,se({},m))]}))}xj.propTypes={classes:D.object.isRequired,element:D.shape({after:D.object.isRequired,before:D.object.isRequired,container:D.object.isRequired,content:D.object.isRequired}).isRequired,slotProps:D.object,slots:D.object};const wj=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiPickersSectionList"}),{slots:r,slotProps:s,elements:a,sectionListRef:o,classes:l}=i,c=St(i,A9),u=P9(l),{ownerState:p}=ir(),m=T.useRef(null),g=Cs(t,m),y=k=>{if(!m.current)throw new Error(`MUI X: Cannot call sectionListRef.${k} before the mount of the component.`);return m.current};T.useImperativeHandle(o,()=>({getRoot(){return y("getRoot")},getSectionContainer(k){return y("getSectionContainer").querySelector(`.${Am.section}[data-sectionindex="${k}"]`)},getSectionContent(k){return y("getSectionContent").querySelector(`.${Am.section}[data-sectionindex="${k}"] .${Am.sectionContent}`)},getSectionIndexFromDOMElement(k){const S=y("getSectionIndexFromDOMElement");if(k==null||!S.contains(k))return null;let E=null;return k.classList.contains(Am.section)?E=k:k.classList.contains(Am.sectionContent)&&(E=k.parentElement),E==null?null:Number(E.dataset.sectionindex)}}));const v=(r==null?void 0:r.root)??gj,w=pn({elementType:v,externalSlotProps:s==null?void 0:s.root,externalForwardedProps:c,additionalProps:{ref:g,suppressContentEditableWarning:!0},className:u.root,ownerState:p});return pe.jsx(v,se({},w,{children:w.contentEditable?a.map(({content:k,before:S,after:E})=>`${S.children}${k.children}${E.children}`).join(""):pe.jsx(T.Fragment,{children:a.map((k,S)=>pe.jsx(xj,{slots:r,slotProps:s,element:k,classes:u},S))})}))});wj.propTypes={classes:D.object,contentEditable:D.bool.isRequired,elements:D.arrayOf(D.shape({after:D.object.isRequired,before:D.object.isRequired,container:D.object.isRequired,content:D.object.isRequired})).isRequired,sectionListRef:D.oneOfType([D.func,D.shape({current:D.shape({getRoot:D.func.isRequired,getSectionContainer:D.func.isRequired,getSectionContent:D.func.isRequired,getSectionIndexFromDOMElement:D.func.isRequired})})]),slotProps:D.object,slots:D.object};const kj=T.createContext(null),Kx=()=>{const n=T.useContext(kj);if(n==null)throw new Error(["MUI X: The `usePickerTextFieldOwnerState` can only be called in components that are used inside a PickerTextField component"].join(`
`));return n},T9=["elements","areAllSectionsEmpty","defaultValue","label","value","onChange","id","autoFocus","endAdornment","startAdornment","renderSuffix","slots","slotProps","contentEditable","tabIndex","onInput","onPaste","onKeyDown","fullWidth","name","readOnly","inputProps","inputRef","sectionListRef","onFocus","onBlur","classes","ownerState"],I9=n=>Math.round(n*1e5)/1e5,Qx=lt("div",{name:"MuiPickersInputBase",slot:"Root"})(({theme:n})=>se({},n.typography.body1,{color:(n.vars||n).palette.text.primary,cursor:"text",padding:0,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",boxSizing:"border-box",letterSpacing:`${I9(.15/16)}em`,variants:[{props:{isInputInFullWidth:!0},style:{width:"100%"}}]})),BE=lt(gj,{name:"MuiPickersInputBase",slot:"SectionsContainer"})(({theme:n})=>({padding:"4px 0 5px",fontFamily:n.typography.fontFamily,fontSize:"inherit",lineHeight:"1.4375em",flexGrow:1,outline:"none",display:"flex",flexWrap:"nowrap",overflow:"hidden",letterSpacing:"inherit",width:"182px",variants:[{props:{fieldDirection:"rtl"},style:{textAlign:"right /*! @noflip */"}},{props:{inputSize:"small"},style:{paddingTop:1}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0},style:{color:"currentColor",opacity:0}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0,inputHasLabel:!1},style:n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:n.palette.mode==="light"?.42:.5}}]})),R9=lt(bj,{name:"MuiPickersInputBase",slot:"Section"})(({theme:n})=>({fontFamily:n.typography.fontFamily,fontSize:"inherit",letterSpacing:"inherit",lineHeight:"1.4375em",display:"inline-block",whiteSpace:"nowrap"})),M9=lt(vj,{name:"MuiPickersInputBase",slot:"SectionContent",overridesResolver:(n,e)=>e.content})(({theme:n})=>({fontFamily:n.typography.fontFamily,lineHeight:"1.4375em",letterSpacing:"inherit",width:"fit-content",outline:"none"})),j9=lt(yj,{name:"MuiPickersInputBase",slot:"Separator"})(()=>({whiteSpace:"pre",letterSpacing:"inherit"})),O9=lt("input",{name:"MuiPickersInputBase",slot:"Input",overridesResolver:(n,e)=>e.hiddenInput})(se({},d4)),L9=lt("div",{name:"MuiPickersInputBase",slot:"ActiveBar"})(({theme:n,ownerState:e})=>({display:"none",position:"absolute",height:2,bottom:2,borderTopLeftRadius:2,borderTopRightRadius:2,transition:n.transitions.create(["width","left"],{duration:n.transitions.duration.shortest}),backgroundColor:(n.vars||n).palette.primary.main,'[data-active-range-position="start"] &, [data-active-range-position="end"] &':{display:"block"},'[data-active-range-position="start"] &':{left:e.sectionOffsets[0]},'[data-active-range-position="end"] &':{left:e.sectionOffsets[1]}})),F9=(n,e)=>{const{isFieldFocused:t,isFieldDisabled:i,isFieldReadOnly:r,hasFieldError:s,inputSize:a,isInputInFullWidth:o,inputColor:l,hasStartAdornment:c,hasEndAdornment:u}=e,p={root:["root",t&&!i&&"focused",i&&"disabled",r&&"readOnly",s&&"error",o&&"fullWidth",`color${u4(l)}`,a==="small"&&"inputSizeSmall",c&&"adornedStart",u&&"adornedEnd"],notchedOutline:["notchedOutline"],input:["input"],sectionsContainer:["sectionsContainer"],sectionContent:["sectionContent"],sectionBefore:["sectionBefore"],sectionAfter:["sectionAfter"],activeBar:["activeBar"]};return ei(p,_9,n)};function VP(n,e,t,i){var r;if(n.content.id){const s=(r=e.current)==null?void 0:r.querySelectorAll(`[data-sectionindex="${t}"] [data-range-position="${i}"]`);if(s)return Array.from(s).reduce((a,o)=>a+o.offsetWidth,0)}return 0}function V9(n,e){var r,s,a,o,l;let t=0;if(((r=e.current)==null?void 0:r.getAttribute("data-active-range-position"))==="end")for(let c=n.length-1;c>=n.length/2;c-=1)t+=VP(n[c],e,c,"end");else for(let c=0;c<n.length/2;c+=1)t+=VP(n[c],e,c,"start");return{activeBarWidth:t,sectionOffsets:[((a=(s=e.current)==null?void 0:s.querySelector('[data-sectionindex="0"]'))==null?void 0:a.offsetLeft)||0,((l=(o=e.current)==null?void 0:o.querySelector(`[data-sectionindex="${n.length/2}"]`))==null?void 0:l.offsetLeft)||0]}}const Jx=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiPickersInputBase"}),{elements:r,areAllSectionsEmpty:s,value:a,onChange:o,id:l,endAdornment:c,startAdornment:u,renderSuffix:p,slots:m,slotProps:g,contentEditable:y,tabIndex:v,onInput:w,onPaste:k,onKeyDown:S,name:E,readOnly:P,inputProps:A,inputRef:N,sectionListRef:R,onFocus:V,onBlur:B,classes:L,ownerState:W}=i,q=St(i,T9),X=Kx(),G=T.useRef(null),K=T.useRef(null),J=T.useRef([]),ee=Cs(t,G),fe=Cs(A==null?void 0:A.ref,N),ae=CR();if(!ae)throw new Error("MUI X: PickersInputBase should always be used inside a PickersTextField component");const U=W??X,he=Ve=>{var we;(we=ae.onFocus)==null||we.call(ae,Ve),V==null||V(Ve)},ie=Ve=>{he(Ve)},$=Ve=>{var we,Ae;if(S==null||S(Ve),Ve.key==="Enter"&&!Ve.defaultMuiPrevented){if((we=G.current)!=null&&we.dataset.multiInput)return;const _e=(Ae=G.current)==null?void 0:Ae.closest("form"),ye=_e==null?void 0:_e.querySelector('[type="submit"]');if(!_e||!ye)return;Ve.preventDefault(),_e.requestSubmit(ye)}},Y=Ve=>{var we;(we=ae.onBlur)==null||we.call(ae,Ve),B==null||B(Ve)};T.useEffect(()=>{ae&&ae.setAdornedStart(!!u)},[ae,u]),T.useEffect(()=>{ae&&(s?ae.onEmpty():ae.onFilled())},[ae,s]);const oe=F9(L,U),be=(m==null?void 0:m.root)||Qx,xe=pn({elementType:be,externalSlotProps:g==null?void 0:g.root,externalForwardedProps:q,additionalProps:{"aria-invalid":ae.error,ref:ee},className:oe.root,ownerState:U}),je=(m==null?void 0:m.input)||BE,ze=r.some(Ve=>Ve.content["data-range-position"]!==void 0);return T.useEffect(()=>{if(!ze||!U.isPickerOpen)return;const{activeBarWidth:Ve,sectionOffsets:we}=V9(r,G);J.current=[we[0],we[1]],K.current&&(K.current.style.width=`${Ve}px`)},[r,ze,U.isPickerOpen]),pe.jsxs(be,se({},xe,{children:[u,pe.jsx(wj,{sectionListRef:R,elements:r,contentEditable:y,tabIndex:v,className:oe.sectionsContainer,onFocus:he,onBlur:Y,onInput:w,onPaste:k,onKeyDown:$,slots:{root:je,section:R9,sectionContent:M9,sectionSeparator:j9},slotProps:{root:se({},g==null?void 0:g.input,{ownerState:U}),sectionContent:{className:yp.sectionContent},sectionSeparator:({separatorPosition:Ve})=>({className:Ve==="before"?yp.sectionBefore:yp.sectionAfter})}}),c,p?p(se({},ae)):null,pe.jsx(O9,se({name:E,className:oe.input,value:a,onChange:o,id:l,"aria-hidden":"true",tabIndex:-1,readOnly:P,required:ae.required,disabled:ae.disabled,onFocus:ie},A,{ref:fe})),ze&&pe.jsx(L9,{className:oe.activeBar,ref:K,ownerState:{sectionOffsets:J.current}})]}))});Jx.propTypes={areAllSectionsEmpty:D.bool.isRequired,className:D.string,component:D.elementType,contentEditable:D.bool.isRequired,"data-multi-input":D.string,elements:D.arrayOf(D.shape({after:D.object.isRequired,before:D.object.isRequired,container:D.object.isRequired,content:D.object.isRequired})).isRequired,endAdornment:D.node,fullWidth:D.bool,id:D.string,inputProps:D.object,inputRef:Nl,label:D.node,margin:D.oneOf(["dense","none","normal"]),name:D.string,onChange:D.func.isRequired,onClick:D.func.isRequired,onInput:D.func.isRequired,onKeyDown:D.func.isRequired,onPaste:D.func.isRequired,ownerState:D.any,readOnly:D.bool,renderSuffix:D.func,sectionListRef:D.oneOfType([D.func,D.shape({current:D.shape({getRoot:D.func.isRequired,getSectionContainer:D.func.isRequired,getSectionContent:D.func.isRequired,getSectionIndexFromDOMElement:D.func.isRequired})})]),slotProps:D.object,slots:D.object,startAdornment:D.node,style:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),value:D.string.isRequired};function U9(n){return Ci("MuiPickersOutlinedInput",n)}const aa=se({},yp,Ai("MuiPickersOutlinedInput",["root","notchedOutline","input"])),z9=["children","className","label","notched","shrink"],B9=lt("fieldset",{name:"MuiPickersOutlinedInput",slot:"NotchedOutline"})(({theme:n})=>{const e=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%",borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),UP=lt("span")(({theme:n})=>({fontFamily:n.typography.fontFamily,fontSize:"inherit"})),$9=lt("legend",{shouldForwardProp:n=>lh(n)&&n!=="notched"})(({theme:n})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:{inputHasLabel:!1},style:{padding:0,lineHeight:"11px",transition:n.transitions.create("width",{duration:150,easing:n.transitions.easing.easeOut})}},{props:{inputHasLabel:!0},style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:n.transitions.create("max-width",{duration:50,easing:n.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:{inputHasLabel:!0,notched:!0},style:{maxWidth:"100%",transition:n.transitions.create("max-width",{duration:100,easing:n.transitions.easing.easeOut,delay:50})}}]}));function W9(n){const{className:e,label:t,notched:i}=n,r=St(n,z9),s=Kx();return pe.jsx(B9,se({"aria-hidden":!0,className:e},r,{ownerState:s,children:pe.jsx($9,{ownerState:s,notched:i,children:t?pe.jsx(UP,{children:t}):pe.jsx(UP,{className:"notranslate",children:"​"})})}))}const H9=["label","autoFocus","ownerState","classes","notched"],q9=lt(Qx,{name:"MuiPickersOutlinedInput",slot:"Root"})(({theme:n})=>{const e=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{padding:"0 14px",borderRadius:(n.vars||n).shape.borderRadius,[`&:hover .${aa.notchedOutline}`]:{borderColor:(n.vars||n).palette.text.primary},"@media (hover: none)":{[`&:hover .${aa.notchedOutline}`]:{borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:e}},[`&.${aa.focused} .${aa.notchedOutline}`]:{borderStyle:"solid",borderWidth:2},[`&.${aa.disabled}`]:{[`& .${aa.notchedOutline}`]:{borderColor:(n.vars||n).palette.action.disabled},"*":{color:(n.vars||n).palette.action.disabled}},[`&.${aa.error} .${aa.notchedOutline}`]:{borderColor:(n.vars||n).palette.error.main},variants:Object.keys((n.vars??n).palette).filter(t=>{var i;return((i=(n.vars??n).palette[t])==null?void 0:i.main)??!1}).map(t=>({props:{inputColor:t},style:{[`&.${aa.focused}:not(.${aa.error}) .${aa.notchedOutline}`]:{borderColor:(n.vars||n).palette[t].main}}}))}}),G9=lt(BE,{name:"MuiPickersOutlinedInput",slot:"SectionsContainer"})({padding:"16.5px 0",variants:[{props:{inputSize:"small"},style:{padding:"8.5px 0"}}]}),Y9=n=>{const t=ei({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},U9,n);return se({},n,t)},$E=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiPickersOutlinedInput"}),{label:r,classes:s,notched:a}=i,o=St(i,H9),l=CR(),c=Y9(s);return pe.jsx(Jx,se({slots:{root:q9,input:G9},renderSuffix:u=>pe.jsx(W9,{shrink:!!(a||u.adornedStart||u.focused||u.filled),notched:!!(a||u.adornedStart||u.focused||u.filled),className:c.notchedOutline,label:r!=null&&r!==""&&(l!=null&&l.required)?pe.jsxs(T.Fragment,{children:[r," ","*"]}):r})},o,{label:r,classes:c,ref:t}))});$E.propTypes={areAllSectionsEmpty:D.bool.isRequired,className:D.string,component:D.elementType,contentEditable:D.bool.isRequired,"data-multi-input":D.string,elements:D.arrayOf(D.shape({after:D.object.isRequired,before:D.object.isRequired,container:D.object.isRequired,content:D.object.isRequired})).isRequired,endAdornment:D.node,fullWidth:D.bool,id:D.string,inputProps:D.object,inputRef:Nl,label:D.node,margin:D.oneOf(["dense","none","normal"]),name:D.string,notched:D.bool,onChange:D.func.isRequired,onClick:D.func.isRequired,onInput:D.func.isRequired,onKeyDown:D.func.isRequired,onPaste:D.func.isRequired,ownerState:D.any,readOnly:D.bool,renderSuffix:D.func,sectionListRef:D.oneOfType([D.func,D.shape({current:D.shape({getRoot:D.func.isRequired,getSectionContainer:D.func.isRequired,getSectionContent:D.func.isRequired,getSectionIndexFromDOMElement:D.func.isRequired})})]),slotProps:D.object,slots:D.object,startAdornment:D.node,style:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),value:D.string.isRequired};$E.muiName="Input";function X9(n){return Ci("MuiPickersFilledInput",n)}const Du=se({},yp,Ai("MuiPickersFilledInput",["root","underline","input"])),K9=["label","autoFocus","disableUnderline","hiddenLabel","classes"],Q9=lt(Qx,{name:"MuiPickersFilledInput",slot:"Root",shouldForwardProp:n=>lh(n)&&n!=="disableUnderline"})(({theme:n})=>{const e=n.palette.mode==="light",t=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",i=e?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",r=e?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",s=e?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:i,borderTopLeftRadius:(n.vars||n).shape.borderRadius,borderTopRightRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create("background-color",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),"&:hover":{backgroundColor:n.vars?n.vars.palette.FilledInput.hoverBg:r,"@media (hover: none)":{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:i}},[`&.${Du.focused}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:i},[`&.${Du.disabled}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.disabledBg:s},variants:[...Object.keys((n.vars??n).palette).filter(a=>(n.vars??n).palette[a].main).map(a=>{var o;return{props:{inputColor:a,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(o=(n.vars||n).palette[a])==null?void 0:o.main}`}}}}),{props:{disableUnderline:!1},style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Du.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Du.error}`]:{"&:before, &:after":{borderBottomColor:(n.vars||n).palette.error.main}},"&::before":{borderBottom:`1px solid ${n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`:t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Du.disabled}, .${Du.error}):before`]:{borderBottom:`1px solid ${(n.vars||n).palette.text.primary}`},[`&.${Du.disabled}:before`]:{borderBottomStyle:"dotted"}}},{props:{hasStartAdornment:!0},style:{paddingLeft:12}},{props:{hasEndAdornment:!0},style:{paddingRight:12}}]}}),J9=lt(BE,{name:"MuiPickersFilledInput",slot:"sectionsContainer",shouldForwardProp:n=>lh(n)&&n!=="hiddenLabel"})({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,variants:[{props:{inputSize:"small"},style:{paddingTop:21,paddingBottom:4}},{props:{hasStartAdornment:!0},style:{paddingLeft:0}},{props:{hasEndAdornment:!0},style:{paddingRight:0}},{props:{hiddenLabel:!0},style:{paddingTop:16,paddingBottom:17}},{props:{hiddenLabel:!0,inputSize:"small"},style:{paddingTop:8,paddingBottom:9}}]}),Z9=(n,e)=>{const{inputHasUnderline:t}=e,r=ei({root:["root",t&&"underline"],input:["input"]},X9,n);return se({},n,r)},WE=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiPickersFilledInput"}),{label:r,disableUnderline:s=!1,hiddenLabel:a=!1,classes:o}=i,l=St(i,K9),c=Kx(),u=se({},c,{inputHasUnderline:!s}),p=Z9(o,u);return pe.jsx(Jx,se({slots:{root:Q9,input:J9},slotProps:{root:{disableUnderline:s},input:{hiddenLabel:a}}},l,{label:r,classes:p,ref:t,ownerState:u}))});WE.propTypes={areAllSectionsEmpty:D.bool.isRequired,className:D.string,component:D.elementType,contentEditable:D.bool.isRequired,"data-multi-input":D.string,disableUnderline:D.bool,elements:D.arrayOf(D.shape({after:D.object.isRequired,before:D.object.isRequired,container:D.object.isRequired,content:D.object.isRequired})).isRequired,endAdornment:D.node,fullWidth:D.bool,hiddenLabel:D.bool,id:D.string,inputProps:D.object,inputRef:Nl,label:D.node,margin:D.oneOf(["dense","none","normal"]),name:D.string,onChange:D.func.isRequired,onClick:D.func.isRequired,onInput:D.func.isRequired,onKeyDown:D.func.isRequired,onPaste:D.func.isRequired,ownerState:D.any,readOnly:D.bool,renderSuffix:D.func,sectionListRef:D.oneOfType([D.func,D.shape({current:D.shape({getRoot:D.func.isRequired,getSectionContainer:D.func.isRequired,getSectionContent:D.func.isRequired,getSectionIndexFromDOMElement:D.func.isRequired})})]),slotProps:D.object,slots:D.object,startAdornment:D.node,style:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),value:D.string.isRequired};WE.muiName="Input";function e7(n){return Ci("MuiPickersFilledInput",n)}const Pm=se({},yp,Ai("MuiPickersInput",["root","underline","input"])),t7=["label","autoFocus","disableUnderline","ownerState","classes"],n7=lt(Qx,{name:"MuiPickersInput",slot:"Root",shouldForwardProp:n=>lh(n)&&n!=="disableUnderline"})(({theme:n})=>{let t=n.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return n.vars&&(t=`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`),{"label + &":{marginTop:16},variants:[...Object.keys((n.vars??n).palette).filter(i=>(n.vars??n).palette[i].main).map(i=>({props:{inputColor:i},style:{"&::after":{borderBottom:`2px solid ${(n.vars||n).palette[i].main}`}}})),{props:{disableUnderline:!1},style:{"&::after":{background:"red",left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Pm.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Pm.error}`]:{"&:before, &:after":{borderBottomColor:(n.vars||n).palette.error.main}},"&::before":{borderBottom:`1px solid ${t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Pm.disabled}, .${Pm.error}):before`]:{borderBottom:`2px solid ${(n.vars||n).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${t}`}},[`&.${Pm.disabled}:before`]:{borderBottomStyle:"dotted"}}}]}}),i7=(n,e)=>{const{inputHasUnderline:t}=e,r=ei({root:["root",!t&&"underline"],input:["input"]},e7,n);return se({},n,r)},HE=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiPickersInput"}),{label:r,disableUnderline:s=!1,classes:a}=i,o=St(i,t7),l=Kx(),c=se({},l,{inputHasUnderline:!s}),u=i7(a,c);return pe.jsx(Jx,se({slots:{root:n7},slotProps:{root:{disableUnderline:s}}},o,{label:r,classes:u,ref:t}))});HE.propTypes={areAllSectionsEmpty:D.bool.isRequired,className:D.string,component:D.elementType,contentEditable:D.bool.isRequired,"data-multi-input":D.string,disableUnderline:D.bool,elements:D.arrayOf(D.shape({after:D.object.isRequired,before:D.object.isRequired,container:D.object.isRequired,content:D.object.isRequired})).isRequired,endAdornment:D.node,fullWidth:D.bool,id:D.string,inputProps:D.object,inputRef:Nl,label:D.node,margin:D.oneOf(["dense","none","normal"]),name:D.string,onChange:D.func.isRequired,onClick:D.func.isRequired,onInput:D.func.isRequired,onKeyDown:D.func.isRequired,onPaste:D.func.isRequired,ownerState:D.any,readOnly:D.bool,renderSuffix:D.func,sectionListRef:D.oneOfType([D.func,D.shape({current:D.shape({getRoot:D.func.isRequired,getSectionContainer:D.func.isRequired,getSectionContent:D.func.isRequired,getSectionIndexFromDOMElement:D.func.isRequired})})]),slotProps:D.object,slots:D.object,startAdornment:D.node,style:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),value:D.string.isRequired};HE.muiName="Input";const r7=["onFocus","onBlur","className","classes","color","disabled","error","variant","required","InputProps","inputProps","inputRef","sectionListRef","elements","areAllSectionsEmpty","onClick","onKeyDown","onKeyUp","onPaste","onInput","endAdornment","startAdornment","tabIndex","contentEditable","focused","value","onChange","fullWidth","id","name","helperText","FormHelperTextProps","label","InputLabelProps","data-active-range-position"],s7={standard:HE,filled:WE,outlined:$E},a7=lt(AR,{name:"MuiPickersTextField",slot:"Root"})({}),o7=(n,e)=>{const{isFieldFocused:t,isFieldDisabled:i,isFieldRequired:r}=e;return ei({root:["root",t&&!i&&"focused",i&&"disabled",r&&"required"]},N9,n)},qE=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiPickersTextField"}),{onFocus:r,onBlur:s,className:a,classes:o,color:l="primary",disabled:c=!1,error:u=!1,variant:p="outlined",required:m=!1,InputProps:g,inputProps:y,inputRef:v,sectionListRef:w,elements:k,areAllSectionsEmpty:S,onClick:E,onKeyDown:P,onKeyUp:A,onPaste:N,onInput:R,endAdornment:V,startAdornment:B,tabIndex:L,contentEditable:W,focused:q,value:X,onChange:G,fullWidth:K,id:J,name:ee,helperText:fe,FormHelperTextProps:ae,label:U,InputLabelProps:he,"data-active-range-position":ie}=i,$=St(i,r7),Y=T.useRef(null),oe=Cs(t,Y),be=Fx(J),xe=fe&&be?`${be}-helper-text`:void 0,je=U&&be?`${be}-label`:void 0,ze=zE({disabled:i.disabled,required:i.required,readOnly:g==null?void 0:g.readOnly}),Ve=T.useMemo(()=>se({},ze,{isFieldValueEmpty:S,isFieldFocused:q??!1,hasFieldError:u??!1,inputSize:i.size??"medium",inputColor:l??"primary",isInputInFullWidth:K??!1,hasStartAdornment:!!(B??(g==null?void 0:g.startAdornment)),hasEndAdornment:!!(V??(g==null?void 0:g.endAdornment)),inputHasLabel:!!U}),[ze,S,q,u,i.size,l,K,B,V,g==null?void 0:g.startAdornment,g==null?void 0:g.endAdornment,U]),we=o7(o,Ve),Ae=s7[p];return pe.jsx(kj.Provider,{value:Ve,children:pe.jsxs(a7,se({className:tr(we.root,a),ref:oe,focused:q,disabled:c,variant:p,error:u,color:l,fullWidth:K,required:m,ownerState:Ve},$,{children:[U!=null&&U!==""&&pe.jsx(h4,se({htmlFor:be,id:je},he,{children:U})),pe.jsx(Ae,se({elements:k,areAllSectionsEmpty:S,onClick:E,onKeyDown:P,onKeyUp:A,onInput:R,onPaste:N,onFocus:r,onBlur:s,endAdornment:V,startAdornment:B,tabIndex:L,contentEditable:W,value:X,onChange:G,id:be,fullWidth:K,inputProps:y,inputRef:v,sectionListRef:w,label:U,name:ee,role:"group","aria-labelledby":je,"aria-describedby":xe,"aria-live":xe?"polite":void 0,"data-active-range-position":ie},g)),fe&&pe.jsx(p4,se({id:xe},ae,{children:fe}))]}))})});qE.propTypes={areAllSectionsEmpty:D.bool.isRequired,className:D.string,color:D.oneOf(["error","info","primary","secondary","success","warning"]),component:D.elementType,contentEditable:D.bool.isRequired,disabled:D.bool.isRequired,elements:D.arrayOf(D.shape({after:D.object.isRequired,before:D.object.isRequired,container:D.object.isRequired,content:D.object.isRequired})).isRequired,endAdornment:D.node,error:D.bool.isRequired,focused:D.bool,FormHelperTextProps:D.object,fullWidth:D.bool,helperText:D.node,hiddenLabel:D.bool,id:D.string,InputLabelProps:D.object,inputProps:D.object,InputProps:D.object,inputRef:Nl,label:D.node,margin:D.oneOf(["dense","none","normal"]),name:D.string,onBlur:D.func.isRequired,onChange:D.func.isRequired,onClick:D.func.isRequired,onFocus:D.func.isRequired,onInput:D.func.isRequired,onKeyDown:D.func.isRequired,onPaste:D.func.isRequired,readOnly:D.bool,required:D.bool,sectionListRef:D.oneOfType([D.func,D.shape({current:D.shape({getRoot:D.func.isRequired,getSectionContainer:D.func.isRequired,getSectionContent:D.func.isRequired,getSectionIndexFromDOMElement:D.func.isRequired})})]),size:D.oneOf(["medium","small"]),startAdornment:D.node,style:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),value:D.string.isRequired,variant:D.oneOf(["filled","outlined","standard"])};const l7=["enableAccessibleFieldDOMStructure"],c7=["InputProps","readOnly","onClear","clearable","clearButtonPosition","openPickerButtonPosition","openPickerAriaLabel"],u7=["onPaste","onKeyDown","inputMode","readOnly","InputProps","inputProps","inputRef","onClear","clearable","clearButtonPosition","openPickerButtonPosition","openPickerAriaLabel"],d7=["ownerState"],h7=["ownerState"],p7=["ownerState"],f7=["ownerState"],m7=["InputProps","inputProps"],g7=n=>{let{enableAccessibleFieldDOMStructure:e}=n,t=St(n,l7);if(e){const{InputProps:w,readOnly:k,onClear:S,clearable:E,clearButtonPosition:P,openPickerButtonPosition:A,openPickerAriaLabel:N}=t,R=St(t,c7);return{clearable:E,onClear:S,clearButtonPosition:P,openPickerButtonPosition:A,openPickerAriaLabel:N,textFieldProps:se({},R,{InputProps:se({},w??{},{readOnly:k})})}}const{onPaste:i,onKeyDown:r,inputMode:s,readOnly:a,InputProps:o,inputProps:l,inputRef:c,onClear:u,clearable:p,clearButtonPosition:m,openPickerButtonPosition:g,openPickerAriaLabel:y}=t,v=St(t,u7);return{clearable:p,onClear:u,clearButtonPosition:m,openPickerButtonPosition:g,openPickerAriaLabel:y,textFieldProps:se({},v,{InputProps:se({},o??{},{readOnly:a}),inputProps:se({},l??{},{inputMode:s,onPaste:i,onKeyDown:r,ref:c})})}},GE=T.createContext({slots:{},slotProps:{},inputRef:void 0});function b7(n){var ae,U;const{slots:e,slotProps:t,fieldResponse:i,defaultOpenPickerIcon:r}=n,s=au(),a=FE(),o=T.useContext(GE),{textFieldProps:l,onClear:c,clearable:u,openPickerAriaLabel:p,clearButtonPosition:m="end",openPickerButtonPosition:g="end"}=g7(i),y=zE(l),v=Ze(he=>{he.preventDefault(),a==null||a.setOpen(ie=>!ie)}),w=a?a.triggerStatus:"hidden",k=u?m:null,S=w!=="hidden"?g:null,E=(e==null?void 0:e.textField)??o.slots.textField??(i.enableAccessibleFieldDOMStructure===!1?Ni:qE),P=(e==null?void 0:e.inputAdornment)??o.slots.inputAdornment??C1,A=pn({elementType:P,externalSlotProps:n0(o.slotProps.inputAdornment,t==null?void 0:t.inputAdornment),additionalProps:{position:"start"},ownerState:se({},y,{position:"start"})}),N=St(A,d7),R=pn({elementType:P,externalSlotProps:t==null?void 0:t.inputAdornment,additionalProps:{position:"end"},ownerState:se({},y,{position:"end"})}),V=St(R,h7),B=o.slots.openPickerButton??ut,L=pn({elementType:B,externalSlotProps:o.slotProps.openPickerButton,additionalProps:{disabled:w==="disabled",onClick:v,"aria-label":p,edge:l.variant!=="standard"?S:!1},ownerState:y}),W=St(L,p7),q=o.slots.openPickerIcon??r,X=pn({elementType:q,externalSlotProps:o.slotProps.openPickerIcon,ownerState:y}),G=(e==null?void 0:e.clearButton)??o.slots.clearButton??ut,K=pn({elementType:G,externalSlotProps:n0(o.slotProps.clearButton,t==null?void 0:t.clearButton),className:"clearButton",additionalProps:{title:s.fieldClearLabel,tabIndex:-1,onClick:c,disabled:i.disabled||i.readOnly,edge:l.variant!=="standard"&&k!==S?k:!1},ownerState:y}),J=St(K,f7),ee=(e==null?void 0:e.clearIcon)??o.slots.clearIcon??E9,fe=pn({elementType:ee,externalSlotProps:n0(o.slotProps.clearIcon,t==null?void 0:t.clearIcon),additionalProps:{fontSize:"small"},ownerState:y});return l.ref=Cs(l.ref,a==null?void 0:a.rootRef),l.InputProps||(l.InputProps={}),a&&(l.InputProps.ref=a.triggerRef),!((ae=l.InputProps)!=null&&ae.startAdornment)&&(k==="start"||S==="start")&&(l.InputProps.startAdornment=pe.jsxs(P,se({},N,{children:[S==="start"&&pe.jsx(B,se({},W,{children:pe.jsx(q,se({},X))})),k==="start"&&pe.jsx(G,se({},J,{children:pe.jsx(ee,se({},fe))}))]}))),!((U=l.InputProps)!=null&&U.endAdornment)&&(k==="end"||S==="end")&&(l.InputProps.endAdornment=pe.jsxs(P,se({},V,{children:[k==="end"&&pe.jsx(G,se({},J,{children:pe.jsx(ee,se({},fe))})),S==="end"&&pe.jsx(B,se({},W,{children:pe.jsx(q,se({},X))}))]}))),k!=null&&(l.sx=[{"& .clearButton":{opacity:1},"@media (pointer: fine)":{"& .clearButton":{opacity:0},"&:hover, &:focus-within":{".clearButton":{opacity:1}}}},...Array.isArray(l.sx)?l.sx:[l.sx]]),pe.jsx(E,se({},l))}function n0(n,e){return n?e?t=>se({},L0(e,t),L0(n,t)):n:e}function y7(n){const{ref:e,externalForwardedProps:t,slotProps:i}=n,r=T.useContext(GE),s=FE(),a=zE(t),{InputProps:o,inputProps:l}=t,c=St(t,m7),u=pn({elementType:qE,externalSlotProps:n0(r.slotProps.textField,i==null?void 0:i.textField),externalForwardedProps:c,additionalProps:{ref:e,sx:s==null?void 0:s.rootSx,label:s==null?void 0:s.label,name:s==null?void 0:s.name,className:s==null?void 0:s.rootClassName,inputRef:r.inputRef},ownerState:a});return u.inputProps=se({},l,u.inputProps),u.InputProps=se({},o,u.InputProps),u}function Dj(n){const{slots:e={},slotProps:t={},inputRef:i,children:r}=n,s=T.useMemo(()=>({inputRef:i,slots:{openPickerButton:e.openPickerButton,openPickerIcon:e.openPickerIcon,textField:e.textField,inputAdornment:e.inputAdornment,clearIcon:e.clearIcon,clearButton:e.clearButton},slotProps:{openPickerButton:t.openPickerButton,openPickerIcon:t.openPickerIcon,textField:t.textField,inputAdornment:t.inputAdornment,clearIcon:t.clearIcon,clearButton:t.clearButton}}),[i,e.openPickerButton,e.openPickerIcon,e.textField,e.inputAdornment,e.clearIcon,e.clearButton,t.openPickerButton,t.openPickerIcon,t.textField,t.inputAdornment,t.clearIcon,t.clearButton]);return pe.jsx(GE.Provider,{value:s,children:r})}function Sj(n){const{steps:e}=n;return n9({steps:e,isViewMatchingStep:(t,i)=>i.views==null||i.views.includes(t),onStepChange:({step:t,defaultView:i,setView:r,view:s,views:a})=>{const o=t.views==null?i:t.views.find(l=>a.includes(l));o!==s&&r(o)}})}const v7=["props","steps"],x7=["ownerState"],w7=n=>{var N;let{props:e,steps:t}=n,i=St(n,v7);const{slots:r,slotProps:s,label:a,inputRef:o,localeText:l}=e,c=Sj({steps:t}),{providerProps:u,renderCurrentView:p,ownerState:m}=hj(se({},i,{props:e,localeText:l,autoFocusView:!0,viewContainerRole:"dialog",variant:"desktop",getStepNavigation:c})),g=u.privateContextValue.labelId,y=((N=s==null?void 0:s.toolbar)==null?void 0:N.hidden)??!1,v=r.field,w=pn({elementType:v,externalSlotProps:s==null?void 0:s.field,additionalProps:se({},y&&{id:g}),ownerState:m}),k=St(w,x7),S=r.layout??UE;let E=g;y&&(a?E=`${g}-label`:E=void 0);const P=se({},s,{toolbar:se({},s==null?void 0:s.toolbar,{titleId:g}),popper:se({"aria-labelledby":E},s==null?void 0:s.popper)});return{renderPicker:()=>pe.jsx(ej,se({},u,{children:pe.jsxs(Dj,{slots:r,slotProps:P,inputRef:o,children:[pe.jsx(v,se({},k)),pe.jsx(Z8,{slots:r,slotProps:P,children:pe.jsx(S,se({},P==null?void 0:P.layout,{slots:r,slotProps:P,children:p()}))})]})}))}},qh=n=>n.saveQuery!=null,Ej=({stateResponse:{localizedDigits:n,sectionsValueBoundaries:e,state:t,timezone:i,setCharacterQuery:r,setTempAndroidValueStr:s,updateSectionValue:a}})=>{const o=jn(),l=({keyPressed:p,sectionIndex:m},g,y)=>{const v=p.toLowerCase(),w=t.sections[m];if(t.characterQuery!=null&&(!y||y(t.characterQuery.value))&&t.characterQuery.sectionIndex===m){const S=`${t.characterQuery.value}${v}`,E=g(S,w);if(!qh(E))return r({sectionIndex:m,value:S,sectionType:w.type}),E}const k=g(v,w);return qh(k)&&!k.saveQuery?(r(null),null):(r({sectionIndex:m,value:v,sectionType:w.type}),qh(k)?null:k)},c=p=>{const m=(v,w,k)=>{const S=w.filter(E=>E.toLowerCase().startsWith(k));return S.length===0?{saveQuery:!1}:{sectionValue:S[0],shouldGoToNextSection:S.length===1}},g=(v,w,k,S)=>{const E=P=>HM(o,i,w.type,P);if(w.contentType==="letter")return m(w.format,E(w.format),v);if(k&&S!=null&&RE(o,k).contentType==="letter"){const P=E(k),A=m(k,P,v);return qh(A)?{saveQuery:!1}:se({},A,{sectionValue:S(A.sectionValue,P)})}return{saveQuery:!1}};return l(p,(v,w)=>{switch(w.type){case"month":{const k=S=>AP(o,S,o.formats.month,w.format);return g(v,w,o.formats.month,k)}case"weekDay":{const k=(S,E)=>E.indexOf(S).toString();return g(v,w,o.formats.weekday,k)}case"meridiem":return g(v,w);default:return{saveQuery:!1}}})},u=p=>{const m=(y,v)=>{const w=th(y,n),k=Number(w),S=e[v.type]({currentDate:null,format:v.format,contentType:v.contentType});if(k>S.maximum)return{saveQuery:!1};if(k<S.minimum)return{saveQuery:!0};const E=k*10>S.maximum||w.length===S.maximum.toString().length;return{sectionValue:qM(o,k,S,n,v),shouldGoToNextSection:E}};return l(p,(y,v)=>{if(v.contentType==="digit"||v.contentType==="digit-with-letter")return m(y,v);if(v.type==="month"){GM(o,"digit","month","MM");const w=m(y,{type:v.type,format:"MM",hasLeadingZerosInInput:!0,contentType:"digit",maxLength:2});if(qh(w))return w;const k=AP(o,w.sectionValue,"MM",v.format);return se({},w,{sectionValue:k})}if(v.type==="weekDay"){const w=m(y,v);if(qh(w))return w;const k=qx(o,v.format)[Number(w.sectionValue)-1];return se({},w,{sectionValue:k})}return{saveQuery:!1}},y=>CP(y,n))};return Ze(p=>{const m=t.sections[p.sectionIndex],y=CP(p.keyPressed,n)?u(se({},p,{keyPressed:ME(p.keyPressed,n)})):c(p);if(y==null){s(null);return}a({section:m,newSectionValue:y.sectionValue,shouldGoToNextSection:y.shouldGoToNextSection})})},k7=5e3,Nj=n=>{var et;const e=jn(),t=au(),i=ph(),r=El(),{manager:{validator:s,valueType:a,internal_valueManager:o,internal_fieldValueManager:l},internalPropsWithDefaults:c,internalPropsWithDefaults:{value:u,defaultValue:p,referenceDate:m,onChange:g,format:y,formatDensity:v="dense",selectedSections:w,onSelectedSectionsChange:k,shouldRespectLeadingZeros:S=!1,timezone:E,enableAccessibleFieldDOMStructure:P=!0},forwardedProps:{error:A}}=n,{value:N,handleValueChange:R,timezone:V}=xy({name:"a field component",timezone:E,value:u,defaultValue:p,referenceDate:m,onChange:g,valueManager:o}),B=T.useRef(N);T.useEffect(()=>{B.current=N},[N]);const{hasValidationError:L}=oj({props:c,validator:s,timezone:V,value:N,onError:c.onError}),W=T.useMemo(()=>A!==void 0?A:L,[L,A]),q=T.useMemo(()=>i8(e),[e]),X=T.useMemo(()=>l8(e,q,V),[e,q,V]),G=T.useCallback(Be=>l.getSectionsFromValue(Be,mt=>MP({utils:e,localeText:t,localizedDigits:q,format:y,date:mt,formatDensity:v,shouldRespectLeadingZeros:S,enableAccessibleFieldDOMStructure:P,isRtl:r})),[l,y,t,q,r,S,e,v,P]),[K,J]=T.useState(()=>{const Be=G(N);TP(Be,a);const mt={sections:Be,lastExternalValue:N,lastSectionsDependencies:{format:y,isRtl:r,locale:e.locale},tempValueStrAndroid:null,characterQuery:null},Xe=e8(Be),ct=o.getInitialReferenceValue({referenceDate:m,value:N,utils:e,props:c,granularity:Xe,timezone:V});return se({},mt,{referenceValue:ct})}),[ee,fe]=Hf({controlled:w,default:null,name:"useField",state:"selectedSections"}),ae=Be=>{fe(Be),k==null||k(Be)},U=T.useMemo(()=>hD(ee,K.sections),[ee,K.sections]),he=U==="all"?0:U,ie=T.useMemo(()=>d8(K.sections,r&&!P),[K.sections,r,P]),$=T.useMemo(()=>K.sections.every(Be=>Be.value===""),[K.sections]),Y=Be=>{const mt={validationError:s({adapter:i,value:Be,timezone:V,props:c})};R(Be,mt)},oe=(Be,mt)=>{const Xe=[...K.sections];return Xe[Be]=se({},Xe[Be],{value:mt,modified:!0}),Xe},be=T.useRef(null),xe=pp(),je=Be=>{he!=null&&(be.current={sectionIndex:he,value:Be},xe.start(0,()=>{be.current=null}))},ze=()=>{o.areValuesEqual(e,N,o.emptyValue)?J(Be=>se({},Be,{sections:Be.sections.map(mt=>se({},mt,{value:""})),tempValueStrAndroid:null,characterQuery:null})):(J(Be=>se({},Be,{characterQuery:null})),Y(o.emptyValue))},Ve=()=>{if(he==null)return;const Be=K.sections[he];Be.value!==""&&(je(""),l.getDateFromSection(N,Be)===null?J(mt=>se({},mt,{sections:oe(he,""),tempValueStrAndroid:null,characterQuery:null})):(J(mt=>se({},mt,{characterQuery:null})),Y(l.updateDateInValue(N,Be,null))))},we=Be=>{const mt=(ct,tn)=>{const on=e.parse(ct,y);if(!e.isValid(on))return null;const Oe=MP({utils:e,localeText:t,localizedDigits:q,format:y,date:on,formatDensity:v,shouldRespectLeadingZeros:S,enableAccessibleFieldDOMStructure:P,isRtl:r});return RP(e,on,Oe,tn,!1)},Xe=l.parseValueStr(Be,K.referenceValue,mt);Y(Xe)},Ae=pp(),_e=({section:Be,newSectionValue:mt,shouldGoToNextSection:Xe})=>{xe.clear(),Ae.clear();const ct=l.getDateFromSection(N,Be);Xe&&he<K.sections.length-1&&ae(he+1);const tn=oe(he,mt),on=l.getDateSectionsFromValue(tn,Be),Oe=s8(e,on,q);if(e.isValid(Oe)){const Ge=RP(e,Oe,on,l.getDateFromSection(K.referenceValue,Be),!0);return ct==null&&Ae.start(0,()=>{B.current===N&&J(ue=>se({},ue,{sections:l.clearDateSections(K.sections,Be),tempValueStrAndroid:null}))}),Y(l.updateDateInValue(N,Be,Ge))}return on.every(Ge=>Ge.value!=="")?(je(mt),Y(l.updateDateInValue(N,Be,Oe))):ct!=null?(je(mt),Y(l.updateDateInValue(N,Be,null))):J(Ge=>se({},Ge,{sections:tn,tempValueStrAndroid:null}))},ye=Be=>J(mt=>se({},mt,{tempValueStrAndroid:Be})),He=Ze(Be=>{J(mt=>se({},mt,{characterQuery:Be}))});if(N!==K.lastExternalValue){let Be;be.current!=null&&!e.isValid(l.getDateFromSection(N,K.sections[be.current.sectionIndex]))?Be=oe(be.current.sectionIndex,be.current.value):Be=G(N),J(mt=>se({},mt,{lastExternalValue:N,sections:Be,sectionsDependencies:{format:y,isRtl:r,locale:e.locale},referenceValue:l.updateReferenceValue(e,N,mt.referenceValue),tempValueStrAndroid:null}))}if(r!==K.lastSectionsDependencies.isRtl||y!==K.lastSectionsDependencies.format||e.locale!==K.lastSectionsDependencies.locale){const Be=G(N);TP(Be,a),J(mt=>se({},mt,{lastSectionsDependencies:{format:y,isRtl:r,locale:e.locale},sections:Be,tempValueStrAndroid:null,characterQuery:null}))}K.characterQuery!=null&&!W&&he==null&&He(null),K.characterQuery!=null&&((et=K.sections[K.characterQuery.sectionIndex])==null?void 0:et.type)!==K.characterQuery.sectionType&&He(null),T.useEffect(()=>{be.current!=null&&(be.current=null)});const Re=pp();return T.useEffect(()=>(K.characterQuery!=null&&Re.start(k7,()=>He(null)),()=>{}),[K.characterQuery,He,Re]),T.useEffect(()=>{K.tempValueStrAndroid!=null&&he!=null&&Ve()},[K.sections]),{activeSectionIndex:he,areAllSectionsEmpty:$,error:W,localizedDigits:q,parsedSelectedSections:U,sectionOrder:ie,sectionsValueBoundaries:X,state:K,timezone:V,value:N,clearValue:ze,clearActiveSection:Ve,setCharacterQuery:He,setSelectedSections:ae,setTempAndroidValueStr:ye,updateSectionValue:_e,updateValueFromValueStr:we,getSectionsFromValue:G}};function _j(n){const{manager:{internal_useApplyDefaultValuesToFieldInternalProps:e},internalProps:t,skipContextFieldRefAssignment:i}=n,r=FE(),s=QM(),a=Cs(t.unstableFieldRef,i?null:s==null?void 0:s.fieldRef),o=r==null?void 0:r.setValue,l=T.useCallback((u,p)=>o==null?void 0:o(u,{validationError:p.validationError,shouldClose:!1}),[o]),c=T.useMemo(()=>s!=null&&r!=null?se({value:r.value,onChange:l,timezone:r.timezone,disabled:r.disabled,readOnly:r.readOnly,autoFocus:r.autoFocus&&!r.open,focused:r.open?!0:void 0,format:r.fieldFormat,formatDensity:s.formatDensity,enableAccessibleFieldDOMStructure:s.enableAccessibleFieldDOMStructure,selectedSections:s.selectedSections,onSelectedSectionsChange:s.onSelectedSectionsChange,unstableFieldRef:a},t):t,[r,s,t,l,a]);return e(c)}function YE(n){const{focused:e,domGetters:t,stateResponse:{parsedSelectedSections:i,state:r}}=n;if(!t.isReady())return;const s=document.getSelection();if(!s)return;if(i==null){s.rangeCount>0&&t.getRoot().contains(s.getRangeAt(0).startContainer)&&s.removeAllRanges(),e&&t.getRoot().blur();return}if(!t.getRoot().contains(pr(document)))return;const a=new window.Range;let o;i==="all"?o=t.getRoot():r.sections[i].type==="empty"?o=t.getSectionContainer(i):o=t.getSectionContent(i),a.selectNodeContents(o),o.focus(),s.removeAllRanges(),s.addRange(a)}function Cj(n){const e=jn(),{manager:{internal_fieldValueManager:t},internalPropsWithDefaults:{minutesStep:i,disabled:r,readOnly:s},stateResponse:{state:a,value:o,activeSectionIndex:l,parsedSelectedSections:c,sectionsValueBoundaries:u,localizedDigits:p,timezone:m,sectionOrder:g,clearValue:y,clearActiveSection:v,setSelectedSections:w,updateSectionValue:k}}=n;return Ze(S=>{if(!r)switch(!0){case((S.ctrlKey||S.metaKey)&&String.fromCharCode(S.keyCode)==="A"&&!S.shiftKey&&!S.altKey):{S.preventDefault(),w("all");break}case S.key==="ArrowRight":{if(S.preventDefault(),c==null)w(g.startIndex);else if(c==="all")w(g.endIndex);else{const E=g.neighbors[c].rightIndex;E!==null&&w(E)}break}case S.key==="ArrowLeft":{if(S.preventDefault(),c==null)w(g.endIndex);else if(c==="all")w(g.startIndex);else{const E=g.neighbors[c].leftIndex;E!==null&&w(E)}break}case S.key==="Delete":{if(S.preventDefault(),s)break;c==null||c==="all"?y():v();break}case["ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(S.key):{if(S.preventDefault(),s||l==null)break;c==="all"&&w(l);const E=a.sections[l],P=S7(e,m,E,S.key,u,p,t.getDateFromSection(o,E),{minutesStep:i});k({section:E,newSectionValue:P,shouldGoToNextSection:!1});break}}})}function D7(n){switch(n){case"ArrowUp":return 1;case"ArrowDown":return-1;case"PageUp":return 5;case"PageDown":return-5;default:return 0}}function S7(n,e,t,i,r,s,a,o){const l=D7(i),c=i==="Home",u=i==="End",p=t.value===""||c||u,m=()=>{const y=r[t.type]({currentDate:a,format:t.format,contentType:t.contentType}),v=S=>qM(n,S,y,s,t),w=t.type==="minutes"&&(o!=null&&o.minutesStep)?o.minutesStep:1;let k;if(p){if(t.type==="year"&&!u&&!c)return n.formatByString(n.date(void 0,e),t.format);l>0||c?k=y.minimum:k=y.maximum}else k=parseInt(th(t.value,s),10)+l*w;return k%w!==0&&((l<0||c)&&(k+=w-(w+k)%w),(l>0||u)&&(k-=k%w)),k>y.maximum?v(y.minimum+(k-y.maximum-1)%(y.maximum-y.minimum+1)):k<y.minimum?v(y.maximum-(y.minimum-k-1)%(y.maximum-y.minimum+1)):v(k)},g=()=>{const y=HM(n,e,t.type,t.format);if(y.length===0)return t.value;if(p)return l>0||c?y[0]:y[y.length-1];const k=((y.indexOf(t.value)+l)%y.length+y.length)%y.length;return y[k]};return t.contentType==="digit"||t.contentType==="digit-with-letter"?m():g()}function E7(n){const{manager:e,focused:t,setFocused:i,domGetters:r,stateResponse:s,applyCharacterEditing:a,internalPropsWithDefaults:o,stateResponse:{parsedSelectedSections:l,sectionOrder:c,state:u,clearValue:p,setCharacterQuery:m,setSelectedSections:g,updateValueFromValueStr:y},internalPropsWithDefaults:{disabled:v=!1,readOnly:w=!1}}=n,k=Cj({manager:e,internalPropsWithDefaults:o,stateResponse:s}),S=pp(),E=Ze(V=>{v||!r.isReady()||(i(!0),l==="all"?S.start(0,()=>{const B=document.getSelection().getRangeAt(0).startOffset;if(B===0){g(c.startIndex);return}let L=0,W=0;for(;W<B&&L<u.sections.length;){const q=u.sections[L];L+=1,W+=`${q.startSeparator}${q.value||q.placeholder}${q.endSeparator}`.length}g(L-1)}):t?r.getRoot().contains(V.target)||g(c.startIndex):(i(!0),g(c.startIndex)))}),P=Ze(V=>{if(!r.isReady()||l!=="all")return;const L=V.target.textContent??"";r.getRoot().innerHTML=u.sections.map(W=>`${W.startSeparator}${W.value||W.placeholder}${W.endSeparator}`).join(""),YE({focused:t,domGetters:r,stateResponse:s}),L.length===0||L.charCodeAt(0)===10?(p(),g("all")):L.length>1?y(L):(l==="all"&&g(0),a({keyPressed:L,sectionIndex:0}))}),A=Ze(V=>{if(w||l!=="all"){V.preventDefault();return}const B=V.clipboardData.getData("text");V.preventDefault(),m(null),y(B)}),N=Ze(()=>{if(t||v||!r.isReady())return;const V=pr(document);i(!0),r.getSectionIndexFromDOMElement(V)!=null||g(c.startIndex)}),R=Ze(()=>{setTimeout(()=>{if(!r.isReady())return;const V=pr(document);!r.getRoot().contains(V)&&(i(!1),g(null))})});return{onKeyDown:k,onBlur:R,onFocus:N,onClick:E,onPaste:A,onInput:P,contentEditable:l==="all",tabIndex:l===0?-1:0}}function N7(n){const{manager:{internal_fieldValueManager:e},stateResponse:{areAllSectionsEmpty:t,state:i,updateValueFromValueStr:r}}=n,s=Ze(o=>{r(o.target.value)});return{value:T.useMemo(()=>t?"":e.getV7HiddenInputValueFromSections(i.sections),[t,i.sections,e]),onChange:s}}function _7(n){const{stateResponse:{setSelectedSections:e},internalPropsWithDefaults:{disabled:t=!1}}=n,i=Ze(r=>s=>{t||s.isDefaultPrevented()||e(r)});return T.useCallback(r=>({"data-sectionindex":r,onClick:i(r)}),[i])}function C7(n){const e=jn(),t=au(),i=Fx(),{focused:r,domGetters:s,stateResponse:a,applyCharacterEditing:o,manager:{internal_fieldValueManager:l},stateResponse:{parsedSelectedSections:c,sectionsValueBoundaries:u,state:p,value:m,clearActiveSection:g,setCharacterQuery:y,setSelectedSections:v,updateSectionValue:w,updateValueFromValueStr:k},internalPropsWithDefaults:{disabled:S=!1,readOnly:E=!1}}=n,P=c==="all",A=!P&&!S&&!E,N=Ze(q=>{if(!s.isReady())return;const X=p.sections[q];s.getSectionContent(q).innerHTML=X.value||X.placeholder,YE({focused:r,domGetters:s,stateResponse:a})}),R=Ze(q=>{if(!s.isReady())return;const X=q.target,G=X.textContent??"",K=s.getSectionIndexFromDOMElement(X),J=p.sections[K];if(E){N(K);return}if(G.length===0){if(J.value===""){N(K);return}const ee=q.nativeEvent.inputType;if(ee==="insertParagraph"||ee==="insertLineBreak"){N(K);return}N(K),g();return}o({keyPressed:G,sectionIndex:K}),N(K)}),V=Ze(q=>{q.preventDefault()}),B=Ze(q=>{if(q.preventDefault(),E||S||typeof c!="number")return;const X=p.sections[c],G=q.clipboardData.getData("text"),K=/^[a-zA-Z]+$/.test(G),J=/^[0-9]+$/.test(G),ee=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(G);X.contentType==="letter"&&K||X.contentType==="digit"&&J||X.contentType==="digit-with-letter"&&ee?(y(null),w({section:X,newSectionValue:G,shouldGoToNextSection:!0})):!K&&!J&&(y(null),k(G))}),L=Ze(q=>{q.preventDefault(),q.dataTransfer.dropEffect="none"}),W=Ze(q=>()=>{S||v(q)});return T.useCallback((q,X)=>{const G=u[q.type]({currentDate:l.getDateFromSection(m,q),contentType:q.contentType,format:q.format});return{onInput:R,onPaste:B,onMouseUp:V,onDragOver:L,onFocus:W(X),"aria-labelledby":`${i}-${q.type}`,"aria-readonly":E,"aria-valuenow":P7(q,e),"aria-valuemin":G.minimum,"aria-valuemax":G.maximum,"aria-valuetext":q.value?A7(q,e):t.empty,"aria-label":t[q.type],"aria-disabled":S,tabIndex:P||X>0?-1:0,contentEditable:!P&&!S&&!E,role:"spinbutton",id:`${i}-${q.type}`,"data-range-position":q.dateName||void 0,spellCheck:A?!1:void 0,autoCapitalize:A?"off":void 0,autoCorrect:A?"off":void 0,children:q.value||q.placeholder,inputMode:q.contentType==="letter"?"text":"numeric"}},[u,i,P,S,E,A,t,e,R,B,V,L,W,l,m])}function A7(n,e){if(n.value)switch(n.type){case"month":{if(n.contentType==="digit")return e.format(e.setMonth(e.date(),Number(n.value)-1),"month");const t=e.parse(n.value,n.format);return t?e.format(t,"month"):void 0}case"day":return n.contentType==="digit"?e.format(e.setDate(e.startOfYear(e.date()),Number(n.value)),"dayOfMonthFull"):n.value;case"weekDay":return;default:return}}function P7(n,e){if(n.value)switch(n.type){case"weekDay":return n.contentType==="letter"?void 0:Number(n.value);case"meridiem":{const t=e.parse(`01:00 ${n.value}`,`${e.formats.hours12h}:${e.formats.minutes} ${n.format}`);return t?e.getHours(t)>=12?1:0:void 0}case"day":return n.contentType==="digit-with-letter"?parseInt(n.value,10):Number(n.value);case"month":{if(n.contentType==="digit")return Number(n.value);const t=e.parse(n.value,n.format);return t?e.getMonth(t)+1:void 0}default:return n.contentType!=="letter"?Number(n.value):void 0}}const T7=n=>{const{props:e,manager:t,skipContextFieldRefAssignment:i,manager:{valueType:r,internal_useOpenPickerButtonAriaLabel:s}}=n,{internalProps:a,forwardedProps:o}=sj(e,r),l=_j({manager:t,internalProps:a,skipContextFieldRefAssignment:i}),{sectionListRef:c,onBlur:u,onClick:p,onFocus:m,onInput:g,onPaste:y,onKeyDown:v,onClear:w,clearable:k}=o,{disabled:S=!1,readOnly:E=!1,autoFocus:P=!1,focused:A,unstableFieldRef:N}=l,R=T.useRef(null),V=Cs(c,R),B=T.useMemo(()=>({isReady:()=>R.current!=null,getRoot:()=>R.current.getRoot(),getSectionContainer:Re=>R.current.getSectionContainer(Re),getSectionContent:Re=>R.current.getSectionContent(Re),getSectionIndexFromDOMElement:Re=>R.current.getSectionIndexFromDOMElement(Re)}),[R]),L=Nj({manager:t,internalPropsWithDefaults:l,forwardedProps:o}),{areAllSectionsEmpty:W,error:q,parsedSelectedSections:X,sectionOrder:G,state:K,value:J,clearValue:ee,setSelectedSections:fe}=L,ae=Ej({stateResponse:L}),U=s(J),[he,ie]=T.useState(!1);function $(Re=0){if(S||!R.current||zP(R)!=null)return;const et=hD(Re,K.sections);ie(!0),R.current.getSectionContent(et).focus()}const Y=E7({manager:t,internalPropsWithDefaults:l,stateResponse:L,applyCharacterEditing:ae,focused:he,setFocused:ie,domGetters:B}),oe=N7({manager:t,stateResponse:L}),be=_7({stateResponse:L,internalPropsWithDefaults:l}),xe=C7({manager:t,stateResponse:L,applyCharacterEditing:ae,internalPropsWithDefaults:l,domGetters:B,focused:he}),je=Ze(Re=>{v==null||v(Re),Y.onKeyDown(Re)}),ze=Ze(Re=>{u==null||u(Re),Y.onBlur(Re)}),Ve=Ze(Re=>{m==null||m(Re),Y.onFocus(Re)}),we=Ze(Re=>{Re.isDefaultPrevented()||(p==null||p(Re),Y.onClick(Re))}),Ae=Ze(Re=>{y==null||y(Re),Y.onPaste(Re)}),_e=Ze(Re=>{g==null||g(Re),Y.onInput(Re)}),ye=Ze((Re,...et)=>{Re.preventDefault(),w==null||w(Re,...et),ee(),BP(R)?fe(G.startIndex):$(0)}),He=T.useMemo(()=>K.sections.map((Re,et)=>{const Be=xe(Re,et);return{container:be(et),content:xe(Re,et),before:{children:Re.startSeparator},after:{children:Re.endSeparator,"data-range-position":Re.isEndFormatSeparator?Be["data-range-position"]:void 0}}}),[K.sections,be,xe]);return T.useEffect(()=>{if(R.current==null)throw new Error(["MUI X: The `sectionListRef` prop has not been initialized by `PickersSectionList`","You probably tried to pass a component to the `textField` slot that contains an `<input />` element instead of a `PickersSectionList`.","","If you want to keep using an `<input />` HTML element for the editing, please add the `enableAccessibleFieldDOMStructure={false}` prop to your Picker or Field component:","","<DatePicker enableAccessibleFieldDOMStructure={false} slots={{ textField: MyCustomTextField }} />","","Learn more about the field accessible DOM structure on the MUI documentation: https://mui.com/x/react-date-pickers/fields/#fields-to-edit-a-single-element"].join(`
`));P&&!S&&R.current&&R.current.getSectionContent(G.startIndex).focus()},[]),Dl(()=>{if(!(!he||!R.current)){if(X==="all")R.current.getRoot().focus();else if(typeof X=="number"){const Re=R.current.getSectionContent(X);Re&&Re.focus()}}},[X,he]),Dl(()=>{YE({focused:he,domGetters:B,stateResponse:L})}),T.useImperativeHandle(N,()=>({getSections:()=>K.sections,getActiveSectionIndex:()=>zP(R),setSelectedSections:Re=>{if(S||!R.current)return;const et=hD(Re,K.sections);ie((et==="all"?0:et)!==null),fe(Re)},focusField:$,isFieldFocused:()=>BP(R)})),se({},o,Y,{onBlur:ze,onClick:we,onFocus:Ve,onInput:_e,onPaste:Ae,onKeyDown:je,onClear:ye},oe,{error:q,clearable:!!(k&&!W&&!E&&!S),focused:A??he,sectionListRef:V,enableAccessibleFieldDOMStructure:!0,elements:He,areAllSectionsEmpty:W,disabled:S,readOnly:E,autoFocus:P,openPickerAriaLabel:U})};function zP(n){const e=pr(document);return!e||!n.current||!n.current.getRoot().contains(e)?null:n.current.getSectionIndexFromDOMElement(e)}function BP(n){const e=pr(document);return!!n.current&&n.current.getRoot().contains(e)}const lp=n=>n.replace(/[\u2066\u2067\u2068\u2069]/g,""),I7=(n,e,t)=>{let i=0,r=t?1:0;const s=[];for(let a=0;a<n.length;a+=1){const o=n[a],l=OE(o,t?"input-rtl":"input-ltr",e),c=`${o.startSeparator}${l}${o.endSeparator}`,u=lp(c).length,p=c.length,m=lp(l),g=r+(m===""?0:l.indexOf(m[0]))+o.startSeparator.length,y=g+m.length;s.push(se({},o,{start:i,end:i+u,startInInput:g,endInInput:y})),i+=u,r+=p}return s},R7=n=>{const e=El(),t=pp(),i=pp(),{props:r,manager:s,skipContextFieldRefAssignment:a,manager:{valueType:o,internal_valueManager:l,internal_fieldValueManager:c,internal_useOpenPickerButtonAriaLabel:u}}=n,{internalProps:p,forwardedProps:m}=sj(r,o),g=_j({manager:s,internalProps:p,skipContextFieldRefAssignment:a}),{onFocus:y,onClick:v,onPaste:w,onBlur:k,onKeyDown:S,onClear:E,clearable:P,inputRef:A,placeholder:N}=m,{readOnly:R=!1,disabled:V=!1,autoFocus:B=!1,focused:L,unstableFieldRef:W}=g,q=T.useRef(null),X=Cs(A,q),G=Nj({manager:s,internalPropsWithDefaults:g,forwardedProps:m}),{activeSectionIndex:K,areAllSectionsEmpty:J,error:ee,localizedDigits:fe,parsedSelectedSections:ae,sectionOrder:U,state:he,value:ie,clearValue:$,clearActiveSection:Y,setCharacterQuery:oe,setSelectedSections:be,setTempAndroidValueStr:xe,updateSectionValue:je,updateValueFromValueStr:ze,getSectionsFromValue:Ve}=G,we=Ej({stateResponse:G}),Ae=u(ie),_e=T.useMemo(()=>I7(he.sections,fe,e),[he.sections,fe,e]);function ye(){const Le=q.current.selectionStart??0;let $e;Le<=_e[0].startInInput||Le>=_e[_e.length-1].endInInput?$e=1:$e=_e.findIndex(Et=>Et.startInInput-Et.startSeparator.length>Le);const ht=$e===-1?_e.length-1:$e-1;be(ht)}function He(Le=0){var $e;pr(document)!==q.current&&(($e=q.current)==null||$e.focus(),be(Le))}const Re=Ze(Le=>{y==null||y(Le);const $e=q.current;t.start(0,()=>{!$e||$e!==q.current||K==null&&($e.value.length&&Number($e.selectionEnd)-Number($e.selectionStart)===$e.value.length?be("all"):ye())})}),et=Ze((Le,...$e)=>{Le.isDefaultPrevented()||(v==null||v(Le,...$e),ye())}),Be=Ze(Le=>{if(w==null||w(Le),Le.preventDefault(),R||V)return;const $e=Le.clipboardData.getData("text");if(typeof ae=="number"){const ht=he.sections[ae],Et=/^[a-zA-Z]+$/.test($e),Ut=/^[0-9]+$/.test($e),zt=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test($e);if(ht.contentType==="letter"&&Et||ht.contentType==="digit"&&Ut||ht.contentType==="digit-with-letter"&&zt){oe(null),je({section:ht,newSectionValue:$e,shouldGoToNextSection:!0});return}if(Et||Ut)return}oe(null),ze($e)}),mt=Ze(Le=>{k==null||k(Le),be(null)}),Xe=Ze(Le=>{if(R)return;const $e=Le.target.value;if($e===""){$();return}const ht=Le.nativeEvent.data,Et=ht&&ht.length>1,Ut=Et?ht:$e,zt=lp(Ut);if(ae==="all"&&be(K),K==null||Et){ze(Et?ht:zt);return}let Te;if(ae==="all"&&zt.length===1)Te=zt;else{const Ue=lp(c.getV6InputValueFromSections(_e,fe,e));let ke=-1,ot=-1;for(let vn=0;vn<Ue.length;vn+=1)ke===-1&&Ue[vn]!==zt[vn]&&(ke=vn),ot===-1&&Ue[Ue.length-vn-1]!==zt[zt.length-vn-1]&&(ot=vn);const Bt=_e[K];if(ke<Bt.start||Ue.length-ot-1>Bt.end)return;const oi=zt.length-Ue.length+Bt.end-lp(Bt.endSeparator||"").length;Te=zt.slice(Bt.start+lp(Bt.startSeparator||"").length,oi)}if(Te.length===0){u8()&&xe(Ut),Y();return}we({keyPressed:Te,sectionIndex:K})}),ct=Ze((Le,...$e)=>{Le.preventDefault(),E==null||E(Le,...$e),$(),$P(q)?be(U.startIndex):He(0)}),tn=Cj({manager:s,internalPropsWithDefaults:g,stateResponse:G}),on=Ze(Le=>{S==null||S(Le),tn(Le)}),Oe=T.useMemo(()=>N!==void 0?N:c.getV6InputValueFromSections(Ve(l.emptyValue),fe,e),[N,c,Ve,l.emptyValue,fe,e]),Ge=T.useMemo(()=>he.tempValueStrAndroid??c.getV6InputValueFromSections(he.sections,fe,e),[he.sections,c,he.tempValueStrAndroid,fe,e]);T.useEffect(()=>{q.current&&q.current===pr(document)&&be("all")},[]),Dl(()=>{function Le(){if(!q.current)return;if(ae==null){q.current.scrollLeft&&(q.current.scrollLeft=0);return}if(q.current!==pr(document))return;const $e=q.current.scrollTop;if(ae==="all")q.current.select();else{const ht=_e[ae],Et=ht.type==="empty"?ht.startInInput-ht.startSeparator.length:ht.startInInput,Ut=ht.type==="empty"?ht.endInInput+ht.endSeparator.length:ht.endInInput;(Et!==q.current.selectionStart||Ut!==q.current.selectionEnd)&&q.current===pr(document)&&q.current.setSelectionRange(Et,Ut),i.start(0,()=>{q.current&&q.current===pr(document)&&q.current.selectionStart===q.current.selectionEnd&&(q.current.selectionStart!==Et||q.current.selectionEnd!==Ut)&&Le()})}q.current.scrollTop=$e}Le()});const ue=T.useMemo(()=>K==null||he.sections[K].contentType==="letter"?"text":"numeric",[K,he.sections]),Pe=!(q.current&&q.current===pr(document))&&J;return T.useImperativeHandle(W,()=>({getSections:()=>he.sections,getActiveSectionIndex:()=>{const Le=q.current.selectionStart??0,$e=q.current.selectionEnd??0;if(Le===0&&$e===0)return null;const ht=Le<=_e[0].startInInput?1:_e.findIndex(Et=>Et.startInInput-Et.startSeparator.length>Le);return ht===-1?_e.length-1:ht-1},setSelectedSections:Le=>be(Le),focusField:He,isFieldFocused:()=>$P(q)})),se({},m,{error:ee,clearable:!!(P&&!J&&!R&&!V),onBlur:mt,onClick:et,onFocus:Re,onPaste:Be,onKeyDown:on,onClear:ct,inputRef:X,enableAccessibleFieldDOMStructure:!1,placeholder:Oe,inputMode:ue,autoComplete:"off",value:Pe?"":Ge,onChange:Xe,focused:L,disabled:V,readOnly:R,autoFocus:B,openPickerAriaLabel:Ae})};function $P(n){return n.current===pr(document)}const M7=n=>{const e=QM();return(n.props.enableAccessibleFieldDOMStructure??(e==null?void 0:e.enableAccessibleFieldDOMStructure)??!0?T7:R7)(n)},j7=n=>{const e=V8(n);return M7({manager:e,props:n})},O7=["slots","slotProps"],XE=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiDateField"}),{slots:r,slotProps:s}=i,a=St(i,O7),o=y7({slotProps:s,ref:t,externalForwardedProps:a}),l=j7(o);return pe.jsx(b7,{slots:r,slotProps:s,fieldResponse:l,defaultOpenPickerIcon:S9})});XE.propTypes={autoFocus:D.bool,className:D.string,clearable:D.bool,clearButtonPosition:D.oneOf(["end","start"]),color:D.oneOf(["error","info","primary","secondary","success","warning"]),component:D.elementType,defaultValue:D.object,disabled:D.bool,disableFuture:D.bool,disablePast:D.bool,enableAccessibleFieldDOMStructure:D.bool,focused:D.bool,format:D.string,formatDensity:D.oneOf(["dense","spacious"]),FormHelperTextProps:D.object,fullWidth:D.bool,helperText:D.node,hiddenLabel:D.bool,id:D.string,InputLabelProps:D.object,inputProps:D.object,InputProps:D.object,inputRef:Nl,label:D.node,margin:D.oneOf(["dense","none","normal"]),maxDate:D.object,minDate:D.object,name:D.string,onBlur:D.func,onChange:D.func,onClear:D.func,onError:D.func,onFocus:D.func,onSelectedSectionsChange:D.func,openPickerButtonPosition:D.oneOf(["end","start"]),readOnly:D.bool,referenceDate:D.object,required:D.bool,selectedSections:D.oneOfType([D.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),D.number]),shouldDisableDate:D.func,shouldDisableMonth:D.func,shouldDisableYear:D.func,shouldRespectLeadingZeros:D.bool,size:D.oneOf(["medium","small"]),slotProps:D.object,slots:D.object,style:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),timezone:D.string,unstableFieldRef:D.oneOfType([D.func,D.object]),value:D.object,variant:D.oneOf(["filled","outlined","standard"])};const Aj=({shouldDisableDate:n,shouldDisableMonth:e,shouldDisableYear:t,minDate:i,maxDate:r,disableFuture:s,disablePast:a,timezone:o})=>{const l=ph();return T.useCallback(c=>yy({adapter:l,value:c,timezone:o,props:{shouldDisableDate:n,shouldDisableMonth:e,shouldDisableYear:t,minDate:i,maxDate:r,disableFuture:s,disablePast:a}})!==null,[l,n,e,t,i,r,s,a,o])},L7=(n,e)=>(t,i)=>{switch(i.type){case"setVisibleDate":return se({},t,{slideDirection:i.direction,currentMonth:i.month,isMonthSwitchingAnimating:!e.isSameMonth(i.month,t.currentMonth)&&!n&&!i.skipAnimation,focusedDay:i.focusedDay});case"changeMonthTimezone":{const r=i.newTimezone;if(e.getTimezone(t.currentMonth)===r)return t;let s=e.setTimezone(t.currentMonth,r);return e.getMonth(s)!==e.getMonth(t.currentMonth)&&(s=e.setMonth(s,e.getMonth(t.currentMonth))),se({},t,{currentMonth:s})}case"finishMonthSwitchingAnimation":return se({},t,{isMonthSwitchingAnimating:!1});default:throw new Error("missing support")}},F7=n=>{const{value:e,referenceDate:t,disableFuture:i,disablePast:r,maxDate:s,minDate:a,onMonthChange:o,onYearChange:l,reduceAnimations:c,shouldDisableDate:u,timezone:p,getCurrentMonthFromVisibleDate:m}=n,g=jn(),y=T.useRef(L7(!!c,g)).current,v=T.useMemo(()=>mo.getInitialReferenceValue({value:e,utils:g,timezone:p,props:n,referenceDate:t,granularity:po.day}),[t,p]),[w,k]=T.useReducer(y,{isMonthSwitchingAnimating:!1,focusedDay:v,currentMonth:g.startOfMonth(v),slideDirection:"left"}),S=Aj({shouldDisableDate:u,minDate:a,maxDate:s,disableFuture:i,disablePast:r,timezone:p});T.useEffect(()=>{k({type:"changeMonthTimezone",newTimezone:g.getTimezone(v)})},[v,g]);const E=Ze(({target:A,reason:N})=>{if(N==="cell-interaction"&&w.focusedDay!=null&&g.isSameDay(A,w.focusedDay))return;const R=N==="cell-interaction";let V,B;if(N==="cell-interaction")V=m(A,w.currentMonth),B=A;else if(V=g.isSameMonth(A,w.currentMonth)?w.currentMonth:g.startOfMonth(A),B=A,S(B)){const q=g.startOfMonth(A),X=g.endOfMonth(A);B=Eg({utils:g,date:B,minDate:g.isBefore(a,q)?q:a,maxDate:g.isAfter(s,X)?X:s,disablePast:r,disableFuture:i,isDateDisabled:S,timezone:p})}const L=!g.isSameMonth(w.currentMonth,V),W=!g.isSameYear(w.currentMonth,V);L&&(o==null||o(V)),W&&(l==null||l(g.startOfYear(V))),k({type:"setVisibleDate",month:V,direction:g.isAfterDay(V,w.currentMonth)?"left":"right",focusedDay:w.focusedDay!=null&&B!=null&&g.isSameDay(B,w.focusedDay)?w.focusedDay:B,skipAnimation:R})}),P=T.useCallback(()=>{k({type:"finishMonthSwitchingAnimation"})},[]);return{referenceDate:v,calendarState:w,setVisibleDate:E,isDateDisabled:S,onMonthSwitchingAnimationEnd:P}},V7=n=>Ci("MuiPickersFadeTransitionGroup",n);Ai("MuiPickersFadeTransitionGroup",["root"]);const U7=["children"],z7=n=>ei({root:["root"]},V7,n),B7=lt(PR,{name:"MuiPickersFadeTransitionGroup",slot:"Root"})({display:"block",position:"relative"});function Pj(n){const e=Yn({props:n,name:"MuiPickersFadeTransitionGroup"}),{className:t,reduceAnimations:i,transKey:r,classes:s}=e,{children:a}=e,o=St(e,U7),l=z7(s),c=oh();if(i)return a;const u=se({},o);return pe.jsx(B7,{className:tr(l.root,t),ownerState:u,children:pe.jsx(Ox,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:c.transitions.duration.enteringScreen,enter:c.transitions.duration.enteringScreen,exit:0},children:a},r)})}function $7(n){return Ci("MuiPickersDay",n)}const Su=Ai("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]);function Tj(n){const{disabled:e,selected:t,today:i,outsideCurrentMonth:r,day:s,disableMargin:a,disableHighlightToday:o,showDaysOutsideCurrentMonth:l}=n,c=jn(),{ownerState:u}=ir();return T.useMemo(()=>se({},u,{day:s,isDaySelected:t??!1,isDayDisabled:e??!1,isDayCurrent:i??!1,isDayOutsideMonth:r??!1,isDayStartOfWeek:c.isSameDay(s,c.startOfWeek(s)),isDayEndOfWeek:c.isSameDay(s,c.endOfWeek(s)),disableMargin:a??!1,disableHighlightToday:o??!1,showDaysOutsideCurrentMonth:l??!1}),[c,u,s,t,e,i,r,a,o,l])}const W7=["autoFocus","className","classes","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","children","isFirstVisibleCell","isLastVisibleCell","day","selected","disabled","today","outsideCurrentMonth","disableMargin","disableHighlightToday","showDaysOutsideCurrentMonth"],H7=(n,e)=>{const{isDaySelected:t,isDayDisabled:i,isDayCurrent:r,isDayOutsideMonth:s,disableMargin:a,disableHighlightToday:o,showDaysOutsideCurrentMonth:l}=e,c=s&&!l;return ei({root:["root",t&&!c&&"selected",i&&"disabled",!a&&"dayWithMargin",!o&&r&&"today",s&&l&&"dayOutsideMonth",c&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},$7,n)},Ij=({theme:n})=>se({},n.typography.caption,{width:Ng,height:Ng,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:n.transitions.create("background-color",{duration:n.transitions.duration.short}),color:(n.vars||n).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Qe(n.palette.primary.main,n.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.focusOpacity})`:Qe(n.palette.primary.main,n.palette.action.focusOpacity),[`&.${Su.selected}`]:{willChange:"background-color",backgroundColor:(n.vars||n).palette.primary.dark}},[`&.${Su.selected}`]:{color:(n.vars||n).palette.primary.contrastText,backgroundColor:(n.vars||n).palette.primary.main,fontWeight:n.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(n.vars||n).palette.primary.dark}},[`&.${Su.disabled}:not(.${Su.selected})`]:{color:(n.vars||n).palette.text.disabled},[`&.${Su.disabled}&.${Su.selected}`]:{opacity:.6},variants:[{props:{disableMargin:!1},style:{margin:`0 ${Yx}px`}},{props:{isDayOutsideMonth:!0,showDaysOutsideCurrentMonth:!0},style:{color:(n.vars||n).palette.text.secondary}},{props:{disableHighlightToday:!1,isDayCurrent:!0},style:{[`&:not(.${Su.selected})`]:{border:`1px solid ${(n.vars||n).palette.text.secondary}`}}}]}),Rj=(n,e)=>{const{ownerState:t}=n;return[e.root,!t.disableMargin&&e.dayWithMargin,!t.disableHighlightToday&&t.isDayCurrent&&e.today,!t.isDayOutsideMonth&&t.showDaysOutsideCurrentMonth&&e.dayOutsideMonth,t.isDayOutsideMonth&&!t.showDaysOutsideCurrentMonth&&e.hiddenDaySpacingFiller]},q7=lt(f4,{name:"MuiPickersDay",slot:"Root",overridesResolver:Rj})(Ij),G7=lt("div",{name:"MuiPickersDay",slot:"Root",overridesResolver:Rj})(({theme:n})=>se({},Ij({theme:n}),{opacity:0,pointerEvents:"none"})),Tm=()=>{},Mj=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiPickersDay"}),{autoFocus:r=!1,className:s,classes:a,isAnimating:o,onClick:l,onDaySelect:c,onFocus:u=Tm,onBlur:p=Tm,onKeyDown:m=Tm,onMouseDown:g=Tm,onMouseEnter:y=Tm,children:v,day:w,selected:k,disabled:S,today:E,outsideCurrentMonth:P,disableMargin:A,disableHighlightToday:N,showDaysOutsideCurrentMonth:R}=i,V=St(i,W7),B=Tj({day:w,selected:k,disabled:S,today:E,outsideCurrentMonth:P,disableMargin:A,disableHighlightToday:N,showDaysOutsideCurrentMonth:R}),L=H7(a,B),W=jn(),q=T.useRef(null),X=Cs(q,t);Dl(()=>{r&&!S&&!o&&!P&&q.current.focus()},[r,S,o,P]);const G=J=>{g(J),P&&J.preventDefault()},K=J=>{S||c(w),P&&J.currentTarget.focus(),l&&l(J)};return P&&!R?pe.jsx(G7,{className:tr(L.root,L.hiddenDaySpacingFiller,s),ownerState:B,role:V.role}):pe.jsx(q7,se({className:tr(L.root,s),ref:X,centerRipple:!0,disabled:S,tabIndex:k?0:-1,onKeyDown:J=>m(J,w),onFocus:J=>u(J,w),onBlur:J=>p(J,w),onMouseEnter:J=>y(J,w),onClick:K,onMouseDown:G},V,{ownerState:B,children:v||W.format(w,"dayOfMonth")}))});Mj.propTypes={action:D.oneOfType([D.func,D.shape({current:D.shape({focusVisible:D.func.isRequired})})]),centerRipple:D.bool,classes:D.object,className:D.string,component:D.elementType,day:D.object.isRequired,disabled:D.bool,disableHighlightToday:D.bool,disableMargin:D.bool,disableRipple:D.bool,disableTouchRipple:D.bool,focusRipple:D.bool,focusVisibleClassName:D.string,isAnimating:D.bool,isFirstVisibleCell:D.bool.isRequired,isLastVisibleCell:D.bool.isRequired,onBlur:D.func,onDaySelect:D.func.isRequired,onFocus:D.func,onFocusVisible:D.func,onKeyDown:D.func,onMouseEnter:D.func,outsideCurrentMonth:D.bool.isRequired,selected:D.bool,showDaysOutsideCurrentMonth:D.bool,style:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),tabIndex:D.number,today:D.bool,TouchRippleProps:D.object,touchRippleRef:D.oneOfType([D.func,D.shape({current:D.shape({pulsate:D.func.isRequired,start:D.func.isRequired,stop:D.func.isRequired})})])};const Y7=T.memo(Mj),X7=n=>Ci("MuiPickersSlideTransition",n),Ls=Ai("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),K7=["children","className","reduceAnimations","slideDirection","transKey","classes"],Q7=(n,e)=>{const{slideDirection:t}=e,i={root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:[`slideEnter-${t}`],exitActive:[`slideExitActiveLeft-${t}`]};return ei(i,X7,n)},J7=lt(PR,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(n,e)=>[e.root,{[`.${Ls["slideEnter-left"]}`]:e["slideEnter-left"]},{[`.${Ls["slideEnter-right"]}`]:e["slideEnter-right"]},{[`.${Ls.slideEnterActive}`]:e.slideEnterActive},{[`.${Ls.slideExit}`]:e.slideExit},{[`.${Ls["slideExitActiveLeft-left"]}`]:e["slideExitActiveLeft-left"]},{[`.${Ls["slideExitActiveLeft-right"]}`]:e["slideExitActiveLeft-right"]}]})(({theme:n})=>{const e=n.transitions.create("transform",{duration:n.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},[`& .${Ls["slideEnter-left"]}`]:{willChange:"transform",transform:"translate(100%)",zIndex:1},[`& .${Ls["slideEnter-right"]}`]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},[`& .${Ls.slideEnterActive}`]:{transform:"translate(0%)",transition:e},[`& .${Ls.slideExit}`]:{transform:"translate(0%)"},[`& .${Ls["slideExitActiveLeft-left"]}`]:{willChange:"transform",transform:"translate(-100%)",transition:e,zIndex:0},[`& .${Ls["slideExitActiveLeft-right"]}`]:{willChange:"transform",transform:"translate(100%)",transition:e,zIndex:0}}});function Z7(n){const e=Yn({props:n,name:"MuiPickersSlideTransition"}),{children:t,className:i,reduceAnimations:r,slideDirection:s,transKey:a,classes:o}=e,l=St(e,K7),{ownerState:c}=ir(),u=se({},c,{slideDirection:s}),p=Q7(o,u),m=oh();if(r)return pe.jsx("div",{className:tr(p.root,i),children:t});const g={exit:p.exit,enterActive:p.enterActive,enter:p.enter,exitActive:p.exitActive};return pe.jsx(J7,{className:tr(p.root,i),childFactory:y=>T.cloneElement(y,{classNames:g}),role:"presentation",ownerState:u,children:pe.jsx(m4,se({mountOnEnter:!0,unmountOnExit:!0,timeout:m.transitions.duration.complex,classNames:g},l,{children:t}),a)})}const eG=n=>Ci("MuiDayCalendar",n);Ai("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]);const tG=["parentProps","day","focusedDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"],nG=["ownerState"],iG=n=>ei({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},eG,n),jj=(Ng+Yx*2)*6,rG=lt("div",{name:"MuiDayCalendar",slot:"Root"})({}),sG=lt("div",{name:"MuiDayCalendar",slot:"Header"})({display:"flex",justifyContent:"center",alignItems:"center"}),aG=lt(ge,{name:"MuiDayCalendar",slot:"WeekDayLabel"})(({theme:n})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(n.vars||n).palette.text.secondary})),oG=lt(ge,{name:"MuiDayCalendar",slot:"WeekNumberLabel"})(({theme:n})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(n.vars||n).palette.text.disabled})),lG=lt(ge,{name:"MuiDayCalendar",slot:"WeekNumber"})(({theme:n})=>se({},n.typography.caption,{width:Ng,height:Ng,padding:0,margin:`0 ${Yx}px`,color:(n.vars||n).palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})),cG=lt("div",{name:"MuiDayCalendar",slot:"LoadingContainer"})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:jj}),uG=lt(Z7,{name:"MuiDayCalendar",slot:"SlideTransition"})({minHeight:jj}),dG=lt("div",{name:"MuiDayCalendar",slot:"MonthContainer"})({overflow:"hidden"}),hG=lt("div",{name:"MuiDayCalendar",slot:"WeekContainer"})({margin:`${Yx}px 0`,display:"flex",justifyContent:"center"});function pG(n){let{parentProps:e,day:t,focusedDay:i,selectedDays:r,isDateDisabled:s,currentMonthNumber:a,isViewFocused:o}=n,l=St(n,tG);const{disabled:c,disableHighlightToday:u,isMonthSwitchingAnimating:p,showDaysOutsideCurrentMonth:m,slots:g,slotProps:y,timezone:v}=e,w=jn(),k=Gx(v),S=i!=null&&w.isSameDay(t,i),E=o&&S,P=r.some(G=>w.isSameDay(G,t)),A=w.isSameDay(t,k),N=T.useMemo(()=>c||s(t),[c,s,t]),R=T.useMemo(()=>w.getMonth(t)!==a,[w,t,a]),V=Tj({day:t,selected:P,disabled:N,today:A,outsideCurrentMonth:R,disableMargin:void 0,disableHighlightToday:u,showDaysOutsideCurrentMonth:m}),B=(g==null?void 0:g.day)??Y7,L=pn({elementType:B,externalSlotProps:y==null?void 0:y.day,additionalProps:se({disableHighlightToday:u,showDaysOutsideCurrentMonth:m,role:"gridcell",isAnimating:p,"data-timestamp":w.toJsDate(t).valueOf()},l),ownerState:se({},V,{day:t,isDayDisabled:N,isDaySelected:P})}),W=St(L,nG),q=T.useMemo(()=>{const G=w.startOfMonth(w.setMonth(t,a));return m?w.isSameDay(t,w.startOfWeek(G)):w.isSameDay(t,G)},[a,t,m,w]),X=T.useMemo(()=>{const G=w.endOfMonth(w.setMonth(t,a));return m?w.isSameDay(t,w.endOfWeek(G)):w.isSameDay(t,G)},[a,t,m,w]);return pe.jsx(B,se({},W,{day:t,disabled:N,autoFocus:!R&&E,today:A,outsideCurrentMonth:R,isFirstVisibleCell:q,isLastVisibleCell:X,selected:P,tabIndex:S?0:-1,"aria-selected":P,"aria-current":A?"date":void 0}))}function fG(n){const e=Yn({props:n,name:"MuiDayCalendar"}),t=jn(),{onFocusedDayChange:i,className:r,classes:s,currentMonth:a,selectedDays:o,focusedDay:l,loading:c,onSelectedDaysChange:u,onMonthSwitchingAnimationEnd:p,readOnly:m,reduceAnimations:g,renderLoading:y=()=>pe.jsx("span",{children:"..."}),slideDirection:v,TransitionProps:w,disablePast:k,disableFuture:S,minDate:E,maxDate:P,shouldDisableDate:A,shouldDisableMonth:N,shouldDisableYear:R,dayOfWeekFormatter:V=we=>t.format(we,"weekdayShort").charAt(0).toUpperCase(),hasFocus:B,onFocusedViewChange:L,gridLabelId:W,displayWeekNumber:q,fixedWeekNumber:X,timezone:G}=e,K=Gx(G),J=iG(s),ee=El(),fe=Aj({shouldDisableDate:A,shouldDisableMonth:N,shouldDisableYear:R,minDate:E,maxDate:P,disablePast:k,disableFuture:S,timezone:G}),ae=au(),U=Ze(we=>{m||u(we)}),he=we=>{fe(we)||(i(we),L==null||L(!0))},ie=Ze((we,Ae)=>{switch(we.key){case"ArrowUp":he(t.addDays(Ae,-7)),we.preventDefault();break;case"ArrowDown":he(t.addDays(Ae,7)),we.preventDefault();break;case"ArrowLeft":{const _e=t.addDays(Ae,ee?1:-1),ye=t.addMonths(Ae,ee?1:-1),He=Eg({utils:t,date:_e,minDate:ee?_e:t.startOfMonth(ye),maxDate:ee?t.endOfMonth(ye):_e,isDateDisabled:fe,timezone:G});he(He||_e),we.preventDefault();break}case"ArrowRight":{const _e=t.addDays(Ae,ee?-1:1),ye=t.addMonths(Ae,ee?-1:1),He=Eg({utils:t,date:_e,minDate:ee?t.startOfMonth(ye):_e,maxDate:ee?_e:t.endOfMonth(ye),isDateDisabled:fe,timezone:G});he(He||_e),we.preventDefault();break}case"Home":he(t.startOfWeek(Ae)),we.preventDefault();break;case"End":he(t.endOfWeek(Ae)),we.preventDefault();break;case"PageUp":he(t.addMonths(Ae,1)),we.preventDefault();break;case"PageDown":he(t.addMonths(Ae,-1)),we.preventDefault();break}}),$=Ze((we,Ae)=>he(Ae)),Y=Ze((we,Ae)=>{l!=null&&t.isSameDay(l,Ae)&&(L==null||L(!1))}),oe=t.getMonth(a),be=t.getYear(a),xe=T.useMemo(()=>o.filter(we=>!!we).map(we=>t.startOfDay(we)),[t,o]),je=`${be}-${oe}`,ze=T.useMemo(()=>T.createRef(),[je]),Ve=T.useMemo(()=>{const we=t.getWeekArray(a);let Ae=t.addMonths(a,1);for(;X&&we.length<X;){const _e=t.getWeekArray(Ae),ye=t.isSameDay(we[we.length-1][0],_e[0][0]);_e.slice(ye?1:0).forEach(He=>{we.length<X&&we.push(He)}),Ae=t.addMonths(Ae,1)}return we},[a,X,t]);return pe.jsxs(rG,{role:"grid","aria-labelledby":W,className:J.root,children:[pe.jsxs(sG,{role:"row",className:J.header,children:[q&&pe.jsx(oG,{variant:"caption",role:"columnheader","aria-label":ae.calendarWeekNumberHeaderLabel,className:J.weekNumberLabel,children:ae.calendarWeekNumberHeaderText}),Kq(t,K).map((we,Ae)=>pe.jsx(aG,{variant:"caption",role:"columnheader","aria-label":t.format(we,"weekday"),className:J.weekDayLabel,children:V(we)},Ae.toString()))]}),c?pe.jsx(cG,{className:J.loadingContainer,children:y()}):pe.jsx(uG,se({transKey:je,onExited:p,reduceAnimations:g,slideDirection:v,className:tr(r,J.slideTransition)},w,{nodeRef:ze,children:pe.jsx(dG,{ref:ze,role:"rowgroup",className:J.monthContainer,children:Ve.map((we,Ae)=>pe.jsxs(hG,{role:"row",className:J.weekContainer,"aria-rowindex":Ae+1,children:[q&&pe.jsx(lG,{className:J.weekNumber,role:"rowheader","aria-label":ae.calendarWeekNumberAriaLabelText(t.getWeekNumber(we[0])),children:ae.calendarWeekNumberText(t.getWeekNumber(we[0]))}),we.map((_e,ye)=>pe.jsx(pG,{parentProps:e,day:_e,selectedDays:xe,isViewFocused:B,focusedDay:l,onKeyDown:ie,onFocus:$,onBlur:Y,onDaySelect:U,isDateDisabled:fe,currentMonthNumber:oe,"aria-colindex":ye+1},_e.toString()))]},`week-${we[0]}`))})}))]})}function Oj(n){return Ci("MuiMonthCalendar",n)}const Iv=Ai("MuiMonthCalendar",["root","button","disabled","selected"]),mG=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],gG=(n,e)=>{const t={button:["button",e.isMonthDisabled&&"disabled",e.isMonthSelected&&"selected"]};return ei(t,Oj,n)},bG=lt("button",{name:"MuiMonthCalendar",slot:"Button",overridesResolver:(n,e)=>[e.button,{[`&.${Iv.disabled}`]:e.disabled},{[`&.${Iv.selected}`]:e.selected}]})(({theme:n})=>se({color:"unset",backgroundColor:"transparent",border:0,outline:0},n.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:n.vars?`rgba(${n.vars.palette.action.activeChannel} / ${n.vars.palette.action.hoverOpacity})`:Qe(n.palette.action.active,n.palette.action.hoverOpacity)},"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette.action.activeChannel} / ${n.vars.palette.action.hoverOpacity})`:Qe(n.palette.action.active,n.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${Iv.disabled}`]:{color:(n.vars||n).palette.text.secondary},[`&.${Iv.selected}`]:{color:(n.vars||n).palette.primary.contrastText,backgroundColor:(n.vars||n).palette.primary.main,"&:focus, &:hover":{backgroundColor:(n.vars||n).palette.primary.dark}}})),yG=T.memo(function(e){const{autoFocus:t,classes:i,disabled:r,selected:s,value:a,onClick:o,onKeyDown:l,onFocus:c,onBlur:u,slots:p,slotProps:m}=e,g=St(e,mG),y=T.useRef(null),{ownerState:v}=ir(),w=se({},v,{isMonthDisabled:r,isMonthSelected:s}),k=gG(i,w);Dl(()=>{var P;t&&((P=y.current)==null||P.focus())},[t]);const S=(p==null?void 0:p.monthButton)??bG,E=pn({elementType:S,externalSlotProps:m==null?void 0:m.monthButton,externalForwardedProps:g,additionalProps:{disabled:r,ref:y,type:"button",role:"radio","aria-checked":s,onClick:P=>o(P,a),onKeyDown:P=>l(P,a),onFocus:P=>c(P,a),onBlur:P=>u(P,a)},ownerState:w,className:k.button});return pe.jsx(S,se({},E))}),vG=["autoFocus","className","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId","slots","slotProps"],xG=n=>ei({root:["root"]},Oj,n);function wG(n,e){const t=Yn({props:n,name:e}),i=vy(t);return se({},t,i,{monthsPerRow:t.monthsPerRow??3})}const kG=lt("div",{name:"MuiMonthCalendar",slot:"Root",shouldForwardProp:n=>lh(n)&&n!=="monthsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:16,padding:"8px 0",width:Xx,boxSizing:"border-box",variants:[{props:{monthsPerRow:3},style:{columnGap:24}},{props:{monthsPerRow:4},style:{columnGap:0}}]}),Lj=T.forwardRef(function(e,t){const i=wG(e,"MuiMonthCalendar"),{autoFocus:r,className:s,classes:a,value:o,defaultValue:l,referenceDate:c,disabled:u,disableFuture:p,disablePast:m,maxDate:g,minDate:y,onChange:v,shouldDisableMonth:w,readOnly:k,onMonthFocus:S,hasFocus:E,onFocusedViewChange:P,monthsPerRow:A,timezone:N,gridLabelId:R,slots:V,slotProps:B}=i,L=St(i,vG),{value:W,handleValueChange:q,timezone:X}=xy({name:"MonthCalendar",timezone:N,value:o,defaultValue:l,referenceDate:c,onChange:v,valueManager:mo}),G=Gx(X),K=El(),J=jn(),{ownerState:ee}=ir(),fe=T.useMemo(()=>mo.getInitialReferenceValue({value:W,utils:J,props:i,timezone:X,referenceDate:c,granularity:po.month}),[]),ae=xG(a),U=T.useMemo(()=>J.getMonth(G),[J,G]),he=T.useMemo(()=>W!=null?J.getMonth(W):null,[W,J]),[ie,$]=T.useState(()=>he||J.getMonth(fe)),[Y,oe]=Hf({name:"MonthCalendar",state:"hasFocus",controlled:E,default:r??!1}),be=Ze(_e=>{oe(_e),P&&P(_e)}),xe=T.useCallback(_e=>{const ye=J.startOfMonth(m&&J.isAfter(G,y)?G:y),He=J.startOfMonth(p&&J.isBefore(G,g)?G:g),Re=J.startOfMonth(_e);return J.isBefore(Re,ye)||J.isAfter(Re,He)?!0:w?w(Re):!1},[p,m,g,y,G,w,J]),je=Ze((_e,ye)=>{if(k)return;const He=J.setMonth(W??fe,ye);q(He)}),ze=Ze(_e=>{xe(J.setMonth(W??fe,_e))||($(_e),be(!0),S&&S(_e))});T.useEffect(()=>{$(_e=>he!==null&&_e!==he?he:_e)},[he]);const Ve=Ze((_e,ye)=>{switch(_e.key){case"ArrowUp":ze((12+ye-3)%12),_e.preventDefault();break;case"ArrowDown":ze((12+ye+3)%12),_e.preventDefault();break;case"ArrowLeft":ze((12+ye+(K?1:-1))%12),_e.preventDefault();break;case"ArrowRight":ze((12+ye+(K?-1:1))%12),_e.preventDefault();break}}),we=Ze((_e,ye)=>{ze(ye)}),Ae=Ze((_e,ye)=>{ie===ye&&be(!1)});return pe.jsx(kG,se({ref:t,className:tr(ae.root,s),ownerState:ee,role:"radiogroup","aria-labelledby":R,monthsPerRow:A},L,{children:TE(J,W??fe).map(_e=>{const ye=J.getMonth(_e),He=J.format(_e,"monthShort"),Re=J.format(_e,"month"),et=ye===he,Be=u||xe(_e);return pe.jsx(yG,{selected:et,value:ye,onClick:je,onKeyDown:Ve,autoFocus:Y&&ye===ie,disabled:Be,tabIndex:ye===ie&&!Be?0:-1,onFocus:we,onBlur:Ae,"aria-current":U===ye?"date":void 0,"aria-label":Re,slots:V,slotProps:B,classes:a,children:He},He)})}))});Lj.propTypes={autoFocus:D.bool,classes:D.object,className:D.string,defaultValue:D.object,disabled:D.bool,disableFuture:D.bool,disableHighlightToday:D.bool,disablePast:D.bool,gridLabelId:D.string,hasFocus:D.bool,maxDate:D.object,minDate:D.object,monthsPerRow:D.oneOf([3,4]),onChange:D.func,onFocusedViewChange:D.func,onMonthFocus:D.func,readOnly:D.bool,referenceDate:D.object,shouldDisableMonth:D.func,slotProps:D.object,slots:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),timezone:D.string,value:D.object};function Fj(n){return Ci("MuiYearCalendar",n)}const Rv=Ai("MuiYearCalendar",["root","button","disabled","selected"]),DG=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],SG=(n,e)=>{const t={button:["button",e.isYearDisabled&&"disabled",e.isYearSelected&&"selected"]};return ei(t,Fj,n)},EG=lt("button",{name:"MuiYearCalendar",slot:"Button",overridesResolver:(n,e)=>[e.button,{[`&.${Rv.disabled}`]:e.disabled},{[`&.${Rv.selected}`]:e.selected}]})(({theme:n})=>se({color:"unset",backgroundColor:"transparent",border:0,outline:0},n.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:n.vars?`rgba(${n.vars.palette.action.activeChannel} / ${n.vars.palette.action.focusOpacity})`:Qe(n.palette.action.active,n.palette.action.focusOpacity)},"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette.action.activeChannel} / ${n.vars.palette.action.hoverOpacity})`:Qe(n.palette.action.active,n.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${Rv.disabled}`]:{color:(n.vars||n).palette.text.secondary},[`&.${Rv.selected}`]:{color:(n.vars||n).palette.primary.contrastText,backgroundColor:(n.vars||n).palette.primary.main,"&:focus, &:hover":{backgroundColor:(n.vars||n).palette.primary.dark}}})),NG=T.memo(function(e){const{autoFocus:t,classes:i,disabled:r,selected:s,value:a,onClick:o,onKeyDown:l,onFocus:c,onBlur:u,slots:p,slotProps:m}=e,g=St(e,DG),y=T.useRef(null),{ownerState:v}=ir(),w=se({},v,{isYearDisabled:r,isYearSelected:s}),k=SG(i,w);Dl(()=>{var P;t&&((P=y.current)==null||P.focus())},[t]);const S=(p==null?void 0:p.yearButton)??EG,E=pn({elementType:S,externalSlotProps:m==null?void 0:m.yearButton,externalForwardedProps:g,additionalProps:{disabled:r,ref:y,type:"button",role:"radio","aria-checked":s,onClick:P=>o(P,a),onKeyDown:P=>l(P,a),onFocus:P=>c(P,a),onBlur:P=>u(P,a)},ownerState:w,className:k.button});return pe.jsx(S,se({},E))}),_G=["autoFocus","className","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsOrder","yearsPerRow","timezone","gridLabelId","slots","slotProps"],CG=n=>ei({root:["root"]},Fj,n);function AG(n,e){const t=Yn({props:n,name:e}),i=vy(t);return se({},t,i,{yearsPerRow:t.yearsPerRow??3,yearsOrder:t.yearsOrder??"asc"})}const PG=lt("div",{name:"MuiYearCalendar",slot:"Root",shouldForwardProp:n=>lh(n)&&n!=="yearsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:12,padding:"6px 0",overflowY:"auto",height:"100%",width:Xx,maxHeight:u9,boxSizing:"border-box",position:"relative",variants:[{props:{yearsPerRow:3},style:{columnGap:24}},{props:{yearsPerRow:4},style:{columnGap:0,padding:"0 2px"}}]}),TG=lt("div",{name:"MuiYearCalendar",slot:"ButtonFiller"})({height:36,width:72}),Vj=T.forwardRef(function(e,t){const i=AG(e,"MuiYearCalendar"),{autoFocus:r,className:s,classes:a,value:o,defaultValue:l,referenceDate:c,disabled:u,disableFuture:p,disablePast:m,maxDate:g,minDate:y,onChange:v,readOnly:w,shouldDisableYear:k,onYearFocus:S,hasFocus:E,onFocusedViewChange:P,yearsOrder:A,yearsPerRow:N,timezone:R,gridLabelId:V,slots:B,slotProps:L}=i,W=St(i,_G),{value:q,handleValueChange:X,timezone:G}=xy({name:"YearCalendar",timezone:R,value:o,defaultValue:l,referenceDate:c,onChange:v,valueManager:mo}),K=Gx(G),J=El(),ee=jn(),{ownerState:fe}=ir(),ae=T.useMemo(()=>mo.getInitialReferenceValue({value:q,utils:ee,props:i,timezone:G,referenceDate:c,granularity:po.year}),[]),U=CG(a),he=T.useMemo(()=>ee.getYear(K),[ee,K]),ie=T.useMemo(()=>q!=null?ee.getYear(q):null,[q,ee]),[$,Y]=T.useState(()=>ie||ee.getYear(ae)),[oe,be]=Hf({name:"YearCalendar",state:"hasFocus",controlled:E,default:r??!1}),xe=Ze(Xe=>{be(Xe),P&&P(Xe)}),je=T.useCallback(Xe=>{if(m&&ee.isBeforeYear(Xe,K)||p&&ee.isAfterYear(Xe,K)||y&&ee.isBeforeYear(Xe,y)||g&&ee.isAfterYear(Xe,g))return!0;if(!k)return!1;const ct=ee.startOfYear(Xe);return k(ct)},[p,m,g,y,K,k,ee]),ze=Ze((Xe,ct)=>{if(w)return;const tn=ee.setYear(q??ae,ct);X(tn)}),Ve=Ze(Xe=>{je(ee.setYear(q??ae,Xe))||(Y(Xe),xe(!0),S==null||S(Xe))});T.useEffect(()=>{Y(Xe=>ie!==null&&Xe!==ie?ie:Xe)},[ie]);const we=A!=="desc"?N*1:N*-1,Ae=J&&A==="asc"||!J&&A==="desc"?-1:1,_e=Ze((Xe,ct)=>{switch(Xe.key){case"ArrowUp":Ve(ct-we),Xe.preventDefault();break;case"ArrowDown":Ve(ct+we),Xe.preventDefault();break;case"ArrowLeft":Ve(ct-Ae),Xe.preventDefault();break;case"ArrowRight":Ve(ct+Ae),Xe.preventDefault();break}}),ye=Ze((Xe,ct)=>{Ve(ct)}),He=Ze((Xe,ct)=>{$===ct&&xe(!1)}),Re=T.useRef(null),et=Cs(t,Re);T.useEffect(()=>{if(r||Re.current===null)return;const Xe=Re.current.querySelector('[tabindex="0"]');if(!Xe)return;const ct=Xe.offsetHeight,tn=Xe.offsetTop,on=Re.current.clientHeight,Oe=Re.current.scrollTop,Ge=tn+ct;ct>on||tn<Oe||(Re.current.scrollTop=Ge-on/2-ct/2)},[r]);const Be=ee.getYearRange([y,g]);A==="desc"&&Be.reverse();let mt=N-Be.length%N;return mt===N&&(mt=0),pe.jsxs(PG,se({ref:et,className:tr(U.root,s),ownerState:fe,role:"radiogroup","aria-labelledby":V,yearsPerRow:N},W,{children:[Be.map(Xe=>{const ct=ee.getYear(Xe),tn=ct===ie,on=u||je(Xe);return pe.jsx(NG,{selected:tn,value:ct,onClick:ze,onKeyDown:_e,autoFocus:oe&&ct===$,disabled:on,tabIndex:ct===$&&!on?0:-1,onFocus:ye,onBlur:He,"aria-current":he===ct?"date":void 0,slots:B,slotProps:L,classes:a,children:ee.format(Xe,"year")},ee.format(Xe,"year"))}),Array.from({length:mt},(Xe,ct)=>pe.jsx(TG,{},ct))]}))});Vj.propTypes={autoFocus:D.bool,classes:D.object,className:D.string,defaultValue:D.object,disabled:D.bool,disableFuture:D.bool,disableHighlightToday:D.bool,disablePast:D.bool,gridLabelId:D.string,hasFocus:D.bool,maxDate:D.object,minDate:D.object,onChange:D.func,onFocusedViewChange:D.func,onYearFocus:D.func,readOnly:D.bool,referenceDate:D.object,shouldDisableYear:D.func,slotProps:D.object,slots:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),timezone:D.string,value:D.object,yearsOrder:D.oneOf(["asc","desc"]),yearsPerRow:D.oneOf([3,4])};const IG=n=>Ci("MuiPickersCalendarHeader",n),RG=Ai("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]);function MG(n){return Ci("MuiPickersArrowSwitcher",n)}Ai("MuiPickersArrowSwitcher",["root","spacer","button","previousIconButton","nextIconButton","leftArrowIcon","rightArrowIcon"]);const jG=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel","labelId","classes"],OG=["ownerState"],LG=["ownerState"],FG=lt("div",{name:"MuiPickersArrowSwitcher",slot:"Root"})({display:"flex"}),VG=lt("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer"})(({theme:n})=>({width:n.spacing(3)})),WP=lt(ut,{name:"MuiPickersArrowSwitcher",slot:"Button"})({variants:[{props:{isButtonHidden:!0},style:{visibility:"hidden"}}]}),UG=n=>ei({root:["root"],spacer:["spacer"],button:["button"],previousIconButton:["previousIconButton"],nextIconButton:["nextIconButton"],leftArrowIcon:["leftArrowIcon"],rightArrowIcon:["rightArrowIcon"]},MG,n),zG=T.forwardRef(function(e,t){const i=El(),r=Yn({props:e,name:"MuiPickersArrowSwitcher"}),{children:s,className:a,slots:o,slotProps:l,isNextDisabled:c,isNextHidden:u,onGoToNext:p,nextLabel:m,isPreviousDisabled:g,isPreviousHidden:y,onGoToPrevious:v,previousLabel:w,labelId:k,classes:S}=r,E=St(r,jG),{ownerState:P}=ir(),A=UG(S),N={isDisabled:c,isHidden:u,goTo:p,label:m},R={isDisabled:g,isHidden:y,goTo:v,label:w},V=(o==null?void 0:o.previousIconButton)??WP,B=pn({elementType:V,externalSlotProps:l==null?void 0:l.previousIconButton,additionalProps:{size:"medium",title:R.label,"aria-label":R.label,disabled:R.isDisabled,edge:"end",onClick:R.goTo},ownerState:se({},P,{isButtonHidden:R.isHidden??!1}),className:tr(A.button,A.previousIconButton)}),L=(o==null?void 0:o.nextIconButton)??WP,W=pn({elementType:L,externalSlotProps:l==null?void 0:l.nextIconButton,additionalProps:{size:"medium",title:N.label,"aria-label":N.label,disabled:N.isDisabled,edge:"start",onClick:N.goTo},ownerState:se({},P,{isButtonHidden:N.isHidden??!1}),className:tr(A.button,A.nextIconButton)}),q=(o==null?void 0:o.leftArrowIcon)??k9,X=pn({elementType:q,externalSlotProps:l==null?void 0:l.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:P,className:A.leftArrowIcon}),G=St(X,OG),K=(o==null?void 0:o.rightArrowIcon)??D9,J=pn({elementType:K,externalSlotProps:l==null?void 0:l.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:P,className:A.rightArrowIcon}),ee=St(J,LG);return pe.jsxs(FG,se({ref:t,className:tr(A.root,a),ownerState:P},E,{children:[pe.jsx(V,se({},B,{children:i?pe.jsx(K,se({},ee)):pe.jsx(q,se({},G))})),s?pe.jsx(ge,{variant:"subtitle1",component:"span",id:k,children:s}):pe.jsx(VG,{className:A.spacer,ownerState:P}),pe.jsx(L,se({},W,{children:i?pe.jsx(q,se({},G)):pe.jsx(K,se({},ee))}))]}))});function BG(n,{disableFuture:e,maxDate:t,timezone:i}){const r=jn();return T.useMemo(()=>{const s=r.date(void 0,i),a=r.startOfMonth(e&&r.isBefore(s,t)?s:t);return!r.isAfter(a,n)},[e,t,n,r,i])}function $G(n,{disablePast:e,minDate:t,timezone:i}){const r=jn();return T.useMemo(()=>{const s=r.date(void 0,i),a=r.startOfMonth(e&&r.isAfter(s,t)?s:t);return!r.isBefore(a,n)},[e,t,n,r,i])}const WG=["slots","slotProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","classes","timezone","format"],HG=["ownerState"],qG=n=>ei({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},IG,n),GG=lt("div",{name:"MuiPickersCalendarHeader",slot:"Root"})({display:"flex",alignItems:"center",marginTop:12,marginBottom:4,paddingLeft:24,paddingRight:12,maxHeight:40,minHeight:40}),YG=lt("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer"})(({theme:n})=>se({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},n.typography.body1,{fontWeight:n.typography.fontWeightMedium})),XG=lt("div",{name:"MuiPickersCalendarHeader",slot:"Label"})({marginRight:6}),KG=lt(ut,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton"})({marginRight:"auto",variants:[{props:{view:"year"},style:{[`.${RG.switchViewIcon}`]:{transform:"rotate(180deg)"}}}]}),QG=lt(w9,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon"})(({theme:n})=>({willChange:"transform",transition:n.transitions.create("transform"),transform:"rotate(0deg)"})),Uj=T.forwardRef(function(e,t){const i=au(),r=jn(),s=Yn({props:e,name:"MuiPickersCalendarHeader"}),{slots:a,slotProps:o,currentMonth:l,disabled:c,disableFuture:u,disablePast:p,maxDate:m,minDate:g,onMonthChange:y,onViewChange:v,view:w,reduceAnimations:k,views:S,labelId:E,className:P,classes:A,timezone:N,format:R=`${r.formats.month} ${r.formats.year}`}=s,V=St(s,WG),{ownerState:B}=ir(),L=qG(A),W=(a==null?void 0:a.switchViewButton)??KG,q=pn({elementType:W,externalSlotProps:o==null?void 0:o.switchViewButton,additionalProps:{size:"small","aria-label":i.calendarViewSwitchingButtonAriaLabel(w)},ownerState:B,className:L.switchViewButton}),X=(a==null?void 0:a.switchViewIcon)??QG,G=pn({elementType:X,externalSlotProps:o==null?void 0:o.switchViewIcon,ownerState:B,className:L.switchViewIcon}),K=St(G,HG),J=()=>y(r.addMonths(l,1)),ee=()=>y(r.addMonths(l,-1)),fe=BG(l,{disableFuture:u,maxDate:m,timezone:N}),ae=$G(l,{disablePast:p,minDate:g,timezone:N}),U=()=>{if(!(S.length===1||!v||c))if(S.length===2)v(S.find(ie=>ie!==w)||S[0]);else{const ie=S.indexOf(w)!==0?0:1;v(S[ie])}};if(S.length===1&&S[0]==="year")return null;const he=r.formatByString(l,R);return pe.jsxs(GG,se({},V,{ownerState:B,className:tr(L.root,P),ref:t,children:[pe.jsxs(YG,{role:"presentation",onClick:U,ownerState:B,"aria-live":"polite",className:L.labelContainer,children:[pe.jsx(Pj,{reduceAnimations:k,transKey:he,children:pe.jsx(XG,{id:E,ownerState:B,className:L.label,children:he})}),S.length>1&&!c&&pe.jsx(W,se({},q,{children:pe.jsx(X,se({},K))}))]}),pe.jsx(Ox,{in:w==="day",appear:!k,enter:!k,children:pe.jsx(zG,{slots:a,slotProps:o,onGoToPrevious:ee,isPreviousDisabled:ae,previousLabel:i.previousMonth,onGoToNext:J,isNextDisabled:fe,nextLabel:i.nextMonth})})]}))});Uj.propTypes={classes:D.object,className:D.string,currentMonth:D.object.isRequired,disabled:D.bool,disableFuture:D.bool,disablePast:D.bool,format:D.string,labelId:D.string,maxDate:D.object.isRequired,minDate:D.object.isRequired,onMonthChange:D.func.isRequired,onViewChange:D.func,reduceAnimations:D.bool.isRequired,slotProps:D.object,slots:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),timezone:D.string.isRequired,view:D.oneOf(["day","month","year"]).isRequired,views:D.arrayOf(D.oneOf(["day","month","year"]).isRequired).isRequired};const JG=lt("div")({overflow:"hidden",width:Xx,maxHeight:VE,display:"flex",flexDirection:"column",margin:"0 auto"}),ZG=n=>Ci("MuiDateCalendar",n);Ai("MuiDateCalendar",["root","viewTransitionContainer"]);const eY=["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","classes","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsOrder","yearsPerRow","monthsPerRow","timezone"],tY=n=>ei({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},ZG,n);function nY(n,e){const t=Yn({props:n,name:e}),i=cj(t.reduceAnimations),r=vy(t);return se({},t,r,{loading:t.loading??!1,openTo:t.openTo??"day",views:t.views??["year","day"],reduceAnimations:i,renderLoading:t.renderLoading??(()=>pe.jsx("span",{children:"..."}))})}const iY=lt(JG,{name:"MuiDateCalendar",slot:"Root"})({display:"flex",flexDirection:"column",height:VE}),rY=lt(Pj,{name:"MuiDateCalendar",slot:"ViewTransitionContainer"})({}),zj=T.forwardRef(function(e,t){const i=jn(),{ownerState:r}=ir(),s=Fx(),a=nY(e,"MuiDateCalendar"),{autoFocus:o,onViewChange:l,value:c,defaultValue:u,referenceDate:p,disableFuture:m,disablePast:g,onChange:y,onMonthChange:v,reduceAnimations:w,shouldDisableDate:k,shouldDisableMonth:S,shouldDisableYear:E,view:P,views:A,openTo:N,className:R,classes:V,disabled:B,readOnly:L,minDate:W,maxDate:q,disableHighlightToday:X,focusedView:G,onFocusedViewChange:K,showDaysOutsideCurrentMonth:J,fixedWeekNumber:ee,dayOfWeekFormatter:fe,slots:ae,slotProps:U,loading:he,renderLoading:ie,displayWeekNumber:$,yearsOrder:Y,yearsPerRow:oe,monthsPerRow:be,timezone:xe}=a,je=St(a,eY),{value:ze,handleValueChange:Ve,timezone:we}=xy({name:"DateCalendar",timezone:xe,value:c,defaultValue:u,referenceDate:p,onChange:y,valueManager:mo}),{view:Ae,setView:_e,focusedView:ye,setFocusedView:He,goToNextView:Re,setValueAndGoToNextView:et}=dj({view:P,views:A,openTo:N,onChange:Ve,onViewChange:l,autoFocus:o,focusedView:G,onFocusedViewChange:K}),{referenceDate:Be,calendarState:mt,setVisibleDate:Xe,isDateDisabled:ct,onMonthSwitchingAnimationEnd:tn}=F7({value:ze,referenceDate:p,reduceAnimations:w,onMonthChange:v,minDate:W,maxDate:q,shouldDisableDate:k,disablePast:g,disableFuture:m,timezone:we,getCurrentMonthFromVisibleDate:(ke,ot)=>i.isSameMonth(ke,ot)?ot:i.startOfMonth(ke)}),on=B&&ze||W,Oe=B&&ze||q,Ge=`${s}-grid-label`,ue=ye!==null,de=(ae==null?void 0:ae.calendarHeader)??Uj,Pe=pn({elementType:de,externalSlotProps:U==null?void 0:U.calendarHeader,additionalProps:{views:A,view:Ae,currentMonth:mt.currentMonth,onViewChange:_e,onMonthChange:ke=>Xe({target:ke,reason:"header-navigation"}),minDate:on,maxDate:Oe,disabled:B,disablePast:g,disableFuture:m,reduceAnimations:w,timezone:we,labelId:Ge},ownerState:r}),Le=Ze(ke=>{const ot=i.startOfMonth(ke),Bt=i.endOfMonth(ke),dn=ct(ke)?Eg({utils:i,date:ke,minDate:i.isBefore(W,ot)?ot:W,maxDate:i.isAfter(q,Bt)?Bt:q,disablePast:g,disableFuture:m,isDateDisabled:ct,timezone:we}):ke;dn?(et(dn,"finish"),Xe({target:dn,reason:"cell-interaction"})):(Re(),Xe({target:ot,reason:"cell-interaction"}))}),$e=Ze(ke=>{const ot=i.startOfYear(ke),Bt=i.endOfYear(ke),dn=ct(ke)?Eg({utils:i,date:ke,minDate:i.isBefore(W,ot)?ot:W,maxDate:i.isAfter(q,Bt)?Bt:q,disablePast:g,disableFuture:m,isDateDisabled:ct,timezone:we}):ke;dn?(et(dn,"finish"),Xe({target:dn,reason:"cell-interaction"})):(Re(),Xe({target:ot,reason:"cell-interaction"}))}),ht=Ze(ke=>Ve(ke&&X0(i,ke,ze??Be),"finish",Ae));T.useEffect(()=>{i.isValid(ze)&&Xe({target:ze,reason:"controlled-value-change"})},[ze]);const Et=tY(V),Ut={disablePast:g,disableFuture:m,maxDate:q,minDate:W},zt={disableHighlightToday:X,readOnly:L,disabled:B,timezone:we,gridLabelId:Ge,slots:ae,slotProps:U},Te=T.useRef(Ae);T.useEffect(()=>{Te.current!==Ae&&(ye===Te.current&&He(Ae,!0),Te.current=Ae)},[ye,He,Ae]);const Ue=T.useMemo(()=>[ze],[ze]);return pe.jsxs(iY,se({ref:t,className:tr(Et.root,R),ownerState:r},je,{children:[pe.jsx(de,se({},Pe,{slots:ae,slotProps:U})),pe.jsx(rY,{reduceAnimations:w,className:Et.viewTransitionContainer,transKey:Ae,ownerState:r,children:pe.jsxs("div",{children:[Ae==="year"&&pe.jsx(Vj,se({},Ut,zt,{value:ze,onChange:$e,shouldDisableYear:E,hasFocus:ue,onFocusedViewChange:ke=>He("year",ke),yearsOrder:Y,yearsPerRow:oe,referenceDate:Be})),Ae==="month"&&pe.jsx(Lj,se({},Ut,zt,{hasFocus:ue,className:R,value:ze,onChange:Le,shouldDisableMonth:S,onFocusedViewChange:ke=>He("month",ke),monthsPerRow:be,referenceDate:Be})),Ae==="day"&&pe.jsx(fG,se({},mt,Ut,zt,{onMonthSwitchingAnimationEnd:tn,hasFocus:ue,onFocusedDayChange:ke=>Xe({target:ke,reason:"cell-interaction"}),reduceAnimations:w,selectedDays:Ue,onSelectedDaysChange:ht,shouldDisableDate:k,shouldDisableMonth:S,shouldDisableYear:E,onFocusedViewChange:ke=>He("day",ke),showDaysOutsideCurrentMonth:J,fixedWeekNumber:ee,dayOfWeekFormatter:fe,displayWeekNumber:$,loading:he,renderLoading:ie}))]})})]}))});zj.propTypes={autoFocus:D.bool,classes:D.object,className:D.string,dayOfWeekFormatter:D.func,defaultValue:D.object,disabled:D.bool,disableFuture:D.bool,disableHighlightToday:D.bool,disablePast:D.bool,displayWeekNumber:D.bool,fixedWeekNumber:D.number,focusedView:D.oneOf(["day","month","year"]),loading:D.bool,maxDate:D.object,minDate:D.object,monthsPerRow:D.oneOf([3,4]),onChange:D.func,onFocusedViewChange:D.func,onMonthChange:D.func,onViewChange:D.func,onYearChange:D.func,openTo:D.oneOf(["day","month","year"]),readOnly:D.bool,reduceAnimations:D.bool,referenceDate:D.object,renderLoading:D.func,shouldDisableDate:D.func,shouldDisableMonth:D.func,shouldDisableYear:D.func,showDaysOutsideCurrentMonth:D.bool,slotProps:D.object,slots:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),timezone:D.string,value:D.object,view:D.oneOf(["day","month","year"]),views:D.arrayOf(D.oneOf(["day","month","year"]).isRequired),yearsOrder:D.oneOf(["asc","desc"]),yearsPerRow:D.oneOf([3,4])};const vp=({view:n,onViewChange:e,views:t,focusedView:i,onFocusedViewChange:r,value:s,defaultValue:a,referenceDate:o,onChange:l,className:c,classes:u,disableFuture:p,disablePast:m,minDate:g,maxDate:y,shouldDisableDate:v,shouldDisableMonth:w,shouldDisableYear:k,reduceAnimations:S,onMonthChange:E,monthsPerRow:P,onYearChange:A,yearsOrder:N,yearsPerRow:R,slots:V,slotProps:B,loading:L,renderLoading:W,disableHighlightToday:q,readOnly:X,disabled:G,showDaysOutsideCurrentMonth:K,dayOfWeekFormatter:J,sx:ee,autoFocus:fe,fixedWeekNumber:ae,displayWeekNumber:U,timezone:he})=>pe.jsx(zj,{view:n,onViewChange:e,views:t.filter(EP),focusedView:i&&EP(i)?i:null,onFocusedViewChange:r,value:s,defaultValue:a,referenceDate:o,onChange:l,className:c,classes:u,disableFuture:p,disablePast:m,minDate:g,maxDate:y,shouldDisableDate:v,shouldDisableMonth:w,shouldDisableYear:k,reduceAnimations:S,onMonthChange:E,monthsPerRow:P,onYearChange:A,yearsOrder:N,yearsPerRow:R,slots:V,slotProps:B,loading:L,renderLoading:W,disableHighlightToday:q,readOnly:X,disabled:G,showDaysOutsideCurrentMonth:K,dayOfWeekFormatter:J,sx:ee,autoFocus:fe,fixedWeekNumber:ae,displayWeekNumber:U,timezone:he}),Bj=T.forwardRef(function(e,t){var l;const i=jn(),r=lj(e,"MuiDesktopDatePicker"),s=se({day:vp,month:vp,year:vp},r.viewRenderers),a=se({},r,{closeOnSelect:r.closeOnSelect??!0,viewRenderers:s,format:IE(i,r,!1),yearsPerRow:r.yearsPerRow??4,slots:se({field:XE},r.slots),slotProps:se({},r.slotProps,{field:c=>{var u;return se({},L0((u=r.slotProps)==null?void 0:u.field,c),rj(r))},toolbar:se({hidden:!0},(l=r.slotProps)==null?void 0:l.toolbar)})}),{renderPicker:o}=w7({ref:t,props:a,valueManager:mo,valueType:"date",validator:yy,steps:null});return o()});Bj.propTypes={autoFocus:D.bool,className:D.string,closeOnSelect:D.bool,dayOfWeekFormatter:D.func,defaultValue:D.object,disabled:D.bool,disableFuture:D.bool,disableHighlightToday:D.bool,disableOpenPicker:D.bool,disablePast:D.bool,displayWeekNumber:D.bool,enableAccessibleFieldDOMStructure:D.any,fixedWeekNumber:D.number,format:D.string,formatDensity:D.oneOf(["dense","spacious"]),inputRef:Nl,label:D.node,loading:D.bool,localeText:D.object,maxDate:D.object,minDate:D.object,monthsPerRow:D.oneOf([3,4]),name:D.string,onAccept:D.func,onChange:D.func,onClose:D.func,onError:D.func,onMonthChange:D.func,onOpen:D.func,onSelectedSectionsChange:D.func,onViewChange:D.func,onYearChange:D.func,open:D.bool,openTo:D.oneOf(["day","month","year"]),orientation:D.oneOf(["landscape","portrait"]),readOnly:D.bool,reduceAnimations:D.bool,referenceDate:D.object,renderLoading:D.func,selectedSections:D.oneOfType([D.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),D.number]),shouldDisableDate:D.func,shouldDisableMonth:D.func,shouldDisableYear:D.func,showDaysOutsideCurrentMonth:D.bool,slotProps:D.object,slots:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),timezone:D.string,value:D.object,view:D.oneOf(["day","month","year"]),viewRenderers:D.shape({day:D.func,month:D.func,year:D.func}),views:D.arrayOf(D.oneOf(["day","month","year"]).isRequired),yearsOrder:D.oneOf(["asc","desc"]),yearsPerRow:D.oneOf([3,4])};const sY=lt(uh)({[`& .${uA.container}`]:{outline:0},[`& .${uA.paper}`]:{outline:0,minWidth:Xx}}),aY=lt(dh)({"&:first-of-type":{padding:0}});function oY(n){const{children:e,slots:t,slotProps:i}=n,{open:r}=nm(),{dismissViews:s}=ir(),a=(t==null?void 0:t.dialog)??sY,o=(t==null?void 0:t.mobileTransition)??Ox;return pe.jsx(a,se({open:r,onClose:s},i==null?void 0:i.dialog,{TransitionComponent:o,TransitionProps:i==null?void 0:i.mobileTransition,PaperComponent:t==null?void 0:t.mobilePaper,PaperProps:i==null?void 0:i.mobilePaper,children:pe.jsx(aY,{children:e})}))}const lY=["props","steps"],cY=["ownerState"],uY=n=>{var N;let{props:e,steps:t}=n,i=St(n,lY);const{slots:r,slotProps:s,label:a,inputRef:o,localeText:l}=e,c=Sj({steps:t}),{providerProps:u,renderCurrentView:p,ownerState:m}=hj(se({},i,{props:e,localeText:l,autoFocusView:!0,viewContainerRole:"dialog",variant:"mobile",getStepNavigation:c})),g=u.privateContextValue.labelId,y=((N=s==null?void 0:s.toolbar)==null?void 0:N.hidden)??!1,v=r.field,w=pn({elementType:v,externalSlotProps:s==null?void 0:s.field,additionalProps:se({},y&&{id:g}),ownerState:m}),k=St(w,cY),S=r.layout??UE;let E=g;y&&(a?E=`${g}-label`:E=void 0);const P=se({},s,{toolbar:se({},s==null?void 0:s.toolbar,{titleId:g}),mobilePaper:se({"aria-labelledby":E},s==null?void 0:s.mobilePaper)});return{renderPicker:()=>pe.jsx(ej,se({},u,{children:pe.jsxs(Dj,{slots:r,slotProps:P,inputRef:o,children:[pe.jsx(v,se({},k)),pe.jsx(oY,{slots:r,slotProps:P,children:pe.jsx(S,se({},P==null?void 0:P.layout,{slots:r,slotProps:P,children:p()}))})]})}))}},$j=T.forwardRef(function(e,t){var l;const i=jn(),r=lj(e,"MuiMobileDatePicker"),s=se({day:vp,month:vp,year:vp},r.viewRenderers),a=se({},r,{viewRenderers:s,format:IE(i,r,!1),slots:se({field:XE},r.slots),slotProps:se({},r.slotProps,{field:c=>{var u;return se({},L0((u=r.slotProps)==null?void 0:u.field,c),rj(r))},toolbar:se({hidden:!1},(l=r.slotProps)==null?void 0:l.toolbar)})}),{renderPicker:o}=uY({ref:t,props:a,valueManager:mo,valueType:"date",validator:yy,steps:null});return o()});$j.propTypes={autoFocus:D.bool,className:D.string,closeOnSelect:D.bool,dayOfWeekFormatter:D.func,defaultValue:D.object,disabled:D.bool,disableFuture:D.bool,disableHighlightToday:D.bool,disableOpenPicker:D.bool,disablePast:D.bool,displayWeekNumber:D.bool,enableAccessibleFieldDOMStructure:D.any,fixedWeekNumber:D.number,format:D.string,formatDensity:D.oneOf(["dense","spacious"]),inputRef:Nl,label:D.node,loading:D.bool,localeText:D.object,maxDate:D.object,minDate:D.object,monthsPerRow:D.oneOf([3,4]),name:D.string,onAccept:D.func,onChange:D.func,onClose:D.func,onError:D.func,onMonthChange:D.func,onOpen:D.func,onSelectedSectionsChange:D.func,onViewChange:D.func,onYearChange:D.func,open:D.bool,openTo:D.oneOf(["day","month","year"]),orientation:D.oneOf(["landscape","portrait"]),readOnly:D.bool,reduceAnimations:D.bool,referenceDate:D.object,renderLoading:D.func,selectedSections:D.oneOfType([D.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),D.number]),shouldDisableDate:D.func,shouldDisableMonth:D.func,shouldDisableYear:D.func,showDaysOutsideCurrentMonth:D.bool,slotProps:D.object,slots:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),timezone:D.string,value:D.object,view:D.oneOf(["day","month","year"]),viewRenderers:D.shape({day:D.func,month:D.func,year:D.func}),views:D.arrayOf(D.oneOf(["day","month","year"]).isRequired),yearsOrder:D.oneOf(["asc","desc"]),yearsPerRow:D.oneOf([3,4])};const dY=["desktopModeMediaQuery"],mD=T.forwardRef(function(e,t){const i=Yn({props:e,name:"MuiDatePicker"}),{desktopModeMediaQuery:r=H8}=i,s=St(i,dY);return Lx(r,{defaultMatches:!0})?pe.jsx(Bj,se({ref:t},s)):pe.jsx($j,se({ref:t},s))});mD.propTypes={autoFocus:D.bool,className:D.string,closeOnSelect:D.bool,dayOfWeekFormatter:D.func,defaultValue:D.object,desktopModeMediaQuery:D.string,disabled:D.bool,disableFuture:D.bool,disableHighlightToday:D.bool,disableOpenPicker:D.bool,disablePast:D.bool,displayWeekNumber:D.bool,enableAccessibleFieldDOMStructure:D.any,fixedWeekNumber:D.number,format:D.string,formatDensity:D.oneOf(["dense","spacious"]),inputRef:Nl,label:D.node,loading:D.bool,localeText:D.object,maxDate:D.object,minDate:D.object,monthsPerRow:D.oneOf([3,4]),name:D.string,onAccept:D.func,onChange:D.func,onClose:D.func,onError:D.func,onMonthChange:D.func,onOpen:D.func,onSelectedSectionsChange:D.func,onViewChange:D.func,onYearChange:D.func,open:D.bool,openTo:D.oneOf(["day","month","year"]),orientation:D.oneOf(["landscape","portrait"]),readOnly:D.bool,reduceAnimations:D.bool,referenceDate:D.object,renderLoading:D.func,selectedSections:D.oneOfType([D.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),D.number]),shouldDisableDate:D.func,shouldDisableMonth:D.func,shouldDisableYear:D.func,showDaysOutsideCurrentMonth:D.bool,slotProps:D.object,slots:D.object,sx:D.oneOfType([D.arrayOf(D.oneOfType([D.func,D.object,D.bool])),D.func,D.object]),timezone:D.string,value:D.object,view:D.oneOf(["day","month","year"]),viewRenderers:D.shape({day:D.func,month:D.func,year:D.func}),views:D.arrayOf(D.oneOf(["day","month","year"]).isRequired),yearsOrder:D.oneOf(["asc","desc"]),yearsPerRow:D.oneOf([3,4])};const hY=()=>{var B,L,W,q,X,G,K,J,ee,fe,ae,U,he,ie,$;const[n,e]=T.useState([]),[t,i]=T.useState([]),[r,s]=T.useState([]),[a,o]=T.useState([]),[l,c]=T.useState(["document","photo","video","audio","physical","digital","other"]),[u,p]=T.useState(!1),[m,g]=T.useState(null),y=We(Y=>Y.selectedProjectId),v=We(Y=>Y.searchFilters),w=We(Y=>Y.setSearchFilters),k=We(Y=>Y.resetSearchFilters);T.useEffect(()=>{y&&S()},[y]);const S=async()=>{try{p(!0),g(null);const{data:Y,error:oe}=await Zn.from("files").select("content_type, file_type").eq("project_id",y).not("content_type","is",null);if(oe)throw oe;const be=[...new Set(Y.map(Re=>Re.content_type))],xe=[...new Set(Y.map(Re=>Re.file_type))];e(xe.filter(Boolean));const{data:je,error:ze}=await Zn.from("file_tags").select("tag").eq("project_id",y);if(ze)throw ze;const Ve=[...new Set(je.map(Re=>Re.tag))];i(Ve);const{data:we,error:Ae}=await Zn.from("entities").select("entity_text, entity_type").eq("project_id",y);if(Ae)throw Ae;s(we||[]);const{data:_e,error:ye}=await Zn.from("files").select("metadata").eq("project_id",y).not("metadata->author","is",null);if(ye)throw ye;const He=[...new Set((_e==null?void 0:_e.map(Re=>{var et;return(et=Re.metadata)==null?void 0:et.author}).filter(Boolean))||[])];o(He)}catch(Y){console.error("Error fetching filter options:",Y),g("Failed to load filter options. Please try again.")}finally{p(!1)}},E=(Y,oe)=>{oe!==null&&w({searchType:oe})},P=()=>{k()},A=()=>{},N=Y=>{w({dateFrom:Y})},R=Y=>{w({dateTo:Y})},V=r.reduce((Y,oe)=>(Y[oe.entity_type]||(Y[oe.entity_type]=[]),Y[oe.entity_type].push(oe.entity_text),Y),{});return b.jsxDEV(sn,{elevation:0,sx:{p:2},children:[m&&b.jsxDEV(Aa,{severity:"error",sx:{mb:2},children:m},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:171,columnNumber:9},void 0),b.jsxDEV(pi,{spacing:2,children:[b.jsxDEV(re,{children:[b.jsxDEV(ge,{variant:"caption",color:"text.secondary",display:"block",sx:{mb:.5},children:"Search Type"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:179,columnNumber:11},void 0),b.jsxDEV(g4,{value:v.searchType||"combined",exclusive:!0,onChange:E,size:"small",fullWidth:!0,children:[b.jsxDEV(Ck,{value:"keyword",children:"Keyword"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:189,columnNumber:13},void 0),b.jsxDEV(Ck,{value:"semantic",children:"Semantic"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:190,columnNumber:13},void 0),b.jsxDEV(Ck,{value:"combined",children:"Combined"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:191,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:182,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:178,columnNumber:9},void 0),u?b.jsxDEV(Na,{variant:"rectangular",height:56},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:197,columnNumber:11},void 0):b.jsxDEV(Nm,{multiple:!0,size:"small",options:n,value:v.fileTypes||[],onChange:(Y,oe)=>{w({fileTypes:oe})},renderTags:(Y,oe)=>Y.map((be,xe)=>b.jsxDEV(It,{label:be,size:"small",...oe({index:xe})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:209,columnNumber:17},void 0)),renderInput:Y=>b.jsxDEV(Ni,{...Y,label:"File Types",placeholder:"Select file types"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:217,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:199,columnNumber:11},void 0),u?b.jsxDEV(Na,{variant:"rectangular",height:56},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:228,columnNumber:11},void 0):b.jsxDEV(Nm,{multiple:!0,size:"small",options:t,value:v.tags||[],onChange:(Y,oe)=>{w({tags:oe})},renderTags:(Y,oe)=>Y.map((be,xe)=>b.jsxDEV(It,{label:be,size:"small",...oe({index:xe})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:240,columnNumber:17},void 0)),renderInput:Y=>b.jsxDEV(Ni,{...Y,label:"Tags",placeholder:"Select tags"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:248,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:230,columnNumber:11},void 0),u?b.jsxDEV(Na,{variant:"rectangular",height:56},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:259,columnNumber:11},void 0):b.jsxDEV(re,{children:[b.jsxDEV(ge,{variant:"caption",color:"text.secondary",display:"block",sx:{mb:.5},children:"Entities"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:262,columnNumber:13},void 0),Object.keys(V).length===0?b.jsxDEV(ge,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.875rem"},children:"No entities available for this project yet"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:267,columnNumber:15},void 0):b.jsxDEV(pi,{spacing:1,children:Object.entries(V).map(([Y,oe])=>{var be;return b.jsxDEV(Nm,{multiple:!0,size:"small",options:oe,value:((be=v.entities)==null?void 0:be.filter(xe=>r.some(je=>je.entity_text===xe&&je.entity_type===Y)))||[],onChange:(xe,je)=>{const ze=(v.entities||[]).filter(Ve=>!r.some(we=>we.entity_text===Ve&&we.entity_type===Y));w({entities:[...ze,...je]})},renderTags:(xe,je)=>xe.map((ze,Ve)=>b.jsxDEV(It,{label:ze,size:"small",...je({index:Ve})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:296,columnNumber:25},void 0)),renderInput:xe=>b.jsxDEV(Ni,{...xe,label:Y.replace("_"," "),placeholder:`Select ${Y.replace("_"," ")}`,InputLabelProps:{sx:{textTransform:"capitalize"}}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:304,columnNumber:23},void 0)},Y,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:273,columnNumber:19},void 0)})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:271,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:261,columnNumber:11},void 0),u?b.jsxDEV(Na,{variant:"rectangular",height:56},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:322,columnNumber:11},void 0):b.jsxDEV(Nm,{multiple:!0,size:"small",options:a,value:v.authors||[],onChange:(Y,oe)=>{w({authors:oe})},renderTags:(Y,oe)=>Y.map((be,xe)=>b.jsxDEV(It,{label:be,size:"small",...oe({index:xe})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:334,columnNumber:17},void 0)),renderInput:Y=>b.jsxDEV(Ni,{...Y,label:"Authors",placeholder:"Select authors"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:342,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:324,columnNumber:11},void 0),u?b.jsxDEV(Na,{variant:"rectangular",height:56},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:353,columnNumber:11},void 0):b.jsxDEV(Nm,{multiple:!0,size:"small",options:l,value:v.evidenceStatus||[],onChange:(Y,oe)=>{w({evidenceStatus:oe})},renderTags:(Y,oe)=>Y.map((be,xe)=>b.jsxDEV(It,{label:be,size:"small",color:"primary",...oe({index:xe})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:365,columnNumber:17},void 0)),renderInput:Y=>b.jsxDEV(Ni,{...Y,label:"Evidence Type",placeholder:"Select evidence types"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:374,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:355,columnNumber:11},void 0),b.jsxDEV(re,{children:[b.jsxDEV(ge,{variant:"caption",color:"text.secondary",display:"block",sx:{mb:1},children:"Advanced Options"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:385,columnNumber:11},void 0),b.jsxDEV(pi,{spacing:1,children:[b.jsxDEV(kv,{control:b.jsxDEV(hA,{size:"small",checked:v.includePrivileged||!1,onChange:Y=>w({includePrivileged:Y.target.checked})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:391,columnNumber:17},void 0),label:b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:.5},children:[b.jsxDEV(ge,{variant:"body2",children:"Include Privileged Documents"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:399,columnNumber:19},void 0),b.jsxDEV(Nt,{title:"Include attorney-client privileged documents in search results",children:b.jsxDEV(dA,{fontSize:"small",sx:{color:"text.secondary"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:401,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:400,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:398,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:389,columnNumber:13},void 0),b.jsxDEV(kv,{control:b.jsxDEV(hA,{size:"small",checked:v.includeWorkProduct||!1,onChange:Y=>w({includeWorkProduct:Y.target.checked})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:409,columnNumber:17},void 0),label:b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:.5},children:[b.jsxDEV(ge,{variant:"body2",children:"Include Work Product"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:417,columnNumber:19},void 0),b.jsxDEV(Nt,{title:"Include attorney work product documents in search results",children:b.jsxDEV(dA,{fontSize:"small",sx:{color:"text.secondary"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:419,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:418,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:416,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:407,columnNumber:13},void 0),b.jsxDEV(kv,{control:b.jsxDEV(pA,{size:"small",checked:v.exactMatch||!1,onChange:Y=>w({exactMatch:Y.target.checked})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:427,columnNumber:17},void 0),label:"Exact phrase matching"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:425,columnNumber:13},void 0),b.jsxDEV(kv,{control:b.jsxDEV(pA,{size:"small",checked:v.caseSensitive||!1,onChange:Y=>w({caseSensitive:Y.target.checked})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:438,columnNumber:17},void 0),label:"Case sensitive search"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:436,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:388,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:384,columnNumber:9},void 0),b.jsxDEV(re,{children:[b.jsxDEV(ge,{variant:"caption",color:"text.secondary",display:"block",sx:{mb:.5},children:"Date Range"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:451,columnNumber:11},void 0),b.jsxDEV(pi,{direction:"row",spacing:2,children:[b.jsxDEV(mD,{label:"From Date",value:v.dateFrom,onChange:N,slotProps:{textField:{size:"small",fullWidth:!0,placeholder:"Start date"}}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:455,columnNumber:13},void 0),b.jsxDEV(mD,{label:"To Date",value:v.dateTo,onChange:R,slotProps:{textField:{size:"small",fullWidth:!0,placeholder:"End date"}}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:467,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:454,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:450,columnNumber:9},void 0),b.jsxDEV(pi,{direction:"row",spacing:1,children:[b.jsxDEV(vt,{variant:"outlined",size:"small",onClick:P,fullWidth:!0,children:"Reset All"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:484,columnNumber:11},void 0),b.jsxDEV(vt,{variant:"contained",size:"small",onClick:A,fullWidth:!0,disabled:u,children:[u?b.jsxDEV(Yr,{size:20,sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:499,columnNumber:26},void 0):null,"Apply Filters"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:492,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:483,columnNumber:9},void 0),((((B=v.fileTypes)==null?void 0:B.length)||0)>0||(((L=v.tags)==null?void 0:L.length)||0)>0||(((W=v.entities)==null?void 0:W.length)||0)>0||(((q=v.authors)==null?void 0:q.length)||0)>0||(((X=v.evidenceStatus)==null?void 0:X.length)||0)>0||v.dateFrom||v.dateTo||v.includePrivileged||v.includeWorkProduct||v.exactMatch||v.caseSensitive)&&b.jsxDEV(re,{sx:{mt:1},children:[b.jsxDEV(Pr,{sx:{my:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:517,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:"Active Filters:"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:518,columnNumber:13},void 0),b.jsxDEV(pi,{direction:"row",spacing:.5,sx:{mt:.5,flexWrap:"wrap",gap:.5},children:[(((G=v.fileTypes)==null?void 0:G.length)||0)>0&&b.jsxDEV(It,{size:"small",label:`${(K=v.fileTypes)==null?void 0:K.length} file types`,variant:"outlined",color:"primary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:523,columnNumber:17},void 0),(((J=v.tags)==null?void 0:J.length)||0)>0&&b.jsxDEV(It,{size:"small",label:`${(ee=v.tags)==null?void 0:ee.length} tags`,variant:"outlined",color:"primary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:531,columnNumber:17},void 0),(((fe=v.entities)==null?void 0:fe.length)||0)>0&&b.jsxDEV(It,{size:"small",label:`${(ae=v.entities)==null?void 0:ae.length} entities`,variant:"outlined",color:"primary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:539,columnNumber:17},void 0),(((U=v.authors)==null?void 0:U.length)||0)>0&&b.jsxDEV(It,{size:"small",label:`${(he=v.authors)==null?void 0:he.length} authors`,variant:"outlined",color:"secondary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:547,columnNumber:17},void 0),(((ie=v.evidenceStatus)==null?void 0:ie.length)||0)>0&&b.jsxDEV(It,{size:"small",label:`${($=v.evidenceStatus)==null?void 0:$.length} evidence types`,variant:"outlined",color:"success"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:555,columnNumber:17},void 0),v.dateFrom&&b.jsxDEV(It,{size:"small",label:`From: ${new Date(v.dateFrom).toLocaleDateString()}`,variant:"outlined",color:"primary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:563,columnNumber:17},void 0),v.dateTo&&b.jsxDEV(It,{size:"small",label:`To: ${new Date(v.dateTo).toLocaleDateString()}`,variant:"outlined",color:"primary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:571,columnNumber:17},void 0),v.includePrivileged&&b.jsxDEV(It,{size:"small",label:"Including Privileged",variant:"outlined",color:"warning"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:579,columnNumber:17},void 0),v.includeWorkProduct&&b.jsxDEV(It,{size:"small",label:"Including Work Product",variant:"outlined",color:"warning"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:587,columnNumber:17},void 0),v.exactMatch&&b.jsxDEV(It,{size:"small",label:"Exact Match",variant:"outlined",color:"info"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:595,columnNumber:17},void 0),v.caseSensitive&&b.jsxDEV(It,{size:"small",label:"Case Sensitive",variant:"outlined",color:"info"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:603,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:521,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:516,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:176,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/AdvancedSearchFilters.tsx",lineNumber:169,columnNumber:5},void 0)},pY=({open:n,fileId:e,onClose:t})=>{const[i,r]=T.useState(""),[s,a]=T.useState(""),[o,l]=T.useState(!0),[c,u]=T.useState(!1),[p,m]=T.useState(!1),[g,y]=T.useState([]),[v,w]=T.useState(""),[k,S]=T.useState(null),[E,P]=T.useState(!1),A=We(ae=>ae.files),N=We(ae=>ae.selectedProjectId),R=Bx(),V=e?A.find(ae=>ae.id===e):null;T.useEffect(()=>{n&&V?(r(V.name||""),a(V.exhibit_id||""),P(!1),S(null),l(!1),N&&(B(V.name,V.storage_path),L())):(l(!0),y([]),w(""))},[n,V,N]),T.useEffect(()=>{if(s&&s!==(V==null?void 0:V.exhibit_id)){const ae=A.some(U=>{var he;return U.id!==e&&((he=U.exhibit_id)==null?void 0:he.toLowerCase())===s.toLowerCase()});P(ae)}else P(!1)},[s,A,e,V]);const B=async(ae,U)=>{var he;if(N)try{u(!0);const ie=await Zn.functions.invoke("suggest-filename",{body:{projectId:N,filename:ae,storagePath:U}});if(ie.error){console.error("Error getting filename suggestions:",ie.error);return}(he=ie.data)!=null&&he.suggestedNames&&y(ie.data.suggestedNames)}catch(ie){console.error("Error getting filename suggestions:",ie)}finally{u(!1)}},L=async()=>{var ae;if(N)try{m(!0);const U=await Zn.functions.invoke("get-next-exhibit-id",{body:{projectId:N}});if(U.error){console.error("Error getting next exhibit ID:",U.error);return}(ae=U.data)!=null&&ae.nextExhibitId&&w(U.data.nextExhibitId)}catch(U){console.error("Error getting next exhibit ID:",U)}finally{m(!1)}},{mutate:W,isPending:q,isError:X,error:G}=hM({mutationFn:async({fileId:ae,name:U,exhibitId:he})=>{if(!ae)throw new Error("File ID is required");const ie={name:U};he!==void 0&&(ie.exhibit_id=he.trim()||null);const{data:$,error:Y}=await Zn.from("files").update(ie).eq("id",ae).select().single();if(Y)throw Y;return $},onSuccess:ae=>{const U=A.map(he=>he.id===ae.id?ae:he);We.getState().setFiles(U),ae.project_id&&R.invalidateQueries({queryKey:["files",ae.project_id]}),t()},onError:ae=>{S(ae instanceof Error?ae.message:"An unknown error occurred")}}),K=()=>{if(e){if(E){S(`Exhibit ID "${s}" is already in use. Please choose a different ID.`);return}W({fileId:e,name:i.trim(),exhibitId:s.trim()})}},J=ae=>{r(ae)},ee=()=>{v&&a(v)},fe=()=>{r(""),a(""),S(null),t()};return b.jsxDEV(uh,{open:n,onClose:fe,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{minHeight:"400px"}},children:[b.jsxDEV(Zf,{children:"Rename File & Assign Exhibit ID"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:249,columnNumber:7},void 0),b.jsxDEV(dh,{children:o?b.jsxDEV(re,{sx:{display:"flex",justifyContent:"center",padding:"20px"},children:b.jsxDEV(Yr,{size:24},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:253,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:252,columnNumber:11},void 0):b.jsxDEV(b.Fragment,{children:[(X||k)&&b.jsxDEV(Aa,{severity:"error",sx:{mb:2},children:k||(G instanceof Error?G.message:"Failed to rename file")},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:258,columnNumber:15},void 0),b.jsxDEV(re,{sx:{mb:3},children:[b.jsxDEV(ge,{variant:"subtitle2",gutterBottom:!0,children:"File Name"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:265,columnNumber:15},void 0),b.jsxDEV(Ni,{autoFocus:!0,margin:"dense",fullWidth:!0,value:i,onChange:ae=>r(ae.target.value),disabled:q,InputProps:{endAdornment:c&&b.jsxDEV(Yr,{size:20},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:277,columnNumber:21},void 0)},error:!i.trim(),helperText:!i.trim()&&"File name is required"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:268,columnNumber:15},void 0),g.length>0&&b.jsxDEV(re,{sx:{mt:1},children:[b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:"Suggested Names:"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:287,columnNumber:19},void 0),b.jsxDEV(re,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mt:.5},children:g.map((ae,U)=>b.jsxDEV(It,{label:ae,size:"small",onClick:()=>J(ae),variant:"outlined"},U,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:292,columnNumber:23},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:290,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:286,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:264,columnNumber:13},void 0),b.jsxDEV(Pr,{sx:{my:2}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:305,columnNumber:13},void 0),b.jsxDEV(re,{children:[b.jsxDEV(ge,{variant:"subtitle2",gutterBottom:!0,children:"Exhibit ID"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:309,columnNumber:15},void 0),b.jsxDEV(Ni,{margin:"dense",fullWidth:!0,value:s,onChange:ae=>a(ae.target.value),disabled:q,placeholder:"e.g., A, B, 1, 2, etc.",error:E,helperText:E?"This Exhibit ID is already in use":"Assign a unique identifier for easy reference in your notes",InputProps:{endAdornment:b.jsxDEV(Nt,{title:"Apply next available ID",children:b.jsxDEV("span",{children:b.jsxDEV(ut,{size:"small",onClick:ee,disabled:!v||p,children:p?b.jsxDEV(Yr,{size:20},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:334,columnNumber:47},void 0):b.jsxDEV(b4,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:334,columnNumber:80},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:329,columnNumber:25},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:328,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:327,columnNumber:21},void 0)}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:312,columnNumber:15},void 0),v&&b.jsxDEV(ge,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5},children:["Next available ID: ",b.jsxDEV(It,{label:v,size:"small",color:"primary",onClick:ee,sx:{ml:.5,height:20,"& .MuiChip-label":{px:1,py:0}}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:345,columnNumber:38},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:344,columnNumber:17},void 0),b.jsxDEV(re,{sx:{mt:2,display:"flex",alignItems:"center"},children:[b.jsxDEV(Nt,{title:"Refresh next available ID",children:b.jsxDEV("span",{children:b.jsxDEV(ut,{size:"small",onClick:L,disabled:p,children:b.jsxDEV(sE,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:359,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:358,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:357,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:356,columnNumber:17},void 0),b.jsxDEV(ge,{variant:"caption",color:"text.secondary",sx:{ml:1},children:"Generate a new suggested ID"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:363,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:355,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:308,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:256,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:250,columnNumber:7},void 0),b.jsxDEV(ch,{children:[b.jsxDEV(vt,{onClick:fe,disabled:q,children:"Cancel"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:372,columnNumber:9},void 0),b.jsxDEV(vt,{onClick:K,color:"primary",variant:"contained",disabled:!i.trim()||q||E,children:q?b.jsxDEV(Yr,{size:24},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:381,columnNumber:24},void 0):"Save"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:375,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:371,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/dialogs/RenameFileDialog.tsx",lineNumber:240,columnNumber:5},void 0)},HP={async processFile(n,e,t,i){console.log(`Processing file ${n} of type ${t}`);try{t==="image"?await this.processImageFile(n,e):t==="pdf"||t==="document"?await this.processDocumentFile(n,e):t==="audio"?await this.processAudioFile(n,e):t==="video"&&await this.processVideoFile(n,e),await this.updateFileProcessingStatus(n,"completed")}catch(r){console.error("Error processing file:",r),await this.updateFileProcessingStatus(n,"failed",{error:String(r)})}},async processImageFile(n,e){var a;const{data:t,error:i}=await rt.storage.from("files").download(e);if(i)throw new Error(`Error downloading image: ${i.message}`);const r=await this.fileToBase64(t),s=await rt.functions.invoke("analyze-file",{body:{fileId:n,task:"analyze_image",base64Image:r}});if(s.error)throw new Error(`Error analyzing image: ${s.error.message}`);(a=s.data)!=null&&a.analysis&&await this.updateFileMetadata(n,{imageAnalysis:s.data.analysis,processingStatus:"completed"})},async processDocumentFile(n,e){var i;const t=await rt.functions.invoke("analyze-file",{body:{fileId:n,storagePath:e,task:"analyze_document"}});if(t.error)throw new Error(`Error analyzing document: ${t.error.message}`);(i=t.data)!=null&&i.analysis&&await this.updateFileMetadata(n,{documentAnalysis:t.data.analysis,processingStatus:"completed"})},async processAudioFile(n,e){await this.updateFileMetadata(n,{audioProcessed:!0,processingStatus:"completed"})},async processVideoFile(n,e){await this.updateFileMetadata(n,{videoProcessed:!0,processingStatus:"completed"})},async updateFileMetadata(n,e){try{const{data:t,error:i}=await rt.from("files").select("metadata").eq("id",n).single();if(i)throw new Error(`Error fetching file metadata: ${i.message}`);const s={...(t==null?void 0:t.metadata)||{},...e},{error:a}=await rt.from("files").update({metadata:s}).eq("id",n);if(a)throw new Error(`Error updating file metadata: ${a.message}`)}catch(t){throw console.error("Error updating file metadata:",t),t}},async updateFileProcessingStatus(n,e,t={}){await this.updateFileMetadata(n,{processingStatus:e,processingTimestamp:Date.now(),...t})},async fileToBase64(n){return new Promise((e,t)=>{const i=new FileReader;i.readAsDataURL(n),i.onload=()=>{if(typeof i.result=="string"){const r=i.result.split(",")[1];e(r)}else t(new Error("Failed to convert file to base64"))},i.onerror=r=>t(r)})},async getFileProcessingStatus(n){var e;try{const{data:t,error:i}=await rt.from("files").select("metadata").eq("id",n).single();if(i)throw i;return((e=t==null?void 0:t.metadata)==null?void 0:e.processingStatus)||"unknown"}catch(t){return console.error("Error getting file processing status:",t),"unknown"}}},fY={DOCUMENT:["pdf","doc","docx","odt","rtf","txt","md"],SPREADSHEET:["xls","xlsx","csv","ods","numbers"],PRESENTATION:["ppt","pptx","odp","key"],IMAGE:["jpg","jpeg","png","gif","webp","svg","bmp","tiff","heic","heif"],VIDEO:["mp4","webm","mov","avi","mkv","flv","wmv","m4v"],AUDIO:["mp3","wav","ogg","aac","flac","m4a","wma"],CODE:["html","css","js","ts","jsx","tsx","json","xml","py","java","c","cpp","php","rb","go","swift"],ARCHIVE:["zip","rar","7z","tar","gz","bz2"],OTHER:[]};function mY(n,e){var i;const t=((i=n.split(".").pop())==null?void 0:i.toLowerCase())||"";if(e.startsWith("image/"))return"image";if(e.startsWith("video/"))return"video";if(e.startsWith("audio/"))return"audio";if(e==="application/pdf")return"pdf";for(const[r,s]of Object.entries(fY))if(s.includes(t))return r.toLowerCase();return"document"}function gY(n){return KW({queryKey:["files",n],queryFn:async()=>{if(!n)return[];const{data:e,error:t}=await rt.from("files").select("*").eq("project_id",n).order("added_at",{ascending:!1});if(t)throw console.error("Error fetching files:",t),t;return e?e.map(r=>({...r,metadata:typeof r.metadata=="object"?r.metadata:{}})):[]},enabled:!!n,staleTime:5*60*1e3,retry:3,refetchOnWindowFocus:!1})}function bY(){const n=Bx();return hM({mutationFn:async({file:e,projectId:t,userId:i,onProgress:r})=>{var s,a,o;if(!e||!t||!i)throw new Error("Missing required parameters: file, projectId, or userId");try{if(!window.DEMO_MODE&&i!=="00000000-0000-0000-0000-000000000000")try{const{data:y,error:v}=await rt.auth.getSession();v&&console.warn("Session validation failed, switching to demo mode:",v),(s=y==null?void 0:y.session)!=null&&s.access_token||console.warn("No valid session token found, using demo mode")}catch(y){console.warn("Session check failed, continuing with demo mode:",y)}console.log("Starting file upload process",{name:e.name,size:e.size,type:e.type,projectId:t});const l=((a=e.name.split(".").pop())==null?void 0:a.toLowerCase())||"",c=mY(e.name,e.type),u=crypto.randomUUID(),p=e.name.replace(/[^a-zA-Z0-9.-]/g,"_"),m=`projects/${t}/${u}_${p}`,g="files";console.log(`Uploading file to ${g}/${m}`);try{const y=await t0(g,m,e,{onProgress:r,upsert:!0,cacheControl:"3600"}),v=y.publicUrl||BM(g,m);console.log("File uploaded successfully",{path:y.path,publicUrl:v}),r&&r({loaded:e.size,total:e.size});let w=e.name,k=[],S="";try{console.log("Requesting AI analysis for file naming and organization");const L=await rt.functions.invoke("suggest-filename",{body:{fileId:u,storagePath:m,contentType:e.type,fileName:e.name,fileType:c}});if(!L.error&&((o=L.data)!=null&&o.suggestions)){const{suggestions:W}=L.data;w=W.suggestedTitle||e.name,k=W.suggestedTags||[],S=W.description||"",console.log("Received AI suggestions:",{title:w,tags:k,description:S})}else L.error&&console.warn("Error getting file name suggestions:",L.error)}catch(L){console.error("Error analyzing file with AI:",L)}const E={thumbnailUrl:c==="image"?v:null,tags:k,fileType:c,uploadTimestamp:Date.now(),originalFileName:e.name,suggestedTitle:w,description:S,fileExtension:l,mimeType:e.type,processingStatus:"pending"};if(i==="demo-user-123"||i==="00000000-0000-0000-0000-000000000000"||window.DEMO_MODE){console.log("Creating local file record (demo mode)");const L={id:u,name:w,project_id:t,owner_id:i,uploaded_by_user_id:i,storage_path:m,content_type:e.type,size:e.size,file_type:c,metadata:E,added_at:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return n.setQueryData(["files",t],W=>[L,...W||[]]),L}console.log("Creating database record for file");let A=null;try{const L=await rt.from("files").insert([{name:w,project_id:t,storage_path:m,content_type:e.type,size:e.size,file_type:c,metadata:E,owner_id:i,uploaded_by_user_id:i,id:u}]).select("*").single();if(L.error)throw console.error("Error creating file record:",L.error),L.error;A=L.data,setTimeout(async()=>{try{console.log("Triggering AI processing for file:",A.id);const{data:W,error:q}=await rt.functions.invoke("process-document",{body:{action:"process_file",file_id:A.id,project_id:t}});q?(console.error("Failed to queue file for AI processing:",q),HP.processFile(A.id,A.storage_path,A.file_type,A.content_type).catch(X=>{console.error("Background file processing error:",X)})):(console.log("File queued for AI processing:",W),n.setQueryData(["files",t],X=>X&&X.map(G=>G.id===A.id?{...G,processing_status:"processing"}:G)))}catch(W){console.error("Error triggering AI processing:",W),HP.processFile(A.id,A.storage_path,A.file_type,A.content_type).catch(q=>{console.error("Background file processing error:",q)})}},100),console.log("File record created successfully:",A==null?void 0:A.id)}catch(L){console.error("Exception creating file record:",L);try{await rt.storage.from(g).remove([m]),console.log("Cleaned up storage file after database insert failed")}catch(W){console.error("Failed to clean up storage file:",W)}throw new Error(`Failed to create file record: ${L.message}`)}const N=We.getState().detectExhibitIdFromFilename,R=We.getState().createExhibitFromFile,V=We.getState().exhibits.filter(L=>L.project_id===t),B=N(e.name);if(B&&A){console.log("Auto-detected exhibit ID from filename:",B);const L=V.find(W=>W.exhibit_id===B);if(!L)console.log("Creating new exhibit:",B),R(A.id,B,`Exhibit ${B}`);else{console.log("Assigning file to existing exhibit:",B);const W=We.getState().assignFileToExhibit;W(A.id,B,!L.files.length)}A={...A,exhibit_id:B}}return A}catch(y){console.error("Error during file upload:",y);const v=(y==null?void 0:y.message)||"Unknown upload error";throw new Error(`Storage upload failed: ${v}`)}}catch(l){throw console.error("File upload process error:",l),l}},onSuccess:e=>{e&&e.project_id&&n.invalidateQueries({queryKey:["files",e.project_id]})}})}var qm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var yY=qm.exports,qP;function vY(){return qP||(qP=1,function(n,e){(function(){var t,i="4.17.21",r=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",o="Invalid `variable` option passed into `_.template`",l="__lodash_hash_undefined__",c=500,u="__lodash_placeholder__",p=1,m=2,g=4,y=1,v=2,w=1,k=2,S=4,E=8,P=16,A=32,N=64,R=128,V=256,B=512,L=30,W="...",q=800,X=16,G=1,K=2,J=3,ee=1/0,fe=9007199254740991,ae=17976931348623157e292,U=NaN,he=4294967295,ie=he-1,$=he>>>1,Y=[["ary",R],["bind",w],["bindKey",k],["curry",E],["curryRight",P],["flip",B],["partial",A],["partialRight",N],["rearg",V]],oe="[object Arguments]",be="[object Array]",xe="[object AsyncFunction]",je="[object Boolean]",ze="[object Date]",Ve="[object DOMException]",we="[object Error]",Ae="[object Function]",_e="[object GeneratorFunction]",ye="[object Map]",He="[object Number]",Re="[object Null]",et="[object Object]",Be="[object Promise]",mt="[object Proxy]",Xe="[object RegExp]",ct="[object Set]",tn="[object String]",on="[object Symbol]",Oe="[object Undefined]",Ge="[object WeakMap]",ue="[object WeakSet]",de="[object ArrayBuffer]",Pe="[object DataView]",Le="[object Float32Array]",$e="[object Float64Array]",ht="[object Int8Array]",Et="[object Int16Array]",Ut="[object Int32Array]",zt="[object Uint8Array]",Te="[object Uint8ClampedArray]",Ue="[object Uint16Array]",ke="[object Uint32Array]",ot=/\b__p \+= '';/g,Bt=/\b(__p \+=) '' \+/g,dn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,oi=/&(?:amp|lt|gt|quot|#39);/g,vn=/[&<>"']/g,cu=RegExp(oi.source),yh=RegExp(vn.source),sm=/<%-([\s\S]+?)%>/g,am=/<%([\s\S]+?)%>/g,om=/<%=([\s\S]+?)%>/g,Rn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rr=/^\w*$/,vh=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lm=/[\\^$.*+?()[\]{}|]/g,My=RegExp(lm.source),cm=/^\s+/,fw=/\s/,Z=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ie=/\{\n\/\* \[wrapped with (.+)\] \*/,Je=/,? & /,Dt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,nn=/[()=,{}\[\]\/\s]/,gn=/\\(\\)?/g,Yt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ft=/\w*$/,zi=/^[-+]0x[0-9a-f]+$/i,$n=/^0b[01]+$/i,Xn=/^\[object .+?Constructor\]$/,Mr=/^0o[0-7]+$/i,Cl=/^(?:0|[1-9]\d*)$/,vo=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,gi=/($^)/,um=/['\n\r\u2028\u2029\\]/g,xh="\\ud800-\\udfff",mw="\\u0300-\\u036f",H2="\\ufe20-\\ufe2f",q2="\\u20d0-\\u20ff",LN=mw+H2+q2,FN="\\u2700-\\u27bf",VN="a-z\\xdf-\\xf6\\xf8-\\xff",G2="\\xac\\xb1\\xd7\\xf7",Y2="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",X2="\\u2000-\\u206f",K2=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",UN="A-Z\\xc0-\\xd6\\xd8-\\xde",zN="\\ufe0e\\ufe0f",BN=G2+Y2+X2+K2,gw="['’]",Q2="["+xh+"]",$N="["+BN+"]",jy="["+LN+"]",WN="\\d+",J2="["+FN+"]",HN="["+VN+"]",qN="[^"+xh+BN+WN+FN+VN+UN+"]",bw="\\ud83c[\\udffb-\\udfff]",Z2="(?:"+jy+"|"+bw+")",GN="[^"+xh+"]",yw="(?:\\ud83c[\\udde6-\\uddff]){2}",vw="[\\ud800-\\udbff][\\udc00-\\udfff]",wh="["+UN+"]",YN="\\u200d",XN="(?:"+HN+"|"+qN+")",eV="(?:"+wh+"|"+qN+")",KN="(?:"+gw+"(?:d|ll|m|re|s|t|ve))?",QN="(?:"+gw+"(?:D|LL|M|RE|S|T|VE))?",JN=Z2+"?",ZN="["+zN+"]?",tV="(?:"+YN+"(?:"+[GN,yw,vw].join("|")+")"+ZN+JN+")*",nV="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",iV="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",e_=ZN+JN+tV,rV="(?:"+[J2,yw,vw].join("|")+")"+e_,sV="(?:"+[GN+jy+"?",jy,yw,vw,Q2].join("|")+")",aV=RegExp(gw,"g"),oV=RegExp(jy,"g"),xw=RegExp(bw+"(?="+bw+")|"+sV+e_,"g"),lV=RegExp([wh+"?"+HN+"+"+KN+"(?="+[$N,wh,"$"].join("|")+")",eV+"+"+QN+"(?="+[$N,wh+XN,"$"].join("|")+")",wh+"?"+XN+"+"+KN,wh+"+"+QN,iV,nV,WN,rV].join("|"),"g"),cV=RegExp("["+YN+xh+LN+zN+"]"),uV=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,dV=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],hV=-1,Mn={};Mn[Le]=Mn[$e]=Mn[ht]=Mn[Et]=Mn[Ut]=Mn[zt]=Mn[Te]=Mn[Ue]=Mn[ke]=!0,Mn[oe]=Mn[be]=Mn[de]=Mn[je]=Mn[Pe]=Mn[ze]=Mn[we]=Mn[Ae]=Mn[ye]=Mn[He]=Mn[et]=Mn[Xe]=Mn[ct]=Mn[tn]=Mn[Ge]=!1;var _n={};_n[oe]=_n[be]=_n[de]=_n[Pe]=_n[je]=_n[ze]=_n[Le]=_n[$e]=_n[ht]=_n[Et]=_n[Ut]=_n[ye]=_n[He]=_n[et]=_n[Xe]=_n[ct]=_n[tn]=_n[on]=_n[zt]=_n[Te]=_n[Ue]=_n[ke]=!0,_n[we]=_n[Ae]=_n[Ge]=!1;var pV={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},fV={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},mV={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},gV={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},bV=parseFloat,yV=parseInt,t_=typeof wv=="object"&&wv&&wv.Object===Object&&wv,vV=typeof self=="object"&&self&&self.Object===Object&&self,Bi=t_||vV||Function("return this")(),ww=e&&!e.nodeType&&e,uu=ww&&!0&&n&&!n.nodeType&&n,n_=uu&&uu.exports===ww,kw=n_&&t_.process,As=function(){try{var le=uu&&uu.require&&uu.require("util").types;return le||kw&&kw.binding&&kw.binding("util")}catch{}}(),i_=As&&As.isArrayBuffer,r_=As&&As.isDate,s_=As&&As.isMap,a_=As&&As.isRegExp,o_=As&&As.isSet,l_=As&&As.isTypedArray;function Qr(le,ve,me){switch(me.length){case 0:return le.call(ve);case 1:return le.call(ve,me[0]);case 2:return le.call(ve,me[0],me[1]);case 3:return le.call(ve,me[0],me[1],me[2])}return le.apply(ve,me)}function xV(le,ve,me,nt){for(var _t=-1,cn=le==null?0:le.length;++_t<cn;){var bi=le[_t];ve(nt,bi,me(bi),le)}return nt}function Ps(le,ve){for(var me=-1,nt=le==null?0:le.length;++me<nt&&ve(le[me],me,le)!==!1;);return le}function wV(le,ve){for(var me=le==null?0:le.length;me--&&ve(le[me],me,le)!==!1;);return le}function c_(le,ve){for(var me=-1,nt=le==null?0:le.length;++me<nt;)if(!ve(le[me],me,le))return!1;return!0}function Al(le,ve){for(var me=-1,nt=le==null?0:le.length,_t=0,cn=[];++me<nt;){var bi=le[me];ve(bi,me,le)&&(cn[_t++]=bi)}return cn}function Oy(le,ve){var me=le==null?0:le.length;return!!me&&kh(le,ve,0)>-1}function Dw(le,ve,me){for(var nt=-1,_t=le==null?0:le.length;++nt<_t;)if(me(ve,le[nt]))return!0;return!1}function On(le,ve){for(var me=-1,nt=le==null?0:le.length,_t=Array(nt);++me<nt;)_t[me]=ve(le[me],me,le);return _t}function Pl(le,ve){for(var me=-1,nt=ve.length,_t=le.length;++me<nt;)le[_t+me]=ve[me];return le}function Sw(le,ve,me,nt){var _t=-1,cn=le==null?0:le.length;for(nt&&cn&&(me=le[++_t]);++_t<cn;)me=ve(me,le[_t],_t,le);return me}function kV(le,ve,me,nt){var _t=le==null?0:le.length;for(nt&&_t&&(me=le[--_t]);_t--;)me=ve(me,le[_t],_t,le);return me}function Ew(le,ve){for(var me=-1,nt=le==null?0:le.length;++me<nt;)if(ve(le[me],me,le))return!0;return!1}var DV=Nw("length");function SV(le){return le.split("")}function EV(le){return le.match(Dt)||[]}function u_(le,ve,me){var nt;return me(le,function(_t,cn,bi){if(ve(_t,cn,bi))return nt=cn,!1}),nt}function Ly(le,ve,me,nt){for(var _t=le.length,cn=me+(nt?1:-1);nt?cn--:++cn<_t;)if(ve(le[cn],cn,le))return cn;return-1}function kh(le,ve,me){return ve===ve?LV(le,ve,me):Ly(le,d_,me)}function NV(le,ve,me,nt){for(var _t=me-1,cn=le.length;++_t<cn;)if(nt(le[_t],ve))return _t;return-1}function d_(le){return le!==le}function h_(le,ve){var me=le==null?0:le.length;return me?Cw(le,ve)/me:U}function Nw(le){return function(ve){return ve==null?t:ve[le]}}function _w(le){return function(ve){return le==null?t:le[ve]}}function p_(le,ve,me,nt,_t){return _t(le,function(cn,bi,En){me=nt?(nt=!1,cn):ve(me,cn,bi,En)}),me}function _V(le,ve){var me=le.length;for(le.sort(ve);me--;)le[me]=le[me].value;return le}function Cw(le,ve){for(var me,nt=-1,_t=le.length;++nt<_t;){var cn=ve(le[nt]);cn!==t&&(me=me===t?cn:me+cn)}return me}function Aw(le,ve){for(var me=-1,nt=Array(le);++me<le;)nt[me]=ve(me);return nt}function CV(le,ve){return On(ve,function(me){return[me,le[me]]})}function f_(le){return le&&le.slice(0,y_(le)+1).replace(cm,"")}function Jr(le){return function(ve){return le(ve)}}function Pw(le,ve){return On(ve,function(me){return le[me]})}function dm(le,ve){return le.has(ve)}function m_(le,ve){for(var me=-1,nt=le.length;++me<nt&&kh(ve,le[me],0)>-1;);return me}function g_(le,ve){for(var me=le.length;me--&&kh(ve,le[me],0)>-1;);return me}function AV(le,ve){for(var me=le.length,nt=0;me--;)le[me]===ve&&++nt;return nt}var PV=_w(pV),TV=_w(fV);function IV(le){return"\\"+gV[le]}function RV(le,ve){return le==null?t:le[ve]}function Dh(le){return cV.test(le)}function MV(le){return uV.test(le)}function jV(le){for(var ve,me=[];!(ve=le.next()).done;)me.push(ve.value);return me}function Tw(le){var ve=-1,me=Array(le.size);return le.forEach(function(nt,_t){me[++ve]=[_t,nt]}),me}function b_(le,ve){return function(me){return le(ve(me))}}function Tl(le,ve){for(var me=-1,nt=le.length,_t=0,cn=[];++me<nt;){var bi=le[me];(bi===ve||bi===u)&&(le[me]=u,cn[_t++]=me)}return cn}function Fy(le){var ve=-1,me=Array(le.size);return le.forEach(function(nt){me[++ve]=nt}),me}function OV(le){var ve=-1,me=Array(le.size);return le.forEach(function(nt){me[++ve]=[nt,nt]}),me}function LV(le,ve,me){for(var nt=me-1,_t=le.length;++nt<_t;)if(le[nt]===ve)return nt;return-1}function FV(le,ve,me){for(var nt=me+1;nt--;)if(le[nt]===ve)return nt;return nt}function Sh(le){return Dh(le)?UV(le):DV(le)}function na(le){return Dh(le)?zV(le):SV(le)}function y_(le){for(var ve=le.length;ve--&&fw.test(le.charAt(ve)););return ve}var VV=_w(mV);function UV(le){for(var ve=xw.lastIndex=0;xw.test(le);)++ve;return ve}function zV(le){return le.match(xw)||[]}function BV(le){return le.match(lV)||[]}var $V=function le(ve){ve=ve==null?Bi:Eh.defaults(Bi.Object(),ve,Eh.pick(Bi,dV));var me=ve.Array,nt=ve.Date,_t=ve.Error,cn=ve.Function,bi=ve.Math,En=ve.Object,Iw=ve.RegExp,WV=ve.String,Ts=ve.TypeError,Vy=me.prototype,HV=cn.prototype,Nh=En.prototype,Uy=ve["__core-js_shared__"],zy=HV.toString,bn=Nh.hasOwnProperty,qV=0,v_=function(){var d=/[^.]+$/.exec(Uy&&Uy.keys&&Uy.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),By=Nh.toString,GV=zy.call(En),YV=Bi._,XV=Iw("^"+zy.call(bn).replace(lm,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$y=n_?ve.Buffer:t,Il=ve.Symbol,Wy=ve.Uint8Array,x_=$y?$y.allocUnsafe:t,Hy=b_(En.getPrototypeOf,En),w_=En.create,k_=Nh.propertyIsEnumerable,qy=Vy.splice,D_=Il?Il.isConcatSpreadable:t,hm=Il?Il.iterator:t,du=Il?Il.toStringTag:t,Gy=function(){try{var d=gu(En,"defineProperty");return d({},"",{}),d}catch{}}(),KV=ve.clearTimeout!==Bi.clearTimeout&&ve.clearTimeout,QV=nt&&nt.now!==Bi.Date.now&&nt.now,JV=ve.setTimeout!==Bi.setTimeout&&ve.setTimeout,Yy=bi.ceil,Xy=bi.floor,Rw=En.getOwnPropertySymbols,ZV=$y?$y.isBuffer:t,S_=ve.isFinite,eU=Vy.join,tU=b_(En.keys,En),yi=bi.max,sr=bi.min,nU=nt.now,iU=ve.parseInt,E_=bi.random,rU=Vy.reverse,Mw=gu(ve,"DataView"),pm=gu(ve,"Map"),jw=gu(ve,"Promise"),_h=gu(ve,"Set"),fm=gu(ve,"WeakMap"),mm=gu(En,"create"),Ky=fm&&new fm,Ch={},sU=bu(Mw),aU=bu(pm),oU=bu(jw),lU=bu(_h),cU=bu(fm),Qy=Il?Il.prototype:t,gm=Qy?Qy.valueOf:t,N_=Qy?Qy.toString:t;function z(d){if(Kn(d)&&!Pt(d)&&!(d instanceof Xt)){if(d instanceof Is)return d;if(bn.call(d,"__wrapped__"))return _C(d)}return new Is(d)}var Ah=function(){function d(){}return function(f){if(!Wn(f))return{};if(w_)return w_(f);d.prototype=f;var x=new d;return d.prototype=t,x}}();function Jy(){}function Is(d,f){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=t}z.templateSettings={escape:sm,evaluate:am,interpolate:om,variable:"",imports:{_:z}},z.prototype=Jy.prototype,z.prototype.constructor=z,Is.prototype=Ah(Jy.prototype),Is.prototype.constructor=Is;function Xt(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=he,this.__views__=[]}function uU(){var d=new Xt(this.__wrapped__);return d.__actions__=jr(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=jr(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=jr(this.__views__),d}function dU(){if(this.__filtered__){var d=new Xt(this);d.__dir__=-1,d.__filtered__=!0}else d=this.clone(),d.__dir__*=-1;return d}function hU(){var d=this.__wrapped__.value(),f=this.__dir__,x=Pt(d),C=f<0,O=x?d.length:0,H=S3(0,O,this.__views__),Q=H.start,ne=H.end,ce=ne-Q,Se=C?ne:Q-1,Ee=this.__iteratees__,Ce=Ee.length,Ke=0,pt=sr(ce,this.__takeCount__);if(!x||!C&&O==ce&&pt==ce)return K_(d,this.__actions__);var wt=[];e:for(;ce--&&Ke<pt;){Se+=f;for(var Ot=-1,kt=d[Se];++Ot<Ce;){var qt=Ee[Ot],Kt=qt.iteratee,ts=qt.type,vr=Kt(kt);if(ts==K)kt=vr;else if(!vr){if(ts==G)continue e;break e}}wt[Ke++]=kt}return wt}Xt.prototype=Ah(Jy.prototype),Xt.prototype.constructor=Xt;function hu(d){var f=-1,x=d==null?0:d.length;for(this.clear();++f<x;){var C=d[f];this.set(C[0],C[1])}}function pU(){this.__data__=mm?mm(null):{},this.size=0}function fU(d){var f=this.has(d)&&delete this.__data__[d];return this.size-=f?1:0,f}function mU(d){var f=this.__data__;if(mm){var x=f[d];return x===l?t:x}return bn.call(f,d)?f[d]:t}function gU(d){var f=this.__data__;return mm?f[d]!==t:bn.call(f,d)}function bU(d,f){var x=this.__data__;return this.size+=this.has(d)?0:1,x[d]=mm&&f===t?l:f,this}hu.prototype.clear=pU,hu.prototype.delete=fU,hu.prototype.get=mU,hu.prototype.has=gU,hu.prototype.set=bU;function xo(d){var f=-1,x=d==null?0:d.length;for(this.clear();++f<x;){var C=d[f];this.set(C[0],C[1])}}function yU(){this.__data__=[],this.size=0}function vU(d){var f=this.__data__,x=Zy(f,d);if(x<0)return!1;var C=f.length-1;return x==C?f.pop():qy.call(f,x,1),--this.size,!0}function xU(d){var f=this.__data__,x=Zy(f,d);return x<0?t:f[x][1]}function wU(d){return Zy(this.__data__,d)>-1}function kU(d,f){var x=this.__data__,C=Zy(x,d);return C<0?(++this.size,x.push([d,f])):x[C][1]=f,this}xo.prototype.clear=yU,xo.prototype.delete=vU,xo.prototype.get=xU,xo.prototype.has=wU,xo.prototype.set=kU;function wo(d){var f=-1,x=d==null?0:d.length;for(this.clear();++f<x;){var C=d[f];this.set(C[0],C[1])}}function DU(){this.size=0,this.__data__={hash:new hu,map:new(pm||xo),string:new hu}}function SU(d){var f=dv(this,d).delete(d);return this.size-=f?1:0,f}function EU(d){return dv(this,d).get(d)}function NU(d){return dv(this,d).has(d)}function _U(d,f){var x=dv(this,d),C=x.size;return x.set(d,f),this.size+=x.size==C?0:1,this}wo.prototype.clear=DU,wo.prototype.delete=SU,wo.prototype.get=EU,wo.prototype.has=NU,wo.prototype.set=_U;function pu(d){var f=-1,x=d==null?0:d.length;for(this.__data__=new wo;++f<x;)this.add(d[f])}function CU(d){return this.__data__.set(d,l),this}function AU(d){return this.__data__.has(d)}pu.prototype.add=pu.prototype.push=CU,pu.prototype.has=AU;function ia(d){var f=this.__data__=new xo(d);this.size=f.size}function PU(){this.__data__=new xo,this.size=0}function TU(d){var f=this.__data__,x=f.delete(d);return this.size=f.size,x}function IU(d){return this.__data__.get(d)}function RU(d){return this.__data__.has(d)}function MU(d,f){var x=this.__data__;if(x instanceof xo){var C=x.__data__;if(!pm||C.length<r-1)return C.push([d,f]),this.size=++x.size,this;x=this.__data__=new wo(C)}return x.set(d,f),this.size=x.size,this}ia.prototype.clear=PU,ia.prototype.delete=TU,ia.prototype.get=IU,ia.prototype.has=RU,ia.prototype.set=MU;function __(d,f){var x=Pt(d),C=!x&&yu(d),O=!x&&!C&&Ll(d),H=!x&&!C&&!O&&Rh(d),Q=x||C||O||H,ne=Q?Aw(d.length,WV):[],ce=ne.length;for(var Se in d)(f||bn.call(d,Se))&&!(Q&&(Se=="length"||O&&(Se=="offset"||Se=="parent")||H&&(Se=="buffer"||Se=="byteLength"||Se=="byteOffset")||Eo(Se,ce)))&&ne.push(Se);return ne}function C_(d){var f=d.length;return f?d[qw(0,f-1)]:t}function jU(d,f){return hv(jr(d),fu(f,0,d.length))}function OU(d){return hv(jr(d))}function Ow(d,f,x){(x!==t&&!ra(d[f],x)||x===t&&!(f in d))&&ko(d,f,x)}function bm(d,f,x){var C=d[f];(!(bn.call(d,f)&&ra(C,x))||x===t&&!(f in d))&&ko(d,f,x)}function Zy(d,f){for(var x=d.length;x--;)if(ra(d[x][0],f))return x;return-1}function LU(d,f,x,C){return Rl(d,function(O,H,Q){f(C,O,x(O),Q)}),C}function A_(d,f){return d&&Ia(f,Pi(f),d)}function FU(d,f){return d&&Ia(f,Lr(f),d)}function ko(d,f,x){f=="__proto__"&&Gy?Gy(d,f,{configurable:!0,enumerable:!0,value:x,writable:!0}):d[f]=x}function Lw(d,f){for(var x=-1,C=f.length,O=me(C),H=d==null;++x<C;)O[x]=H?t:bk(d,f[x]);return O}function fu(d,f,x){return d===d&&(x!==t&&(d=d<=x?d:x),f!==t&&(d=d>=f?d:f)),d}function Rs(d,f,x,C,O,H){var Q,ne=f&p,ce=f&m,Se=f&g;if(x&&(Q=O?x(d,C,O,H):x(d)),Q!==t)return Q;if(!Wn(d))return d;var Ee=Pt(d);if(Ee){if(Q=N3(d),!ne)return jr(d,Q)}else{var Ce=ar(d),Ke=Ce==Ae||Ce==_e;if(Ll(d))return Z_(d,ne);if(Ce==et||Ce==oe||Ke&&!O){if(Q=ce||Ke?{}:yC(d),!ne)return ce?m3(d,FU(Q,d)):f3(d,A_(Q,d))}else{if(!_n[Ce])return O?d:{};Q=_3(d,Ce,ne)}}H||(H=new ia);var pt=H.get(d);if(pt)return pt;H.set(d,Q),GC(d)?d.forEach(function(kt){Q.add(Rs(kt,f,x,kt,d,H))}):HC(d)&&d.forEach(function(kt,qt){Q.set(qt,Rs(kt,f,x,qt,d,H))});var wt=Se?ce?ik:nk:ce?Lr:Pi,Ot=Ee?t:wt(d);return Ps(Ot||d,function(kt,qt){Ot&&(qt=kt,kt=d[qt]),bm(Q,qt,Rs(kt,f,x,qt,d,H))}),Q}function VU(d){var f=Pi(d);return function(x){return P_(x,d,f)}}function P_(d,f,x){var C=x.length;if(d==null)return!C;for(d=En(d);C--;){var O=x[C],H=f[O],Q=d[O];if(Q===t&&!(O in d)||!H(Q))return!1}return!0}function T_(d,f,x){if(typeof d!="function")throw new Ts(a);return Sm(function(){d.apply(t,x)},f)}function ym(d,f,x,C){var O=-1,H=Oy,Q=!0,ne=d.length,ce=[],Se=f.length;if(!ne)return ce;x&&(f=On(f,Jr(x))),C?(H=Dw,Q=!1):f.length>=r&&(H=dm,Q=!1,f=new pu(f));e:for(;++O<ne;){var Ee=d[O],Ce=x==null?Ee:x(Ee);if(Ee=C||Ee!==0?Ee:0,Q&&Ce===Ce){for(var Ke=Se;Ke--;)if(f[Ke]===Ce)continue e;ce.push(Ee)}else H(f,Ce,C)||ce.push(Ee)}return ce}var Rl=rC(Ta),I_=rC(Vw,!0);function UU(d,f){var x=!0;return Rl(d,function(C,O,H){return x=!!f(C,O,H),x}),x}function ev(d,f,x){for(var C=-1,O=d.length;++C<O;){var H=d[C],Q=f(H);if(Q!=null&&(ne===t?Q===Q&&!es(Q):x(Q,ne)))var ne=Q,ce=H}return ce}function zU(d,f,x,C){var O=d.length;for(x=Mt(x),x<0&&(x=-x>O?0:O+x),C=C===t||C>O?O:Mt(C),C<0&&(C+=O),C=x>C?0:XC(C);x<C;)d[x++]=f;return d}function R_(d,f){var x=[];return Rl(d,function(C,O,H){f(C,O,H)&&x.push(C)}),x}function $i(d,f,x,C,O){var H=-1,Q=d.length;for(x||(x=A3),O||(O=[]);++H<Q;){var ne=d[H];f>0&&x(ne)?f>1?$i(ne,f-1,x,C,O):Pl(O,ne):C||(O[O.length]=ne)}return O}var Fw=sC(),M_=sC(!0);function Ta(d,f){return d&&Fw(d,f,Pi)}function Vw(d,f){return d&&M_(d,f,Pi)}function tv(d,f){return Al(f,function(x){return No(d[x])})}function mu(d,f){f=jl(f,d);for(var x=0,C=f.length;d!=null&&x<C;)d=d[Ra(f[x++])];return x&&x==C?d:t}function j_(d,f,x){var C=f(d);return Pt(d)?C:Pl(C,x(d))}function br(d){return d==null?d===t?Oe:Re:du&&du in En(d)?D3(d):O3(d)}function Uw(d,f){return d>f}function BU(d,f){return d!=null&&bn.call(d,f)}function $U(d,f){return d!=null&&f in En(d)}function WU(d,f,x){return d>=sr(f,x)&&d<yi(f,x)}function zw(d,f,x){for(var C=x?Dw:Oy,O=d[0].length,H=d.length,Q=H,ne=me(H),ce=1/0,Se=[];Q--;){var Ee=d[Q];Q&&f&&(Ee=On(Ee,Jr(f))),ce=sr(Ee.length,ce),ne[Q]=!x&&(f||O>=120&&Ee.length>=120)?new pu(Q&&Ee):t}Ee=d[0];var Ce=-1,Ke=ne[0];e:for(;++Ce<O&&Se.length<ce;){var pt=Ee[Ce],wt=f?f(pt):pt;if(pt=x||pt!==0?pt:0,!(Ke?dm(Ke,wt):C(Se,wt,x))){for(Q=H;--Q;){var Ot=ne[Q];if(!(Ot?dm(Ot,wt):C(d[Q],wt,x)))continue e}Ke&&Ke.push(wt),Se.push(pt)}}return Se}function HU(d,f,x,C){return Ta(d,function(O,H,Q){f(C,x(O),H,Q)}),C}function vm(d,f,x){f=jl(f,d),d=kC(d,f);var C=d==null?d:d[Ra(js(f))];return C==null?t:Qr(C,d,x)}function O_(d){return Kn(d)&&br(d)==oe}function qU(d){return Kn(d)&&br(d)==de}function GU(d){return Kn(d)&&br(d)==ze}function xm(d,f,x,C,O){return d===f?!0:d==null||f==null||!Kn(d)&&!Kn(f)?d!==d&&f!==f:YU(d,f,x,C,xm,O)}function YU(d,f,x,C,O,H){var Q=Pt(d),ne=Pt(f),ce=Q?be:ar(d),Se=ne?be:ar(f);ce=ce==oe?et:ce,Se=Se==oe?et:Se;var Ee=ce==et,Ce=Se==et,Ke=ce==Se;if(Ke&&Ll(d)){if(!Ll(f))return!1;Q=!0,Ee=!1}if(Ke&&!Ee)return H||(H=new ia),Q||Rh(d)?mC(d,f,x,C,O,H):w3(d,f,ce,x,C,O,H);if(!(x&y)){var pt=Ee&&bn.call(d,"__wrapped__"),wt=Ce&&bn.call(f,"__wrapped__");if(pt||wt){var Ot=pt?d.value():d,kt=wt?f.value():f;return H||(H=new ia),O(Ot,kt,x,C,H)}}return Ke?(H||(H=new ia),k3(d,f,x,C,O,H)):!1}function XU(d){return Kn(d)&&ar(d)==ye}function Bw(d,f,x,C){var O=x.length,H=O,Q=!C;if(d==null)return!H;for(d=En(d);O--;){var ne=x[O];if(Q&&ne[2]?ne[1]!==d[ne[0]]:!(ne[0]in d))return!1}for(;++O<H;){ne=x[O];var ce=ne[0],Se=d[ce],Ee=ne[1];if(Q&&ne[2]){if(Se===t&&!(ce in d))return!1}else{var Ce=new ia;if(C)var Ke=C(Se,Ee,ce,d,f,Ce);if(!(Ke===t?xm(Ee,Se,y|v,C,Ce):Ke))return!1}}return!0}function L_(d){if(!Wn(d)||T3(d))return!1;var f=No(d)?XV:Xn;return f.test(bu(d))}function KU(d){return Kn(d)&&br(d)==Xe}function QU(d){return Kn(d)&&ar(d)==ct}function JU(d){return Kn(d)&&yv(d.length)&&!!Mn[br(d)]}function F_(d){return typeof d=="function"?d:d==null?Fr:typeof d=="object"?Pt(d)?z_(d[0],d[1]):U_(d):aA(d)}function $w(d){if(!Dm(d))return tU(d);var f=[];for(var x in En(d))bn.call(d,x)&&x!="constructor"&&f.push(x);return f}function ZU(d){if(!Wn(d))return j3(d);var f=Dm(d),x=[];for(var C in d)C=="constructor"&&(f||!bn.call(d,C))||x.push(C);return x}function Ww(d,f){return d<f}function V_(d,f){var x=-1,C=Or(d)?me(d.length):[];return Rl(d,function(O,H,Q){C[++x]=f(O,H,Q)}),C}function U_(d){var f=sk(d);return f.length==1&&f[0][2]?xC(f[0][0],f[0][1]):function(x){return x===d||Bw(x,d,f)}}function z_(d,f){return ok(d)&&vC(f)?xC(Ra(d),f):function(x){var C=bk(x,d);return C===t&&C===f?yk(x,d):xm(f,C,y|v)}}function nv(d,f,x,C,O){d!==f&&Fw(f,function(H,Q){if(O||(O=new ia),Wn(H))e3(d,f,Q,x,nv,C,O);else{var ne=C?C(ck(d,Q),H,Q+"",d,f,O):t;ne===t&&(ne=H),Ow(d,Q,ne)}},Lr)}function e3(d,f,x,C,O,H,Q){var ne=ck(d,x),ce=ck(f,x),Se=Q.get(ce);if(Se){Ow(d,x,Se);return}var Ee=H?H(ne,ce,x+"",d,f,Q):t,Ce=Ee===t;if(Ce){var Ke=Pt(ce),pt=!Ke&&Ll(ce),wt=!Ke&&!pt&&Rh(ce);Ee=ce,Ke||pt||wt?Pt(ne)?Ee=ne:ti(ne)?Ee=jr(ne):pt?(Ce=!1,Ee=Z_(ce,!0)):wt?(Ce=!1,Ee=eC(ce,!0)):Ee=[]:Em(ce)||yu(ce)?(Ee=ne,yu(ne)?Ee=KC(ne):(!Wn(ne)||No(ne))&&(Ee=yC(ce))):Ce=!1}Ce&&(Q.set(ce,Ee),O(Ee,ce,C,H,Q),Q.delete(ce)),Ow(d,x,Ee)}function B_(d,f){var x=d.length;if(x)return f+=f<0?x:0,Eo(f,x)?d[f]:t}function $_(d,f,x){f.length?f=On(f,function(H){return Pt(H)?function(Q){return mu(Q,H.length===1?H[0]:H)}:H}):f=[Fr];var C=-1;f=On(f,Jr(yt()));var O=V_(d,function(H,Q,ne){var ce=On(f,function(Se){return Se(H)});return{criteria:ce,index:++C,value:H}});return _V(O,function(H,Q){return p3(H,Q,x)})}function t3(d,f){return W_(d,f,function(x,C){return yk(d,C)})}function W_(d,f,x){for(var C=-1,O=f.length,H={};++C<O;){var Q=f[C],ne=mu(d,Q);x(ne,Q)&&wm(H,jl(Q,d),ne)}return H}function n3(d){return function(f){return mu(f,d)}}function Hw(d,f,x,C){var O=C?NV:kh,H=-1,Q=f.length,ne=d;for(d===f&&(f=jr(f)),x&&(ne=On(d,Jr(x)));++H<Q;)for(var ce=0,Se=f[H],Ee=x?x(Se):Se;(ce=O(ne,Ee,ce,C))>-1;)ne!==d&&qy.call(ne,ce,1),qy.call(d,ce,1);return d}function H_(d,f){for(var x=d?f.length:0,C=x-1;x--;){var O=f[x];if(x==C||O!==H){var H=O;Eo(O)?qy.call(d,O,1):Xw(d,O)}}return d}function qw(d,f){return d+Xy(E_()*(f-d+1))}function i3(d,f,x,C){for(var O=-1,H=yi(Yy((f-d)/(x||1)),0),Q=me(H);H--;)Q[C?H:++O]=d,d+=x;return Q}function Gw(d,f){var x="";if(!d||f<1||f>fe)return x;do f%2&&(x+=d),f=Xy(f/2),f&&(d+=d);while(f);return x}function Vt(d,f){return uk(wC(d,f,Fr),d+"")}function r3(d){return C_(Mh(d))}function s3(d,f){var x=Mh(d);return hv(x,fu(f,0,x.length))}function wm(d,f,x,C){if(!Wn(d))return d;f=jl(f,d);for(var O=-1,H=f.length,Q=H-1,ne=d;ne!=null&&++O<H;){var ce=Ra(f[O]),Se=x;if(ce==="__proto__"||ce==="constructor"||ce==="prototype")return d;if(O!=Q){var Ee=ne[ce];Se=C?C(Ee,ce,ne):t,Se===t&&(Se=Wn(Ee)?Ee:Eo(f[O+1])?[]:{})}bm(ne,ce,Se),ne=ne[ce]}return d}var q_=Ky?function(d,f){return Ky.set(d,f),d}:Fr,a3=Gy?function(d,f){return Gy(d,"toString",{configurable:!0,enumerable:!1,value:xk(f),writable:!0})}:Fr;function o3(d){return hv(Mh(d))}function Ms(d,f,x){var C=-1,O=d.length;f<0&&(f=-f>O?0:O+f),x=x>O?O:x,x<0&&(x+=O),O=f>x?0:x-f>>>0,f>>>=0;for(var H=me(O);++C<O;)H[C]=d[C+f];return H}function l3(d,f){var x;return Rl(d,function(C,O,H){return x=f(C,O,H),!x}),!!x}function iv(d,f,x){var C=0,O=d==null?C:d.length;if(typeof f=="number"&&f===f&&O<=$){for(;C<O;){var H=C+O>>>1,Q=d[H];Q!==null&&!es(Q)&&(x?Q<=f:Q<f)?C=H+1:O=H}return O}return Yw(d,f,Fr,x)}function Yw(d,f,x,C){var O=0,H=d==null?0:d.length;if(H===0)return 0;f=x(f);for(var Q=f!==f,ne=f===null,ce=es(f),Se=f===t;O<H;){var Ee=Xy((O+H)/2),Ce=x(d[Ee]),Ke=Ce!==t,pt=Ce===null,wt=Ce===Ce,Ot=es(Ce);if(Q)var kt=C||wt;else Se?kt=wt&&(C||Ke):ne?kt=wt&&Ke&&(C||!pt):ce?kt=wt&&Ke&&!pt&&(C||!Ot):pt||Ot?kt=!1:kt=C?Ce<=f:Ce<f;kt?O=Ee+1:H=Ee}return sr(H,ie)}function G_(d,f){for(var x=-1,C=d.length,O=0,H=[];++x<C;){var Q=d[x],ne=f?f(Q):Q;if(!x||!ra(ne,ce)){var ce=ne;H[O++]=Q===0?0:Q}}return H}function Y_(d){return typeof d=="number"?d:es(d)?U:+d}function Zr(d){if(typeof d=="string")return d;if(Pt(d))return On(d,Zr)+"";if(es(d))return N_?N_.call(d):"";var f=d+"";return f=="0"&&1/d==-1/0?"-0":f}function Ml(d,f,x){var C=-1,O=Oy,H=d.length,Q=!0,ne=[],ce=ne;if(x)Q=!1,O=Dw;else if(H>=r){var Se=f?null:v3(d);if(Se)return Fy(Se);Q=!1,O=dm,ce=new pu}else ce=f?[]:ne;e:for(;++C<H;){var Ee=d[C],Ce=f?f(Ee):Ee;if(Ee=x||Ee!==0?Ee:0,Q&&Ce===Ce){for(var Ke=ce.length;Ke--;)if(ce[Ke]===Ce)continue e;f&&ce.push(Ce),ne.push(Ee)}else O(ce,Ce,x)||(ce!==ne&&ce.push(Ce),ne.push(Ee))}return ne}function Xw(d,f){return f=jl(f,d),d=kC(d,f),d==null||delete d[Ra(js(f))]}function X_(d,f,x,C){return wm(d,f,x(mu(d,f)),C)}function rv(d,f,x,C){for(var O=d.length,H=C?O:-1;(C?H--:++H<O)&&f(d[H],H,d););return x?Ms(d,C?0:H,C?H+1:O):Ms(d,C?H+1:0,C?O:H)}function K_(d,f){var x=d;return x instanceof Xt&&(x=x.value()),Sw(f,function(C,O){return O.func.apply(O.thisArg,Pl([C],O.args))},x)}function Kw(d,f,x){var C=d.length;if(C<2)return C?Ml(d[0]):[];for(var O=-1,H=me(C);++O<C;)for(var Q=d[O],ne=-1;++ne<C;)ne!=O&&(H[O]=ym(H[O]||Q,d[ne],f,x));return Ml($i(H,1),f,x)}function Q_(d,f,x){for(var C=-1,O=d.length,H=f.length,Q={};++C<O;){var ne=C<H?f[C]:t;x(Q,d[C],ne)}return Q}function Qw(d){return ti(d)?d:[]}function Jw(d){return typeof d=="function"?d:Fr}function jl(d,f){return Pt(d)?d:ok(d,f)?[d]:NC(hn(d))}var c3=Vt;function Ol(d,f,x){var C=d.length;return x=x===t?C:x,!f&&x>=C?d:Ms(d,f,x)}var J_=KV||function(d){return Bi.clearTimeout(d)};function Z_(d,f){if(f)return d.slice();var x=d.length,C=x_?x_(x):new d.constructor(x);return d.copy(C),C}function Zw(d){var f=new d.constructor(d.byteLength);return new Wy(f).set(new Wy(d)),f}function u3(d,f){var x=f?Zw(d.buffer):d.buffer;return new d.constructor(x,d.byteOffset,d.byteLength)}function d3(d){var f=new d.constructor(d.source,Ft.exec(d));return f.lastIndex=d.lastIndex,f}function h3(d){return gm?En(gm.call(d)):{}}function eC(d,f){var x=f?Zw(d.buffer):d.buffer;return new d.constructor(x,d.byteOffset,d.length)}function tC(d,f){if(d!==f){var x=d!==t,C=d===null,O=d===d,H=es(d),Q=f!==t,ne=f===null,ce=f===f,Se=es(f);if(!ne&&!Se&&!H&&d>f||H&&Q&&ce&&!ne&&!Se||C&&Q&&ce||!x&&ce||!O)return 1;if(!C&&!H&&!Se&&d<f||Se&&x&&O&&!C&&!H||ne&&x&&O||!Q&&O||!ce)return-1}return 0}function p3(d,f,x){for(var C=-1,O=d.criteria,H=f.criteria,Q=O.length,ne=x.length;++C<Q;){var ce=tC(O[C],H[C]);if(ce){if(C>=ne)return ce;var Se=x[C];return ce*(Se=="desc"?-1:1)}}return d.index-f.index}function nC(d,f,x,C){for(var O=-1,H=d.length,Q=x.length,ne=-1,ce=f.length,Se=yi(H-Q,0),Ee=me(ce+Se),Ce=!C;++ne<ce;)Ee[ne]=f[ne];for(;++O<Q;)(Ce||O<H)&&(Ee[x[O]]=d[O]);for(;Se--;)Ee[ne++]=d[O++];return Ee}function iC(d,f,x,C){for(var O=-1,H=d.length,Q=-1,ne=x.length,ce=-1,Se=f.length,Ee=yi(H-ne,0),Ce=me(Ee+Se),Ke=!C;++O<Ee;)Ce[O]=d[O];for(var pt=O;++ce<Se;)Ce[pt+ce]=f[ce];for(;++Q<ne;)(Ke||O<H)&&(Ce[pt+x[Q]]=d[O++]);return Ce}function jr(d,f){var x=-1,C=d.length;for(f||(f=me(C));++x<C;)f[x]=d[x];return f}function Ia(d,f,x,C){var O=!x;x||(x={});for(var H=-1,Q=f.length;++H<Q;){var ne=f[H],ce=C?C(x[ne],d[ne],ne,x,d):t;ce===t&&(ce=d[ne]),O?ko(x,ne,ce):bm(x,ne,ce)}return x}function f3(d,f){return Ia(d,ak(d),f)}function m3(d,f){return Ia(d,gC(d),f)}function sv(d,f){return function(x,C){var O=Pt(x)?xV:LU,H=f?f():{};return O(x,d,yt(C,2),H)}}function Ph(d){return Vt(function(f,x){var C=-1,O=x.length,H=O>1?x[O-1]:t,Q=O>2?x[2]:t;for(H=d.length>3&&typeof H=="function"?(O--,H):t,Q&&yr(x[0],x[1],Q)&&(H=O<3?t:H,O=1),f=En(f);++C<O;){var ne=x[C];ne&&d(f,ne,C,H)}return f})}function rC(d,f){return function(x,C){if(x==null)return x;if(!Or(x))return d(x,C);for(var O=x.length,H=f?O:-1,Q=En(x);(f?H--:++H<O)&&C(Q[H],H,Q)!==!1;);return x}}function sC(d){return function(f,x,C){for(var O=-1,H=En(f),Q=C(f),ne=Q.length;ne--;){var ce=Q[d?ne:++O];if(x(H[ce],ce,H)===!1)break}return f}}function g3(d,f,x){var C=f&w,O=km(d);function H(){var Q=this&&this!==Bi&&this instanceof H?O:d;return Q.apply(C?x:this,arguments)}return H}function aC(d){return function(f){f=hn(f);var x=Dh(f)?na(f):t,C=x?x[0]:f.charAt(0),O=x?Ol(x,1).join(""):f.slice(1);return C[d]()+O}}function Th(d){return function(f){return Sw(rA(iA(f).replace(aV,"")),d,"")}}function km(d){return function(){var f=arguments;switch(f.length){case 0:return new d;case 1:return new d(f[0]);case 2:return new d(f[0],f[1]);case 3:return new d(f[0],f[1],f[2]);case 4:return new d(f[0],f[1],f[2],f[3]);case 5:return new d(f[0],f[1],f[2],f[3],f[4]);case 6:return new d(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new d(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var x=Ah(d.prototype),C=d.apply(x,f);return Wn(C)?C:x}}function b3(d,f,x){var C=km(d);function O(){for(var H=arguments.length,Q=me(H),ne=H,ce=Ih(O);ne--;)Q[ne]=arguments[ne];var Se=H<3&&Q[0]!==ce&&Q[H-1]!==ce?[]:Tl(Q,ce);if(H-=Se.length,H<x)return dC(d,f,av,O.placeholder,t,Q,Se,t,t,x-H);var Ee=this&&this!==Bi&&this instanceof O?C:d;return Qr(Ee,this,Q)}return O}function oC(d){return function(f,x,C){var O=En(f);if(!Or(f)){var H=yt(x,3);f=Pi(f),x=function(ne){return H(O[ne],ne,O)}}var Q=d(f,x,C);return Q>-1?O[H?f[Q]:Q]:t}}function lC(d){return So(function(f){var x=f.length,C=x,O=Is.prototype.thru;for(d&&f.reverse();C--;){var H=f[C];if(typeof H!="function")throw new Ts(a);if(O&&!Q&&uv(H)=="wrapper")var Q=new Is([],!0)}for(C=Q?C:x;++C<x;){H=f[C];var ne=uv(H),ce=ne=="wrapper"?rk(H):t;ce&&lk(ce[0])&&ce[1]==(R|E|A|V)&&!ce[4].length&&ce[9]==1?Q=Q[uv(ce[0])].apply(Q,ce[3]):Q=H.length==1&&lk(H)?Q[ne]():Q.thru(H)}return function(){var Se=arguments,Ee=Se[0];if(Q&&Se.length==1&&Pt(Ee))return Q.plant(Ee).value();for(var Ce=0,Ke=x?f[Ce].apply(this,Se):Ee;++Ce<x;)Ke=f[Ce].call(this,Ke);return Ke}})}function av(d,f,x,C,O,H,Q,ne,ce,Se){var Ee=f&R,Ce=f&w,Ke=f&k,pt=f&(E|P),wt=f&B,Ot=Ke?t:km(d);function kt(){for(var qt=arguments.length,Kt=me(qt),ts=qt;ts--;)Kt[ts]=arguments[ts];if(pt)var vr=Ih(kt),ns=AV(Kt,vr);if(C&&(Kt=nC(Kt,C,O,pt)),H&&(Kt=iC(Kt,H,Q,pt)),qt-=ns,pt&&qt<Se){var ni=Tl(Kt,vr);return dC(d,f,av,kt.placeholder,x,Kt,ni,ne,ce,Se-qt)}var sa=Ce?x:this,Co=Ke?sa[d]:d;return qt=Kt.length,ne?Kt=L3(Kt,ne):wt&&qt>1&&Kt.reverse(),Ee&&ce<qt&&(Kt.length=ce),this&&this!==Bi&&this instanceof kt&&(Co=Ot||km(Co)),Co.apply(sa,Kt)}return kt}function cC(d,f){return function(x,C){return HU(x,d,f(C),{})}}function ov(d,f){return function(x,C){var O;if(x===t&&C===t)return f;if(x!==t&&(O=x),C!==t){if(O===t)return C;typeof x=="string"||typeof C=="string"?(x=Zr(x),C=Zr(C)):(x=Y_(x),C=Y_(C)),O=d(x,C)}return O}}function ek(d){return So(function(f){return f=On(f,Jr(yt())),Vt(function(x){var C=this;return d(f,function(O){return Qr(O,C,x)})})})}function lv(d,f){f=f===t?" ":Zr(f);var x=f.length;if(x<2)return x?Gw(f,d):f;var C=Gw(f,Yy(d/Sh(f)));return Dh(f)?Ol(na(C),0,d).join(""):C.slice(0,d)}function y3(d,f,x,C){var O=f&w,H=km(d);function Q(){for(var ne=-1,ce=arguments.length,Se=-1,Ee=C.length,Ce=me(Ee+ce),Ke=this&&this!==Bi&&this instanceof Q?H:d;++Se<Ee;)Ce[Se]=C[Se];for(;ce--;)Ce[Se++]=arguments[++ne];return Qr(Ke,O?x:this,Ce)}return Q}function uC(d){return function(f,x,C){return C&&typeof C!="number"&&yr(f,x,C)&&(x=C=t),f=_o(f),x===t?(x=f,f=0):x=_o(x),C=C===t?f<x?1:-1:_o(C),i3(f,x,C,d)}}function cv(d){return function(f,x){return typeof f=="string"&&typeof x=="string"||(f=Os(f),x=Os(x)),d(f,x)}}function dC(d,f,x,C,O,H,Q,ne,ce,Se){var Ee=f&E,Ce=Ee?Q:t,Ke=Ee?t:Q,pt=Ee?H:t,wt=Ee?t:H;f|=Ee?A:N,f&=~(Ee?N:A),f&S||(f&=-4);var Ot=[d,f,O,pt,Ce,wt,Ke,ne,ce,Se],kt=x.apply(t,Ot);return lk(d)&&DC(kt,Ot),kt.placeholder=C,SC(kt,d,f)}function tk(d){var f=bi[d];return function(x,C){if(x=Os(x),C=C==null?0:sr(Mt(C),292),C&&S_(x)){var O=(hn(x)+"e").split("e"),H=f(O[0]+"e"+(+O[1]+C));return O=(hn(H)+"e").split("e"),+(O[0]+"e"+(+O[1]-C))}return f(x)}}var v3=_h&&1/Fy(new _h([,-0]))[1]==ee?function(d){return new _h(d)}:Dk;function hC(d){return function(f){var x=ar(f);return x==ye?Tw(f):x==ct?OV(f):CV(f,d(f))}}function Do(d,f,x,C,O,H,Q,ne){var ce=f&k;if(!ce&&typeof d!="function")throw new Ts(a);var Se=C?C.length:0;if(Se||(f&=-97,C=O=t),Q=Q===t?Q:yi(Mt(Q),0),ne=ne===t?ne:Mt(ne),Se-=O?O.length:0,f&N){var Ee=C,Ce=O;C=O=t}var Ke=ce?t:rk(d),pt=[d,f,x,C,O,Ee,Ce,H,Q,ne];if(Ke&&M3(pt,Ke),d=pt[0],f=pt[1],x=pt[2],C=pt[3],O=pt[4],ne=pt[9]=pt[9]===t?ce?0:d.length:yi(pt[9]-Se,0),!ne&&f&(E|P)&&(f&=-25),!f||f==w)var wt=g3(d,f,x);else f==E||f==P?wt=b3(d,f,ne):(f==A||f==(w|A))&&!O.length?wt=y3(d,f,x,C):wt=av.apply(t,pt);var Ot=Ke?q_:DC;return SC(Ot(wt,pt),d,f)}function pC(d,f,x,C){return d===t||ra(d,Nh[x])&&!bn.call(C,x)?f:d}function fC(d,f,x,C,O,H){return Wn(d)&&Wn(f)&&(H.set(f,d),nv(d,f,t,fC,H),H.delete(f)),d}function x3(d){return Em(d)?t:d}function mC(d,f,x,C,O,H){var Q=x&y,ne=d.length,ce=f.length;if(ne!=ce&&!(Q&&ce>ne))return!1;var Se=H.get(d),Ee=H.get(f);if(Se&&Ee)return Se==f&&Ee==d;var Ce=-1,Ke=!0,pt=x&v?new pu:t;for(H.set(d,f),H.set(f,d);++Ce<ne;){var wt=d[Ce],Ot=f[Ce];if(C)var kt=Q?C(Ot,wt,Ce,f,d,H):C(wt,Ot,Ce,d,f,H);if(kt!==t){if(kt)continue;Ke=!1;break}if(pt){if(!Ew(f,function(qt,Kt){if(!dm(pt,Kt)&&(wt===qt||O(wt,qt,x,C,H)))return pt.push(Kt)})){Ke=!1;break}}else if(!(wt===Ot||O(wt,Ot,x,C,H))){Ke=!1;break}}return H.delete(d),H.delete(f),Ke}function w3(d,f,x,C,O,H,Q){switch(x){case Pe:if(d.byteLength!=f.byteLength||d.byteOffset!=f.byteOffset)return!1;d=d.buffer,f=f.buffer;case de:return!(d.byteLength!=f.byteLength||!H(new Wy(d),new Wy(f)));case je:case ze:case He:return ra(+d,+f);case we:return d.name==f.name&&d.message==f.message;case Xe:case tn:return d==f+"";case ye:var ne=Tw;case ct:var ce=C&y;if(ne||(ne=Fy),d.size!=f.size&&!ce)return!1;var Se=Q.get(d);if(Se)return Se==f;C|=v,Q.set(d,f);var Ee=mC(ne(d),ne(f),C,O,H,Q);return Q.delete(d),Ee;case on:if(gm)return gm.call(d)==gm.call(f)}return!1}function k3(d,f,x,C,O,H){var Q=x&y,ne=nk(d),ce=ne.length,Se=nk(f),Ee=Se.length;if(ce!=Ee&&!Q)return!1;for(var Ce=ce;Ce--;){var Ke=ne[Ce];if(!(Q?Ke in f:bn.call(f,Ke)))return!1}var pt=H.get(d),wt=H.get(f);if(pt&&wt)return pt==f&&wt==d;var Ot=!0;H.set(d,f),H.set(f,d);for(var kt=Q;++Ce<ce;){Ke=ne[Ce];var qt=d[Ke],Kt=f[Ke];if(C)var ts=Q?C(Kt,qt,Ke,f,d,H):C(qt,Kt,Ke,d,f,H);if(!(ts===t?qt===Kt||O(qt,Kt,x,C,H):ts)){Ot=!1;break}kt||(kt=Ke=="constructor")}if(Ot&&!kt){var vr=d.constructor,ns=f.constructor;vr!=ns&&"constructor"in d&&"constructor"in f&&!(typeof vr=="function"&&vr instanceof vr&&typeof ns=="function"&&ns instanceof ns)&&(Ot=!1)}return H.delete(d),H.delete(f),Ot}function So(d){return uk(wC(d,t,PC),d+"")}function nk(d){return j_(d,Pi,ak)}function ik(d){return j_(d,Lr,gC)}var rk=Ky?function(d){return Ky.get(d)}:Dk;function uv(d){for(var f=d.name+"",x=Ch[f],C=bn.call(Ch,f)?x.length:0;C--;){var O=x[C],H=O.func;if(H==null||H==d)return O.name}return f}function Ih(d){var f=bn.call(z,"placeholder")?z:d;return f.placeholder}function yt(){var d=z.iteratee||wk;return d=d===wk?F_:d,arguments.length?d(arguments[0],arguments[1]):d}function dv(d,f){var x=d.__data__;return P3(f)?x[typeof f=="string"?"string":"hash"]:x.map}function sk(d){for(var f=Pi(d),x=f.length;x--;){var C=f[x],O=d[C];f[x]=[C,O,vC(O)]}return f}function gu(d,f){var x=RV(d,f);return L_(x)?x:t}function D3(d){var f=bn.call(d,du),x=d[du];try{d[du]=t;var C=!0}catch{}var O=By.call(d);return C&&(f?d[du]=x:delete d[du]),O}var ak=Rw?function(d){return d==null?[]:(d=En(d),Al(Rw(d),function(f){return k_.call(d,f)}))}:Sk,gC=Rw?function(d){for(var f=[];d;)Pl(f,ak(d)),d=Hy(d);return f}:Sk,ar=br;(Mw&&ar(new Mw(new ArrayBuffer(1)))!=Pe||pm&&ar(new pm)!=ye||jw&&ar(jw.resolve())!=Be||_h&&ar(new _h)!=ct||fm&&ar(new fm)!=Ge)&&(ar=function(d){var f=br(d),x=f==et?d.constructor:t,C=x?bu(x):"";if(C)switch(C){case sU:return Pe;case aU:return ye;case oU:return Be;case lU:return ct;case cU:return Ge}return f});function S3(d,f,x){for(var C=-1,O=x.length;++C<O;){var H=x[C],Q=H.size;switch(H.type){case"drop":d+=Q;break;case"dropRight":f-=Q;break;case"take":f=sr(f,d+Q);break;case"takeRight":d=yi(d,f-Q);break}}return{start:d,end:f}}function E3(d){var f=d.match(Ie);return f?f[1].split(Je):[]}function bC(d,f,x){f=jl(f,d);for(var C=-1,O=f.length,H=!1;++C<O;){var Q=Ra(f[C]);if(!(H=d!=null&&x(d,Q)))break;d=d[Q]}return H||++C!=O?H:(O=d==null?0:d.length,!!O&&yv(O)&&Eo(Q,O)&&(Pt(d)||yu(d)))}function N3(d){var f=d.length,x=new d.constructor(f);return f&&typeof d[0]=="string"&&bn.call(d,"index")&&(x.index=d.index,x.input=d.input),x}function yC(d){return typeof d.constructor=="function"&&!Dm(d)?Ah(Hy(d)):{}}function _3(d,f,x){var C=d.constructor;switch(f){case de:return Zw(d);case je:case ze:return new C(+d);case Pe:return u3(d,x);case Le:case $e:case ht:case Et:case Ut:case zt:case Te:case Ue:case ke:return eC(d,x);case ye:return new C;case He:case tn:return new C(d);case Xe:return d3(d);case ct:return new C;case on:return h3(d)}}function C3(d,f){var x=f.length;if(!x)return d;var C=x-1;return f[C]=(x>1?"& ":"")+f[C],f=f.join(x>2?", ":" "),d.replace(Z,`{
/* [wrapped with `+f+`] */
`)}function A3(d){return Pt(d)||yu(d)||!!(D_&&d&&d[D_])}function Eo(d,f){var x=typeof d;return f=f??fe,!!f&&(x=="number"||x!="symbol"&&Cl.test(d))&&d>-1&&d%1==0&&d<f}function yr(d,f,x){if(!Wn(x))return!1;var C=typeof f;return(C=="number"?Or(x)&&Eo(f,x.length):C=="string"&&f in x)?ra(x[f],d):!1}function ok(d,f){if(Pt(d))return!1;var x=typeof d;return x=="number"||x=="symbol"||x=="boolean"||d==null||es(d)?!0:rr.test(d)||!Rn.test(d)||f!=null&&d in En(f)}function P3(d){var f=typeof d;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?d!=="__proto__":d===null}function lk(d){var f=uv(d),x=z[f];if(typeof x!="function"||!(f in Xt.prototype))return!1;if(d===x)return!0;var C=rk(x);return!!C&&d===C[0]}function T3(d){return!!v_&&v_ in d}var I3=Uy?No:Ek;function Dm(d){var f=d&&d.constructor,x=typeof f=="function"&&f.prototype||Nh;return d===x}function vC(d){return d===d&&!Wn(d)}function xC(d,f){return function(x){return x==null?!1:x[d]===f&&(f!==t||d in En(x))}}function R3(d){var f=gv(d,function(C){return x.size===c&&x.clear(),C}),x=f.cache;return f}function M3(d,f){var x=d[1],C=f[1],O=x|C,H=O<(w|k|R),Q=C==R&&x==E||C==R&&x==V&&d[7].length<=f[8]||C==(R|V)&&f[7].length<=f[8]&&x==E;if(!(H||Q))return d;C&w&&(d[2]=f[2],O|=x&w?0:S);var ne=f[3];if(ne){var ce=d[3];d[3]=ce?nC(ce,ne,f[4]):ne,d[4]=ce?Tl(d[3],u):f[4]}return ne=f[5],ne&&(ce=d[5],d[5]=ce?iC(ce,ne,f[6]):ne,d[6]=ce?Tl(d[5],u):f[6]),ne=f[7],ne&&(d[7]=ne),C&R&&(d[8]=d[8]==null?f[8]:sr(d[8],f[8])),d[9]==null&&(d[9]=f[9]),d[0]=f[0],d[1]=O,d}function j3(d){var f=[];if(d!=null)for(var x in En(d))f.push(x);return f}function O3(d){return By.call(d)}function wC(d,f,x){return f=yi(f===t?d.length-1:f,0),function(){for(var C=arguments,O=-1,H=yi(C.length-f,0),Q=me(H);++O<H;)Q[O]=C[f+O];O=-1;for(var ne=me(f+1);++O<f;)ne[O]=C[O];return ne[f]=x(Q),Qr(d,this,ne)}}function kC(d,f){return f.length<2?d:mu(d,Ms(f,0,-1))}function L3(d,f){for(var x=d.length,C=sr(f.length,x),O=jr(d);C--;){var H=f[C];d[C]=Eo(H,x)?O[H]:t}return d}function ck(d,f){if(!(f==="constructor"&&typeof d[f]=="function")&&f!="__proto__")return d[f]}var DC=EC(q_),Sm=JV||function(d,f){return Bi.setTimeout(d,f)},uk=EC(a3);function SC(d,f,x){var C=f+"";return uk(d,C3(C,F3(E3(C),x)))}function EC(d){var f=0,x=0;return function(){var C=nU(),O=X-(C-x);if(x=C,O>0){if(++f>=q)return arguments[0]}else f=0;return d.apply(t,arguments)}}function hv(d,f){var x=-1,C=d.length,O=C-1;for(f=f===t?C:f;++x<f;){var H=qw(x,O),Q=d[H];d[H]=d[x],d[x]=Q}return d.length=f,d}var NC=R3(function(d){var f=[];return d.charCodeAt(0)===46&&f.push(""),d.replace(vh,function(x,C,O,H){f.push(O?H.replace(gn,"$1"):C||x)}),f});function Ra(d){if(typeof d=="string"||es(d))return d;var f=d+"";return f=="0"&&1/d==-1/0?"-0":f}function bu(d){if(d!=null){try{return zy.call(d)}catch{}try{return d+""}catch{}}return""}function F3(d,f){return Ps(Y,function(x){var C="_."+x[0];f&x[1]&&!Oy(d,C)&&d.push(C)}),d.sort()}function _C(d){if(d instanceof Xt)return d.clone();var f=new Is(d.__wrapped__,d.__chain__);return f.__actions__=jr(d.__actions__),f.__index__=d.__index__,f.__values__=d.__values__,f}function V3(d,f,x){(x?yr(d,f,x):f===t)?f=1:f=yi(Mt(f),0);var C=d==null?0:d.length;if(!C||f<1)return[];for(var O=0,H=0,Q=me(Yy(C/f));O<C;)Q[H++]=Ms(d,O,O+=f);return Q}function U3(d){for(var f=-1,x=d==null?0:d.length,C=0,O=[];++f<x;){var H=d[f];H&&(O[C++]=H)}return O}function z3(){var d=arguments.length;if(!d)return[];for(var f=me(d-1),x=arguments[0],C=d;C--;)f[C-1]=arguments[C];return Pl(Pt(x)?jr(x):[x],$i(f,1))}var B3=Vt(function(d,f){return ti(d)?ym(d,$i(f,1,ti,!0)):[]}),$3=Vt(function(d,f){var x=js(f);return ti(x)&&(x=t),ti(d)?ym(d,$i(f,1,ti,!0),yt(x,2)):[]}),W3=Vt(function(d,f){var x=js(f);return ti(x)&&(x=t),ti(d)?ym(d,$i(f,1,ti,!0),t,x):[]});function H3(d,f,x){var C=d==null?0:d.length;return C?(f=x||f===t?1:Mt(f),Ms(d,f<0?0:f,C)):[]}function q3(d,f,x){var C=d==null?0:d.length;return C?(f=x||f===t?1:Mt(f),f=C-f,Ms(d,0,f<0?0:f)):[]}function G3(d,f){return d&&d.length?rv(d,yt(f,3),!0,!0):[]}function Y3(d,f){return d&&d.length?rv(d,yt(f,3),!0):[]}function X3(d,f,x,C){var O=d==null?0:d.length;return O?(x&&typeof x!="number"&&yr(d,f,x)&&(x=0,C=O),zU(d,f,x,C)):[]}function CC(d,f,x){var C=d==null?0:d.length;if(!C)return-1;var O=x==null?0:Mt(x);return O<0&&(O=yi(C+O,0)),Ly(d,yt(f,3),O)}function AC(d,f,x){var C=d==null?0:d.length;if(!C)return-1;var O=C-1;return x!==t&&(O=Mt(x),O=x<0?yi(C+O,0):sr(O,C-1)),Ly(d,yt(f,3),O,!0)}function PC(d){var f=d==null?0:d.length;return f?$i(d,1):[]}function K3(d){var f=d==null?0:d.length;return f?$i(d,ee):[]}function Q3(d,f){var x=d==null?0:d.length;return x?(f=f===t?1:Mt(f),$i(d,f)):[]}function J3(d){for(var f=-1,x=d==null?0:d.length,C={};++f<x;){var O=d[f];C[O[0]]=O[1]}return C}function TC(d){return d&&d.length?d[0]:t}function Z3(d,f,x){var C=d==null?0:d.length;if(!C)return-1;var O=x==null?0:Mt(x);return O<0&&(O=yi(C+O,0)),kh(d,f,O)}function ez(d){var f=d==null?0:d.length;return f?Ms(d,0,-1):[]}var tz=Vt(function(d){var f=On(d,Qw);return f.length&&f[0]===d[0]?zw(f):[]}),nz=Vt(function(d){var f=js(d),x=On(d,Qw);return f===js(x)?f=t:x.pop(),x.length&&x[0]===d[0]?zw(x,yt(f,2)):[]}),iz=Vt(function(d){var f=js(d),x=On(d,Qw);return f=typeof f=="function"?f:t,f&&x.pop(),x.length&&x[0]===d[0]?zw(x,t,f):[]});function rz(d,f){return d==null?"":eU.call(d,f)}function js(d){var f=d==null?0:d.length;return f?d[f-1]:t}function sz(d,f,x){var C=d==null?0:d.length;if(!C)return-1;var O=C;return x!==t&&(O=Mt(x),O=O<0?yi(C+O,0):sr(O,C-1)),f===f?FV(d,f,O):Ly(d,d_,O,!0)}function az(d,f){return d&&d.length?B_(d,Mt(f)):t}var oz=Vt(IC);function IC(d,f){return d&&d.length&&f&&f.length?Hw(d,f):d}function lz(d,f,x){return d&&d.length&&f&&f.length?Hw(d,f,yt(x,2)):d}function cz(d,f,x){return d&&d.length&&f&&f.length?Hw(d,f,t,x):d}var uz=So(function(d,f){var x=d==null?0:d.length,C=Lw(d,f);return H_(d,On(f,function(O){return Eo(O,x)?+O:O}).sort(tC)),C});function dz(d,f){var x=[];if(!(d&&d.length))return x;var C=-1,O=[],H=d.length;for(f=yt(f,3);++C<H;){var Q=d[C];f(Q,C,d)&&(x.push(Q),O.push(C))}return H_(d,O),x}function dk(d){return d==null?d:rU.call(d)}function hz(d,f,x){var C=d==null?0:d.length;return C?(x&&typeof x!="number"&&yr(d,f,x)?(f=0,x=C):(f=f==null?0:Mt(f),x=x===t?C:Mt(x)),Ms(d,f,x)):[]}function pz(d,f){return iv(d,f)}function fz(d,f,x){return Yw(d,f,yt(x,2))}function mz(d,f){var x=d==null?0:d.length;if(x){var C=iv(d,f);if(C<x&&ra(d[C],f))return C}return-1}function gz(d,f){return iv(d,f,!0)}function bz(d,f,x){return Yw(d,f,yt(x,2),!0)}function yz(d,f){var x=d==null?0:d.length;if(x){var C=iv(d,f,!0)-1;if(ra(d[C],f))return C}return-1}function vz(d){return d&&d.length?G_(d):[]}function xz(d,f){return d&&d.length?G_(d,yt(f,2)):[]}function wz(d){var f=d==null?0:d.length;return f?Ms(d,1,f):[]}function kz(d,f,x){return d&&d.length?(f=x||f===t?1:Mt(f),Ms(d,0,f<0?0:f)):[]}function Dz(d,f,x){var C=d==null?0:d.length;return C?(f=x||f===t?1:Mt(f),f=C-f,Ms(d,f<0?0:f,C)):[]}function Sz(d,f){return d&&d.length?rv(d,yt(f,3),!1,!0):[]}function Ez(d,f){return d&&d.length?rv(d,yt(f,3)):[]}var Nz=Vt(function(d){return Ml($i(d,1,ti,!0))}),_z=Vt(function(d){var f=js(d);return ti(f)&&(f=t),Ml($i(d,1,ti,!0),yt(f,2))}),Cz=Vt(function(d){var f=js(d);return f=typeof f=="function"?f:t,Ml($i(d,1,ti,!0),t,f)});function Az(d){return d&&d.length?Ml(d):[]}function Pz(d,f){return d&&d.length?Ml(d,yt(f,2)):[]}function Tz(d,f){return f=typeof f=="function"?f:t,d&&d.length?Ml(d,t,f):[]}function hk(d){if(!(d&&d.length))return[];var f=0;return d=Al(d,function(x){if(ti(x))return f=yi(x.length,f),!0}),Aw(f,function(x){return On(d,Nw(x))})}function RC(d,f){if(!(d&&d.length))return[];var x=hk(d);return f==null?x:On(x,function(C){return Qr(f,t,C)})}var Iz=Vt(function(d,f){return ti(d)?ym(d,f):[]}),Rz=Vt(function(d){return Kw(Al(d,ti))}),Mz=Vt(function(d){var f=js(d);return ti(f)&&(f=t),Kw(Al(d,ti),yt(f,2))}),jz=Vt(function(d){var f=js(d);return f=typeof f=="function"?f:t,Kw(Al(d,ti),t,f)}),Oz=Vt(hk);function Lz(d,f){return Q_(d||[],f||[],bm)}function Fz(d,f){return Q_(d||[],f||[],wm)}var Vz=Vt(function(d){var f=d.length,x=f>1?d[f-1]:t;return x=typeof x=="function"?(d.pop(),x):t,RC(d,x)});function MC(d){var f=z(d);return f.__chain__=!0,f}function Uz(d,f){return f(d),d}function pv(d,f){return f(d)}var zz=So(function(d){var f=d.length,x=f?d[0]:0,C=this.__wrapped__,O=function(H){return Lw(H,d)};return f>1||this.__actions__.length||!(C instanceof Xt)||!Eo(x)?this.thru(O):(C=C.slice(x,+x+(f?1:0)),C.__actions__.push({func:pv,args:[O],thisArg:t}),new Is(C,this.__chain__).thru(function(H){return f&&!H.length&&H.push(t),H}))});function Bz(){return MC(this)}function $z(){return new Is(this.value(),this.__chain__)}function Wz(){this.__values__===t&&(this.__values__=YC(this.value()));var d=this.__index__>=this.__values__.length,f=d?t:this.__values__[this.__index__++];return{done:d,value:f}}function Hz(){return this}function qz(d){for(var f,x=this;x instanceof Jy;){var C=_C(x);C.__index__=0,C.__values__=t,f?O.__wrapped__=C:f=C;var O=C;x=x.__wrapped__}return O.__wrapped__=d,f}function Gz(){var d=this.__wrapped__;if(d instanceof Xt){var f=d;return this.__actions__.length&&(f=new Xt(this)),f=f.reverse(),f.__actions__.push({func:pv,args:[dk],thisArg:t}),new Is(f,this.__chain__)}return this.thru(dk)}function Yz(){return K_(this.__wrapped__,this.__actions__)}var Xz=sv(function(d,f,x){bn.call(d,x)?++d[x]:ko(d,x,1)});function Kz(d,f,x){var C=Pt(d)?c_:UU;return x&&yr(d,f,x)&&(f=t),C(d,yt(f,3))}function Qz(d,f){var x=Pt(d)?Al:R_;return x(d,yt(f,3))}var Jz=oC(CC),Zz=oC(AC);function eB(d,f){return $i(fv(d,f),1)}function tB(d,f){return $i(fv(d,f),ee)}function nB(d,f,x){return x=x===t?1:Mt(x),$i(fv(d,f),x)}function jC(d,f){var x=Pt(d)?Ps:Rl;return x(d,yt(f,3))}function OC(d,f){var x=Pt(d)?wV:I_;return x(d,yt(f,3))}var iB=sv(function(d,f,x){bn.call(d,x)?d[x].push(f):ko(d,x,[f])});function rB(d,f,x,C){d=Or(d)?d:Mh(d),x=x&&!C?Mt(x):0;var O=d.length;return x<0&&(x=yi(O+x,0)),vv(d)?x<=O&&d.indexOf(f,x)>-1:!!O&&kh(d,f,x)>-1}var sB=Vt(function(d,f,x){var C=-1,O=typeof f=="function",H=Or(d)?me(d.length):[];return Rl(d,function(Q){H[++C]=O?Qr(f,Q,x):vm(Q,f,x)}),H}),aB=sv(function(d,f,x){ko(d,x,f)});function fv(d,f){var x=Pt(d)?On:V_;return x(d,yt(f,3))}function oB(d,f,x,C){return d==null?[]:(Pt(f)||(f=f==null?[]:[f]),x=C?t:x,Pt(x)||(x=x==null?[]:[x]),$_(d,f,x))}var lB=sv(function(d,f,x){d[x?0:1].push(f)},function(){return[[],[]]});function cB(d,f,x){var C=Pt(d)?Sw:p_,O=arguments.length<3;return C(d,yt(f,4),x,O,Rl)}function uB(d,f,x){var C=Pt(d)?kV:p_,O=arguments.length<3;return C(d,yt(f,4),x,O,I_)}function dB(d,f){var x=Pt(d)?Al:R_;return x(d,bv(yt(f,3)))}function hB(d){var f=Pt(d)?C_:r3;return f(d)}function pB(d,f,x){(x?yr(d,f,x):f===t)?f=1:f=Mt(f);var C=Pt(d)?jU:s3;return C(d,f)}function fB(d){var f=Pt(d)?OU:o3;return f(d)}function mB(d){if(d==null)return 0;if(Or(d))return vv(d)?Sh(d):d.length;var f=ar(d);return f==ye||f==ct?d.size:$w(d).length}function gB(d,f,x){var C=Pt(d)?Ew:l3;return x&&yr(d,f,x)&&(f=t),C(d,yt(f,3))}var bB=Vt(function(d,f){if(d==null)return[];var x=f.length;return x>1&&yr(d,f[0],f[1])?f=[]:x>2&&yr(f[0],f[1],f[2])&&(f=[f[0]]),$_(d,$i(f,1),[])}),mv=QV||function(){return Bi.Date.now()};function yB(d,f){if(typeof f!="function")throw new Ts(a);return d=Mt(d),function(){if(--d<1)return f.apply(this,arguments)}}function LC(d,f,x){return f=x?t:f,f=d&&f==null?d.length:f,Do(d,R,t,t,t,t,f)}function FC(d,f){var x;if(typeof f!="function")throw new Ts(a);return d=Mt(d),function(){return--d>0&&(x=f.apply(this,arguments)),d<=1&&(f=t),x}}var pk=Vt(function(d,f,x){var C=w;if(x.length){var O=Tl(x,Ih(pk));C|=A}return Do(d,C,f,x,O)}),VC=Vt(function(d,f,x){var C=w|k;if(x.length){var O=Tl(x,Ih(VC));C|=A}return Do(f,C,d,x,O)});function UC(d,f,x){f=x?t:f;var C=Do(d,E,t,t,t,t,t,f);return C.placeholder=UC.placeholder,C}function zC(d,f,x){f=x?t:f;var C=Do(d,P,t,t,t,t,t,f);return C.placeholder=zC.placeholder,C}function BC(d,f,x){var C,O,H,Q,ne,ce,Se=0,Ee=!1,Ce=!1,Ke=!0;if(typeof d!="function")throw new Ts(a);f=Os(f)||0,Wn(x)&&(Ee=!!x.leading,Ce="maxWait"in x,H=Ce?yi(Os(x.maxWait)||0,f):H,Ke="trailing"in x?!!x.trailing:Ke);function pt(ni){var sa=C,Co=O;return C=O=t,Se=ni,Q=d.apply(Co,sa),Q}function wt(ni){return Se=ni,ne=Sm(qt,f),Ee?pt(ni):Q}function Ot(ni){var sa=ni-ce,Co=ni-Se,oA=f-sa;return Ce?sr(oA,H-Co):oA}function kt(ni){var sa=ni-ce,Co=ni-Se;return ce===t||sa>=f||sa<0||Ce&&Co>=H}function qt(){var ni=mv();if(kt(ni))return Kt(ni);ne=Sm(qt,Ot(ni))}function Kt(ni){return ne=t,Ke&&C?pt(ni):(C=O=t,Q)}function ts(){ne!==t&&J_(ne),Se=0,C=ce=O=ne=t}function vr(){return ne===t?Q:Kt(mv())}function ns(){var ni=mv(),sa=kt(ni);if(C=arguments,O=this,ce=ni,sa){if(ne===t)return wt(ce);if(Ce)return J_(ne),ne=Sm(qt,f),pt(ce)}return ne===t&&(ne=Sm(qt,f)),Q}return ns.cancel=ts,ns.flush=vr,ns}var vB=Vt(function(d,f){return T_(d,1,f)}),xB=Vt(function(d,f,x){return T_(d,Os(f)||0,x)});function wB(d){return Do(d,B)}function gv(d,f){if(typeof d!="function"||f!=null&&typeof f!="function")throw new Ts(a);var x=function(){var C=arguments,O=f?f.apply(this,C):C[0],H=x.cache;if(H.has(O))return H.get(O);var Q=d.apply(this,C);return x.cache=H.set(O,Q)||H,Q};return x.cache=new(gv.Cache||wo),x}gv.Cache=wo;function bv(d){if(typeof d!="function")throw new Ts(a);return function(){var f=arguments;switch(f.length){case 0:return!d.call(this);case 1:return!d.call(this,f[0]);case 2:return!d.call(this,f[0],f[1]);case 3:return!d.call(this,f[0],f[1],f[2])}return!d.apply(this,f)}}function kB(d){return FC(2,d)}var DB=c3(function(d,f){f=f.length==1&&Pt(f[0])?On(f[0],Jr(yt())):On($i(f,1),Jr(yt()));var x=f.length;return Vt(function(C){for(var O=-1,H=sr(C.length,x);++O<H;)C[O]=f[O].call(this,C[O]);return Qr(d,this,C)})}),fk=Vt(function(d,f){var x=Tl(f,Ih(fk));return Do(d,A,t,f,x)}),$C=Vt(function(d,f){var x=Tl(f,Ih($C));return Do(d,N,t,f,x)}),SB=So(function(d,f){return Do(d,V,t,t,t,f)});function EB(d,f){if(typeof d!="function")throw new Ts(a);return f=f===t?f:Mt(f),Vt(d,f)}function NB(d,f){if(typeof d!="function")throw new Ts(a);return f=f==null?0:yi(Mt(f),0),Vt(function(x){var C=x[f],O=Ol(x,0,f);return C&&Pl(O,C),Qr(d,this,O)})}function _B(d,f,x){var C=!0,O=!0;if(typeof d!="function")throw new Ts(a);return Wn(x)&&(C="leading"in x?!!x.leading:C,O="trailing"in x?!!x.trailing:O),BC(d,f,{leading:C,maxWait:f,trailing:O})}function CB(d){return LC(d,1)}function AB(d,f){return fk(Jw(f),d)}function PB(){if(!arguments.length)return[];var d=arguments[0];return Pt(d)?d:[d]}function TB(d){return Rs(d,g)}function IB(d,f){return f=typeof f=="function"?f:t,Rs(d,g,f)}function RB(d){return Rs(d,p|g)}function MB(d,f){return f=typeof f=="function"?f:t,Rs(d,p|g,f)}function jB(d,f){return f==null||P_(d,f,Pi(f))}function ra(d,f){return d===f||d!==d&&f!==f}var OB=cv(Uw),LB=cv(function(d,f){return d>=f}),yu=O_(function(){return arguments}())?O_:function(d){return Kn(d)&&bn.call(d,"callee")&&!k_.call(d,"callee")},Pt=me.isArray,FB=i_?Jr(i_):qU;function Or(d){return d!=null&&yv(d.length)&&!No(d)}function ti(d){return Kn(d)&&Or(d)}function VB(d){return d===!0||d===!1||Kn(d)&&br(d)==je}var Ll=ZV||Ek,UB=r_?Jr(r_):GU;function zB(d){return Kn(d)&&d.nodeType===1&&!Em(d)}function BB(d){if(d==null)return!0;if(Or(d)&&(Pt(d)||typeof d=="string"||typeof d.splice=="function"||Ll(d)||Rh(d)||yu(d)))return!d.length;var f=ar(d);if(f==ye||f==ct)return!d.size;if(Dm(d))return!$w(d).length;for(var x in d)if(bn.call(d,x))return!1;return!0}function $B(d,f){return xm(d,f)}function WB(d,f,x){x=typeof x=="function"?x:t;var C=x?x(d,f):t;return C===t?xm(d,f,t,x):!!C}function mk(d){if(!Kn(d))return!1;var f=br(d);return f==we||f==Ve||typeof d.message=="string"&&typeof d.name=="string"&&!Em(d)}function HB(d){return typeof d=="number"&&S_(d)}function No(d){if(!Wn(d))return!1;var f=br(d);return f==Ae||f==_e||f==xe||f==mt}function WC(d){return typeof d=="number"&&d==Mt(d)}function yv(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=fe}function Wn(d){var f=typeof d;return d!=null&&(f=="object"||f=="function")}function Kn(d){return d!=null&&typeof d=="object"}var HC=s_?Jr(s_):XU;function qB(d,f){return d===f||Bw(d,f,sk(f))}function GB(d,f,x){return x=typeof x=="function"?x:t,Bw(d,f,sk(f),x)}function YB(d){return qC(d)&&d!=+d}function XB(d){if(I3(d))throw new _t(s);return L_(d)}function KB(d){return d===null}function QB(d){return d==null}function qC(d){return typeof d=="number"||Kn(d)&&br(d)==He}function Em(d){if(!Kn(d)||br(d)!=et)return!1;var f=Hy(d);if(f===null)return!0;var x=bn.call(f,"constructor")&&f.constructor;return typeof x=="function"&&x instanceof x&&zy.call(x)==GV}var gk=a_?Jr(a_):KU;function JB(d){return WC(d)&&d>=-9007199254740991&&d<=fe}var GC=o_?Jr(o_):QU;function vv(d){return typeof d=="string"||!Pt(d)&&Kn(d)&&br(d)==tn}function es(d){return typeof d=="symbol"||Kn(d)&&br(d)==on}var Rh=l_?Jr(l_):JU;function ZB(d){return d===t}function e5(d){return Kn(d)&&ar(d)==Ge}function t5(d){return Kn(d)&&br(d)==ue}var n5=cv(Ww),i5=cv(function(d,f){return d<=f});function YC(d){if(!d)return[];if(Or(d))return vv(d)?na(d):jr(d);if(hm&&d[hm])return jV(d[hm]());var f=ar(d),x=f==ye?Tw:f==ct?Fy:Mh;return x(d)}function _o(d){if(!d)return d===0?d:0;if(d=Os(d),d===ee||d===-1/0){var f=d<0?-1:1;return f*ae}return d===d?d:0}function Mt(d){var f=_o(d),x=f%1;return f===f?x?f-x:f:0}function XC(d){return d?fu(Mt(d),0,he):0}function Os(d){if(typeof d=="number")return d;if(es(d))return U;if(Wn(d)){var f=typeof d.valueOf=="function"?d.valueOf():d;d=Wn(f)?f+"":f}if(typeof d!="string")return d===0?d:+d;d=f_(d);var x=$n.test(d);return x||Mr.test(d)?yV(d.slice(2),x?2:8):zi.test(d)?U:+d}function KC(d){return Ia(d,Lr(d))}function r5(d){return d?fu(Mt(d),-9007199254740991,fe):d===0?d:0}function hn(d){return d==null?"":Zr(d)}var s5=Ph(function(d,f){if(Dm(f)||Or(f)){Ia(f,Pi(f),d);return}for(var x in f)bn.call(f,x)&&bm(d,x,f[x])}),QC=Ph(function(d,f){Ia(f,Lr(f),d)}),xv=Ph(function(d,f,x,C){Ia(f,Lr(f),d,C)}),a5=Ph(function(d,f,x,C){Ia(f,Pi(f),d,C)}),o5=So(Lw);function l5(d,f){var x=Ah(d);return f==null?x:A_(x,f)}var c5=Vt(function(d,f){d=En(d);var x=-1,C=f.length,O=C>2?f[2]:t;for(O&&yr(f[0],f[1],O)&&(C=1);++x<C;)for(var H=f[x],Q=Lr(H),ne=-1,ce=Q.length;++ne<ce;){var Se=Q[ne],Ee=d[Se];(Ee===t||ra(Ee,Nh[Se])&&!bn.call(d,Se))&&(d[Se]=H[Se])}return d}),u5=Vt(function(d){return d.push(t,fC),Qr(JC,t,d)});function d5(d,f){return u_(d,yt(f,3),Ta)}function h5(d,f){return u_(d,yt(f,3),Vw)}function p5(d,f){return d==null?d:Fw(d,yt(f,3),Lr)}function f5(d,f){return d==null?d:M_(d,yt(f,3),Lr)}function m5(d,f){return d&&Ta(d,yt(f,3))}function g5(d,f){return d&&Vw(d,yt(f,3))}function b5(d){return d==null?[]:tv(d,Pi(d))}function y5(d){return d==null?[]:tv(d,Lr(d))}function bk(d,f,x){var C=d==null?t:mu(d,f);return C===t?x:C}function v5(d,f){return d!=null&&bC(d,f,BU)}function yk(d,f){return d!=null&&bC(d,f,$U)}var x5=cC(function(d,f,x){f!=null&&typeof f.toString!="function"&&(f=By.call(f)),d[f]=x},xk(Fr)),w5=cC(function(d,f,x){f!=null&&typeof f.toString!="function"&&(f=By.call(f)),bn.call(d,f)?d[f].push(x):d[f]=[x]},yt),k5=Vt(vm);function Pi(d){return Or(d)?__(d):$w(d)}function Lr(d){return Or(d)?__(d,!0):ZU(d)}function D5(d,f){var x={};return f=yt(f,3),Ta(d,function(C,O,H){ko(x,f(C,O,H),C)}),x}function S5(d,f){var x={};return f=yt(f,3),Ta(d,function(C,O,H){ko(x,O,f(C,O,H))}),x}var E5=Ph(function(d,f,x){nv(d,f,x)}),JC=Ph(function(d,f,x,C){nv(d,f,x,C)}),N5=So(function(d,f){var x={};if(d==null)return x;var C=!1;f=On(f,function(H){return H=jl(H,d),C||(C=H.length>1),H}),Ia(d,ik(d),x),C&&(x=Rs(x,p|m|g,x3));for(var O=f.length;O--;)Xw(x,f[O]);return x});function _5(d,f){return ZC(d,bv(yt(f)))}var C5=So(function(d,f){return d==null?{}:t3(d,f)});function ZC(d,f){if(d==null)return{};var x=On(ik(d),function(C){return[C]});return f=yt(f),W_(d,x,function(C,O){return f(C,O[0])})}function A5(d,f,x){f=jl(f,d);var C=-1,O=f.length;for(O||(O=1,d=t);++C<O;){var H=d==null?t:d[Ra(f[C])];H===t&&(C=O,H=x),d=No(H)?H.call(d):H}return d}function P5(d,f,x){return d==null?d:wm(d,f,x)}function T5(d,f,x,C){return C=typeof C=="function"?C:t,d==null?d:wm(d,f,x,C)}var eA=hC(Pi),tA=hC(Lr);function I5(d,f,x){var C=Pt(d),O=C||Ll(d)||Rh(d);if(f=yt(f,4),x==null){var H=d&&d.constructor;O?x=C?new H:[]:Wn(d)?x=No(H)?Ah(Hy(d)):{}:x={}}return(O?Ps:Ta)(d,function(Q,ne,ce){return f(x,Q,ne,ce)}),x}function R5(d,f){return d==null?!0:Xw(d,f)}function M5(d,f,x){return d==null?d:X_(d,f,Jw(x))}function j5(d,f,x,C){return C=typeof C=="function"?C:t,d==null?d:X_(d,f,Jw(x),C)}function Mh(d){return d==null?[]:Pw(d,Pi(d))}function O5(d){return d==null?[]:Pw(d,Lr(d))}function L5(d,f,x){return x===t&&(x=f,f=t),x!==t&&(x=Os(x),x=x===x?x:0),f!==t&&(f=Os(f),f=f===f?f:0),fu(Os(d),f,x)}function F5(d,f,x){return f=_o(f),x===t?(x=f,f=0):x=_o(x),d=Os(d),WU(d,f,x)}function V5(d,f,x){if(x&&typeof x!="boolean"&&yr(d,f,x)&&(f=x=t),x===t&&(typeof f=="boolean"?(x=f,f=t):typeof d=="boolean"&&(x=d,d=t)),d===t&&f===t?(d=0,f=1):(d=_o(d),f===t?(f=d,d=0):f=_o(f)),d>f){var C=d;d=f,f=C}if(x||d%1||f%1){var O=E_();return sr(d+O*(f-d+bV("1e-"+((O+"").length-1))),f)}return qw(d,f)}var U5=Th(function(d,f,x){return f=f.toLowerCase(),d+(x?nA(f):f)});function nA(d){return vk(hn(d).toLowerCase())}function iA(d){return d=hn(d),d&&d.replace(vo,PV).replace(oV,"")}function z5(d,f,x){d=hn(d),f=Zr(f);var C=d.length;x=x===t?C:fu(Mt(x),0,C);var O=x;return x-=f.length,x>=0&&d.slice(x,O)==f}function B5(d){return d=hn(d),d&&yh.test(d)?d.replace(vn,TV):d}function $5(d){return d=hn(d),d&&My.test(d)?d.replace(lm,"\\$&"):d}var W5=Th(function(d,f,x){return d+(x?"-":"")+f.toLowerCase()}),H5=Th(function(d,f,x){return d+(x?" ":"")+f.toLowerCase()}),q5=aC("toLowerCase");function G5(d,f,x){d=hn(d),f=Mt(f);var C=f?Sh(d):0;if(!f||C>=f)return d;var O=(f-C)/2;return lv(Xy(O),x)+d+lv(Yy(O),x)}function Y5(d,f,x){d=hn(d),f=Mt(f);var C=f?Sh(d):0;return f&&C<f?d+lv(f-C,x):d}function X5(d,f,x){d=hn(d),f=Mt(f);var C=f?Sh(d):0;return f&&C<f?lv(f-C,x)+d:d}function K5(d,f,x){return x||f==null?f=0:f&&(f=+f),iU(hn(d).replace(cm,""),f||0)}function Q5(d,f,x){return(x?yr(d,f,x):f===t)?f=1:f=Mt(f),Gw(hn(d),f)}function J5(){var d=arguments,f=hn(d[0]);return d.length<3?f:f.replace(d[1],d[2])}var Z5=Th(function(d,f,x){return d+(x?"_":"")+f.toLowerCase()});function e$(d,f,x){return x&&typeof x!="number"&&yr(d,f,x)&&(f=x=t),x=x===t?he:x>>>0,x?(d=hn(d),d&&(typeof f=="string"||f!=null&&!gk(f))&&(f=Zr(f),!f&&Dh(d))?Ol(na(d),0,x):d.split(f,x)):[]}var t$=Th(function(d,f,x){return d+(x?" ":"")+vk(f)});function n$(d,f,x){return d=hn(d),x=x==null?0:fu(Mt(x),0,d.length),f=Zr(f),d.slice(x,x+f.length)==f}function i$(d,f,x){var C=z.templateSettings;x&&yr(d,f,x)&&(f=t),d=hn(d),f=xv({},f,C,pC);var O=xv({},f.imports,C.imports,pC),H=Pi(O),Q=Pw(O,H),ne,ce,Se=0,Ee=f.interpolate||gi,Ce="__p += '",Ke=Iw((f.escape||gi).source+"|"+Ee.source+"|"+(Ee===om?Yt:gi).source+"|"+(f.evaluate||gi).source+"|$","g"),pt="//# sourceURL="+(bn.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++hV+"]")+`
`;d.replace(Ke,function(kt,qt,Kt,ts,vr,ns){return Kt||(Kt=ts),Ce+=d.slice(Se,ns).replace(um,IV),qt&&(ne=!0,Ce+=`' +
__e(`+qt+`) +
'`),vr&&(ce=!0,Ce+=`';
`+vr+`;
__p += '`),Kt&&(Ce+=`' +
((__t = (`+Kt+`)) == null ? '' : __t) +
'`),Se=ns+kt.length,kt}),Ce+=`';
`;var wt=bn.call(f,"variable")&&f.variable;if(!wt)Ce=`with (obj) {
`+Ce+`
}
`;else if(nn.test(wt))throw new _t(o);Ce=(ce?Ce.replace(ot,""):Ce).replace(Bt,"$1").replace(dn,"$1;"),Ce="function("+(wt||"obj")+`) {
`+(wt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ne?", __e = _.escape":"")+(ce?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Ce+`return __p
}`;var Ot=sA(function(){return cn(H,pt+"return "+Ce).apply(t,Q)});if(Ot.source=Ce,mk(Ot))throw Ot;return Ot}function r$(d){return hn(d).toLowerCase()}function s$(d){return hn(d).toUpperCase()}function a$(d,f,x){if(d=hn(d),d&&(x||f===t))return f_(d);if(!d||!(f=Zr(f)))return d;var C=na(d),O=na(f),H=m_(C,O),Q=g_(C,O)+1;return Ol(C,H,Q).join("")}function o$(d,f,x){if(d=hn(d),d&&(x||f===t))return d.slice(0,y_(d)+1);if(!d||!(f=Zr(f)))return d;var C=na(d),O=g_(C,na(f))+1;return Ol(C,0,O).join("")}function l$(d,f,x){if(d=hn(d),d&&(x||f===t))return d.replace(cm,"");if(!d||!(f=Zr(f)))return d;var C=na(d),O=m_(C,na(f));return Ol(C,O).join("")}function c$(d,f){var x=L,C=W;if(Wn(f)){var O="separator"in f?f.separator:O;x="length"in f?Mt(f.length):x,C="omission"in f?Zr(f.omission):C}d=hn(d);var H=d.length;if(Dh(d)){var Q=na(d);H=Q.length}if(x>=H)return d;var ne=x-Sh(C);if(ne<1)return C;var ce=Q?Ol(Q,0,ne).join(""):d.slice(0,ne);if(O===t)return ce+C;if(Q&&(ne+=ce.length-ne),gk(O)){if(d.slice(ne).search(O)){var Se,Ee=ce;for(O.global||(O=Iw(O.source,hn(Ft.exec(O))+"g")),O.lastIndex=0;Se=O.exec(Ee);)var Ce=Se.index;ce=ce.slice(0,Ce===t?ne:Ce)}}else if(d.indexOf(Zr(O),ne)!=ne){var Ke=ce.lastIndexOf(O);Ke>-1&&(ce=ce.slice(0,Ke))}return ce+C}function u$(d){return d=hn(d),d&&cu.test(d)?d.replace(oi,VV):d}var d$=Th(function(d,f,x){return d+(x?" ":"")+f.toUpperCase()}),vk=aC("toUpperCase");function rA(d,f,x){return d=hn(d),f=x?t:f,f===t?MV(d)?BV(d):EV(d):d.match(f)||[]}var sA=Vt(function(d,f){try{return Qr(d,t,f)}catch(x){return mk(x)?x:new _t(x)}}),h$=So(function(d,f){return Ps(f,function(x){x=Ra(x),ko(d,x,pk(d[x],d))}),d});function p$(d){var f=d==null?0:d.length,x=yt();return d=f?On(d,function(C){if(typeof C[1]!="function")throw new Ts(a);return[x(C[0]),C[1]]}):[],Vt(function(C){for(var O=-1;++O<f;){var H=d[O];if(Qr(H[0],this,C))return Qr(H[1],this,C)}})}function f$(d){return VU(Rs(d,p))}function xk(d){return function(){return d}}function m$(d,f){return d==null||d!==d?f:d}var g$=lC(),b$=lC(!0);function Fr(d){return d}function wk(d){return F_(typeof d=="function"?d:Rs(d,p))}function y$(d){return U_(Rs(d,p))}function v$(d,f){return z_(d,Rs(f,p))}var x$=Vt(function(d,f){return function(x){return vm(x,d,f)}}),w$=Vt(function(d,f){return function(x){return vm(d,x,f)}});function kk(d,f,x){var C=Pi(f),O=tv(f,C);x==null&&!(Wn(f)&&(O.length||!C.length))&&(x=f,f=d,d=this,O=tv(f,Pi(f)));var H=!(Wn(x)&&"chain"in x)||!!x.chain,Q=No(d);return Ps(O,function(ne){var ce=f[ne];d[ne]=ce,Q&&(d.prototype[ne]=function(){var Se=this.__chain__;if(H||Se){var Ee=d(this.__wrapped__),Ce=Ee.__actions__=jr(this.__actions__);return Ce.push({func:ce,args:arguments,thisArg:d}),Ee.__chain__=Se,Ee}return ce.apply(d,Pl([this.value()],arguments))})}),d}function k$(){return Bi._===this&&(Bi._=YV),this}function Dk(){}function D$(d){return d=Mt(d),Vt(function(f){return B_(f,d)})}var S$=ek(On),E$=ek(c_),N$=ek(Ew);function aA(d){return ok(d)?Nw(Ra(d)):n3(d)}function _$(d){return function(f){return d==null?t:mu(d,f)}}var C$=uC(),A$=uC(!0);function Sk(){return[]}function Ek(){return!1}function P$(){return{}}function T$(){return""}function I$(){return!0}function R$(d,f){if(d=Mt(d),d<1||d>fe)return[];var x=he,C=sr(d,he);f=yt(f),d-=he;for(var O=Aw(C,f);++x<d;)f(x);return O}function M$(d){return Pt(d)?On(d,Ra):es(d)?[d]:jr(NC(hn(d)))}function j$(d){var f=++qV;return hn(d)+f}var O$=ov(function(d,f){return d+f},0),L$=tk("ceil"),F$=ov(function(d,f){return d/f},1),V$=tk("floor");function U$(d){return d&&d.length?ev(d,Fr,Uw):t}function z$(d,f){return d&&d.length?ev(d,yt(f,2),Uw):t}function B$(d){return h_(d,Fr)}function $$(d,f){return h_(d,yt(f,2))}function W$(d){return d&&d.length?ev(d,Fr,Ww):t}function H$(d,f){return d&&d.length?ev(d,yt(f,2),Ww):t}var q$=ov(function(d,f){return d*f},1),G$=tk("round"),Y$=ov(function(d,f){return d-f},0);function X$(d){return d&&d.length?Cw(d,Fr):0}function K$(d,f){return d&&d.length?Cw(d,yt(f,2)):0}return z.after=yB,z.ary=LC,z.assign=s5,z.assignIn=QC,z.assignInWith=xv,z.assignWith=a5,z.at=o5,z.before=FC,z.bind=pk,z.bindAll=h$,z.bindKey=VC,z.castArray=PB,z.chain=MC,z.chunk=V3,z.compact=U3,z.concat=z3,z.cond=p$,z.conforms=f$,z.constant=xk,z.countBy=Xz,z.create=l5,z.curry=UC,z.curryRight=zC,z.debounce=BC,z.defaults=c5,z.defaultsDeep=u5,z.defer=vB,z.delay=xB,z.difference=B3,z.differenceBy=$3,z.differenceWith=W3,z.drop=H3,z.dropRight=q3,z.dropRightWhile=G3,z.dropWhile=Y3,z.fill=X3,z.filter=Qz,z.flatMap=eB,z.flatMapDeep=tB,z.flatMapDepth=nB,z.flatten=PC,z.flattenDeep=K3,z.flattenDepth=Q3,z.flip=wB,z.flow=g$,z.flowRight=b$,z.fromPairs=J3,z.functions=b5,z.functionsIn=y5,z.groupBy=iB,z.initial=ez,z.intersection=tz,z.intersectionBy=nz,z.intersectionWith=iz,z.invert=x5,z.invertBy=w5,z.invokeMap=sB,z.iteratee=wk,z.keyBy=aB,z.keys=Pi,z.keysIn=Lr,z.map=fv,z.mapKeys=D5,z.mapValues=S5,z.matches=y$,z.matchesProperty=v$,z.memoize=gv,z.merge=E5,z.mergeWith=JC,z.method=x$,z.methodOf=w$,z.mixin=kk,z.negate=bv,z.nthArg=D$,z.omit=N5,z.omitBy=_5,z.once=kB,z.orderBy=oB,z.over=S$,z.overArgs=DB,z.overEvery=E$,z.overSome=N$,z.partial=fk,z.partialRight=$C,z.partition=lB,z.pick=C5,z.pickBy=ZC,z.property=aA,z.propertyOf=_$,z.pull=oz,z.pullAll=IC,z.pullAllBy=lz,z.pullAllWith=cz,z.pullAt=uz,z.range=C$,z.rangeRight=A$,z.rearg=SB,z.reject=dB,z.remove=dz,z.rest=EB,z.reverse=dk,z.sampleSize=pB,z.set=P5,z.setWith=T5,z.shuffle=fB,z.slice=hz,z.sortBy=bB,z.sortedUniq=vz,z.sortedUniqBy=xz,z.split=e$,z.spread=NB,z.tail=wz,z.take=kz,z.takeRight=Dz,z.takeRightWhile=Sz,z.takeWhile=Ez,z.tap=Uz,z.throttle=_B,z.thru=pv,z.toArray=YC,z.toPairs=eA,z.toPairsIn=tA,z.toPath=M$,z.toPlainObject=KC,z.transform=I5,z.unary=CB,z.union=Nz,z.unionBy=_z,z.unionWith=Cz,z.uniq=Az,z.uniqBy=Pz,z.uniqWith=Tz,z.unset=R5,z.unzip=hk,z.unzipWith=RC,z.update=M5,z.updateWith=j5,z.values=Mh,z.valuesIn=O5,z.without=Iz,z.words=rA,z.wrap=AB,z.xor=Rz,z.xorBy=Mz,z.xorWith=jz,z.zip=Oz,z.zipObject=Lz,z.zipObjectDeep=Fz,z.zipWith=Vz,z.entries=eA,z.entriesIn=tA,z.extend=QC,z.extendWith=xv,kk(z,z),z.add=O$,z.attempt=sA,z.camelCase=U5,z.capitalize=nA,z.ceil=L$,z.clamp=L5,z.clone=TB,z.cloneDeep=RB,z.cloneDeepWith=MB,z.cloneWith=IB,z.conformsTo=jB,z.deburr=iA,z.defaultTo=m$,z.divide=F$,z.endsWith=z5,z.eq=ra,z.escape=B5,z.escapeRegExp=$5,z.every=Kz,z.find=Jz,z.findIndex=CC,z.findKey=d5,z.findLast=Zz,z.findLastIndex=AC,z.findLastKey=h5,z.floor=V$,z.forEach=jC,z.forEachRight=OC,z.forIn=p5,z.forInRight=f5,z.forOwn=m5,z.forOwnRight=g5,z.get=bk,z.gt=OB,z.gte=LB,z.has=v5,z.hasIn=yk,z.head=TC,z.identity=Fr,z.includes=rB,z.indexOf=Z3,z.inRange=F5,z.invoke=k5,z.isArguments=yu,z.isArray=Pt,z.isArrayBuffer=FB,z.isArrayLike=Or,z.isArrayLikeObject=ti,z.isBoolean=VB,z.isBuffer=Ll,z.isDate=UB,z.isElement=zB,z.isEmpty=BB,z.isEqual=$B,z.isEqualWith=WB,z.isError=mk,z.isFinite=HB,z.isFunction=No,z.isInteger=WC,z.isLength=yv,z.isMap=HC,z.isMatch=qB,z.isMatchWith=GB,z.isNaN=YB,z.isNative=XB,z.isNil=QB,z.isNull=KB,z.isNumber=qC,z.isObject=Wn,z.isObjectLike=Kn,z.isPlainObject=Em,z.isRegExp=gk,z.isSafeInteger=JB,z.isSet=GC,z.isString=vv,z.isSymbol=es,z.isTypedArray=Rh,z.isUndefined=ZB,z.isWeakMap=e5,z.isWeakSet=t5,z.join=rz,z.kebabCase=W5,z.last=js,z.lastIndexOf=sz,z.lowerCase=H5,z.lowerFirst=q5,z.lt=n5,z.lte=i5,z.max=U$,z.maxBy=z$,z.mean=B$,z.meanBy=$$,z.min=W$,z.minBy=H$,z.stubArray=Sk,z.stubFalse=Ek,z.stubObject=P$,z.stubString=T$,z.stubTrue=I$,z.multiply=q$,z.nth=az,z.noConflict=k$,z.noop=Dk,z.now=mv,z.pad=G5,z.padEnd=Y5,z.padStart=X5,z.parseInt=K5,z.random=V5,z.reduce=cB,z.reduceRight=uB,z.repeat=Q5,z.replace=J5,z.result=A5,z.round=G$,z.runInContext=le,z.sample=hB,z.size=mB,z.snakeCase=Z5,z.some=gB,z.sortedIndex=pz,z.sortedIndexBy=fz,z.sortedIndexOf=mz,z.sortedLastIndex=gz,z.sortedLastIndexBy=bz,z.sortedLastIndexOf=yz,z.startCase=t$,z.startsWith=n$,z.subtract=Y$,z.sum=X$,z.sumBy=K$,z.template=i$,z.times=R$,z.toFinite=_o,z.toInteger=Mt,z.toLength=XC,z.toLower=r$,z.toNumber=Os,z.toSafeInteger=r5,z.toString=hn,z.toUpper=s$,z.trim=a$,z.trimEnd=o$,z.trimStart=l$,z.truncate=c$,z.unescape=u$,z.uniqueId=j$,z.upperCase=d$,z.upperFirst=vk,z.each=jC,z.eachRight=OC,z.first=TC,kk(z,function(){var d={};return Ta(z,function(f,x){bn.call(z.prototype,x)||(d[x]=f)}),d}(),{chain:!1}),z.VERSION=i,Ps(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){z[d].placeholder=z}),Ps(["drop","take"],function(d,f){Xt.prototype[d]=function(x){x=x===t?1:yi(Mt(x),0);var C=this.__filtered__&&!f?new Xt(this):this.clone();return C.__filtered__?C.__takeCount__=sr(x,C.__takeCount__):C.__views__.push({size:sr(x,he),type:d+(C.__dir__<0?"Right":"")}),C},Xt.prototype[d+"Right"]=function(x){return this.reverse()[d](x).reverse()}}),Ps(["filter","map","takeWhile"],function(d,f){var x=f+1,C=x==G||x==J;Xt.prototype[d]=function(O){var H=this.clone();return H.__iteratees__.push({iteratee:yt(O,3),type:x}),H.__filtered__=H.__filtered__||C,H}}),Ps(["head","last"],function(d,f){var x="take"+(f?"Right":"");Xt.prototype[d]=function(){return this[x](1).value()[0]}}),Ps(["initial","tail"],function(d,f){var x="drop"+(f?"":"Right");Xt.prototype[d]=function(){return this.__filtered__?new Xt(this):this[x](1)}}),Xt.prototype.compact=function(){return this.filter(Fr)},Xt.prototype.find=function(d){return this.filter(d).head()},Xt.prototype.findLast=function(d){return this.reverse().find(d)},Xt.prototype.invokeMap=Vt(function(d,f){return typeof d=="function"?new Xt(this):this.map(function(x){return vm(x,d,f)})}),Xt.prototype.reject=function(d){return this.filter(bv(yt(d)))},Xt.prototype.slice=function(d,f){d=Mt(d);var x=this;return x.__filtered__&&(d>0||f<0)?new Xt(x):(d<0?x=x.takeRight(-d):d&&(x=x.drop(d)),f!==t&&(f=Mt(f),x=f<0?x.dropRight(-f):x.take(f-d)),x)},Xt.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},Xt.prototype.toArray=function(){return this.take(he)},Ta(Xt.prototype,function(d,f){var x=/^(?:filter|find|map|reject)|While$/.test(f),C=/^(?:head|last)$/.test(f),O=z[C?"take"+(f=="last"?"Right":""):f],H=C||/^find/.test(f);O&&(z.prototype[f]=function(){var Q=this.__wrapped__,ne=C?[1]:arguments,ce=Q instanceof Xt,Se=ne[0],Ee=ce||Pt(Q),Ce=function(qt){var Kt=O.apply(z,Pl([qt],ne));return C&&Ke?Kt[0]:Kt};Ee&&x&&typeof Se=="function"&&Se.length!=1&&(ce=Ee=!1);var Ke=this.__chain__,pt=!!this.__actions__.length,wt=H&&!Ke,Ot=ce&&!pt;if(!H&&Ee){Q=Ot?Q:new Xt(this);var kt=d.apply(Q,ne);return kt.__actions__.push({func:pv,args:[Ce],thisArg:t}),new Is(kt,Ke)}return wt&&Ot?d.apply(this,ne):(kt=this.thru(Ce),wt?C?kt.value()[0]:kt.value():kt)})}),Ps(["pop","push","shift","sort","splice","unshift"],function(d){var f=Vy[d],x=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",C=/^(?:pop|shift)$/.test(d);z.prototype[d]=function(){var O=arguments;if(C&&!this.__chain__){var H=this.value();return f.apply(Pt(H)?H:[],O)}return this[x](function(Q){return f.apply(Pt(Q)?Q:[],O)})}}),Ta(Xt.prototype,function(d,f){var x=z[f];if(x){var C=x.name+"";bn.call(Ch,C)||(Ch[C]=[]),Ch[C].push({name:f,func:x})}}),Ch[av(t,k).name]=[{name:"wrapper",func:t}],Xt.prototype.clone=uU,Xt.prototype.reverse=dU,Xt.prototype.value=hU,z.prototype.at=zz,z.prototype.chain=Bz,z.prototype.commit=$z,z.prototype.next=Wz,z.prototype.plant=qz,z.prototype.reverse=Gz,z.prototype.toJSON=z.prototype.valueOf=z.prototype.value=Yz,z.prototype.first=z.prototype.head,hm&&(z.prototype[hm]=Hz),z},Eh=$V();uu?((uu.exports=Eh)._=Eh,ww._=Eh):Bi._=Eh}).call(yY)}(qm,qm.exports)),qm.exports}var xY=vY();function Mv(n,e="An unexpected error occurred"){return n?n instanceof Error?n.message||e:wY(n)?n.message||`Database error: ${n.code||"unknown"}`:kY(n)?n.message||`API error: ${n.code||n.status||"unknown"}`:typeof n=="string"?n:DY(n)?n.message:e:e}function Gh(n,e){const t=e?`[${e}] `:"";if(n instanceof Error){console.error(`${t}Error:`,n.message),n.stack&&console.debug("Stack trace:",n.stack);return}console.error(`${t}Error:`,n)}function wY(n){return typeof n=="object"&&n!==null&&"message"in n&&"code"in n}function kY(n){return typeof n=="object"&&n!==null&&"message"in n}function DY(n){return typeof n=="object"&&n!==null&&"message"in n&&typeof n.message=="string"}const SY=({projects:n,selectedProjectId:e,loading:t,onSelectProject:i,onCreateProject:r,onRefresh:s})=>{const[a,o]=T.useState(!1),[l,c]=T.useState(""),[u,p]=T.useState(!1),m=jx(),g=async()=>{if(l.trim()){p(!0);try{await r(l),c(""),o(!1)}catch(w){console.error("Error creating project:",w)}finally{p(!1)}}},y=w=>{i(w),m(`/projects/${w}`)},v=async()=>{await s()};return b.jsxDEV(b.Fragment,{children:[b.jsxDEV("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 16px",marginBottom:8},children:[b.jsxDEV(ge,{variant:"subtitle1",fontWeight:"bold",children:"Projects"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:80,columnNumber:9},void 0),b.jsxDEV("div",{children:[b.jsxDEV(Nt,{title:"Refresh projects",children:b.jsxDEV(ut,{onClick:v,size:"small",children:b.jsxDEV(sE,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:86,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:85,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:84,columnNumber:11},void 0),b.jsxDEV(Nt,{title:"Create new project",children:b.jsxDEV(ut,{onClick:()=>o(!0),size:"small",color:"primary","data-test":"create-project-button",children:b.jsxDEV(Qd,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:96,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:89,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:83,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:79,columnNumber:7},void 0),b.jsxDEV(nu,{sx:{width:"100%",bgcolor:"background.paper",overflow:"auto","& .MuiListItemButton-root.Mui-selected":{bgcolor:"action.selected",borderLeft:"3px solid",borderLeftColor:"primary.main",pl:1.75}},component:"nav","aria-label":"projects list",children:t?Array.from(new Array(3)).map((w,k)=>b.jsxDEV(Js,{disablePadding:!0,children:b.jsxDEV(qf,{disabled:!0,children:b.jsxDEV(si,{primary:b.jsxDEV(Na,{width:"80%"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:124,columnNumber:28},void 0),secondary:b.jsxDEV(Na,{width:"40%"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:125,columnNumber:30},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:123,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:122,columnNumber:15},void 0)},`skeleton-${k}`,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:121,columnNumber:13},void 0)):n.length===0?b.jsxDEV(Js,{children:b.jsxDEV(si,{primary:"No projects found",secondary:b.jsxDEV(vt,{startIcon:b.jsxDEV(Qd,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:137,columnNumber:30},void 0),onClick:()=>o(!0),size:"small",sx:{mt:1},children:"Create your first project"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:136,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:133,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:132,columnNumber:11},void 0):b.jsxDEV(b.Fragment,{children:n.map(w=>b.jsxDEV(Js,{disablePadding:!0,divider:!0,children:b.jsxDEV(qf,{selected:e===w.id,onClick:()=>y(w.id),"data-test":`project-item-${w.id}`,children:b.jsxDEV(si,{primary:w.name,secondary:b.jsxDEV(ge,{variant:"caption",color:"text.secondary",component:"span",children:new Date(w.created_at).toLocaleDateString()},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:160,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:157,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:152,columnNumber:17},void 0)},w.id,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:151,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:149,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:103,columnNumber:7},void 0),b.jsxDEV(uh,{open:a,onClose:()=>!u&&o(!1),"aria-labelledby":"create-project-dialog-title",maxWidth:"xs",fullWidth:!0,children:[b.jsxDEV(Zf,{id:"create-project-dialog-title",children:"Create New Project"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:180,columnNumber:9},void 0),b.jsxDEV(dh,{children:[b.jsxDEV(TR,{children:"Enter a name for your new project. This will be used to organize your files and notes."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:184,columnNumber:11},void 0),b.jsxDEV(Ni,{autoFocus:!0,margin:"dense",id:"project-name",label:"Project Name",type:"text",fullWidth:!0,variant:"outlined",value:l,onChange:w=>c(w.target.value),disabled:u,inputProps:{maxLength:50},onKeyPress:w=>{w.key==="Enter"&&l.trim()&&g()}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:187,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:183,columnNumber:9},void 0),b.jsxDEV(ch,{children:[b.jsxDEV(vt,{onClick:()=>o(!1),color:"inherit",disabled:u,children:"Cancel"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:207,columnNumber:11},void 0),b.jsxDEV(vt,{onClick:g,color:"primary",variant:"contained",disabled:!l.trim()||u,children:u?"Creating...":"Create"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:214,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:206,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:173,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/ProjectList.tsx",lineNumber:77,columnNumber:5},void 0)},GP={pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",txt:"text/plain",rtf:"application/rtf",odt:"application/vnd.oasis.opendocument.text",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",csv:"text/csv",ods:"application/vnd.oasis.opendocument.spreadsheet",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",odp:"application/vnd.oasis.opendocument.presentation",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",bmp:"image/bmp",webp:"image/webp",svg:"image/svg+xml",tiff:"image/tiff",tif:"image/tiff",mp3:"audio/mpeg",wav:"audio/wav",ogg:"audio/ogg",flac:"audio/flac",m4a:"audio/mp4",mp4:"video/mp4",avi:"video/x-msvideo",mov:"video/quicktime",wmv:"video/x-ms-wmv",mkv:"video/x-matroska",webm:"video/webm",html:"text/html",css:"text/css",js:"text/javascript",ts:"text/typescript",jsx:"text/jsx",tsx:"text/tsx",json:"application/json",xml:"application/xml",py:"text/x-python",java:"text/x-java",c:"text/x-c",cpp:"text/x-c++",php:"application/x-php",zip:"application/zip",rar:"application/vnd.rar","7z":"application/x-7z-compressed",tar:"application/x-tar",gz:"application/gzip",eml:"message/rfc822",msg:"application/vnd.ms-outlook"},ja={"application/pdf":b.jsxDEV(F0,{color:"error"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:94,columnNumber:22},void 0),image:b.jsxDEV(xg,{color:"primary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:95,columnNumber:12},void 0),audio:b.jsxDEV(oE,{color:"secondary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:96,columnNumber:12},void 0),video:b.jsxDEV(aE,{color:"success"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:97,columnNumber:12},void 0),text:b.jsxDEV(v4,{color:"info"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:98,columnNumber:11},void 0),"application/msword":b.jsxDEV(Gf,{color:"primary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:99,columnNumber:25},void 0),"application/vnd.openxmlformats-officedocument.wordprocessingml.document":b.jsxDEV(Gf,{color:"primary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:100,columnNumber:78},void 0),"application/vnd.ms-excel":b.jsxDEV(mA,{color:"success"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:101,columnNumber:31},void 0),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":b.jsxDEV(mA,{color:"success"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:102,columnNumber:72},void 0),"application/vnd.ms-powerpoint":b.jsxDEV(fA,{color:"warning"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:103,columnNumber:36},void 0),"application/vnd.openxmlformats-officedocument.presentationml.presentation":b.jsxDEV(fA,{color:"warning"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:104,columnNumber:80},void 0),"application/json":b.jsxDEV($m,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:105,columnNumber:23},void 0),"application/xml":b.jsxDEV($m,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:106,columnNumber:22},void 0),"text/html":b.jsxDEV($m,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:107,columnNumber:16},void 0),"text/javascript":b.jsxDEV($m,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:108,columnNumber:22},void 0),"application/zip":b.jsxDEV(Ak,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:109,columnNumber:22},void 0),"application/vnd.rar":b.jsxDEV(Ak,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:110,columnNumber:26},void 0),"application/x-7z-compressed":b.jsxDEV(Ak,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:111,columnNumber:34},void 0),model:b.jsxDEV(y4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:112,columnNumber:12},void 0)},EY=({fileName:n,mimeType:e,fileType:t,size:i="medium",sx:r={},showExtension:s=!1})=>{const a=p=>{var m;return((m=p.split(".").pop())==null?void 0:m.toLowerCase())||""},l=((p,m,g)=>{const y=a(p);if(g){if(ja[g])return ja[g];const v=g.split("/")[0];if(ja[v])return ja[v]}if(m&&ja[m])return ja[m];if(y&&GP[y]){const v=GP[y];if(ja[v])return ja[v];const w=v.split("/")[0];if(ja[w])return ja[w]}return b.jsxDEV(fp,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:175,columnNumber:12},void 0)})(n,t,e),c=a(n),u={small:{width:24,height:24,fontSize:12},medium:{width:40,height:40,fontSize:14},large:{width:56,height:56,fontSize:16}};return b.jsxDEV(re,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",...u[i],...r},children:[l,s&&c&&b.jsxDEV(ge,{variant:"caption",sx:{fontSize:u[i].fontSize,mt:.5},children:c.toUpperCase()},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:200,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/icons/FileTypeIcon.tsx",lineNumber:188,columnNumber:5},void 0)},NY=({files:n,filteredFiles:e,selectedFileId:t,loading:i,uploading:r,uploadProgress:s,onSelectFile:a,onDeleteFile:o,onDownloadFile:l,onRenameFile:c,onUploadFile:u,searchActive:p})=>{const[m,g]=T.useState(null),[y,v]=T.useState(null),w=(N,R)=>{N.stopPropagation(),g(N.currentTarget),v(R)},k=()=>{g(null),v(null)},S=()=>{y&&(c(y),k())},E=async()=>{y&&(await o(y),k())},P=async()=>{y&&(await l(y),k())},A=p?e:n;return b.jsxDEV(b.Fragment,{children:[b.jsxDEV(re,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",px:2,py:1,borderBottom:1,borderColor:"divider"},children:[b.jsxDEV(ge,{variant:"subtitle1",fontWeight:"bold",children:["Files",A.length>0&&b.jsxDEV(ge,{component:"span",variant:"body2",color:"text.secondary",sx:{ml:1},children:["(",A.length,")"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:119,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:116,columnNumber:9},void 0),b.jsxDEV(Nt,{title:"Upload file",children:b.jsxDEV(ut,{onClick:u,color:"primary",size:"small","data-test":"upload-file-button",children:b.jsxDEV(IR,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:137,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:131,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:130,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:107,columnNumber:7},void 0),r&&b.jsxDEV(re,{sx:{width:"100%",px:2,py:1},children:[b.jsxDEV(lE,{variant:"determinate",value:s,sx:{height:6,borderRadius:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:145,columnNumber:11},void 0),b.jsxDEV(ge,{variant:"caption",color:"text.secondary",align:"center",sx:{display:"block",mt:.5},children:["Uploading... ",s,"%"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:150,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:144,columnNumber:9},void 0),b.jsxDEV(nu,{sx:{width:"100%",bgcolor:"background.paper",overflow:"auto",flexGrow:1,"& .MuiListItemButton-root.Mui-selected":{bgcolor:"action.selected",borderLeft:"3px solid",borderLeftColor:"primary.main",pl:1.75}},component:"nav","aria-label":"files list",children:i?Array.from(new Array(5)).map((N,R)=>b.jsxDEV(Js,{disablePadding:!0,children:b.jsxDEV(qf,{disabled:!0,children:[b.jsxDEV(Ui,{children:b.jsxDEV(Na,{variant:"circular",width:40,height:40},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:179,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:178,columnNumber:17},void 0),b.jsxDEV(si,{primary:b.jsxDEV(Na,{width:"80%"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:182,columnNumber:28},void 0),secondary:b.jsxDEV(Na,{width:"40%"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:183,columnNumber:30},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:181,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:177,columnNumber:15},void 0)},`skeleton-${R}`,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:176,columnNumber:13},void 0)):A.length===0?b.jsxDEV(Js,{children:b.jsxDEV(si,{primary:p?"No files match your search criteria":"No files in this project yet",secondary:!p&&b.jsxDEV(ge,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Upload files to get started"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:197,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:191,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:190,columnNumber:11},void 0):A.map(N=>b.jsxDEV(Js,{disablePadding:!0,divider:!0,secondaryAction:b.jsxDEV(ut,{edge:"end","aria-label":"file options",onClick:R=>w(R,N.id),size:"small",children:b.jsxDEV(my,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:217,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:211,columnNumber:17},void 0),children:b.jsxDEV(qf,{selected:t===N.id,onClick:()=>a(N.id),sx:{pr:7},"data-test":`file-item-${N.id}`,children:[b.jsxDEV(Ui,{children:b.jsxDEV(EY,{fileType:N.file_type,fileName:N.name,size:"medium"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:228,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:227,columnNumber:17},void 0),b.jsxDEV(si,{primary:b.jsxDEV(ge,{variant:"body2",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:N.name},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:232,columnNumber:21},void 0),secondary:b.jsxDEV(pi,{direction:"row",spacing:1,alignItems:"center",sx:{mt:.5},children:[N.exhibit_id&&b.jsxDEV(It,{label:N.exhibit_id,size:"small",color:"primary",variant:"outlined",icon:b.jsxDEV(x4,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:251,columnNumber:33},void 0),sx:{height:20,"& .MuiChip-label":{px:1}}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:246,columnNumber:25},void 0),b.jsxDEV(ge,{variant:"caption",color:"text.secondary",sx:{display:"inline-block",lineHeight:1.2},children:new Date(N.added_at).toLocaleDateString()},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:255,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:244,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:230,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:221,columnNumber:15},void 0)},N.id,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:206,columnNumber:13},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:157,columnNumber:7},void 0),b.jsxDEV(ru,{anchorEl:m,open:!!m,onClose:k,PaperProps:{elevation:3,sx:{width:200}},children:[b.jsxDEV(Dn,{onClick:S,children:[b.jsxDEV(Ui,{children:b.jsxDEV(cE,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:286,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:285,columnNumber:11},void 0),b.jsxDEV(si,{children:"Rename / Assign ID"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:288,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:284,columnNumber:9},void 0),b.jsxDEV(Dn,{onClick:P,children:[b.jsxDEV(Ui,{children:b.jsxDEV(Vx,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:292,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:291,columnNumber:11},void 0),b.jsxDEV(si,{children:"Download"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:294,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:290,columnNumber:9},void 0),b.jsxDEV(Pr,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:296,columnNumber:9},void 0),b.jsxDEV(Dn,{onClick:E,sx:{color:"error.main"},children:[b.jsxDEV(Ui,{children:b.jsxDEV(uE,{fontSize:"small",color:"error"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:299,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:298,columnNumber:11},void 0),b.jsxDEV(si,{children:"Delete"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:301,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:297,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:275,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/search/FileList.tsx",lineNumber:105,columnNumber:5},void 0)},_Y=({projectId:n,onExhibitClick:e,onCitationInsert:t})=>{const i=We(Y=>Y.exhibits),r=We(Y=>Y.files),s=Xr.useMemo(()=>i.filter(Y=>Y.project_id===n),[i,n]),a=Xr.useMemo(()=>r.filter(Y=>Y.project_id===n),[r,n]),o=We(Y=>Y.selectedExhibitId),l=We(Y=>Y.setSelectedExhibit),c=We(Y=>Y.addExhibit),u=We(Y=>Y.updateExhibit),p=We(Y=>Y.deleteExhibit),m=We(Y=>Y.createExhibitFromFile),g=We(Y=>Y.assignFileToExhibit),y=We(Y=>Y.detectExhibitIdFromFilename),v=We(Y=>Y.getNextExhibitId),w=We(Y=>Y.getFilesByExhibit),k=We(Y=>Y.navigateToExhibit),[S,E]=T.useState(!1),[P,A]=T.useState(null),[N,R]=T.useState({exhibit_id:"",title:"",description:"",exhibit_type:"document",is_key_evidence:!1}),[V,B]=T.useState(null),[L,W]=T.useState(null),[q,X]=T.useState(!1),G=T.useCallback(async()=>{X(!0);let Y=0;const oe=a.filter(be=>!be.exhibit_id&&!s.some(xe=>xe.files.some(je=>je.file_id===be.id)));for(const be of oe){const xe=y(be.name);if(xe){let je=s.find(ze=>ze.exhibit_id===xe);je?(g(be.id,xe,!je.files.length),Y++):(await m(be.id,xe,`Exhibit ${xe}`),Y++)}}X(!1),Y>0&&console.log(`Auto-detected ${Y} exhibit assignments`)},[a,s,y,m,g]),K=Y=>{switch(Y){case"photo":return b.jsxDEV(xg,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:155,columnNumber:28},void 0);case"video":return b.jsxDEV(aE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:156,columnNumber:28},void 0);case"audio":return b.jsxDEV(oE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:157,columnNumber:28},void 0);case"document":default:return b.jsxDEV(Gf,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:159,columnNumber:23},void 0)}},J=Y=>{l(Y.id),k(Y.exhibit_id,"exhibit_list"),e==null||e(Y.exhibit_id)},ee=(Y,oe)=>{const be=Y;t==null||t(Y,oe),console.log("Requesting citation insertion:",be)},fe=()=>{if(!N.exhibit_id||!N.title)return;const Y={id:crypto.randomUUID(),exhibit_id:N.exhibit_id.toUpperCase(),project_id:n,title:N.title,description:N.description,exhibit_type:N.exhibit_type,is_key_evidence:N.is_key_evidence,files:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString(),owner_id:""};c(Y),E(!1),R({exhibit_id:"",title:"",description:"",exhibit_type:"document",is_key_evidence:!1})},ae=(Y,oe)=>{Y.stopPropagation(),B(Y.currentTarget),W(oe)},U=()=>{B(null),W(null)},he=Y=>{u(Y.id,{is_key_evidence:!Y.is_key_evidence}),U()},ie=Y=>{p(Y),U()},$=[...s].sort((Y,oe)=>{const be=we=>{const Ae=we.match(/^(\d+)([A-Z])$/);return Ae?[parseInt(Ae[1],10),Ae[2]]:[0,we]},[xe,je]=be(Y.exhibit_id),[ze,Ve]=be(oe.exhibit_id);return xe!==ze?xe-ze:je.localeCompare(Ve)});return b.jsxDEV(re,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[b.jsxDEV(re,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:[b.jsxDEV(ge,{variant:"h6",sx:{fontWeight:600},children:"Exhibits"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:255,columnNumber:11},void 0),b.jsxDEV(re,{sx:{display:"flex",gap:1},children:[b.jsxDEV(Nt,{title:"Auto-detect exhibits from filenames",children:b.jsxDEV(ut,{size:"small",onClick:G,disabled:q,sx:{color:"primary.main"},children:q?b.jsxDEV(Yr,{size:16},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:266,columnNumber:36},void 0):b.jsxDEV(dE,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:266,columnNumber:69},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:260,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:259,columnNumber:13},void 0),b.jsxDEV(Nt,{title:"Create new exhibit",children:b.jsxDEV(ut,{size:"small",onClick:()=>{R(Y=>({...Y,exhibit_id:v()})),E(!0)},sx:{color:"primary.main"},children:b.jsxDEV(Qd,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:278,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:270,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:269,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:258,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:254,columnNumber:9},void 0),s.length>0&&b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:[s.length," exhibit",s.length!==1?"s":""," •",s.filter(Y=>Y.is_key_evidence).length," key evidence"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:285,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:253,columnNumber:7},void 0),b.jsxDEV(re,{sx:{flex:1,overflow:"auto"},children:$.length===0?b.jsxDEV(re,{sx:{p:3,textAlign:"center"},children:[b.jsxDEV(V0,{sx:{fontSize:48,color:"text.secondary",mb:2}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:296,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"body2",color:"text.secondary",paragraph:!0,children:"No exhibits yet. Upload files or create exhibits manually."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:297,columnNumber:13},void 0),b.jsxDEV(vt,{variant:"outlined",startIcon:b.jsxDEV(Qd,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:302,columnNumber:26},void 0),onClick:()=>E(!0),size:"small",children:"Create First Exhibit"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:300,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:295,columnNumber:11},void 0):b.jsxDEV(nu,{dense:!0,children:$.map(Y=>{const oe=w(Y.exhibit_id),be=o===Y.id;return b.jsxDEV(Js,{disablePadding:!0,children:b.jsxDEV(w4,{expanded:be,onChange:()=>J(Y),sx:{width:"100%",boxShadow:"none","&:before":{display:"none"},bgcolor:be?"action.selected":"transparent"},children:[b.jsxDEV(k4,{expandIcon:b.jsxDEV(MR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:328,columnNumber:35},void 0),sx:{minHeight:"unset","& .MuiAccordionSummary-content":{margin:"8px 0",alignItems:"center"}},children:b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",flex:1},children:[b.jsxDEV(Ui,{sx:{minWidth:32},children:Y.is_key_evidence?b.jsxDEV(Yc,{color:"error",variant:"dot",children:K(Y.exhibit_type)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:340,columnNumber:29},void 0):K(Y.exhibit_type)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:338,columnNumber:25},void 0),b.jsxDEV(si,{primary:b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1},children:[b.jsxDEV(It,{label:Y.exhibit_id,size:"small",variant:"outlined",sx:{fontFamily:"monospace",fontWeight:600,minWidth:40}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:351,columnNumber:31},void 0),b.jsxDEV(ge,{variant:"body2",sx:{fontWeight:500},children:Y.title},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:361,columnNumber:31},void 0),Y.is_key_evidence&&b.jsxDEV(gA,{sx:{fontSize:16,color:"warning.main"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:365,columnNumber:33},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:350,columnNumber:29},void 0),secondary:b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:[oe.length," file",oe.length!==1?"s":"",Y.description&&` • ${Y.description}`]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:370,columnNumber:29},void 0),sx:{m:0}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:348,columnNumber:25},void 0),b.jsxDEV(RR,{children:b.jsxDEV(ut,{size:"small",onClick:xe=>ae(xe,Y.id),children:b.jsxDEV(my,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:383,columnNumber:29},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:379,columnNumber:27},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:378,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:337,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:327,columnNumber:21},void 0),b.jsxDEV(D4,{sx:{pt:0},children:b.jsxDEV(pi,{spacing:1,children:[oe.length>0&&b.jsxDEV(re,{children:[b.jsxDEV(ge,{variant:"caption",color:"text.secondary",gutterBottom:!0,children:"Files:"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:394,columnNumber:29},void 0),oe.map(xe=>b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1,p:.5,borderRadius:1,bgcolor:"action.hover",mb:.5},children:[b.jsxDEV(ge,{variant:"caption",sx:{flex:1},children:xe.name},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:410,columnNumber:33},void 0),b.jsxDEV(Nt,{title:"Insert citation",children:b.jsxDEV(ut,{size:"small",onClick:()=>ee(Y.exhibit_id),children:b.jsxDEV(jR,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:418,columnNumber:37},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:414,columnNumber:35},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:413,columnNumber:33},void 0)]},xe.id,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:398,columnNumber:31},void 0))]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:393,columnNumber:27},void 0),b.jsxDEV(re,{sx:{display:"flex",gap:1,pt:1},children:[b.jsxDEV(vt,{size:"small",startIcon:b.jsxDEV(S4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:430,columnNumber:40},void 0),onClick:()=>ee(Y.exhibit_id),variant:"outlined",children:["Insert [",Y.exhibit_id,"]"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:428,columnNumber:27},void 0),b.jsxDEV(vt,{size:"small",startIcon:b.jsxDEV(OR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:438,columnNumber:40},void 0),onClick:()=>k(Y.exhibit_id,"exhibit_list"),variant:"text",children:"View"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:436,columnNumber:27},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:427,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:390,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:389,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:317,columnNumber:19},void 0)},Y.id,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:316,columnNumber:17},void 0)})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:310,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:293,columnNumber:7},void 0),b.jsxDEV(ru,{anchorEl:V,open:!!V,onClose:U,children:L&&(()=>{const Y=s.find(oe=>oe.id===L);return Y?[b.jsxDEV(Dn,{onClick:()=>he(Y),children:[Y.is_key_evidence?b.jsxDEV(E4,{sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:467,columnNumber:42},void 0):b.jsxDEV(gA,{sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:467,columnNumber:78},void 0),Y.is_key_evidence?"Remove Key Evidence":"Mark as Key Evidence"]},"toggle-key",!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:466,columnNumber:13},void 0),b.jsxDEV(Dn,{onClick:()=>{A(Y),U()},children:[b.jsxDEV(cE,{sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:474,columnNumber:15},void 0),"Edit Exhibit"]},"edit",!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:470,columnNumber:13},void 0),b.jsxDEV(Dn,{onClick:()=>ie(Y.id),sx:{color:"error.main"},children:[b.jsxDEV(uE,{sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:478,columnNumber:15},void 0),"Delete Exhibit"]},"delete",!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:477,columnNumber:13},void 0)]:null})()},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:456,columnNumber:7},void 0),b.jsxDEV(uh,{open:S,onClose:()=>E(!1),maxWidth:"sm",fullWidth:!0,children:[b.jsxDEV(Zf,{children:"Create New Exhibit"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:492,columnNumber:9},void 0),b.jsxDEV(dh,{children:b.jsxDEV(pi,{spacing:2,sx:{mt:1},children:[b.jsxDEV(Ni,{label:"Exhibit ID",value:N.exhibit_id,onChange:Y=>R(oe=>({...oe,exhibit_id:Y.target.value.toUpperCase()})),placeholder:"1A, 2B, 15C...",helperText:"Auto-generated or enter custom ID",size:"small",fullWidth:!0},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:495,columnNumber:13},void 0),b.jsxDEV(Ni,{label:"Title",value:N.title,onChange:Y=>R(oe=>({...oe,title:Y.target.value})),placeholder:"Brief description of the exhibit",size:"small",fullWidth:!0,required:!0},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:504,columnNumber:13},void 0),b.jsxDEV(Ni,{label:"Description",value:N.description,onChange:Y=>R(oe=>({...oe,description:Y.target.value})),multiline:!0,rows:2,size:"small",fullWidth:!0},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:513,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:494,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:493,columnNumber:9},void 0),b.jsxDEV(ch,{children:[b.jsxDEV(vt,{onClick:()=>E(!1),children:"Cancel"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:525,columnNumber:11},void 0),b.jsxDEV(vt,{onClick:fe,variant:"contained",disabled:!N.exhibit_id||!N.title,children:"Create Exhibit"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:526,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:524,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:486,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/legal/ExhibitManager.tsx",lineNumber:251,columnNumber:5},void 0)};function fh(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(i.next(u))}catch(p){a(p)}}function l(u){try{c(i.throw(u))}catch(p){a(p)}}function c(u){u.done?s(u.value):r(u.value).then(o,l)}c((i=i.apply(n,e||[])).next())})}const CY=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Xf(n,e,t){const i=AY(n),{webkitRelativePath:r}=n,s=typeof e=="string"?e:typeof r=="string"&&r.length>0?r:`./${n.name}`;return typeof i.path!="string"&&YP(i,"path",s),YP(i,"relativePath",s),i}function AY(n){const{name:e}=n;if(e&&e.lastIndexOf(".")!==-1&&!n.type){const i=e.split(".").pop().toLowerCase(),r=CY.get(i);r&&Object.defineProperty(n,"type",{value:r,writable:!1,configurable:!1,enumerable:!0})}return n}function YP(n,e,t){Object.defineProperty(n,e,{value:t,writable:!1,configurable:!1,enumerable:!0})}const PY=[".DS_Store","Thumbs.db"];function TY(n){return fh(this,void 0,void 0,function*(){return Q0(n)&&IY(n.dataTransfer)?OY(n.dataTransfer,n.type):RY(n)?MY(n):Array.isArray(n)&&n.every(e=>"getFile"in e&&typeof e.getFile=="function")?jY(n):[]})}function IY(n){return Q0(n)}function RY(n){return Q0(n)&&Q0(n.target)}function Q0(n){return typeof n=="object"&&n!==null}function MY(n){return gD(n.target.files).map(e=>Xf(e))}function jY(n){return fh(this,void 0,void 0,function*(){return(yield Promise.all(n.map(t=>t.getFile()))).map(t=>Xf(t))})}function OY(n,e){return fh(this,void 0,void 0,function*(){if(n.items){const t=gD(n.items).filter(r=>r.kind==="file");if(e!=="drop")return t;const i=yield Promise.all(t.map(LY));return XP(Wj(i))}return XP(gD(n.files).map(t=>Xf(t)))})}function XP(n){return n.filter(e=>PY.indexOf(e.name)===-1)}function gD(n){if(n===null)return[];const e=[];for(let t=0;t<n.length;t++){const i=n[t];e.push(i)}return e}function LY(n){if(typeof n.webkitGetAsEntry!="function")return KP(n);const e=n.webkitGetAsEntry();return e&&e.isDirectory?Hj(e):KP(n,e)}function Wj(n){return n.reduce((e,t)=>[...e,...Array.isArray(t)?Wj(t):[t]],[])}function KP(n,e){return fh(this,void 0,void 0,function*(){var t;if(globalThis.isSecureContext&&typeof n.getAsFileSystemHandle=="function"){const s=yield n.getAsFileSystemHandle();if(s===null)throw new Error(`${n} is not a File`);if(s!==void 0){const a=yield s.getFile();return a.handle=s,Xf(a)}}const i=n.getAsFile();if(!i)throw new Error(`${n} is not a File`);return Xf(i,(t=e==null?void 0:e.fullPath)!==null&&t!==void 0?t:void 0)})}function FY(n){return fh(this,void 0,void 0,function*(){return n.isDirectory?Hj(n):VY(n)})}function Hj(n){const e=n.createReader();return new Promise((t,i)=>{const r=[];function s(){e.readEntries(a=>fh(this,void 0,void 0,function*(){if(a.length){const o=Promise.all(a.map(FY));r.push(o),s()}else try{const o=yield Promise.all(r);t(o)}catch(o){i(o)}}),a=>{i(a)})}s()})}function VY(n){return fh(this,void 0,void 0,function*(){return new Promise((e,t)=>{n.file(i=>{const r=Xf(i,n.fullPath);e(r)},i=>{t(i)})})})}var jv={},QP;function UY(){return QP||(QP=1,jv.__esModule=!0,jv.default=function(n,e){if(n&&e){var t=Array.isArray(e)?e:e.split(",");if(t.length===0)return!0;var i=n.name||"",r=(n.type||"").toLowerCase(),s=r.replace(/\/.*$/,"");return t.some(function(a){var o=a.trim().toLowerCase();return o.charAt(0)==="."?i.toLowerCase().endsWith(o):o.endsWith("/*")?s===o.replace(/\/.*$/,""):r===o})}return!0}),jv}var zY=UY();const Wk=Jf(zY);function JP(n){return WY(n)||$Y(n)||Gj(n)||BY()}function BY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Y(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function WY(n){if(Array.isArray(n))return bD(n)}function ZP(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function eT(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ZP(Object(t),!0).forEach(function(i){qj(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ZP(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function qj(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _g(n,e){return GY(n)||qY(n,e)||Gj(n,e)||HY()}function HY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gj(n,e){if(n){if(typeof n=="string")return bD(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return bD(n,e)}}function bD(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function qY(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i=[],r=!0,s=!1,a,o;try{for(t=t.call(n);!(r=(a=t.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(l){s=!0,o=l}finally{try{!r&&t.return!=null&&t.return()}finally{if(s)throw o}}return i}}function GY(n){if(Array.isArray(n))return n}var YY=typeof Wk=="function"?Wk:Wk.default,XY="file-invalid-type",KY="file-too-large",QY="file-too-small",JY="too-many-files",ZY=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=e.split(","),i=t.length>1?"one of ".concat(t.join(", ")):t[0];return{code:XY,message:"File type must be ".concat(i)}},tT=function(e){return{code:KY,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},nT=function(e){return{code:QY,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},eX={code:JY,message:"Too many files"};function Yj(n,e){var t=n.type==="application/x-moz-file"||YY(n,e);return[t,t?null:ZY(e)]}function Xj(n,e,t){if(Iu(n.size))if(Iu(e)&&Iu(t)){if(n.size>t)return[!1,tT(t)];if(n.size<e)return[!1,nT(e)]}else{if(Iu(e)&&n.size<e)return[!1,nT(e)];if(Iu(t)&&n.size>t)return[!1,tT(t)]}return[!0,null]}function Iu(n){return n!=null}function tX(n){var e=n.files,t=n.accept,i=n.minSize,r=n.maxSize,s=n.multiple,a=n.maxFiles,o=n.validator;return!s&&e.length>1||s&&a>=1&&e.length>a?!1:e.every(function(l){var c=Yj(l,t),u=_g(c,1),p=u[0],m=Xj(l,i,r),g=_g(m,1),y=g[0],v=o?o(l):null;return p&&y&&!v})}function J0(n){return typeof n.isPropagationStopped=="function"?n.isPropagationStopped():typeof n.cancelBubble<"u"?n.cancelBubble:!1}function Ov(n){return n.dataTransfer?Array.prototype.some.call(n.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!n.target&&!!n.target.files}function iT(n){n.preventDefault()}function nX(n){return n.indexOf("MSIE")!==-1||n.indexOf("Trident/")!==-1}function iX(n){return n.indexOf("Edge/")!==-1}function rX(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return nX(n)||iX(n)}function Oa(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return e.some(function(o){return!J0(i)&&o&&o.apply(void 0,[i].concat(s)),J0(i)})}}function sX(){return"showOpenFilePicker"in window}function aX(n){if(Iu(n)){var e=Object.entries(n).filter(function(t){var i=_g(t,2),r=i[0],s=i[1],a=!0;return Kj(r)||(console.warn('Skipped "'.concat(r,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),a=!1),(!Array.isArray(s)||!s.every(Qj))&&(console.warn('Skipped "'.concat(r,'" because an invalid file extension was provided.')),a=!1),a}).reduce(function(t,i){var r=_g(i,2),s=r[0],a=r[1];return eT(eT({},t),{},qj({},s,a))},{});return[{description:"Files",accept:e}]}return n}function oX(n){if(Iu(n))return Object.entries(n).reduce(function(e,t){var i=_g(t,2),r=i[0],s=i[1];return[].concat(JP(e),[r],JP(s))},[]).filter(function(e){return Kj(e)||Qj(e)}).join(",")}function lX(n){return n instanceof DOMException&&(n.name==="AbortError"||n.code===n.ABORT_ERR)}function cX(n){return n instanceof DOMException&&(n.name==="SecurityError"||n.code===n.SECURITY_ERR)}function Kj(n){return n==="audio/*"||n==="video/*"||n==="image/*"||n==="text/*"||n==="application/*"||/\w+\/[-+.\w]+/g.test(n)}function Qj(n){return/^.*\.[\w]+$/.test(n)}var uX=["children"],dX=["open"],hX=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],pX=["refKey","onChange","onClick"];function fX(n){return bX(n)||gX(n)||Jj(n)||mX()}function mX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gX(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function bX(n){if(Array.isArray(n))return yD(n)}function Hk(n,e){return xX(n)||vX(n,e)||Jj(n,e)||yX()}function yX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jj(n,e){if(n){if(typeof n=="string")return yD(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return yD(n,e)}}function yD(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function vX(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i=[],r=!0,s=!1,a,o;try{for(t=t.call(n);!(r=(a=t.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(l){s=!0,o=l}finally{try{!r&&t.return!=null&&t.return()}finally{if(s)throw o}}return i}}function xX(n){if(Array.isArray(n))return n}function rT(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Gn(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rT(Object(t),!0).forEach(function(i){vD(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):rT(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function vD(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Z0(n,e){if(n==null)return{};var t=wX(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function wX(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}var KE=T.forwardRef(function(n,e){var t=n.children,i=Z0(n,uX),r=eO(i),s=r.open,a=Z0(r,dX);return T.useImperativeHandle(e,function(){return{open:s}},[s]),Xr.createElement(T.Fragment,null,t(Gn(Gn({},a),{},{open:s})))});KE.displayName="Dropzone";var Zj={disabled:!1,getFilesFromEvent:TY,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};KE.defaultProps=Zj;KE.propTypes={children:D.func,accept:D.objectOf(D.arrayOf(D.string)),multiple:D.bool,preventDropOnDocument:D.bool,noClick:D.bool,noKeyboard:D.bool,noDrag:D.bool,noDragEventsBubbling:D.bool,minSize:D.number,maxSize:D.number,maxFiles:D.number,disabled:D.bool,getFilesFromEvent:D.func,onFileDialogCancel:D.func,onFileDialogOpen:D.func,useFsAccessApi:D.bool,autoFocus:D.bool,onDragEnter:D.func,onDragLeave:D.func,onDragOver:D.func,onDrop:D.func,onDropAccepted:D.func,onDropRejected:D.func,onError:D.func,validator:D.func};var xD={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function eO(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=Gn(Gn({},Zj),n),t=e.accept,i=e.disabled,r=e.getFilesFromEvent,s=e.maxSize,a=e.minSize,o=e.multiple,l=e.maxFiles,c=e.onDragEnter,u=e.onDragLeave,p=e.onDragOver,m=e.onDrop,g=e.onDropAccepted,y=e.onDropRejected,v=e.onFileDialogCancel,w=e.onFileDialogOpen,k=e.useFsAccessApi,S=e.autoFocus,E=e.preventDropOnDocument,P=e.noClick,A=e.noKeyboard,N=e.noDrag,R=e.noDragEventsBubbling,V=e.onError,B=e.validator,L=T.useMemo(function(){return oX(t)},[t]),W=T.useMemo(function(){return aX(t)},[t]),q=T.useMemo(function(){return typeof w=="function"?w:sT},[w]),X=T.useMemo(function(){return typeof v=="function"?v:sT},[v]),G=T.useRef(null),K=T.useRef(null),J=T.useReducer(kX,xD),ee=Hk(J,2),fe=ee[0],ae=ee[1],U=fe.isFocused,he=fe.isFileDialogActive,ie=T.useRef(typeof window<"u"&&window.isSecureContext&&k&&sX()),$=function(){!ie.current&&he&&setTimeout(function(){if(K.current){var Ge=K.current.files;Ge.length||(ae({type:"closeDialog"}),X())}},300)};T.useEffect(function(){return window.addEventListener("focus",$,!1),function(){window.removeEventListener("focus",$,!1)}},[K,he,X,ie]);var Y=T.useRef([]),oe=function(Ge){G.current&&G.current.contains(Ge.target)||(Ge.preventDefault(),Y.current=[])};T.useEffect(function(){return E&&(document.addEventListener("dragover",iT,!1),document.addEventListener("drop",oe,!1)),function(){E&&(document.removeEventListener("dragover",iT),document.removeEventListener("drop",oe))}},[G,E]),T.useEffect(function(){return!i&&S&&G.current&&G.current.focus(),function(){}},[G,S,i]);var be=T.useCallback(function(Oe){V?V(Oe):console.error(Oe)},[V]),xe=T.useCallback(function(Oe){Oe.preventDefault(),Oe.persist(),Xe(Oe),Y.current=[].concat(fX(Y.current),[Oe.target]),Ov(Oe)&&Promise.resolve(r(Oe)).then(function(Ge){if(!(J0(Oe)&&!R)){var ue=Ge.length,de=ue>0&&tX({files:Ge,accept:L,minSize:a,maxSize:s,multiple:o,maxFiles:l,validator:B}),Pe=ue>0&&!de;ae({isDragAccept:de,isDragReject:Pe,isDragActive:!0,type:"setDraggedFiles"}),c&&c(Oe)}}).catch(function(Ge){return be(Ge)})},[r,c,be,R,L,a,s,o,l,B]),je=T.useCallback(function(Oe){Oe.preventDefault(),Oe.persist(),Xe(Oe);var Ge=Ov(Oe);if(Ge&&Oe.dataTransfer)try{Oe.dataTransfer.dropEffect="copy"}catch{}return Ge&&p&&p(Oe),!1},[p,R]),ze=T.useCallback(function(Oe){Oe.preventDefault(),Oe.persist(),Xe(Oe);var Ge=Y.current.filter(function(de){return G.current&&G.current.contains(de)}),ue=Ge.indexOf(Oe.target);ue!==-1&&Ge.splice(ue,1),Y.current=Ge,!(Ge.length>0)&&(ae({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Ov(Oe)&&u&&u(Oe))},[G,u,R]),Ve=T.useCallback(function(Oe,Ge){var ue=[],de=[];Oe.forEach(function(Pe){var Le=Yj(Pe,L),$e=Hk(Le,2),ht=$e[0],Et=$e[1],Ut=Xj(Pe,a,s),zt=Hk(Ut,2),Te=zt[0],Ue=zt[1],ke=B?B(Pe):null;if(ht&&Te&&!ke)ue.push(Pe);else{var ot=[Et,Ue];ke&&(ot=ot.concat(ke)),de.push({file:Pe,errors:ot.filter(function(Bt){return Bt})})}}),(!o&&ue.length>1||o&&l>=1&&ue.length>l)&&(ue.forEach(function(Pe){de.push({file:Pe,errors:[eX]})}),ue.splice(0)),ae({acceptedFiles:ue,fileRejections:de,isDragReject:de.length>0,type:"setFiles"}),m&&m(ue,de,Ge),de.length>0&&y&&y(de,Ge),ue.length>0&&g&&g(ue,Ge)},[ae,o,L,a,s,l,m,g,y,B]),we=T.useCallback(function(Oe){Oe.preventDefault(),Oe.persist(),Xe(Oe),Y.current=[],Ov(Oe)&&Promise.resolve(r(Oe)).then(function(Ge){J0(Oe)&&!R||Ve(Ge,Oe)}).catch(function(Ge){return be(Ge)}),ae({type:"reset"})},[r,Ve,be,R]),Ae=T.useCallback(function(){if(ie.current){ae({type:"openDialog"}),q();var Oe={multiple:o,types:W};window.showOpenFilePicker(Oe).then(function(Ge){return r(Ge)}).then(function(Ge){Ve(Ge,null),ae({type:"closeDialog"})}).catch(function(Ge){lX(Ge)?(X(Ge),ae({type:"closeDialog"})):cX(Ge)?(ie.current=!1,K.current?(K.current.value=null,K.current.click()):be(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):be(Ge)});return}K.current&&(ae({type:"openDialog"}),q(),K.current.value=null,K.current.click())},[ae,q,X,k,Ve,be,W,o]),_e=T.useCallback(function(Oe){!G.current||!G.current.isEqualNode(Oe.target)||(Oe.key===" "||Oe.key==="Enter"||Oe.keyCode===32||Oe.keyCode===13)&&(Oe.preventDefault(),Ae())},[G,Ae]),ye=T.useCallback(function(){ae({type:"focus"})},[]),He=T.useCallback(function(){ae({type:"blur"})},[]),Re=T.useCallback(function(){P||(rX()?setTimeout(Ae,0):Ae())},[P,Ae]),et=function(Ge){return i?null:Ge},Be=function(Ge){return A?null:et(Ge)},mt=function(Ge){return N?null:et(Ge)},Xe=function(Ge){R&&Ge.stopPropagation()},ct=T.useMemo(function(){return function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ge=Oe.refKey,ue=Ge===void 0?"ref":Ge,de=Oe.role,Pe=Oe.onKeyDown,Le=Oe.onFocus,$e=Oe.onBlur,ht=Oe.onClick,Et=Oe.onDragEnter,Ut=Oe.onDragOver,zt=Oe.onDragLeave,Te=Oe.onDrop,Ue=Z0(Oe,hX);return Gn(Gn(vD({onKeyDown:Be(Oa(Pe,_e)),onFocus:Be(Oa(Le,ye)),onBlur:Be(Oa($e,He)),onClick:et(Oa(ht,Re)),onDragEnter:mt(Oa(Et,xe)),onDragOver:mt(Oa(Ut,je)),onDragLeave:mt(Oa(zt,ze)),onDrop:mt(Oa(Te,we)),role:typeof de=="string"&&de!==""?de:"presentation"},ue,G),!i&&!A?{tabIndex:0}:{}),Ue)}},[G,_e,ye,He,Re,xe,je,ze,we,A,N,i]),tn=T.useCallback(function(Oe){Oe.stopPropagation()},[]),on=T.useMemo(function(){return function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ge=Oe.refKey,ue=Ge===void 0?"ref":Ge,de=Oe.onChange,Pe=Oe.onClick,Le=Z0(Oe,pX),$e=vD({accept:L,multiple:o,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:et(Oa(de,we)),onClick:et(Oa(Pe,tn)),tabIndex:-1},ue,K);return Gn(Gn({},$e),Le)}},[K,t,o,we,i]);return Gn(Gn({},fe),{},{isFocused:U&&!i,getRootProps:ct,getInputProps:on,rootRef:G,inputRef:K,open:et(Ae)})}function kX(n,e){switch(e.type){case"focus":return Gn(Gn({},n),{},{isFocused:!0});case"blur":return Gn(Gn({},n),{},{isFocused:!1});case"openDialog":return Gn(Gn({},xD),{},{isFileDialogActive:!0});case"closeDialog":return Gn(Gn({},n),{},{isFileDialogActive:!1});case"setDraggedFiles":return Gn(Gn({},n),{},{isDragActive:e.isDragActive,isDragAccept:e.isDragAccept,isDragReject:e.isDragReject});case"setFiles":return Gn(Gn({},n),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections,isDragReject:e.isDragReject});case"reset":return Gn({},xD);default:return n}}function sT(){}const Wi=[];for(let n=0;n<256;++n)Wi.push((n+256).toString(16).slice(1));function DX(n,e=0){return(Wi[n[e+0]]+Wi[n[e+1]]+Wi[n[e+2]]+Wi[n[e+3]]+"-"+Wi[n[e+4]]+Wi[n[e+5]]+"-"+Wi[n[e+6]]+Wi[n[e+7]]+"-"+Wi[n[e+8]]+Wi[n[e+9]]+"-"+Wi[n[e+10]]+Wi[n[e+11]]+Wi[n[e+12]]+Wi[n[e+13]]+Wi[n[e+14]]+Wi[n[e+15]]).toLowerCase()}let qk;const SX=new Uint8Array(16);function EX(){if(!qk){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");qk=crypto.getRandomValues.bind(crypto)}return qk(SX)}const NX=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),aT={randomUUID:NX};function Wl(n,e,t){var r;if(aT.randomUUID&&!n)return aT.randomUUID();n=n||{};const i=n.random??((r=n.rng)==null?void 0:r.call(n))??EX();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,DX(i)}class _X{constructor(){this.bucketName="project-files"}async uploadFile(e,t,i,r){const s=Wl(),a=e.name.split(".").pop(),o=`${i}/${t}/${s}.${a}`;try{const{data:l,error:c}=await rt.storage.from(this.bucketName).upload(o,e,{cacheControl:"3600",upsert:!1,onUploadProgress:y=>{if(r){const v=y.loaded/y.total*100;r(v)}}});if(c)throw c;const{data:u}=rt.storage.from(this.bucketName).getPublicUrl(o),p={id:s,name:e.name,size:e.size,type:e.type,project_id:t,owner_id:i,storage_path:o,public_url:u.publicUrl,processing_status:"processing",created_at:new Date().toISOString()},{data:m,error:g}=await rt.from("files").insert(p).select().single();if(g)throw await rt.storage.from(this.bucketName).remove([o]),g;return m}catch(l){throw console.error("File upload failed:",l),l}}async getProjectFiles(e){const{data:t,error:i}=await rt.from("files").select("*").eq("project_id",e).order("created_at",{ascending:!1});if(i)throw i;return t||[]}async getFile(e){const{data:t,error:i}=await rt.from("files").select("*").eq("id",e).single();return i?(console.error("Failed to get file:",i),null):t}async updateFile(e,t){const{data:i,error:r}=await rt.from("files").update(t).eq("id",e).select().single();if(r)throw r;return i}async deleteFile(e){const t=await this.getFile(e);if(!t)throw new Error("File not found");const{error:i}=await rt.storage.from(this.bucketName).remove([t.storage_path]);if(i)throw i;const{error:r}=await rt.from("files").delete().eq("id",e);if(r)throw r}async getSignedUrl(e,t=3600){const i=await this.getFile(e);if(!i)throw new Error("File not found");const{data:r,error:s}=await rt.storage.from(this.bucketName).createSignedUrl(i.storage_path,t);if(s)throw s;return r.signedUrl}async downloadFile(e){const t=await this.getFile(e);if(!t)throw new Error("File not found");const{data:i,error:r}=await rt.storage.from(this.bucketName).download(t.storage_path);if(r)throw r;return i}async searchFiles(e,t){const{data:i,error:r}=await rt.from("files").select("*").eq("project_id",e).or(`name.ilike.%${t}%,content_text.ilike.%${t}%`).order("created_at",{ascending:!1});if(r)throw r;return i||[]}async getExhibitFiles(e,t){const{data:i,error:r}=await rt.from("files").select("*").eq("project_id",e).eq("exhibit_id",t).order("created_at",{ascending:!1});if(r)throw r;return i||[]}async generateExhibitId(e,t){let i="D";t.startsWith("image")?i="P":t.startsWith("video")?i="V":t.startsWith("audio")&&(i="A");const{data:r}=await rt.from("files").select("exhibit_id").eq("project_id",e).like("exhibit_id",`${i}%`).order("exhibit_id",{ascending:!1}).limit(1);if(!r||r.length===0)return`${i}1`;const s=parseInt(r[0].exhibit_id.substring(1))||0;return`${i}${s+1}`}subscribeToFileUpdates(e,t){return rt.channel(`files_${e}`).on("postgres_changes",{event:"*",schema:"public",table:"files",filter:`project_id=eq.${e}`},t).subscribe()}}const oT=new _X;var lT;(function(n){n.STRING="string",n.NUMBER="number",n.INTEGER="integer",n.BOOLEAN="boolean",n.ARRAY="array",n.OBJECT="object"})(lT||(lT={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cT;(function(n){n.LANGUAGE_UNSPECIFIED="language_unspecified",n.PYTHON="python"})(cT||(cT={}));var uT;(function(n){n.OUTCOME_UNSPECIFIED="outcome_unspecified",n.OUTCOME_OK="outcome_ok",n.OUTCOME_FAILED="outcome_failed",n.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(uT||(uT={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dT=["user","model","function","system"];var hT;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(hT||(hT={}));var pT;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(pT||(pT={}));var fT;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(fT||(fT={}));var mT;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER"})(mT||(mT={}));var gg;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.OTHER="OTHER"})(gg||(gg={}));var gT;(function(n){n.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",n.RETRIEVAL_QUERY="RETRIEVAL_QUERY",n.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",n.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",n.CLASSIFICATION="CLASSIFICATION",n.CLUSTERING="CLUSTERING"})(gT||(gT={}));var bT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(bT||(bT={}));var yT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(yT||(yT={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class Yh extends fr{constructor(e,t){super(e),this.response=t}}class tO extends fr{constructor(e,t,i,r){super(e),this.status=t,this.statusText=i,this.errorDetails=r}}class qc extends fr{}class nO extends fr{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CX="https://generativelanguage.googleapis.com",AX="v1beta",PX="0.24.1",TX="genai-js";var nh;(function(n){n.GENERATE_CONTENT="generateContent",n.STREAM_GENERATE_CONTENT="streamGenerateContent",n.COUNT_TOKENS="countTokens",n.EMBED_CONTENT="embedContent",n.BATCH_EMBED_CONTENTS="batchEmbedContents"})(nh||(nh={}));class IX{constructor(e,t,i,r,s){this.model=e,this.task=t,this.apiKey=i,this.stream=r,this.requestOptions=s}toString(){var e,t;const i=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||AX;let s=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||CX}/${i}/${this.model}:${this.task}`;return this.stream&&(s+="?alt=sse"),s}}function RX(n){const e=[];return n!=null&&n.apiClient&&e.push(n.apiClient),e.push(`${TX}/${PX}`),e.join(" ")}async function MX(n){var e;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",RX(n.requestOptions)),t.append("x-goog-api-key",n.apiKey);let i=(e=n.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(i){if(!(i instanceof Headers))try{i=new Headers(i)}catch(r){throw new qc(`unable to convert customHeaders value ${JSON.stringify(i)} to Headers: ${r.message}`)}for(const[r,s]of i.entries()){if(r==="x-goog-api-key")throw new qc(`Cannot set reserved header name ${r}`);if(r==="x-goog-api-client")throw new qc(`Header name ${r} can only be set using the apiClient field`);t.append(r,s)}}return t}async function jX(n,e,t,i,r,s){const a=new IX(n,e,t,i,s);return{url:a.toString(),fetchOptions:Object.assign(Object.assign({},VX(s)),{method:"POST",headers:await MX(a),body:r})}}async function wy(n,e,t,i,r,s={},a=fetch){const{url:o,fetchOptions:l}=await jX(n,e,t,i,r,s);return OX(o,l,a)}async function OX(n,e,t=fetch){let i;try{i=await t(n,e)}catch(r){LX(r,n)}return i.ok||await FX(i,n),i}function LX(n,e){let t=n;throw t.name==="AbortError"?(t=new nO(`Request aborted when fetching ${e.toString()}: ${n.message}`),t.stack=n.stack):n instanceof tO||n instanceof qc||(t=new fr(`Error fetching from ${e.toString()}: ${n.message}`),t.stack=n.stack),t}async function FX(n,e){let t="",i;try{const r=await n.json();t=r.error.message,r.error.details&&(t+=` ${JSON.stringify(r.error.details)}`,i=r.error.details)}catch{}throw new tO(`Error fetching from ${e.toString()}: [${n.status} ${n.statusText}] ${t}`,n.status,n.statusText,i)}function VX(n){const e={};if((n==null?void 0:n.signal)!==void 0||(n==null?void 0:n.timeout)>=0){const t=new AbortController;(n==null?void 0:n.timeout)>=0&&setTimeout(()=>t.abort(),n.timeout),n!=null&&n.signal&&n.signal.addEventListener("abort",()=>{t.abort()}),e.signal=t.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(n){return n.text=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),i0(n.candidates[0]))throw new Yh(`${Hl(n)}`,n);return UX(n)}else if(n.promptFeedback)throw new Yh(`Text not available. ${Hl(n)}`,n);return""},n.functionCall=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),i0(n.candidates[0]))throw new Yh(`${Hl(n)}`,n);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),vT(n)[0]}else if(n.promptFeedback)throw new Yh(`Function call not available. ${Hl(n)}`,n)},n.functionCalls=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),i0(n.candidates[0]))throw new Yh(`${Hl(n)}`,n);return vT(n)}else if(n.promptFeedback)throw new Yh(`Function call not available. ${Hl(n)}`,n)},n}function UX(n){var e,t,i,r;const s=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const a of(r=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||r===void 0?void 0:r.parts)a.text&&s.push(a.text),a.executableCode&&s.push("\n```"+a.executableCode.language+`
`+a.executableCode.code+"\n```\n"),a.codeExecutionResult&&s.push("\n```\n"+a.codeExecutionResult.output+"\n```\n");return s.length>0?s.join(""):""}function vT(n){var e,t,i,r;const s=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const a of(r=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||r===void 0?void 0:r.parts)a.functionCall&&s.push(a.functionCall);if(s.length>0)return s}const zX=[gg.RECITATION,gg.SAFETY,gg.LANGUAGE];function i0(n){return!!n.finishReason&&zX.includes(n.finishReason)}function Hl(n){var e,t,i;let r="";if((!n.candidates||n.candidates.length===0)&&n.promptFeedback)r+="Response was blocked",!((e=n.promptFeedback)===null||e===void 0)&&e.blockReason&&(r+=` due to ${n.promptFeedback.blockReason}`),!((t=n.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(r+=`: ${n.promptFeedback.blockReasonMessage}`);else if(!((i=n.candidates)===null||i===void 0)&&i[0]){const s=n.candidates[0];i0(s)&&(r+=`Candidate was blocked due to ${s.finishReason}`,s.finishMessage&&(r+=`: ${s.finishMessage}`))}return r}function Cg(n){return this instanceof Cg?(this.v=n,this):new Cg(n)}function BX(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(m){i[m]&&(r[m]=function(g){return new Promise(function(y,v){s.push([m,g,y,v])>1||o(m,g)})})}function o(m,g){try{l(i[m](g))}catch(y){p(s[0][3],y)}}function l(m){m.value instanceof Cg?Promise.resolve(m.value.v).then(c,u):p(s[0][2],m)}function c(m){o("next",m)}function u(m){o("throw",m)}function p(m,g){m(g),s.shift(),s.length&&o(s[0][0],s[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xT=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function $X(n){const e=n.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=qX(e),[i,r]=t.tee();return{stream:HX(i),response:WX(r)}}async function WX(n){const e=[],t=n.getReader();for(;;){const{done:i,value:r}=await t.read();if(i)return QE(GX(e));e.push(r)}}function HX(n){return BX(this,arguments,function*(){const t=n.getReader();for(;;){const{value:i,done:r}=yield Cg(t.read());if(r)break;yield yield Cg(QE(i))}})}function qX(n){const e=n.getReader();return new ReadableStream({start(i){let r="";return s();function s(){return e.read().then(({value:a,done:o})=>{if(o){if(r.trim()){i.error(new fr("Failed to parse stream"));return}i.close();return}r+=a;let l=r.match(xT),c;for(;l;){try{c=JSON.parse(l[1])}catch{i.error(new fr(`Error parsing JSON response: "${l[1]}"`));return}i.enqueue(c),r=r.substring(l[0].length),l=r.match(xT)}return s()}).catch(a=>{let o=a;throw o.stack=a.stack,o.name==="AbortError"?o=new nO("Request aborted when reading from the stream"):o=new fr("Error reading from the stream"),o})}}})}function GX(n){const e=n[n.length-1],t={promptFeedback:e==null?void 0:e.promptFeedback};for(const i of n){if(i.candidates){let r=0;for(const s of i.candidates)if(t.candidates||(t.candidates=[]),t.candidates[r]||(t.candidates[r]={index:r}),t.candidates[r].citationMetadata=s.citationMetadata,t.candidates[r].groundingMetadata=s.groundingMetadata,t.candidates[r].finishReason=s.finishReason,t.candidates[r].finishMessage=s.finishMessage,t.candidates[r].safetyRatings=s.safetyRatings,s.content&&s.content.parts){t.candidates[r].content||(t.candidates[r].content={role:s.content.role||"user",parts:[]});const a={};for(const o of s.content.parts)o.text&&(a.text=o.text),o.functionCall&&(a.functionCall=o.functionCall),o.executableCode&&(a.executableCode=o.executableCode),o.codeExecutionResult&&(a.codeExecutionResult=o.codeExecutionResult),Object.keys(a).length===0&&(a.text=""),t.candidates[r].content.parts.push(a)}r++}i.usageMetadata&&(t.usageMetadata=i.usageMetadata)}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iO(n,e,t,i){const r=await wy(e,nh.STREAM_GENERATE_CONTENT,n,!0,JSON.stringify(t),i);return $X(r)}async function rO(n,e,t,i){const s=await(await wy(e,nh.GENERATE_CONTENT,n,!1,JSON.stringify(t),i)).json();return{response:QE(s)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sO(n){if(n!=null){if(typeof n=="string")return{role:"system",parts:[{text:n}]};if(n.text)return{role:"system",parts:[n]};if(n.parts)return n.role?n:{role:"system",parts:n.parts}}}function Ag(n){let e=[];if(typeof n=="string")e=[{text:n}];else for(const t of n)typeof t=="string"?e.push({text:t}):e.push(t);return YX(e)}function YX(n){const e={role:"user",parts:[]},t={role:"function",parts:[]};let i=!1,r=!1;for(const s of n)"functionResponse"in s?(t.parts.push(s),r=!0):(e.parts.push(s),i=!0);if(i&&r)throw new fr("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!i&&!r)throw new fr("No content is provided for sending chat message.");return i?e:t}function XX(n,e){var t;let i={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(t=e==null?void 0:e.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const r=n.generateContentRequest!=null;if(n.contents){if(r)throw new qc("CountTokensRequest must have one of contents or generateContentRequest, not both.");i.contents=n.contents}else if(r)i=Object.assign(Object.assign({},i),n.generateContentRequest);else{const s=Ag(n);i.contents=[s]}return{generateContentRequest:i}}function wT(n){let e;return n.contents?e=n:e={contents:[Ag(n)]},n.systemInstruction&&(e.systemInstruction=sO(n.systemInstruction)),e}function KX(n){return typeof n=="string"||Array.isArray(n)?{content:Ag(n)}:n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],QX={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function JX(n){let e=!1;for(const t of n){const{role:i,parts:r}=t;if(!e&&i!=="user")throw new fr(`First content should be with role 'user', got ${i}`);if(!dT.includes(i))throw new fr(`Each item should include role field. Got ${i} but valid roles are: ${JSON.stringify(dT)}`);if(!Array.isArray(r))throw new fr("Content should have 'parts' property with an array of Parts");if(r.length===0)throw new fr("Each Content should have at least one part");const s={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const o of r)for(const l of kT)l in o&&(s[l]+=1);const a=QX[i];for(const o of kT)if(!a.includes(o)&&s[o]>0)throw new fr(`Content with role '${i}' can't contain '${o}' part`);e=!0}}function DT(n){var e;if(n.candidates===void 0||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;if(t===void 0||t.parts===void 0||t.parts.length===0)return!1;for(const i of t.parts)if(i===void 0||Object.keys(i).length===0||i.text!==void 0&&i.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ST="SILENT_ERROR";class ZX{constructor(e,t,i,r={}){this.model=t,this.params=i,this._requestOptions=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,i!=null&&i.history&&(JX(i.history),this._history=i.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var i,r,s,a,o,l;await this._sendPromise;const c=Ag(e),u={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(s=this.params)===null||s===void 0?void 0:s.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(o=this.params)===null||o===void 0?void 0:o.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,c]},p=Object.assign(Object.assign({},this._requestOptions),t);let m;return this._sendPromise=this._sendPromise.then(()=>rO(this._apiKey,this.model,u,p)).then(g=>{var y;if(DT(g.response)){this._history.push(c);const v=Object.assign({parts:[],role:"model"},(y=g.response.candidates)===null||y===void 0?void 0:y[0].content);this._history.push(v)}else{const v=Hl(g.response);v&&console.warn(`sendMessage() was unsuccessful. ${v}. Inspect response object for details.`)}m=g}).catch(g=>{throw this._sendPromise=Promise.resolve(),g}),await this._sendPromise,m}async sendMessageStream(e,t={}){var i,r,s,a,o,l;await this._sendPromise;const c=Ag(e),u={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(s=this.params)===null||s===void 0?void 0:s.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(o=this.params)===null||o===void 0?void 0:o.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,c]},p=Object.assign(Object.assign({},this._requestOptions),t),m=iO(this._apiKey,this.model,u,p);return this._sendPromise=this._sendPromise.then(()=>m).catch(g=>{throw new Error(ST)}).then(g=>g.response).then(g=>{if(DT(g)){this._history.push(c);const y=Object.assign({},g.candidates[0].content);y.role||(y.role="model"),this._history.push(y)}else{const y=Hl(g);y&&console.warn(`sendMessageStream() was unsuccessful. ${y}. Inspect response object for details.`)}}).catch(g=>{g.message!==ST&&console.error(g)}),m}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eK(n,e,t,i){return(await wy(e,nh.COUNT_TOKENS,n,!1,JSON.stringify(t),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tK(n,e,t,i){return(await wy(e,nh.EMBED_CONTENT,n,!1,JSON.stringify(t),i)).json()}async function nK(n,e,t,i){const r=t.requests.map(a=>Object.assign(Object.assign({},a),{model:e}));return(await wy(e,nh.BATCH_EMBED_CONTENTS,n,!1,JSON.stringify({requests:r}),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e,t,i={}){this.apiKey=e,this._requestOptions=i,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=sO(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var i;const r=wT(e),s=Object.assign(Object.assign({},this._requestOptions),t);return rO(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},r),s)}async generateContentStream(e,t={}){var i;const r=wT(e),s=Object.assign(Object.assign({},this._requestOptions),t);return iO(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},r),s)}startChat(e){var t;return new ZX(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const i=XX(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),r=Object.assign(Object.assign({},this._requestOptions),t);return eK(this.apiKey,this.model,i,r)}async embedContent(e,t={}){const i=KX(e),r=Object.assign(Object.assign({},this._requestOptions),t);return tK(this.apiKey,this.model,i,r)}async batchEmbedContents(e,t={}){const i=Object.assign(Object.assign({},this._requestOptions),t);return nK(this.apiKey,this.model,e,i)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new fr("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new ET(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,i){if(!e.name)throw new qc("Cached content must contain a `name` field.");if(!e.model)throw new qc("Cached content must contain a `model` field.");const r=["model","systemInstruction"];for(const a of r)if(t!=null&&t[a]&&e[a]&&(t==null?void 0:t[a])!==e[a]){if(a==="model"){const o=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,l=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(o===l)continue}throw new qc(`Different value for "${a}" specified in modelParams (${t[a]}) and cachedContent (${e[a]})`)}const s=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new ET(this.apiKey,s,i)}}const NT=new aO("AIzaSyBoHxMRLlqSzCzvVpeuw06SUqmkj4eNzm8");class iK{constructor(){this.model=NT.getGenerativeModel({model:"gemini-2.5-pro",generationConfig:{temperature:.7,topK:40,topP:.95,maxOutputTokens:8192}})}async analyzeDocument(e,t,i,r){try{const a=[{text:this.buildLegalAnalysisPrompt(t,i,r)}];typeof e=="string"?a.push({text:`

Document Content:
${e}`}):a.push({inlineData:{mimeType:i,data:Buffer.from(e).toString("base64")}});const c=(await(await this.model.generateContent(a)).response).text();return this.parseAnalysisResponse(c,t)}catch(s){throw console.error("Gemini analysis failed:",s),s}}async generateEmbeddings(e){try{return(await NT.getGenerativeModel({model:"text-embedding-004"}).embedContent(e)).embedding.values}catch(t){return console.error("Embedding generation failed:",t),[]}}async chatWithContext(e,t,i){try{const r=this.model.startChat({history:i.map(l=>({role:l.role==="user"?"user":"model",parts:[{text:l.content}]})),generationConfig:{maxOutputTokens:4096,temperature:.8}}),s=`
You are a legal AI assistant analyzing case documents. Here's the relevant context:

${t.join(`

`)}

User Question: ${e}

Provide a detailed, legally-informed response focusing on:
1. Direct answer to the question
2. Relevant legal considerations
3. Citations to the provided documents
4. Practical next steps if applicable
`;return(await(await r.sendMessage(s)).response).text()}catch(r){throw console.error("Chat generation failed:",r),r}}buildLegalAnalysisPrompt(e,t,i){return`You are an expert legal analyst. Analyze this document and provide structured insights.

File Name: ${e}
File Type: ${t}
${i?`Case Context: ${i}`:""}

Analyze this document and provide:

1. DOCUMENT TYPE: Classify as one of: contract, email, brief, motion, evidence, correspondence, other

2. KEY ENTITIES: List all important parties, people, organizations mentioned

3. LEGAL ISSUES: Identify all legal issues, claims, or causes of action

4. EXHIBIT SUGGESTION:
   - Suggested Exhibit ID (format: D1 for documents, P1 for photos, E1 for emails, etc.)
   - Suggested Exhibit Title (concise, descriptive)

5. INSIGHTS: Provide 3-5 key insights categorized as:
   - risk: Potential legal risks or liabilities
   - opportunity: Strategic advantages or opportunities
   - deadline: Time-sensitive dates or deadlines
   - citation: Important legal citations or references
   - key_term: Critical contractual terms or provisions

6. SUMMARY: Provide a 2-3 sentence executive summary

Format your response as structured JSON for easy parsing.`}parseAnalysisResponse(e,t){try{const i=e.match(/\{[\s\S]*\}/);if(i){const r=JSON.parse(i[0]);return{extractedText:r.extractedText||e,documentType:r.documentType||"other",keyEntities:r.keyEntities||[],legalIssues:r.legalIssues||[],suggestedExhibitId:r.suggestedExhibitId||"D1",suggestedExhibitTitle:r.suggestedExhibitTitle||t,insights:r.insights||[],confidenceScore:r.confidenceScore||.85,summary:r.summary||""}}}catch{}return{extractedText:e,documentType:this.extractDocumentType(e),keyEntities:this.extractEntities(e),legalIssues:this.extractLegalIssues(e),suggestedExhibitId:this.extractExhibitId(e,t),suggestedExhibitTitle:this.extractExhibitTitle(e,t),insights:this.extractInsights(e),confidenceScore:.75,summary:this.extractSummary(e)}}extractDocumentType(e){const t=e.toLowerCase();return t.includes("contract")?"contract":t.includes("email")||t.includes("e-mail")?"email":t.includes("brief")?"brief":t.includes("motion")?"motion":t.includes("evidence")?"evidence":t.includes("correspondence")?"correspondence":"other"}extractEntities(e){const t=/(?:Mr\.|Ms\.|Mrs\.|Dr\.|Judge|Attorney)\s+[A-Z][a-z]+\s+[A-Z][a-z]+/g,i=e.match(t)||[];return[...new Set(i)]}extractLegalIssues(e){const t=[];return["breach","violation","damages","liability","negligence","fraud","misrepresentation","dispute","claim","cause of action"].forEach(r=>{e.toLowerCase().includes(r)&&t.push(r)}),t}extractExhibitId(e,t){var s;const i=e.match(/[DPVACE]\d+/);if(i)return i[0];const r=(s=t.split(".").pop())==null?void 0:s.toLowerCase();return["jpg","png","jpeg"].includes(r||"")?"P1":["pdf","doc","docx"].includes(r||"")?"D1":["eml","msg"].includes(r||"")?"E1":"D1"}extractExhibitTitle(e,t){const i=e.match(/title[:\s]+["']([^"']+)["']/i);return i?i[1]:t.replace(/\.[^/.]+$/,"").replace(/[_-]/g," ")}extractInsights(e){const t=[];return(e.toLowerCase().includes("risk")||e.toLowerCase().includes("liability"))&&t.push({type:"risk",title:"Potential Legal Risk",description:"This document contains potential legal risks that require attention.",importance:"high"}),/\b\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}\b/g.test(e)&&t.push({type:"deadline",title:"Important Date Found",description:"This document contains date references that may be deadlines.",importance:"medium"}),t}extractSummary(e){return e.split(/[.!?]+/).slice(0,2).join(". ").substring(0,200)}async generateExhibitData(e,t){const i=await e.text(),r=await this.analyzeDocument(i,e.name,e.type,t);return{exhibitId:r.suggestedExhibitId,exhibitTitle:r.suggestedExhibitTitle,insights:r.insights}}}const _T=new iK,rK=()=>{const n=We(v=>v.user),e=We(v=>v.selectedProjectId),[t,i]=T.useState(new Map),[r,s]=T.useState(new Set),a=T.useCallback(async v=>{if((!n||!e)&&(console.error("User or project not selected"),!e)){alert("Please select or create a project first");return}for(const w of v){const k=Wl();i(S=>new Map(S.set(k,{id:k,file:w,fileName:w.name,stage:"uploading",progress:0,insights:[]})));try{const S=(n==null?void 0:n.id)||"00000000-0000-0000-0000-000000000000";await o(w,k,S,e)}catch(S){console.error("Upload failed:",S),l(k,{stage:"error",error:S.message})}}},[n,e]),o=async(v,w,k,S)=>{try{if(k==="00000000-0000-0000-0000-000000000000"){l(w,{stage:"uploading",progress:20}),await new Promise(V=>setTimeout(V,1e3)),l(w,{progress:50});const R={id:`demo-${w}`,name:v.name,size:v.size,type:v.type,project_id:S,owner_id:k,storage_path:`demo/${v.name}`,public_url:URL.createObjectURL(v),processing_status:"processing",created_at:new Date().toISOString()};l(w,{progress:50}),l(w,{stage:"completed",progress:100,exhibitId:"D1",exhibitTitle:`Demo: ${v.name}`,insights:[{type:"info",title:"Demo Mode",description:"This is a demo upload. Real uploads would use cloud storage and AI analysis.",importance:"low"}]});return}l(w,{stage:"uploading",progress:10});const E=await oT.uploadFile(v,S,k,R=>l(w,{progress:Math.min(R*.5,50)}));l(w,{progress:50}),l(w,{stage:"analyzing",progress:60});let P="";if(v.type.startsWith("text/")||v.type==="application/json")P=await v.text();else{const R=await v.arrayBuffer();P=new Uint8Array(R)}const A=await _T.analyzeDocument(P,v.name,v.type,`Legal case project: ${S}`);l(w,{progress:80});const N=await oT.updateFile(E.id,{exhibit_id:A.suggestedExhibitId,exhibit_title:A.suggestedExhibitTitle,content_text:A.extractedText.substring(0,1e4),ai_insights:A.insights,processing_status:"completed",processed_at:new Date().toISOString()});if(A.extractedText)try{const R=await _T.generateEmbeddings(A.extractedText.substring(0,5e3));console.log("Generated embeddings:",R.length,"dimensions")}catch(R){console.warn("Embedding generation failed:",R)}We.getState().addFile({id:E.id,name:v.name,project_id:S,owner_id:k,file_type:v.type.split("/")[0],content_type:v.type,size:v.size,storage_path:E.storage_path,added_at:new Date().toISOString(),exhibit_id:A.suggestedExhibitId,exhibit_title:A.suggestedExhibitTitle}),l(w,{stage:"completed",progress:100,exhibitId:A.suggestedExhibitId,exhibitTitle:A.suggestedExhibitTitle,insights:A.insights})}catch(E){throw console.error("Processing failed:",E),E}},l=(v,w)=>{i(k=>{const S=new Map(k),E=S.get(v);return E&&S.set(v,{...E,...w}),S})},{getRootProps:c,getInputProps:u,isDragActive:p}=eO({onDrop:a,accept:{"application/pdf":[".pdf"],"image/*":[".png",".jpg",".jpeg",".gif",".bmp",".tiff"],"audio/*":[".mp3",".wav",".m4a",".aac"],"video/*":[".mp4",".mov",".avi",".mkv"],"application/msword":[".doc"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"text/plain":[".txt"],"message/rfc822":[".eml"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},multiple:!0,maxSize:50*1024*1024}),m=v=>{s(w=>{const k=new Set(w);return k.has(v)?k.delete(v):k.add(v),k})},g=v=>{switch(v){case"uploading":return"Uploading to Cloud";case"analyzing":return"AI Analysis (Gemini 2.5 Pro)";case"completed":return"Completed";case"error":return"Failed";default:return v}},y=v=>{switch(v){case"completed":return"success";case"error":return"error";case"analyzing":return"warning";default:return"primary"}};return b.jsxDEV(re,{sx:{width:"100%",p:2},children:[b.jsxDEV(sn,{...c(),sx:{border:"2px dashed",borderColor:p?"primary.main":"divider",borderRadius:2,p:4,textAlign:"center",cursor:"pointer",transition:"all 0.2s ease",backgroundColor:p?"action.hover":"background.paper","&:hover":{borderColor:"primary.main",backgroundColor:"action.hover"}},children:[b.jsxDEV("input",{...u()},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:313,columnNumber:9},void 0),b.jsxDEV(LR,{sx:{fontSize:48,color:"primary.main",mb:2}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:314,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"h6",gutterBottom:!0,children:p?"Drop files here...":"Upload Legal Documents"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:315,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Drag & drop or click to browse • Max 50MB per file"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:318,columnNumber:9},void 0),b.jsxDEV(re,{sx:{display:"flex",gap:1,justifyContent:"center",flexWrap:"wrap"},children:[b.jsxDEV(It,{size:"small",label:"PDF"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:322,columnNumber:11},void 0),b.jsxDEV(It,{size:"small",label:"Word"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:323,columnNumber:11},void 0),b.jsxDEV(It,{size:"small",label:"Images"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:324,columnNumber:11},void 0),b.jsxDEV(It,{size:"small",label:"Email"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:325,columnNumber:11},void 0),b.jsxDEV(It,{size:"small",label:"Audio/Video"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:326,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:321,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"caption",display:"block",sx:{mt:2,color:"primary.main"},children:"Powered by Gemini 2.5 Pro AI • Automatic exhibit generation • Cloud storage"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:328,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:296,columnNumber:7},void 0),t.size>0&&b.jsxDEV(re,{sx:{mt:3},children:[b.jsxDEV(ge,{variant:"h6",gutterBottom:!0,children:"Processing Files"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:336,columnNumber:11},void 0),b.jsxDEV(nu,{children:Array.from(t.values()).map(v=>{const w=r.has(v.id);return b.jsxDEV(sn,{sx:{mb:2},children:[b.jsxDEV(qf,{onClick:()=>m(v.id),sx:{flexDirection:"column",alignItems:"flex-start"},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",width:"100%",mb:1},children:[b.jsxDEV(Ui,{sx:{minWidth:40},children:v.error?b.jsxDEV(N4,{color:"error"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:353,columnNumber:27},void 0):v.stage==="completed"?b.jsxDEV(_4,{color:"success"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:355,columnNumber:27},void 0):b.jsxDEV(Yr,{size:24},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:357,columnNumber:27},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:351,columnNumber:23},void 0),b.jsxDEV(si,{primary:v.fileName,secondary:b.jsxDEV(b.Fragment,{children:[b.jsxDEV(It,{icon:v.stage==="analyzing"?b.jsxDEV(dE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:366,columnNumber:68},void 0):b.jsxDEV(fp,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:366,columnNumber:81},void 0),label:g(v.stage),size:"small",color:y(v.stage),variant:"outlined",sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:365,columnNumber:29},void 0),v.exhibitId&&b.jsxDEV(It,{label:v.exhibitId,size:"small",color:"secondary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:374,columnNumber:31},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:364,columnNumber:27},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:361,columnNumber:23},void 0),b.jsxDEV(ge,{variant:"caption",children:[v.progress,"%"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:384,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:350,columnNumber:21},void 0),b.jsxDEV(lE,{variant:"determinate",value:v.progress,sx:{width:"100%",height:6,borderRadius:3},color:y(v.stage)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:389,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:346,columnNumber:19},void 0),b.jsxDEV(FR,{in:w,children:b.jsxDEV(re,{sx:{p:2,pt:0},children:[v.error&&b.jsxDEV(Aa,{severity:"error",sx:{mb:2},children:v.error},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:401,columnNumber:25},void 0),v.exhibitId&&b.jsxDEV(re,{sx:{mb:2},children:[b.jsxDEV(ge,{variant:"subtitle2",gutterBottom:!0,children:"Exhibit Information"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:409,columnNumber:27},void 0),b.jsxDEV(sn,{elevation:0,sx:{p:2,bgcolor:"background.default"},children:[b.jsxDEV(ge,{variant:"body2",children:[b.jsxDEV("strong",{children:"ID:"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:414,columnNumber:31},void 0)," ",v.exhibitId]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:413,columnNumber:29},void 0),b.jsxDEV(ge,{variant:"body2",children:[b.jsxDEV("strong",{children:"Title:"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:417,columnNumber:31},void 0)," ",v.exhibitTitle]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:416,columnNumber:29},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:412,columnNumber:27},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:408,columnNumber:25},void 0),v.insights.length>0&&b.jsxDEV(re,{children:[b.jsxDEV(ge,{variant:"subtitle2",gutterBottom:!0,children:"AI Analysis (Gemini 2.5 Pro)"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:426,columnNumber:27},void 0),v.insights.map((k,S)=>b.jsxDEV(Aa,{severity:k.type==="risk"?"warning":k.type==="opportunity"?"success":"info",sx:{mb:1},children:b.jsxDEV(ge,{variant:"body2",children:[b.jsxDEV("strong",{children:k.title},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:440,columnNumber:33},void 0),": ",k.description]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:439,columnNumber:31},void 0)},S,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:430,columnNumber:29},void 0))]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:425,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:399,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:398,columnNumber:19},void 0)]},v.id,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:345,columnNumber:17},void 0)})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:340,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:335,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/upload/CloudUploadZone.tsx",lineNumber:294,columnNumber:5},void 0)},oO=({isCollapsed:n=!1,headerComponent:e}={})=>{const{user:t,loading:i}=AE(),{showNotification:r}=PE(),s=We(Te=>Te.selectedProjectId),a=We(Te=>Te.setSelectedProject),o=We(Te=>Te.selectedFileId),l=We(Te=>Te.setSelectedFile),c=We(Te=>Te.searchFilters),u=We(Te=>Te.setSearchFilters),p=We(Te=>Te.resetSearchFilters),m=We(Te=>Te.setFiles),g=We(Te=>Te.projects),y=We(Te=>Te.setProjects),v=jx(),[w,k]=T.useState(0),[S,E]=T.useState(!1),P=T.useRef(null),[A,N]=T.useState(!1),[R,V]=T.useState(""),[B,L]=T.useState(!1),[W,q]=T.useState(null),[X,G]=T.useState(!1),[K,J]=T.useState(null),[ee,fe]=T.useState(!1),[ae,U]=T.useState(!0),[he,ie]=T.useState(!1),[$,Y]=T.useState(null),[oe,be]=T.useState(null),[xe,je]=T.useState("added_at"),[ze,Ve]=T.useState("desc"),[we,Ae]=T.useState("upload"),{data:_e=[],isLoading:ye,refetch:He,isError:Re,error:et}=gY(s),{mutate:Be,isPending:mt}=bY();T.useEffect(()=>{_e&&m(_e)},[_e,m]),T.useEffect(()=>{!i&&t&&ct()},[t,i]),T.useEffect(()=>{if(!ae&&g.length===0&&t){const Te=setTimeout(()=>{N(!0)},500);return()=>clearTimeout(Te)}},[ae,g,t]);const Xe=T.useCallback(xY.debounce(async Te=>{var Ue;if(s){if(!Te.trim()){ie(!1);return}try{ie(!0);const ke=await Zn.functions.invoke("project-search",{body:{projectId:s,query:Te,filters:{fileTypes:c.fileTypes||[],tags:c.tags||[],entities:c.entities||[],dateFrom:c.dateFrom?new Date(c.dateFrom).toISOString():null,dateTo:c.dateTo?new Date(c.dateTo).toISOString():null},searchType:c.searchType||"combined"}});if(ke.error)throw new Error(ke.error.message);(Ue=ke.data)!=null&&Ue.results&&console.log("Search results:",ke.data.results)}catch(ke){console.error("Error during search:",ke)}finally{ie(!1)}}},500),[s,c]);T.useEffect(()=>{c.searchTerm&&(ie(!0),Xe(c.searchTerm))},[c.searchTerm,Xe]);const ct=async()=>{var Te,Ue;try{if(U(!0),!t){console.log("Skipping project fetch - no authenticated user");return}if((t==null?void 0:t.id)==="00000000-0000-0000-0000-000000000000"||window.DEMO_MODE){console.log("Demo user detected - using local projects");return}const{data:ke,error:ot}=await Zn.auth.getSession();if(ot)throw new Error(`Authentication error: ${ot.message}`);if(!((Te=ke==null?void 0:ke.session)!=null&&Te.access_token))throw new Error("Authentication error: No API key found in request");const{data:Bt,error:dn}=await Zn.from("projects").select("*").order("created_at",{ascending:!1});if(dn)throw dn;y(Bt||[])}catch(ke){Gh(ke,"fetchProjects"),!window.DEMO_MODE&&(t==null?void 0:t.id)!=="00000000-0000-0000-0000-000000000000"&&(Ue=ke==null?void 0:ke.message)!=null&&Ue.includes("No API key found")&&r("Session expired. Please refresh your browser or log in again.","warning",6e3)}finally{U(!1)}},tn=async()=>{var Ue;if(!R.trim())return;N(!1);const Te=!t||t.id==="demo-user-123";try{console.log("Creating new project:",R,Te?"(DEMO MODE)":"");const{data:ke,error:ot}=await Zn.auth.getSession();if(ot)throw new Error(`Authentication error: ${ot.message}`);if(!((Ue=ke==null?void 0:ke.session)!=null&&Ue.access_token))throw new Error("Authentication error: No API key found in request");const Bt=(t==null?void 0:t.id)||"demo-user-123";if(Te){const vn={id:crypto.randomUUID(),name:R.trim(),owner_id:Bt,created_at:new Date().toISOString()};console.log("Created mock project (demo mode):",vn),y([vn,...g]),a(vn.id),V(""),console.log("Navigating to:",`/projects/${vn.id}`),v(`/projects/${vn.id}`),r("Project created in demo mode (changes won't be saved)","info",6e3);return}const{data:dn,error:oi}=await Zn.from("projects").insert({name:R.trim(),owner_id:Bt}).select().single();if(oi)throw oi;console.log("Project created successfully:",dn),y([dn,...g]),a(dn.id),V(""),console.log("Navigating to:",`/projects/${dn.id}`),v(`/projects/${dn.id}`)}catch(ke){Gh(ke,"handleCreateProject"),r(Mv(ke,"Error creating project"),"error",6e3)}},on=async Te=>{if(!(!s||!t||!Te.target.files||Te.target.files.length===0))try{k(0);const Ue=Te.target.files[0];await Be({file:Ue,projectId:s,userId:t.id,onProgress:ke=>{const ot=Math.round(ke.loaded/ke.total*100);k(ot)}},{onSuccess:ke=>{console.log("Upload successful:",ke),r("File uploaded successfully","success"),ke&&ke.id&&l(ke.id),Te.target.value=""},onError:ke=>{Gh(ke,"fileUpload"),r(Mv(ke,"Error uploading file"),"error",6e3)}})}catch(Ue){console.error("Error uploading file:",Ue)}},Oe=Te=>{u({searchTerm:Te.target.value})},Ge=()=>{u({searchTerm:""})},ue=Te=>!c.tags||c.tags.length===0?Te:Te.filter(Ue=>{var ot;const ke=((ot=Ue.metadata)==null?void 0:ot.tags)||[];return c.tags.some(Bt=>ke.includes(Bt))}),de=Te=>{if(!Array.isArray(Te))return console.warn("filterFiles received non-array input:",Te),[];if(!c.searchTerm&&(!c.fileTypes||c.fileTypes.length===0)&&(!c.tags||c.tags.length===0)&&!c.dateFrom&&!c.dateTo)return Pe(Te);let Ue=Te.filter(ke=>{var oi;const ot=!c.searchTerm||ke.name.toLowerCase().includes(c.searchTerm.toLowerCase())||ke.exhibit_id&&ke.exhibit_id.toLowerCase().includes(c.searchTerm.toLowerCase())||((oi=ke.metadata)==null?void 0:oi.description)&&ke.metadata.description.toLowerCase().includes(c.searchTerm.toLowerCase()),Bt=!c.fileTypes||c.fileTypes.length===0||c.fileTypes.includes(ke.file_type);let dn=!0;if(c.dateFrom||c.dateTo){const vn=new Date(ke.added_at);c.dateFrom&&(dn=vn>=new Date(c.dateFrom)),dn&&c.dateTo&&(dn=vn<=new Date(c.dateTo))}return ot&&Bt&&dn});return c.tags&&c.tags.length>0&&(Ue=ue(Ue)),Pe(Ue)},Pe=Te=>[...Te].sort((Ue,ke)=>{let ot=0;switch(xe){case"name":ot=Ue.name.localeCompare(ke.name);break;case"exhibit_id":!Ue.exhibit_id&&!ke.exhibit_id?ot=0:Ue.exhibit_id?ke.exhibit_id?ot=Ue.exhibit_id.localeCompare(ke.exhibit_id):ot=-1:ot=1;break;case"added_at":default:ot=new Date(ke.added_at).getTime()-new Date(Ue.added_at).getTime();break}return ze==="asc"?ot:-ot}),Le=Te=>{l(Te)},$e=(Te,Ue)=>{Ue.stopPropagation(),q(Te),L(!0),ht()},ht=()=>{Y(null),be(null)},Et=async()=>{if(!K||!s){G(!1);return}try{const Te=_e.find(Ue=>Ue.id===K);if(Te){const{error:Ue}=await Zn.storage.from("files").remove([Te.storage_path]);Ue&&Gh(Ue,"handleDeleteFile.storage");const{error:ke}=await Zn.from("files").delete().eq("id",K);if(ke)throw ke;o===K&&l(null),He()}}catch(Te){Gh(Te,"handleDeleteFile.database"),r(Mv(Te,"Error deleting file"),"error",6e3)}finally{G(!1),J(null)}},Ut=async Te=>{ht();const Ue=_e.find(ke=>ke.id===Te);if(Ue)try{const{data:ke,error:ot}=await Zn.storage.from("files").createSignedUrl(Ue.storage_path,60);if(ot)throw ot;if(ke!=null&&ke.signedUrl){const Bt=document.createElement("a");Bt.href=ke.signedUrl,Bt.download=Ue.name,document.body.appendChild(Bt),Bt.click(),document.body.removeChild(Bt)}}catch(ke){Gh(ke,"handleDownloadFile"),r(Mv(ke,"Error downloading file"),"error",6e3)}},zt=de(_e||[]);return b.jsxDEV(re,{sx:{height:"100%",maxHeight:"100%",display:"flex",flexDirection:"column",overflow:"hidden",pt:1.5,backgroundColor:Te=>Te.palette.background.default},"data-test":"left-panel",children:[e?e(b.jsxDEV(ge,{variant:"h6",sx:{fontWeight:"bold"},children:"Clarity Hub"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:672,columnNumber:9},void 0)):b.jsxDEV(ge,{variant:"h6",sx:{fontWeight:"bold",px:2,py:1},children:"Clarity Hub"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:676,columnNumber:9},void 0),b.jsxDEV(re,{sx:{display:n?"none":"flex",flexDirection:"column",height:"100%",overflowY:"auto"},children:[b.jsxDEV(re,{sx:{pb:2},children:b.jsxDEV(SY,{projects:g,selectedProjectId:s,loading:ae,onSelectProject:a,onCreateProject:tn,onRefresh:ct},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:692,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:691,columnNumber:9},void 0),b.jsxDEV(Pr,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:702,columnNumber:9},void 0),s&&b.jsxDEV(re,{sx:{borderBottom:1,borderColor:"divider"},children:b.jsxDEV(hE,{value:we,onChange:(Te,Ue)=>Ae(Ue),variant:"fullWidth",textColor:"primary",indicatorColor:"primary",children:[b.jsxDEV(mp,{icon:b.jsxDEV(IR,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:715,columnNumber:23},void 0),iconPosition:"start",label:"Upload",value:"upload",sx:{minHeight:48,textTransform:"none"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:714,columnNumber:15},void 0),b.jsxDEV(mp,{icon:b.jsxDEV(fp,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:722,columnNumber:23},void 0),iconPosition:"start",label:"Files",value:"files",sx:{minHeight:48,textTransform:"none"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:721,columnNumber:15},void 0),b.jsxDEV(mp,{icon:b.jsxDEV(V0,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:729,columnNumber:23},void 0),iconPosition:"start",label:"Exhibits",value:"exhibits",sx:{minHeight:48,textTransform:"none"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:728,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:707,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:706,columnNumber:11},void 0),s&&b.jsxDEV(re,{sx:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:we==="upload"?b.jsxDEV(re,{sx:{flex:1,overflow:"auto"},children:b.jsxDEV(rK,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:745,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:744,columnNumber:15},void 0):we==="files"?b.jsxDEV(b.Fragment,{children:[b.jsxDEV(re,{sx:{p:2},children:[b.jsxDEV(Ni,{fullWidth:!0,placeholder:"Search files...",value:c.searchTerm||"",onChange:Oe,InputProps:{startAdornment:b.jsxDEV(C1,{position:"start",children:b.jsxDEV(VR,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:759,columnNumber:27},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:758,columnNumber:25},void 0),endAdornment:b.jsxDEV(C1,{position:"end",children:he?b.jsxDEV(Yr,{size:20},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:765,columnNumber:29},void 0):c.searchTerm?b.jsxDEV(ut,{size:"small",onClick:Ge,edge:"end","aria-label":"clear search",children:b.jsxDEV(C4,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:773,columnNumber:31},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:767,columnNumber:29},void 0):b.jsxDEV(ut,{size:"small",onClick:()=>fe(!ee),edge:"end","aria-label":"advanced search",color:ee?"primary":"default",children:b.jsxDEV(A4,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:783,columnNumber:31},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:776,columnNumber:29},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:763,columnNumber:25},void 0)},size:"small",sx:{mb:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:751,columnNumber:19},void 0),ee&&b.jsxDEV(hY,{filters:c,onUpdateFilters:u,onReset:p,projectId:s},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:795,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:750,columnNumber:17},void 0),b.jsxDEV(re,{sx:{flex:1,overflow:"hidden"},children:b.jsxDEV(NY,{files:_e,filteredFiles:zt,selectedFileId:o,loading:ye,uploading:mt,uploadProgress:w,onSelectFile:Le,onDeleteFile:Et,onDownloadFile:Ut,onRenameFile:$e,onUploadFile:()=>{r('Use the "Upload Files" tab in the center panel for AI-powered uploads',"info")},searchActive:!!c.searchTerm||c.tags&&c.tags.length>0||c.fileTypes&&c.fileTypes.length>0||c.dateFrom||c.dateTo},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:806,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:805,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:748,columnNumber:15},void 0):b.jsxDEV(_Y,{projectId:s,onExhibitClick:Te=>{Ae("files")},onCitationInsert:(Te,Ue)=>{const ke=Ue?`${Te}:${Ue}`:Te,ot=new CustomEvent("insertCitation",{detail:{exhibitId:Te,pageNumber:Ue,citationReference:ke,description:`Exhibit ${Te}${Ue?`, page ${Ue}`:""}`}});window.dispatchEvent(ot),console.log("Dispatched citation insertion event:",ke)}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:834,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:741,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:682,columnNumber:7},void 0),b.jsxDEV("input",{type:"file",ref:P,style:{display:"none"},onChange:on},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:864,columnNumber:7},void 0),b.jsxDEV(pY,{open:B,fileId:W,onClose:()=>{L(!1),q(null)}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:872,columnNumber:7},void 0),b.jsxDEV(uh,{open:X,onClose:()=>G(!1),children:[b.jsxDEV(Zf,{children:"Confirm Delete"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:886,columnNumber:9},void 0),b.jsxDEV(dh,{children:b.jsxDEV(TR,{children:"Are you sure you want to delete this file? This action cannot be undone."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:888,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:887,columnNumber:9},void 0),b.jsxDEV(ch,{children:[b.jsxDEV(vt,{onClick:()=>G(!1),children:"Cancel"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:893,columnNumber:11},void 0),b.jsxDEV(vt,{onClick:Et,color:"error",variant:"contained",children:"Delete"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:894,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:892,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:882,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/LeftPanel.tsx",lineNumber:658,columnNumber:5},void 0)};var wD=function(){return wD=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},wD.apply(this,arguments)},lO={onActivate:Ne.func,onAddUndo:Ne.func,onBeforeAddUndo:Ne.func,onBeforeExecCommand:Ne.func,onBeforeGetContent:Ne.func,onBeforeRenderUI:Ne.func,onBeforeSetContent:Ne.func,onBeforePaste:Ne.func,onBlur:Ne.func,onChange:Ne.func,onClearUndos:Ne.func,onClick:Ne.func,onContextMenu:Ne.func,onCommentChange:Ne.func,onCompositionEnd:Ne.func,onCompositionStart:Ne.func,onCompositionUpdate:Ne.func,onCopy:Ne.func,onCut:Ne.func,onDblclick:Ne.func,onDeactivate:Ne.func,onDirty:Ne.func,onDrag:Ne.func,onDragDrop:Ne.func,onDragEnd:Ne.func,onDragGesture:Ne.func,onDragOver:Ne.func,onDrop:Ne.func,onExecCommand:Ne.func,onFocus:Ne.func,onFocusIn:Ne.func,onFocusOut:Ne.func,onGetContent:Ne.func,onHide:Ne.func,onInit:Ne.func,onInput:Ne.func,onKeyDown:Ne.func,onKeyPress:Ne.func,onKeyUp:Ne.func,onLoadContent:Ne.func,onMouseDown:Ne.func,onMouseEnter:Ne.func,onMouseLeave:Ne.func,onMouseMove:Ne.func,onMouseOut:Ne.func,onMouseOver:Ne.func,onMouseUp:Ne.func,onNodeChange:Ne.func,onObjectResizeStart:Ne.func,onObjectResized:Ne.func,onObjectSelected:Ne.func,onPaste:Ne.func,onPostProcess:Ne.func,onPostRender:Ne.func,onPreProcess:Ne.func,onProgressState:Ne.func,onRedo:Ne.func,onRemove:Ne.func,onReset:Ne.func,onSaveContent:Ne.func,onSelectionChange:Ne.func,onSetAttrib:Ne.func,onSetContent:Ne.func,onShow:Ne.func,onSubmit:Ne.func,onUndo:Ne.func,onVisualAid:Ne.func,onSkinLoadError:Ne.func,onThemeLoadError:Ne.func,onModelLoadError:Ne.func,onPluginLoadError:Ne.func,onIconsLoadError:Ne.func,onLanguageLoadError:Ne.func,onScriptsLoad:Ne.func,onScriptsLoadError:Ne.func},sK=wD({apiKey:Ne.string,licenseKey:Ne.string,id:Ne.string,inline:Ne.bool,init:Ne.object,initialValue:Ne.string,onEditorChange:Ne.func,value:Ne.string,tagName:Ne.string,tabIndex:Ne.number,cloudChannel:Ne.string,plugins:Ne.oneOfType([Ne.string,Ne.array]),toolbar:Ne.oneOfType([Ne.string,Ne.array]),disabled:Ne.bool,textareaName:Ne.string,tinymceScriptSrc:Ne.oneOfType([Ne.string,Ne.arrayOf(Ne.string),Ne.arrayOf(Ne.shape({src:Ne.string,async:Ne.bool,defer:Ne.bool}))]),rollback:Ne.oneOfType([Ne.number,Ne.oneOf([!1])]),scriptLoading:Ne.shape({async:Ne.bool,defer:Ne.bool,delay:Ne.number})},lO),Gk=function(n){return typeof n=="function"},CT=function(n){return n in lO},AT=function(n){return n.substr(2)},aK=function(n,e,t,i,r,s,a){var o=Object.keys(r).filter(CT),l=Object.keys(s).filter(CT),c=o.filter(function(p){return s[p]===void 0}),u=l.filter(function(p){return r[p]===void 0});c.forEach(function(p){var m=AT(p),g=a[m];t(m,g),delete a[m]}),u.forEach(function(p){var m=i(n,p),g=AT(p);a[g]=m,e(g,m)})},oK=function(n,e,t,i,r){return aK(r,n.on.bind(n),n.off.bind(n),function(s,a){return function(o){var l;return(l=s(a))===null||l===void 0?void 0:l(o,n)}},e,t,i)},PT=0,cO=function(n){var e=Date.now(),t=Math.floor(Math.random()*1e9);return PT++,n+"_"+t+PT+String(e)},TT=function(n){return n!==null&&(n.tagName.toLowerCase()==="textarea"||n.tagName.toLowerCase()==="input")},IT=function(n){return typeof n>"u"||n===""?[]:Array.isArray(n)?n:n.split(" ")},lK=function(n,e){return IT(n).concat(IT(e))},cK=function(){return window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function"},uK=function(n){if(!("isConnected"in Node.prototype)){for(var e=n,t=n.parentNode;t!=null;)e=t,t=e.parentNode;return e===n.ownerDocument}return n.isConnected},RT=function(n,e){n!==void 0&&(n.mode!=null&&typeof n.mode=="object"&&typeof n.mode.set=="function"?n.mode.set(e):n.setMode(e))},kD=function(){return kD=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},kD.apply(this,arguments)},dK=function(n,e,t){var i,r,s=n.createElement("script");s.referrerPolicy="origin",s.type="application/javascript",s.id=e.id,s.src=e.src,s.async=(i=e.async)!==null&&i!==void 0?i:!1,s.defer=(r=e.defer)!==null&&r!==void 0?r:!1;var a=function(){s.removeEventListener("load",a),s.removeEventListener("error",o),t(e.src)},o=function(l){s.removeEventListener("load",a),s.removeEventListener("error",o),t(e.src,l)};s.addEventListener("load",a),s.addEventListener("error",o),n.head&&n.head.appendChild(s)},hK=function(n){var e={},t=function(a,o){var l=e[a];l.done=!0,l.error=o;for(var c=0,u=l.handlers;c<u.length;c++){var p=u[c];p(a,o)}l.handlers=[]},i=function(a,o,l){var c=function(S){return l!==void 0?l(S):console.error(S)};if(a.length===0){c(new Error("At least one script must be provided"));return}for(var u=0,p=!1,m=function(S,E){p||(E?(p=!0,c(E)):++u===a.length&&o())},g=0,y=a;g<y.length;g++){var v=y[g],w=e[v.src];if(w)w.done?m(v.src,w.error):w.handlers.push(m);else{var k=cO("tiny-");e[v.src]={id:k,src:v.src,done:!1,error:null,handlers:[m]},dK(n,kD({id:k},v),t)}}},r=function(){for(var a,o=0,l=Object.values(e);o<l.length;o++){var c=l[o],u=n.getElementById(c.id);u!=null&&u.tagName==="SCRIPT"&&((a=u.parentNode)===null||a===void 0||a.removeChild(u))}e={}},s=function(){return n};return{loadScripts:i,deleteScripts:r,getDocument:s}},pK=function(){var n=[],e=function(r){var s=n.find(function(a){return a.getDocument()===r});return s===void 0&&(s=hK(r),n.push(s)),s},t=function(r,s,a,o,l){var c=function(){return e(r).loadScripts(s,o,l)};a>0?setTimeout(c,a):c()},i=function(){for(var r=n.pop();r!=null;r=n.pop())r.deleteScripts()};return{loadList:t,reinitialize:i}},fK=pK(),MT=function(n){var e=n;return e&&e.tinymce?e.tinymce:null},mK=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(i[s]=r[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),cp=function(){return cp=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},cp.apply(this,arguments)},Yk="change keyup compositionend setcontent CommentChange",gK=function(n){mK(e,n);function e(t){var i,r,s,a=n.call(this,t)||this;return a.rollbackTimer=void 0,a.valueCursor=void 0,a.rollbackChange=function(){var o=a.editor,l=a.props.value;o&&l&&l!==a.currentContent&&o.undoManager.ignore(function(){if(o.setContent(l),a.valueCursor&&(!a.inline||o.hasFocus()))try{o.selection.moveToBookmark(a.valueCursor)}catch{}}),a.rollbackTimer=void 0},a.handleBeforeInput=function(o){if(a.props.value!==void 0&&a.props.value===a.currentContent&&a.editor&&(!a.inline||a.editor.hasFocus()))try{a.valueCursor=a.editor.selection.getBookmark(3)}catch{}},a.handleBeforeInputSpecial=function(o){(o.key==="Enter"||o.key==="Backspace"||o.key==="Delete")&&a.handleBeforeInput(o)},a.handleEditorChange=function(o){var l=a.editor;if(l&&l.initialized){var c=l.getContent();a.props.value!==void 0&&a.props.value!==c&&a.props.rollback!==!1&&(a.rollbackTimer||(a.rollbackTimer=window.setTimeout(a.rollbackChange,typeof a.props.rollback=="number"?a.props.rollback:200))),c!==a.currentContent&&(a.currentContent=c,Gk(a.props.onEditorChange)&&a.props.onEditorChange(c,l))}},a.handleEditorChangeSpecial=function(o){(o.key==="Backspace"||o.key==="Delete")&&a.handleEditorChange(o)},a.initialise=function(o){var l,c,u;o===void 0&&(o=0);var p=a.elementRef.current;if(p){if(!uK(p)){if(o===0)setTimeout(function(){return a.initialise(1)},1);else if(o<100)setTimeout(function(){return a.initialise(o+1)},100);else throw new Error("tinymce can only be initialised when in a document");return}var m=MT(a.view);if(!m)throw new Error("tinymce should have been loaded into global scope");var g=cp(cp(cp(cp({},a.props.init),{selector:void 0,target:p,readonly:a.props.disabled,inline:a.inline,plugins:lK((l=a.props.init)===null||l===void 0?void 0:l.plugins,a.props.plugins),toolbar:(c=a.props.toolbar)!==null&&c!==void 0?c:(u=a.props.init)===null||u===void 0?void 0:u.toolbar}),a.props.licenseKey?{license_key:a.props.licenseKey}:{}),{setup:function(y){a.editor=y,a.bindHandlers({}),a.inline&&!TT(p)&&y.once("PostRender",function(v){y.setContent(a.getInitialValue(),{no_events:!0})}),a.props.init&&Gk(a.props.init.setup)&&a.props.init.setup(y)},init_instance_callback:function(y){var v,w,k=a.getInitialValue();a.currentContent=(v=a.currentContent)!==null&&v!==void 0?v:y.getContent(),a.currentContent!==k&&(a.currentContent=k,y.setContent(k),y.undoManager.clear(),y.undoManager.add(),y.setDirty(!1));var S=(w=a.props.disabled)!==null&&w!==void 0?w:!1;RT(a.editor,S?"readonly":"design"),a.props.init&&Gk(a.props.init.init_instance_callback)&&a.props.init.init_instance_callback(y)}});a.inline||(p.style.visibility=""),TT(p)&&(p.value=a.getInitialValue()),m.init(g)}},a.id=a.props.id||cO("tiny-react"),a.elementRef=T.createRef(),a.inline=(s=(i=a.props.inline)!==null&&i!==void 0?i:(r=a.props.init)===null||r===void 0?void 0:r.inline)!==null&&s!==void 0?s:!1,a.boundHandlers={},a}return Object.defineProperty(e.prototype,"view",{get:function(){var t,i;return(i=(t=this.elementRef.current)===null||t===void 0?void 0:t.ownerDocument.defaultView)!==null&&i!==void 0?i:window},enumerable:!1,configurable:!0}),e.prototype.componentDidUpdate=function(t){var i=this,r,s;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(t),this.editor.initialized)){if(this.currentContent=(r=this.currentContent)!==null&&r!==void 0?r:this.editor.getContent(),typeof this.props.initialValue=="string"&&this.props.initialValue!==t.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if(typeof this.props.value=="string"&&this.props.value!==this.currentContent){var a=this.editor;a.undoManager.transact(function(){var l;if(!i.inline||a.hasFocus())try{l=a.selection.getBookmark(3)}catch{}var c=i.valueCursor;if(a.setContent(i.props.value),!i.inline||a.hasFocus())for(var u=0,p=[l,c];u<p.length;u++){var m=p[u];if(m)try{a.selection.moveToBookmark(m),i.valueCursor=m;break}catch{}}})}if(this.props.disabled!==t.disabled){var o=(s=this.props.disabled)!==null&&s!==void 0?s:!1;RT(this.editor,o?"readonly":"design")}}},e.prototype.componentDidMount=function(){var t=this,i,r,s,a,o;if(MT(this.view)!==null)this.initialise();else if(Array.isArray(this.props.tinymceScriptSrc)&&this.props.tinymceScriptSrc.length===0)(r=(i=this.props).onScriptsLoadError)===null||r===void 0||r.call(i,new Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array."));else if(!((s=this.elementRef.current)===null||s===void 0)&&s.ownerDocument){var l=function(){var u,p;(p=(u=t.props).onScriptsLoad)===null||p===void 0||p.call(u),t.initialise()},c=function(u){var p,m;(m=(p=t.props).onScriptsLoadError)===null||m===void 0||m.call(p,u)};fK.loadList(this.elementRef.current.ownerDocument,this.getScriptSources(),(o=(a=this.props.scriptLoading)===null||a===void 0?void 0:a.delay)!==null&&o!==void 0?o:0,l,c)}},e.prototype.componentWillUnmount=function(){var t=this,i=this.editor;i&&(i.off(Yk,this.handleEditorChange),i.off(this.beforeInputEvent(),this.handleBeforeInput),i.off("keypress",this.handleEditorChangeSpecial),i.off("keydown",this.handleBeforeInputSpecial),i.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach(function(r){i.off(r,t.boundHandlers[r])}),this.boundHandlers={},i.remove(),this.editor=void 0)},e.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},e.prototype.beforeInputEvent=function(){return cK()?"beforeinput SelectionChange":"SelectionChange"},e.prototype.renderInline=function(){var t=this.props.tagName,i=t===void 0?"div":t;return T.createElement(i,{ref:this.elementRef,id:this.id,tabIndex:this.props.tabIndex})},e.prototype.renderIframe=function(){return T.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id,tabIndex:this.props.tabIndex})},e.prototype.getScriptSources=function(){var t,i,r=(t=this.props.scriptLoading)===null||t===void 0?void 0:t.async,s=(i=this.props.scriptLoading)===null||i===void 0?void 0:i.defer;if(this.props.tinymceScriptSrc!==void 0)return typeof this.props.tinymceScriptSrc=="string"?[{src:this.props.tinymceScriptSrc,async:r,defer:s}]:this.props.tinymceScriptSrc.map(function(c){return typeof c=="string"?{src:c,async:r,defer:s}:c});var a=this.props.cloudChannel,o=this.props.apiKey?this.props.apiKey:"no-api-key",l="https://cdn.tiny.cloud/1/".concat(o,"/tinymce/").concat(a,"/tinymce.min.js");return[{src:l,async:r,defer:s}]},e.prototype.getInitialValue=function(){return typeof this.props.initialValue=="string"?this.props.initialValue:typeof this.props.value=="string"?this.props.value:""},e.prototype.bindHandlers=function(t){var i=this;if(this.editor!==void 0){oK(this.editor,t,this.props,this.boundHandlers,function(o){return i.props[o]});var r=function(o){return o.onEditorChange!==void 0||o.value!==void 0},s=r(t),a=r(this.props);!s&&a?(this.editor.on(Yk,this.handleEditorChange),this.editor.on(this.beforeInputEvent(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):s&&!a&&(this.editor.off(Yk,this.handleEditorChange),this.editor.off(this.beforeInputEvent(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},e.propTypes=sK,e.defaultProps={cloudChannel:"7"},e}(T.Component);class bK{constructor(){this.db=null,this.DB_NAME="ClarityHubDemo",this.DB_VERSION=2}async init(){return new Promise((e,t)=>{const i=indexedDB.open(this.DB_NAME,this.DB_VERSION);i.onerror=()=>t(i.error),i.onsuccess=()=>{this.db=i.result,e()},i.onupgradeneeded=r=>{const s=r.target.result;s.objectStoreNames.contains("files")||s.createObjectStore("files",{keyPath:"id"}).createIndex("project_id","project_id",{unique:!1}),s.objectStoreNames.contains("projects")||s.createObjectStore("projects",{keyPath:"id"}),s.objectStoreNames.contains("conversations")||s.createObjectStore("conversations",{keyPath:"id"}).createIndex("project_id","project_id",{unique:!1}),s.objectStoreNames.contains("documents")||s.createObjectStore("documents",{keyPath:"id"}).createIndex("project_id","project_id",{unique:!1})}})}async saveFile(e,t,i,r){this.db||await this.init();const s=await e.arrayBuffer(),a={id:crypto.randomUUID(),name:e.name,type:e.type,size:e.size,content:s,project_id:t,exhibit_id:i,exhibit_title:r,uploaded_at:new Date().toISOString()};return new Promise((o,l)=>{const p=this.db.transaction(["files"],"readwrite").objectStore("files").add(a);p.onsuccess=()=>o(a),p.onerror=()=>l(p.error)})}async getFiles(e){return this.db||await this.init(),new Promise((t,i)=>{const o=this.db.transaction(["files"],"readonly").objectStore("files").index("project_id").getAll(e);o.onsuccess=()=>t(o.result||[]),o.onerror=()=>i(o.error)})}async getFileBlob(e){return this.db||await this.init(),new Promise((t,i)=>{const a=this.db.transaction(["files"],"readonly").objectStore("files").get(e);a.onsuccess=()=>{const o=a.result;t(o?new Blob([o.content],{type:o.type}):null)},a.onerror=()=>i(a.error)})}async updateFileExhibit(e,t,i){return this.db||await this.init(),new Promise((r,s)=>{const o=this.db.transaction(["files"],"readwrite").objectStore("files");o.get(e).onsuccess=l=>{const c=l.target.result;if(c){c.exhibit_id=t,c.exhibit_title=i;const u=o.put(c);u.onsuccess=()=>r(),u.onerror=()=>s(u.error)}else s(new Error("File not found"))}})}async saveProject(e){return this.db||await this.init(),new Promise((t,i)=>{const a=this.db.transaction(["projects"],"readwrite").objectStore("projects").put(e);a.onsuccess=()=>t(),a.onerror=()=>i(a.error)})}async getProjects(){return this.db||await this.init(),new Promise((e,t)=>{const s=this.db.transaction(["projects"],"readonly").objectStore("projects").getAll();s.onsuccess=()=>e(s.result||[]),s.onerror=()=>t(s.error)})}async saveConversation(e){return this.db||await this.init(),new Promise((t,i)=>{const a=this.db.transaction(["conversations"],"readwrite").objectStore("conversations").put(e);a.onsuccess=()=>t(),a.onerror=()=>i(a.error)})}async getConversations(e){return this.db||await this.init(),new Promise((t,i)=>{const o=this.db.transaction(["conversations"],"readonly").objectStore("conversations").index("project_id").getAll(e);o.onsuccess=()=>t(o.result||[]),o.onerror=()=>i(o.error)})}async saveDocument(e,t,i,r="Untitled Document"){this.db||await this.init();const s={id:e,project_id:t,title:r,content:i,updated_at:new Date().toISOString()};return new Promise((a,o)=>{const u=this.db.transaction(["documents"],"readwrite").objectStore("documents").put(s);u.onsuccess=()=>a(),u.onerror=()=>o(u.error)})}async getDocument(e){return this.db||await this.init(),new Promise((t,i)=>{const a=this.db.transaction(["documents"],"readonly").objectStore("documents").get(e);a.onsuccess=()=>t(a.result||null),a.onerror=()=>i(a.error)})}async getProjectDocuments(e){return this.db||await this.init(),new Promise((t,i)=>{const o=this.db.transaction(["documents"],"readonly").objectStore("documents").index("project_id").getAll(e);o.onsuccess=()=>t(o.result||[]),o.onerror=()=>i(o.error)})}async initializeDemoData(){if(this.db||await this.init(),(await this.getProjects()).length>0){console.log("Demo data already exists, skipping initialization");return}const t={id:"11111111-1111-1111-1111-111111111111",name:"Acme Corp. v. Widget Industries",description:"Contract dispute regarding manufacturing components - Demo Case",created_at:new Date().toISOString(),status:"active"};await this.saveProject(t),await this.saveDocument("demo-welcome-doc",t.id,`
      <h1>Welcome to Clarity Hub - Demo Mode</h1>
      <p>This is your persistent demo environment. Any changes you make here will be saved locally and persist across browser sessions.</p>
      
      <h2>Demo Features Available:</h2>
      <ul>
        <li><strong>File Upload & Analysis:</strong> Upload real files and get AI-powered analysis</li>
        <li><strong>Exhibit Management:</strong> Automatic exhibit ID generation and management</li>
        <li><strong>AI Chat Assistant:</strong> Get personalized legal insights and document help</li>
        <li><strong>Document Editing:</strong> Full rich-text editor with auto-save</li>
        <li><strong>Persistent Storage:</strong> All your demo data persists across sessions</li>
      </ul>
      
      <h2>Try These Demo Actions:</h2>
      <ol>
        <li>Upload a PDF or document file using the "Upload Files" tab</li>
        <li>Ask the AI Assistant questions about your case</li>
        <li>Edit this document and see auto-save in action</li>
        <li>Generate exhibit IDs and manage your evidence</li>
      </ol>
      
      <p><em>This demo uses local browser storage, so your data stays private and persists across sessions.</em></p>
    `,"Demo Case - Welcome Document"),console.log("Demo data initialized successfully")}async clearDemoData(){this.db||await this.init();const e=["files","projects","conversations","documents"];return new Promise((t,i)=>{const r=this.db.transaction(e,"readwrite");let s=0;const a=()=>{s++,s===e.length&&t()};e.forEach(o=>{const c=r.objectStore(o).clear();c.onsuccess=a,c.onerror=()=>i(c.error)})})}async exportDemoData(){const[e,t,i,r]=await Promise.all([this.getProjects(),this.getFiles("11111111-1111-1111-1111-111111111111"),this.getConversations("11111111-1111-1111-1111-111111111111"),this.getProjectDocuments("11111111-1111-1111-1111-111111111111")]),s=t.map(a=>({...a,content:btoa(String.fromCharCode(...new Uint8Array(a.content)))}));return JSON.stringify({projects:e,files:s,conversations:i,documents:r,exportedAt:new Date().toISOString()},null,2)}}const vl=new bK,jT=({initialContent:n="",onChange:e,onSave:t,autoSave:i=!0,autoSaveInterval:r=3e4,height:s="100%",placeholder:a="Start typing your document...",readOnly:o=!1})=>{const l=T.useRef(null),[c,u]=T.useState(n),[p,m]=T.useState(!1),[g,y]=T.useState(0),[v,w]=T.useState(0),[k,S]=T.useState(!1),[E,P]=T.useState(!1),[A,N]=T.useState(null),[R,V]=T.useState(!1),[B,L]=T.useState(null),[W,q]=T.useState(!1),X=We(U=>U.themeMode),G=We(U=>U.user),K=We(U=>U.selectedProjectId);T.useEffect(()=>{(async()=>{if((G==null?void 0:G.id)==="00000000-0000-0000-0000-000000000000"&&K&&!n){m(!0);try{const he=`editor-${K}`,ie=await vl.getDocument(he);ie!=null&&ie.content&&(u(ie.content),console.log("Loaded saved document from demo storage"))}catch(he){console.error("Failed to load demo content:",he)}finally{m(!1)}}})()},[G,K,n]),T.useEffect(()=>{if(i&&W&&t){const U=setTimeout(async()=>{await J()},r);return()=>clearTimeout(U)}},[c,i,r,W]);const J=T.useCallback(async()=>{P(!0);try{if((G==null?void 0:G.id)==="00000000-0000-0000-0000-000000000000"&&K){const U=`editor-${K}`;await vl.saveDocument(U,K,c,"Document Editor"),console.log("Document saved to demo storage")}t&&await t(c),N(new Date),V(!0),q(!1)}catch(U){console.error("Failed to save:",U)}finally{P(!1)}},[c,t,G,K]),ee=U=>{u(U),q(!0),e==null||e(U);const he=U.replace(/<[^>]*>/g,"");y(he.trim().split(/\s+/).filter(ie=>ie.length>0).length),w(he.length)},fe=U=>{const he=l.current;if(!he)return;const ie=he.getContent(),$=new Blob([ie],{type:"text/html"}),Y=URL.createObjectURL($),oe=document.createElement("a");oe.href=Y,oe.download=`document.${U}`,oe.click(),URL.revokeObjectURL(Y),L(null)},ae={height:k?"calc(100vh - 60px)":"calc(100vh - 250px)",menubar:"file edit view insert format tools table help",branding:!1,placeholder:a,readonly:o,skin:X==="dark"?"oxide-dark":"oxide",content_css:X==="dark"?"dark":"default",license_key:"gpl",plugins:["autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","wordcount","help","emoticons","codesample","autosave","directionality","visualchars","nonbreaking","pagebreak","quickbars","advlist"],toolbar:"undo redo | cut copy paste | formatselect | bold italic underline strikethrough subscript superscript | alignleft aligncenter alignright alignjustify | bullist numlist checklist outdent indent | link unlink anchor image media table | forecolor backcolor | fontfamily fontsize | codesample blockquote | searchreplace | removeformat | fullscreen help",toolbar_mode:"sliding",quickbars_selection_toolbar:"bold italic | quicklink h2 h3 blockquote",quickbars_insert_toolbar:"quickimage quicktable",paste_data_images:!0,paste_as_text:!1,browser_spellcheck:!0,allow_html_in_named_anchor:!0,link_context_toolbar:!0,link_quicklink:!0,default_link_target:"_blank",link_assume_external_targets:!0,table_toolbar:"tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol",table_appearance_options:!0,table_grid:!0,table_class_list:[{title:"None",value:""},{title:"Bordered",value:"table-bordered"},{title:"Striped",value:"table-striped"}],content_style:`
      body { 
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-size: 16px;
        line-height: 1.6;
        color: ${X==="dark"?"#f1f5f9":"#1e293b"};
        padding: 20px;
        max-width: 100%;
      }
      h1 { font-size: 2.5em; font-weight: 700; margin-bottom: 0.5em; }
      h2 { font-size: 2em; font-weight: 600; margin-bottom: 0.5em; }
      h3 { font-size: 1.75em; font-weight: 600; margin-bottom: 0.5em; }
      h4 { font-size: 1.5em; font-weight: 600; margin-bottom: 0.5em; }
      h5 { font-size: 1.25em; font-weight: 600; margin-bottom: 0.5em; }
      h6 { font-size: 1em; font-weight: 600; margin-bottom: 0.5em; }
      p { margin-bottom: 1em; }
      a { color: #2563eb; text-decoration: none; }
      a:hover { text-decoration: underline; }
      blockquote {
        border-left: 4px solid #2563eb;
        padding-left: 1em;
        margin: 1em 0;
        font-style: italic;
        color: ${X==="dark"?"#94a3b8":"#64748b"};
      }
      pre {
        background: ${X==="dark"?"#1e293b":"#f1f5f9"};
        padding: 1em;
        border-radius: 4px;
        overflow-x: auto;
      }
      code {
        background: ${X==="dark"?"#334155":"#e2e8f0"};
        padding: 0.2em 0.4em;
        border-radius: 3px;
        font-family: 'Monaco', 'Courier New', monospace;
      }
      table {
        border-collapse: collapse;
        width: 100%;
        margin: 1em 0;
      }
      th, td {
        border: 1px solid ${X==="dark"?"#475569":"#cbd5e1"};
        padding: 0.5em;
        text-align: left;
      }
      th {
        background: ${X==="dark"?"#334155":"#f8fafc"};
        font-weight: 600;
      }
      ul, ol {
        margin-bottom: 1em;
        padding-left: 2em;
      }
      li {
        margin-bottom: 0.25em;
      }
      img {
        max-width: 100%;
        height: auto;
        border-radius: 4px;
      }
      .citation {
        background: ${X==="dark"?"#1e3a8a":"#dbeafe"};
        color: ${X==="dark"?"#dbeafe":"#1e3a8a"};
        padding: 0.2em 0.4em;
        border-radius: 3px;
        font-weight: 500;
        font-size: 0.9em;
      }
    `,autosave_interval:"30s",autosave_restore_when_empty:!1,image_advtab:!0,image_caption:!0,noneditable_class:"mceNonEditable",toolbar_sticky:!0,setup:U=>{l.current=U,U.addShortcut("meta+s","Save",()=>{J()}),U.addShortcut("meta+shift+f","Fullscreen",()=>{S(!k)})}};return b.jsxDEV(sn,{elevation:0,sx:{height:k?"100vh":"100%",width:k?"100vw":"100%",position:k?"fixed":"relative",top:k?0:"auto",left:k?0:"auto",zIndex:k?9999:"auto",display:"flex",flexDirection:"column",bgcolor:"background.paper",border:"1px solid",borderColor:"divider",borderRadius:k?0:2,overflow:"hidden"},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:2,py:1,borderBottom:"1px solid",borderColor:"divider",bgcolor:U=>U.palette.mode==="dark"?"#1e293b":"#fafafa"},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:2},children:[E?b.jsxDEV(It,{icon:b.jsxDEV(LR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:344,columnNumber:21},void 0),label:"Saving...",size:"small",color:"primary",variant:"outlined"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:343,columnNumber:13},void 0):A?b.jsxDEV(It,{icon:b.jsxDEV(_R,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:352,columnNumber:21},void 0),label:`Saved ${A.toLocaleTimeString()}`,size:"small",color:"success",variant:"outlined"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:351,columnNumber:13},void 0):null,W&&!E&&b.jsxDEV(It,{label:"Unsaved changes",size:"small",color:"warning",variant:"outlined"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:361,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:341,columnNumber:9},void 0),b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:2},children:[b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:[g," words"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:372,columnNumber:11},void 0),b.jsxDEV(Pr,{orientation:"vertical",flexItem:!0},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:375,columnNumber:11},void 0),b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:[v," characters"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:376,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:371,columnNumber:9},void 0),b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1},children:[b.jsxDEV(Nt,{title:"Save (⌘S)",children:b.jsxDEV(ut,{onClick:J,disabled:!W||E,size:"small",children:b.jsxDEV(UR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:389,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:384,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:383,columnNumber:11},void 0),b.jsxDEV(Nt,{title:"Export",children:b.jsxDEV(ut,{onClick:U=>L(U.currentTarget),size:"small",children:b.jsxDEV(zR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:398,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:394,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:393,columnNumber:11},void 0),b.jsxDEV(Nt,{title:"Print",children:b.jsxDEV(ut,{onClick:()=>window.print(),size:"small",children:b.jsxDEV(BR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:407,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:403,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:402,columnNumber:11},void 0),b.jsxDEV(Pr,{orientation:"vertical",flexItem:!0,sx:{mx:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:411,columnNumber:11},void 0),b.jsxDEV(Nt,{title:k?"Exit fullscreen":"Fullscreen (⌘⇧F)",children:b.jsxDEV(ut,{onClick:()=>S(!k),size:"small",children:k?b.jsxDEV(pE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:418,columnNumber:31},void 0):b.jsxDEV(fE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:418,columnNumber:56},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:414,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:413,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:382,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:328,columnNumber:7},void 0),i&&W&&b.jsxDEV(lE,{variant:"determinate",value:Date.now()%r/r*100,sx:{height:2}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:426,columnNumber:9},void 0),b.jsxDEV(re,{sx:{flex:1,overflow:"hidden",minHeight:0},children:b.jsxDEV(gK,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:(U,he)=>l.current=he,initialValue:n,init:ae,onEditorChange:ee},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:435,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:434,columnNumber:7},void 0),b.jsxDEV(ru,{anchorEl:B,open:!!B,onClose:()=>L(null),children:[b.jsxDEV(Dn,{onClick:()=>fe("pdf"),children:"Export as PDF"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:450,columnNumber:9},void 0),b.jsxDEV(Dn,{onClick:()=>fe("docx"),children:"Export as Word"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:453,columnNumber:9},void 0),b.jsxDEV(Dn,{onClick:()=>fe("html"),children:"Export as HTML"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:456,columnNumber:9},void 0),b.jsxDEV(Dn,{onClick:()=>fe("txt"),children:"Export as Text"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:459,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:445,columnNumber:7},void 0),b.jsxDEV(NR,{open:R,autoHideDuration:3e3,onClose:()=>V(!1),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:b.jsxDEV(Aa,{onClose:()=>V(!1),severity:"success",variant:"filled",children:"Document saved successfully!"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:471,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:465,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/editor/ProfessionalRichEditor.tsx",lineNumber:309,columnNumber:5},void 0)},uO=({children:n})=>{const e=We(s=>s.user),t=(e==null?void 0:e.id)==="00000000-0000-0000-0000-000000000000",i=async s=>(console.log("Saving document:",s.substring(0,100)+"..."),await new Promise(a=>setTimeout(a,1e3)),Promise.resolve()),r=s=>{};return b.jsxDEV(re,{sx:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",backgroundColor:"#ffffff",color:"#1a1a1a"},"data-test":"center-panel",children:t?b.jsxDEV(jT,{initialContent:"<h1>Welcome to Clarity Hub</h1><p>Start creating your professional legal documents here. Use the AI Assistant tab on the right to get personalized help with your case analysis.</p>",onSave:i,onChange:r,autoSave:!0,autoSaveInterval:3e4,height:"100%"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/CenterPanelWrapper.tsx",lineNumber:40,columnNumber:9},void 0):n||b.jsxDEV(jT,{initialContent:"<h1>Welcome to Clarity Hub</h1><p>Start creating your professional legal documents here. Use the AI Assistant tab on the right to get personalized help with your case analysis.</p>",onSave:i,onChange:r,autoSave:!0,autoSaveInterval:3e4,height:"100%"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/CenterPanelWrapper.tsx",lineNumber:50,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/CenterPanelWrapper.tsx",lineNumber:27,columnNumber:5},void 0)},Cr=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),DD=[.001,0,0,.001,0,0],Xk=1.35,ks={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Gl={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},dO="pdfjs_internal_editor_",Ct={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101,COMMENT:102},Zt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},yK={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},or={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},r0={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ui={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Zh={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Zx={ERRORS:0,WARNINGS:1,INFOS:5},ex={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Lv={moveTo:0,lineTo:1,curveTo:2,closePath:3},vK={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let ew=Zx.WARNINGS;function xK(n){Number.isInteger(n)&&(ew=n)}function wK(){return ew}function tw(n){ew>=Zx.INFOS&&console.log(`Info: ${n}`)}function At(n){ew>=Zx.WARNINGS&&console.log(`Warning: ${n}`)}function Sn(n){throw new Error(n)}function fi(n,e){n||Sn(e)}function kK(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function hO(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const r=n.match(/\./g);(r==null?void 0:r.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=_K(n)}catch{}}const i=e?URL.parse(n,e):URL.parse(n);return kK(i)?i:null}function pO(n,e,t=!1){const i=URL.parse(n);return i?(i.hash=e,i.href):t&&hO(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Wt(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const mh=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class OT extends mh{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Kk extends mh{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class SD extends mh{constructor(e){super(e,"InvalidPDFException")}}class tx extends mh{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}}class DK extends mh{constructor(e){super(e,"FormatError")}}class Xc extends mh{constructor(e){super(e,"AbortException")}}function fO(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Sn("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let r=0;r<e;r+=t){const s=Math.min(r+t,e),a=n.subarray(r,s);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function ky(n){typeof n!="string"&&Sn("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function SK(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function EK(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function NK(){try{return new Function(""),!0}catch{return!1}}class nr{static get isLittleEndian(){return Wt(this,"isLittleEndian",EK())}static get isEvalSupported(){return Wt(this,"isEvalSupported",NK())}static get isOffscreenCanvasSupported(){return Wt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Wt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Wt(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Wt(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Qk=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var wl,s0,ED;class gt{static makeHexColor(e,t,i){return`#${Qk[e]}${Qk[t]}${Qk[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,i=0){const r=e[i],s=e[i+1];e[i]=r*t[0]+s*t[2]+t[4],e[i+1]=r*t[1]+s*t[3]+t[5]}static applyTransformToBezier(e,t,i=0){const r=t[0],s=t[1],a=t[2],o=t[3],l=t[4],c=t[5];for(let u=0;u<6;u+=2){const p=e[i+u],m=e[i+u+1];e[i+u]=p*r+m*a+l,e[i+u+1]=p*s+m*o+c}}static applyInverseTransform(e,t){const i=e[0],r=e[1],s=t[0]*t[3]-t[1]*t[2];e[0]=(i*t[3]-r*t[2]+t[2]*t[5]-t[4]*t[3])/s,e[1]=(-i*t[1]+r*t[0]+t[4]*t[1]-t[5]*t[0])/s}static axialAlignedBoundingBox(e,t,i){const r=t[0],s=t[1],a=t[2],o=t[3],l=t[4],c=t[5],u=e[0],p=e[1],m=e[2],g=e[3];let y=r*u+l,v=y,w=r*m+l,k=w,S=o*p+c,E=S,P=o*g+c,A=P;if(s!==0||a!==0){const N=s*u,R=s*m,V=a*p,B=a*g;y+=V,k+=V,w+=B,v+=B,S+=N,A+=N,P+=R,E+=R}i[0]=Math.min(i[0],y,w,v,k),i[1]=Math.min(i[1],S,P,E,A),i[2]=Math.max(i[2],y,w,v,k),i[3]=Math.max(i[3],S,P,E,A)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const i=e[0],r=e[1],s=e[2],a=e[3],o=i**2+r**2,l=i*s+r*a,c=s**2+a**2,u=(o+c)/2,p=Math.sqrt(u**2-(o*c-l**2));t[0]=Math.sqrt(u+p||1),t[1]=Math.sqrt(u-p||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>r)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>a?null:[i,s,r,a]}static pointBoundingBox(e,t,i){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}static rectBoundingBox(e,t,i,r,s){s[0]=Math.min(s[0],e,i),s[1]=Math.min(s[1],t,r),s[2]=Math.max(s[2],e,i),s[3]=Math.max(s[3],t,r)}static bezierBoundingBox(e,t,i,r,s,a,o,l,c){c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l),j(this,wl,ED).call(this,e,i,s,o,t,r,a,l,3*(-e+3*(i-s)+o),6*(e-2*i+s),3*(i-e),c),j(this,wl,ED).call(this,e,i,s,o,t,r,a,l,3*(-t+3*(r-a)+l),6*(t-2*r+a),3*(r-t),c)}}wl=new WeakSet,s0=function(e,t,i,r,s,a,o,l,c,u){if(c<=0||c>=1)return;const p=1-c,m=c*c,g=m*c,y=p*(p*(p*e+3*c*t)+3*m*i)+g*r,v=p*(p*(p*s+3*c*a)+3*m*o)+g*l;u[0]=Math.min(u[0],y),u[1]=Math.min(u[1],v),u[2]=Math.max(u[2],y),u[3]=Math.max(u[3],v)},ED=function(e,t,i,r,s,a,o,l,c,u,p,m){if(Math.abs(c)<1e-12){Math.abs(u)>=1e-12&&j(this,wl,s0).call(this,e,t,i,r,s,a,o,l,-p/u,m);return}const g=u**2-4*p*c;if(g<0)return;const y=Math.sqrt(g),v=2*c;j(this,wl,s0).call(this,e,t,i,r,s,a,o,l,(-u+y)/v,m),j(this,wl,s0).call(this,e,t,i,r,s,a,o,l,(-u-y)/v,m)},M(gt,wl);function _K(n){return decodeURIComponent(escape(n))}let Jk=null,LT=null;function CK(n){return Jk||(Jk=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,LT=new Map([["ﬅ","ſt"]])),n.replaceAll(Jk,(e,t,i)=>t?t.normalize("NFKC"):LT.get(i))}function mO(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),fO(n)}const JE="pdfjs_internal_id_";function AK(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,r,...s]=t;if(!n(i)&&!Number.isInteger(i)||!e(r))return!1;const a=s.length;let o=!0;switch(r.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of s)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function Ar(n,e,t){return Math.min(Math.max(n,e),t)}function gO(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(fO(n))}function PK(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):ky(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const Io="http://www.w3.org/2000/svg",Ru=class Ru{};Me(Ru,"CSS",96),Me(Ru,"PDF",72),Me(Ru,"PDF_TO_CSS_UNITS",Ru.CSS/Ru.PDF);let Kc=Ru;async function Dy(n,e="text"){if(Gm(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}i(new Error(r.statusText))}},r.send(null)})}class Sy{constructor({viewBox:e,userUnit:t,scale:i,rotation:r,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=r,this.offsetX=s,this.offsetY=a,i*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let u,p,m,g;switch(r%=360,r<0&&(r+=360),r){case 180:u=-1,p=0,m=0,g=1;break;case 90:u=0,p=1,m=1,g=0;break;case 270:u=0,p=-1,m=-1,g=0;break;case 0:u=1,p=0,m=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(m=-m,g=-g);let y,v,w,k;u===0?(y=Math.abs(c-e[1])*i+s,v=Math.abs(l-e[0])*i+a,w=(e[3]-e[1])*i,k=(e[2]-e[0])*i):(y=Math.abs(l-e[0])*i+s,v=Math.abs(c-e[1])*i+a,w=(e[2]-e[0])*i,k=(e[3]-e[1])*i),this.transform=[u*i,p*i,m*i,g*i,y-u*i*l-m*i*c,v-p*i*l-g*i*c],this.width=w,this.height=k}get rawDims(){const e=this.viewBox;return Wt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:r=this.offsetY,dontFlip:s=!1}={}){return new Sy({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:s})}convertToViewportPoint(e,t){const i=[e,t];return gt.applyTransform(i,this.transform),i}convertToViewportRectangle(e){const t=[e[0],e[1]];gt.applyTransform(t,this.transform);const i=[e[2],e[3]];return gt.applyTransform(i,this.transform),[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){const i=[e,t];return gt.applyInverseTransform(i,this.transform),i}}class ZE extends mh{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function nw(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function eN(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function TK(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function IK(n,e="document.pdf"){if(typeof n!="string")return e;if(nw(n))return At('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const i=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(n);if(!i)return e;const r=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},s=/\.pdf$/i,a=i.pathname.split("/").at(-1);if(s.test(a))return r(a);if(i.searchParams.size>0){const o=Array.from(i.searchParams.values()).reverse();for(const c of o)if(s.test(c))return r(c);const l=Array.from(i.searchParams.keys()).reverse();for(const c of l)if(s.test(c))return r(c)}if(i.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(l)return r(l[0])}return e}class FT{constructor(){Me(this,"started",Object.create(null));Me(this,"times",[])}time(e){e in this.started&&At(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||At(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:r,end:s}of this.times)e.push(`${i.padEnd(t)} ${s-r}ms
`);return e.join("")}}function Gm(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function ea(n){n.preventDefault()}function hi(n){n.preventDefault(),n.stopPropagation()}function RK(n){console.log("Deprecated API usage: "+n)}var Ug;class nx{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;h(this,Ug)||_(this,Ug,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=h(this,Ug).exec(e);if(!t)return null;const i=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;let p=parseInt(t[9],10)||0;return p=p>=0&&p<=59?p:0,c==="-"?(a+=u,o+=p):c==="+"&&(a-=u,o-=p),new Date(Date.UTC(i,r,s,a,o,l))}}Ug=new WeakMap,M(nx,Ug);function MK(n,{scale:e=1,rotation:t=0}){const{width:i,height:r}=n.attributes.style,s=[0,0,parseInt(i),parseInt(r)];return new Sy({viewBox:s,userUnit:1,scale:e,rotation:t})}function iw(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(At(`Not a valid color format: "${n}"`),[0,0,0])}function jK(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,iw(i))}e.remove()}function qn(n){const{a:e,b:t,c:i,d:r,e:s,f:a}=n.getTransform();return[e,t,i,r,s,a]}function La(n){const{a:e,b:t,c:i,d:r,e:s,f:a}=n.getTransform().invertSelf();return[e,t,i,r,s,a]}function ih(n,e,t=!1,i=!0){if(e instanceof Sy){const{pageWidth:r,pageHeight:s}=e.rawDims,{style:a}=n,o=nr.isCSSRoundSupported,l=`var(--total-scale-factor) * ${r}px`,c=`var(--total-scale-factor) * ${s}px`,u=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,p=o?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=u,a.height=p):(a.width=p,a.height=u)}i&&n.setAttribute("data-main-rotation",e.rotation)}class go{constructor(){const{pixelRatio:e}=go;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,i,r,s=-1){let a=1/0,o=1/0,l=1/0;i=go.capPixels(i,s),i>0&&(a=Math.sqrt(i/(e*t))),r!==-1&&(o=r/e,l=r/t);const c=Math.min(a,o,l);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,i):i}return e}}const ND=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var rc,sc,Us,Uo,zg,jp,Op,Bg,gx,bO,er,yO,vO,ep,Ym;const Oo=class Oo{constructor(e){M(this,er);M(this,rc,null);M(this,sc,null);M(this,Us);M(this,Uo,null);M(this,zg,null);M(this,jp,null);M(this,Op,null);_(this,Us,e),h(Oo,Bg)||_(Oo,Bg,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=_(this,rc,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=h(this,Us)._uiManager._signal;e.addEventListener("contextmenu",ea,{signal:t}),e.addEventListener("pointerdown",j(Oo,gx,bO),{signal:t});const i=_(this,Uo,document.createElement("div"));i.className="buttons",e.append(i);const r=h(this,Us).toolbarPosition;if(r){const{style:s}=e,a=h(this,Us)._uiManager.direction==="ltr"?1-r[0]:r[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return h(this,rc)}hide(){var e;h(this,rc).classList.add("hidden"),(e=h(this,sc))==null||e.hideDropdown()}show(){var e,t;h(this,rc).classList.remove("hidden"),(e=h(this,zg))==null||e.shown(),(t=h(this,jp))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=h(this,Us),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",h(Oo,Bg)[e]),j(this,er,ep).call(this,i),i.addEventListener("click",r=>{t.delete()},{signal:t._signal}),h(this,Uo).append(i)}async addAltText(e){const t=await e.render();j(this,er,ep).call(this,t),h(this,Uo).append(t,h(this,er,Ym)),_(this,zg,e)}addComment(e){if(h(this,jp))return;const t=e.render();t&&(j(this,er,ep).call(this,t),h(this,Uo).prepend(t,h(this,er,Ym)),_(this,jp,e),e.toolbar=this)}addColorPicker(e){if(h(this,sc))return;_(this,sc,e);const t=e.renderButton();j(this,er,ep).call(this,t),h(this,Uo).append(t,h(this,er,Ym))}async addEditSignatureButton(e){const t=_(this,Op,await e.renderEditButton(h(this,Us)));j(this,er,ep).call(this,t),h(this,Uo).append(t,h(this,er,Ym))}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}updateEditSignatureButton(e){h(this,Op)&&(h(this,Op).title=e)}remove(){var e;h(this,rc).remove(),(e=h(this,sc))==null||e.destroy(),_(this,sc,null)}};rc=new WeakMap,sc=new WeakMap,Us=new WeakMap,Uo=new WeakMap,zg=new WeakMap,jp=new WeakMap,Op=new WeakMap,Bg=new WeakMap,gx=new WeakSet,bO=function(e){e.stopPropagation()},er=new WeakSet,yO=function(e){h(this,Us)._focusEventsAllowed=!1,hi(e)},vO=function(e){h(this,Us)._focusEventsAllowed=!0,hi(e)},ep=function(e){const t=h(this,Us)._uiManager._signal;e.addEventListener("focusin",j(this,er,yO).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",j(this,er,vO).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ea,{signal:t})},Ym=function(){const e=document.createElement("div");return e.className="divider",e},M(Oo,gx),M(Oo,Bg,null);let _D=Oo;var $g,Wu,Hu,Zc,xO,wO,kO;class OK{constructor(e){M(this,Zc);M(this,$g,null);M(this,Wu,null);M(this,Hu);_(this,Hu,e)}show(e,t,i){const[r,s]=j(this,Zc,wO).call(this,t,i),{style:a}=h(this,Wu)||_(this,Wu,j(this,Zc,xO).call(this));e.append(h(this,Wu)),a.insetInlineEnd=`${100*r}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){h(this,Wu).remove()}}$g=new WeakMap,Wu=new WeakMap,Hu=new WeakMap,Zc=new WeakSet,xO=function(){const e=_(this,Wu,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",ea,{signal:h(this,Hu)._signal});const t=_(this,$g,document.createElement("div"));return t.className="buttons",e.append(t),j(this,Zc,kO).call(this),e},wO=function(e,t){let i=0,r=0;for(const s of e){const a=s.y+s.height;if(a<i)continue;const o=s.x+(t?s.width:0);if(a>i){r=o,i=a;continue}t?o>r&&(r=o):o<r&&(r=o)}return[t?1-r:r,i]},kO=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=h(this,Hu)._signal;e.addEventListener("contextmenu",ea,{signal:i}),e.addEventListener("click",()=>{h(this,Hu).highlightSelection("floating_button")},{signal:i}),h(this,$g).append(e)};function DO(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var bx;class LK{constructor(){M(this,bx,0)}get id(){return`${dO}${Ti(this,bx)._++}`}}bx=new WeakMap;var Lp,Wg,ur,Fp,a0;const IN=class IN{constructor(){M(this,Fp);M(this,Lp,mO());M(this,Wg,0);M(this,ur,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const s=r.decode().then(()=>(i.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Wt(this,"_isSVGFittingCanvas",s)}async getFromFile(e){const{lastModified:t,name:i,size:r,type:s}=e;return j(this,Fp,a0).call(this,`${t}_${i}_${r}_${s}`,e)}async getFromUrl(e){return j(this,Fp,a0).call(this,e,e)}async getFromBlob(e,t){const i=await t;return j(this,Fp,a0).call(this,e,i)}async getFromId(e){h(this,ur)||_(this,ur,new Map);const t=h(this,ur).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){h(this,ur)||_(this,ur,new Map);let i=h(this,ur).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),i={bitmap:r.transferToImageBitmap(),id:`image_${h(this,Lp)}_${Ti(this,Wg)._++}`,refCounter:1,isSvg:!1},h(this,ur).set(e,i),h(this,ur).set(i.id,i),i}getSvgUrl(e){const t=h(this,ur).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var r;h(this,ur)||_(this,ur,new Map);const t=h(this,ur).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(i.width,i.height);s.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=s.convertToBlob()}(r=i.close)==null||r.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${h(this,Lp)}_`)}};Lp=new WeakMap,Wg=new WeakMap,ur=new WeakMap,Fp=new WeakSet,a0=async function(e,t){h(this,ur)||_(this,ur,new Map);let i=h(this,ur).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${h(this,Lp)}_${Ti(this,Wg)._++}`,refCounter:0,isSvg:!1});let r;if(typeof t=="string"?(i.url=t,r=await Dy(t,"blob")):t instanceof File?r=i.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const s=IN._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,u)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,c()},a.onload=async()=>{const p=i.svgUrl=a.result;o.src=await s?`${p}#svgView(preserveAspectRatio(none))`:p},o.onerror=a.onerror=u});a.readAsDataURL(r),await l}else i.bitmap=await createImageBitmap(r);i.refCounter=1}catch(r){At(r),i=null}return h(this,ur).set(e,i),i&&h(this,ur).set(i.id,i),i};let CD=IN;var ii,ac,Hg,Hn;class FK{constructor(e=128){M(this,ii,[]);M(this,ac,!1);M(this,Hg);M(this,Hn,-1);_(this,Hg,e)}add({cmd:e,undo:t,post:i,mustExec:r,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(r&&e(),h(this,ac))return;const l={cmd:e,undo:t,post:i,type:s};if(h(this,Hn)===-1){h(this,ii).length>0&&(h(this,ii).length=0),_(this,Hn,0),h(this,ii).push(l);return}if(a&&h(this,ii)[h(this,Hn)].type===s){o&&(l.undo=h(this,ii)[h(this,Hn)].undo),h(this,ii)[h(this,Hn)]=l;return}const c=h(this,Hn)+1;c===h(this,Hg)?h(this,ii).splice(0,1):(_(this,Hn,c),c<h(this,ii).length&&h(this,ii).splice(c)),h(this,ii).push(l)}undo(){if(h(this,Hn)===-1)return;_(this,ac,!0);const{undo:e,post:t}=h(this,ii)[h(this,Hn)];e(),t==null||t(),_(this,ac,!1),_(this,Hn,h(this,Hn)-1)}redo(){if(h(this,Hn)<h(this,ii).length-1){_(this,Hn,h(this,Hn)+1),_(this,ac,!0);const{cmd:e,post:t}=h(this,ii)[h(this,Hn)];e(),t==null||t(),_(this,ac,!1)}}hasSomethingToUndo(){return h(this,Hn)!==-1}hasSomethingToRedo(){return h(this,Hn)<h(this,ii).length-1}cleanType(e){if(h(this,Hn)!==-1){for(let t=h(this,Hn);t>=0;t--)if(h(this,ii)[t].type!==e){h(this,ii).splice(t+1,h(this,Hn)-t),_(this,Hn,t);return}h(this,ii).length=0,_(this,Hn,-1)}}destroy(){_(this,ii,null)}}ii=new WeakMap,ac=new WeakMap,Hg=new WeakMap,Hn=new WeakMap;var yx,SO;class Ey{constructor(e){M(this,yx);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=nr.platform;for(const[i,r,s={}]of e)for(const a of i){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:r,options:s}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:r,options:s}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(j(this,yx,SO).call(this,t));if(!i)return;const{callback:r,options:{bubbles:s=!1,args:a=[],checker:o=null}}=i;o&&!o(e,t)||(r.bind(e,...a,t)(),s||hi(t))}}yx=new WeakSet,SO=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const vx=class vx{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return jK(e),Wt(this,"_colors",e)}convert(e){const t=iw(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,r]of this._colors)if(r.every((s,a)=>s===t[a]))return vx._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?gt.makeHexColor(...t):e}};Me(vx,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let AD=vx;var Vp,os,ki,Hi,Up,zo,zp,zs,qu,oc,lc,Bp,Gu,qa,da,Yu,qg,Gg,$p,Yg,Ga,cc,Wp,uc,Ya,xx,dc,Xg,hc,Xu,Hp,pc,Kg,Ri,yn,Bo,fc,mc,Qg,Jg,gc,Xa,$o,Zg,eb,Bs,Ye,o0,PD,EO,NO,l0,_O,CO,AO,TD,PO,ID,RD,TO,wr,Ro,IO,RO,MD,MO,Xm,jD;const dp=class dp{constructor(e,t,i,r,s,a,o,l,c,u,p,m,g,y,v,w){M(this,Ye);M(this,Vp,new AbortController);M(this,os,null);M(this,ki,new Map);M(this,Hi,new Map);M(this,Up,null);M(this,zo,null);M(this,zp,null);M(this,zs,new FK);M(this,qu,null);M(this,oc,null);M(this,lc,null);M(this,Bp,0);M(this,Gu,new Set);M(this,qa,null);M(this,da,null);M(this,Yu,new Set);Me(this,"_editorUndoBar",null);M(this,qg,!1);M(this,Gg,!1);M(this,$p,!1);M(this,Yg,null);M(this,Ga,null);M(this,cc,null);M(this,Wp,null);M(this,uc,!1);M(this,Ya,null);M(this,xx,new LK);M(this,dc,!1);M(this,Xg,!1);M(this,hc,null);M(this,Xu,null);M(this,Hp,null);M(this,pc,null);M(this,Kg,null);M(this,Ri,Ct.NONE);M(this,yn,new Set);M(this,Bo,null);M(this,fc,null);M(this,mc,null);M(this,Qg,null);M(this,Jg,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});M(this,gc,[0,0]);M(this,Xa,null);M(this,$o,null);M(this,Zg,null);M(this,eb,null);M(this,Bs,null);const k=this._signal=h(this,Vp).signal;_(this,$o,e),_(this,Zg,t),_(this,eb,i),_(this,Up,r),_(this,qu,s),_(this,fc,a),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:k}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:k}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:k}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:k}),o._on("setpreference",this.onSetPreference.bind(this),{signal:k}),o._on("switchannotationeditorparams",S=>this.updateParams(S.type,S.value),{signal:k}),j(this,Ye,_O).call(this),j(this,Ye,TO).call(this),j(this,Ye,TD).call(this),_(this,zo,l.annotationStorage),_(this,Yg,l.filterFactory),_(this,mc,c),_(this,Wp,u||null),_(this,qg,p),_(this,Gg,m),_(this,$p,g),_(this,Kg,y||null),this.viewParameters={realScale:Kc.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=v||null,this._supportsPinchToZoom=w!==!1}static get _keyboardManager(){const e=dp.prototype,t=a=>h(a,$o).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},r=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Wt(this,"_keyboardManager",new Ey([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&h(a,$o).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&h(a,$o).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}destroy(){var e,t,i,r,s,a,o,l,c;(e=h(this,Bs))==null||e.resolve(),_(this,Bs,null),(t=h(this,Vp))==null||t.abort(),_(this,Vp,null),this._signal=null;for(const u of h(this,Hi).values())u.destroy();h(this,Hi).clear(),h(this,ki).clear(),h(this,Yu).clear(),(i=h(this,pc))==null||i.clear(),_(this,os,null),h(this,yn).clear(),h(this,zs).destroy(),(r=h(this,Up))==null||r.destroy(),(s=h(this,qu))==null||s.destroy(),(a=h(this,fc))==null||a.destroy(),(o=h(this,Ya))==null||o.hide(),_(this,Ya,null),(l=h(this,Hp))==null||l.destroy(),_(this,Hp,null),h(this,Ga)&&(clearTimeout(h(this,Ga)),_(this,Ga,null)),h(this,Xa)&&(clearTimeout(h(this,Xa)),_(this,Xa,null)),(c=this._editorUndoBar)==null||c.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return h(this,Kg)}get useNewAltTextFlow(){return h(this,Gg)}get useNewAltTextWhenAddingImage(){return h(this,$p)}get hcmFilter(){return Wt(this,"hcmFilter",h(this,mc)?h(this,Yg).addHCMFilter(h(this,mc).foreground,h(this,mc).background):"none")}get direction(){return Wt(this,"direction",getComputedStyle(h(this,$o)).direction)}get _highlightColors(){return Wt(this,"_highlightColors",h(this,Wp)?new Map(h(this,Wp).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Wt(this,"highlightColors",null);const t=new Map,i=!!h(this,mc);for(const[r,s]of e){const a=r.endsWith("_HCM");if(i&&a){t.set(r.replace("_HCM",""),s);continue}!i&&!a&&t.set(r,s)}return Wt(this,"highlightColors",t)}get highlightColorNames(){return Wt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),_(this,lc,e)}setMainHighlightColorPicker(e){_(this,Hp,e)}editAltText(e,t=!1){var i;(i=h(this,Up))==null||i.editAltText(this,e,t)}hasCommentManager(){return!!h(this,qu)}editComment(e,t){var i;(i=h(this,qu))==null||i.open(this,e,t)}getSignature(e){var t;(t=h(this,fc))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return h(this,fc)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":_(this,$p,t);break}}onPageChanging({pageNumber:e}){_(this,Bp,e-1)}focusMainContainer(){h(this,$o).focus()}findParent(e,t){for(const i of h(this,Hi).values()){const{x:r,y:s,width:a,height:o}=i.div.getBoundingClientRect();if(e>=r&&e<=r+a&&t>=s&&t<=s+o)return i}return null}disableUserSelect(e=!1){h(this,Zg).classList.toggle("noUserSelect",e)}addShouldRescale(e){h(this,Yu).add(e)}removeShouldRescale(e){h(this,Yu).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Kc.PDF_TO_CSS_UNITS;for(const i of h(this,Yu))i.onScaleChanging();(t=h(this,lc))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:a}=t,o=t.toString(),c=j(this,Ye,o0).call(this,t).closest(".textLayer"),u=this.getSelectionBoxes(c);if(!u)return;t.empty();const p=j(this,Ye,PD).call(this,c),m=h(this,Ri)===Ct.NONE,g=()=>{p==null||p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:u,anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:a,text:o}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(Ct.HIGHLIGHT,g);return}g()}addToAnnotationStorage(e){!e.isEmpty()&&h(this,zo)&&!h(this,zo).has(e.id)&&h(this,zo).setValue(e.id,e)}a11yAlert(e,t=null){const i=h(this,eb);i&&(i.setAttribute("data-l10n-id",e),t?i.setAttribute("data-l10n-args",JSON.stringify(t)):i.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,h(this,uc)&&(_(this,uc,!1),j(this,Ye,l0).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of h(this,yn))if(t.div.contains(e)){_(this,Xu,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!h(this,Xu))return;const[e,t]=h(this,Xu);_(this,Xu,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){j(this,Ye,TD).call(this),j(this,Ye,ID).call(this)}removeEditListeners(){j(this,Ye,PO).call(this),j(this,Ye,RD).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of h(this,da))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of h(this,da))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=h(this,os))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const r of h(this,yn)){const s=r.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const a of h(this,da))if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(s){At(`paste: "${s.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const r=this.currentLayer;try{const s=[];for(const l of i){const c=await r.deserialize(l);if(!c)return;s.push(c)}const a=()=>{for(const l of s)j(this,Ye,MD).call(this,l);j(this,Ye,jD).call(this,s)},o=()=>{for(const l of s)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(s){At(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),h(this,Ri)!==Ct.NONE&&!this.isEditorHandlingKeyboard&&dp._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,h(this,uc)&&(_(this,uc,!1),j(this,Ye,l0).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(j(this,Ye,CO).call(this),j(this,Ye,ID).call(this),j(this,Ye,wr).call(this,{isEditing:h(this,Ri)!==Ct.NONE,isEmpty:j(this,Ye,Xm).call(this),hasSomethingToUndo:h(this,zs).hasSomethingToUndo(),hasSomethingToRedo:h(this,zs).hasSomethingToRedo(),hasSelectedEditor:!1})):(j(this,Ye,AO).call(this),j(this,Ye,RD).call(this),j(this,Ye,wr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!h(this,da)){_(this,da,e);for(const t of h(this,da))j(this,Ye,Ro).call(this,t.defaultPropertiesToUpdate)}}getId(){return h(this,xx).id}get currentLayer(){return h(this,Hi).get(h(this,Bp))}getLayer(e){return h(this,Hi).get(e)}get currentPageIndex(){return h(this,Bp)}addLayer(e){h(this,Hi).set(e.pageIndex,e),h(this,dc)?e.enable():e.disable()}removeLayer(e){h(this,Hi).delete(e.pageIndex)}async updateMode(e,t=null,i=!1,r=!1,s=!1){var a,o,l;if(h(this,Ri)!==e&&!(h(this,Bs)&&(await h(this,Bs).promise,!h(this,Bs)))){if(_(this,Bs,Promise.withResolvers()),(a=h(this,lc))==null||a.commitOrRemove(),_(this,Ri,e),e===Ct.NONE){this.setEditingState(!1),j(this,Ye,RO).call(this),(o=this._editorUndoBar)==null||o.hide(),h(this,Bs).resolve();return}e===Ct.SIGNATURE&&await((l=h(this,fc))==null?void 0:l.loadSignatures()),this.setEditingState(!0),await j(this,Ye,IO).call(this),this.unselectAll();for(const c of h(this,Hi).values())c.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),h(this,Bs).resolve();return}for(const c of h(this,ki).values())c.annotationElementId===t||c.id===t?(this.setSelected(c),s?c.editComment():r&&c.enterInEditMode()):c.unselect();h(this,Bs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==h(this,Ri)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(h(this,da)){switch(e){case Zt.CREATE:this.currentLayer.addNewEditor(t);return;case Zt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(h(this,Qg)||_(this,Qg,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const i of h(this,yn))i.updateParams(e,t);else for(const i of h(this,da))i.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var s;for(const a of h(this,ki).values())a.editorType===e&&a.show(t);(((s=h(this,Qg))==null?void 0:s.get(Zt.HIGHLIGHT_SHOW_ALL))??!0)!==t&&j(this,Ye,Ro).call(this,[[Zt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(h(this,Xg)!==e){_(this,Xg,e);for(const t of h(this,Hi).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const i of h(this,ki).values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return h(this,ki).get(e)}addEditor(e){h(this,ki).set(e.id,e)}removeEditor(e){var t,i;e.div.contains(document.activeElement)&&(h(this,Ga)&&clearTimeout(h(this,Ga)),_(this,Ga,setTimeout(()=>{this.focusMainContainer(),_(this,Ga,null)},0))),h(this,ki).delete(e.id),e.annotationElementId&&((t=h(this,pc))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!h(this,Gu).has(e.annotationElementId))&&((i=h(this,zo))==null||i.remove(e.id))}addDeletedAnnotationElement(e){h(this,Gu).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return h(this,Gu).has(e)}removeDeletedAnnotationElement(e){h(this,Gu).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){h(this,os)!==e&&(_(this,os,e),e&&j(this,Ye,Ro).call(this,e.propertiesToUpdate))}updateUI(e){h(this,Ye,MO)===e&&j(this,Ye,Ro).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){j(this,Ye,Ro).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(h(this,yn).has(e)){h(this,yn).delete(e),e.unselect(),j(this,Ye,wr).call(this,{hasSelectedEditor:this.hasSelection});return}h(this,yn).add(e),e.select(),j(this,Ye,Ro).call(this,e.propertiesToUpdate),j(this,Ye,wr).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=h(this,lc))==null||t.commitOrRemove();for(const i of h(this,yn))i!==e&&i.unselect();h(this,yn).clear(),h(this,yn).add(e),e.select(),j(this,Ye,Ro).call(this,e.propertiesToUpdate),j(this,Ye,wr).call(this,{hasSelectedEditor:!0})}isSelected(e){return h(this,yn).has(e)}get firstSelectedEditor(){return h(this,yn).values().next().value}unselect(e){e.unselect(),h(this,yn).delete(e),j(this,Ye,wr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return h(this,yn).size!==0}get isEnterHandled(){return h(this,yn).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;h(this,zs).undo(),j(this,Ye,wr).call(this,{hasSomethingToUndo:h(this,zs).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:j(this,Ye,Xm).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){h(this,zs).redo(),j(this,Ye,wr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:h(this,zs).hasSomethingToRedo(),isEmpty:j(this,Ye,Xm).call(this)})}addCommands(e){h(this,zs).add(e),j(this,Ye,wr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:j(this,Ye,Xm).call(this)})}cleanUndoStack(e){h(this,zs).cleanType(e)}delete(){var s;this.commitOrRemove();const e=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...h(this,yn)],i=()=>{var a;(a=this._editorUndoBar)==null||a.show(r,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},r=()=>{for(const a of t)j(this,Ye,MD).call(this,a)};this.addCommands({cmd:i,undo:r,mustExec:!0})}commitOrRemove(){var e;(e=h(this,os))==null||e.commitOrRemove()}hasSomethingToControl(){return h(this,os)||this.hasSelection}selectAll(){for(const e of h(this,yn))e.commit();j(this,Ye,jD).call(this,h(this,ki).values())}unselectAll(){var e;if(!(h(this,os)&&(h(this,os).commitOrRemove(),h(this,Ri)!==Ct.NONE))&&!((e=h(this,lc))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of h(this,yn))t.unselect();h(this,yn).clear(),j(this,Ye,wr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;h(this,gc)[0]+=e,h(this,gc)[1]+=t;const[r,s]=h(this,gc),a=[...h(this,yn)],o=1e3;h(this,Xa)&&clearTimeout(h(this,Xa)),_(this,Xa,setTimeout(()=>{_(this,Xa,null),h(this,gc)[0]=h(this,gc)[1]=0,this.addCommands({cmd:()=>{for(const l of a)h(this,ki).has(l.id)&&(l.translateInPage(r,s),l.translationDone())},undo:()=>{for(const l of a)h(this,ki).has(l.id)&&(l.translateInPage(-r,-s),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),_(this,qa,new Map);for(const e of h(this,yn))h(this,qa).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!h(this,qa))return!1;this.disableUserSelect(!1);const e=h(this,qa);_(this,qa,null);let t=!1;for(const[{x:r,y:s,pageIndex:a},o]of e)o.newX=r,o.newY=s,o.newPageIndex=a,t||(t=r!==o.savedX||s!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const i=(r,s,a,o)=>{if(h(this,ki).has(r.id)){const l=h(this,Hi).get(o);l?r._setParentAndPosition(l,s,a):(r.pageIndex=o,r.x=s,r.y=a)}};return this.addCommands({cmd:()=>{for(const[r,{newX:s,newY:a,newPageIndex:o}]of e)i(r,s,a,o)},undo:()=>{for(const[r,{savedX:s,savedY:a,savedPageIndex:o}]of e)i(r,s,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(h(this,qa))for(const i of h(this,qa).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||h(this,yn).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return h(this,os)===e}getActive(){return h(this,os)}getMode(){return h(this,Ri)}get imageManager(){return Wt(this,"imageManager",new CD)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,u=t.rangeCount;c<u;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:r,width:s,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,u,p,m)=>({x:(u-r)/a,y:1-(c+p-i)/s,width:m/a,height:p/s});break;case"180":o=(c,u,p,m)=>({x:1-(c+p-i)/s,y:1-(u+m-r)/a,width:p/s,height:m/a});break;case"270":o=(c,u,p,m)=>({x:1-(u+m-r)/a,y:(c-i)/s,width:m/a,height:p/s});break;default:o=(c,u,p,m)=>({x:(c-i)/s,y:(u-r)/a,width:p/s,height:m/a});break}const l=[];for(let c=0,u=t.rangeCount;c<u;c++){const p=t.getRangeAt(c);if(!p.collapsed)for(const{x:m,y:g,width:y,height:v}of p.getClientRects())y===0||v===0||l.push(o(m,g,y,v))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(h(this,zp)||_(this,zp,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=h(this,zp))==null||t.delete(e)}renderAnnotationElement(e){var r;const t=(r=h(this,zp))==null?void 0:r.get(e.data.id);if(!t)return;const i=h(this,zo).getRawValue(t);i&&(h(this,Ri)===Ct.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}setMissingCanvas(e,t,i){var s;const r=(s=h(this,pc))==null?void 0:s.get(e);r&&(r.setCanvas(t,i),h(this,pc).delete(e))}addMissingCanvas(e,t){(h(this,pc)||_(this,pc,new Map)).set(e,t)}};Vp=new WeakMap,os=new WeakMap,ki=new WeakMap,Hi=new WeakMap,Up=new WeakMap,zo=new WeakMap,zp=new WeakMap,zs=new WeakMap,qu=new WeakMap,oc=new WeakMap,lc=new WeakMap,Bp=new WeakMap,Gu=new WeakMap,qa=new WeakMap,da=new WeakMap,Yu=new WeakMap,qg=new WeakMap,Gg=new WeakMap,$p=new WeakMap,Yg=new WeakMap,Ga=new WeakMap,cc=new WeakMap,Wp=new WeakMap,uc=new WeakMap,Ya=new WeakMap,xx=new WeakMap,dc=new WeakMap,Xg=new WeakMap,hc=new WeakMap,Xu=new WeakMap,Hp=new WeakMap,pc=new WeakMap,Kg=new WeakMap,Ri=new WeakMap,yn=new WeakMap,Bo=new WeakMap,fc=new WeakMap,mc=new WeakMap,Qg=new WeakMap,Jg=new WeakMap,gc=new WeakMap,Xa=new WeakMap,$o=new WeakMap,Zg=new WeakMap,eb=new WeakMap,Bs=new WeakMap,Ye=new WeakSet,o0=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},PD=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of h(this,Hi).values())if(i.hasTextLayer(e))return i;return null},EO=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=j(this,Ye,o0).call(this,e).closest(".textLayer"),r=this.getSelectionBoxes(i);r&&(h(this,Ya)||_(this,Ya,new OK(this)),h(this,Ya).show(i,r,this.direction==="ltr"))},NO=function(){var s,a,o;const e=document.getSelection();if(!e||e.isCollapsed){h(this,Bo)&&((s=h(this,Ya))==null||s.hide(),_(this,Bo,null),j(this,Ye,wr).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===h(this,Bo))return;const r=j(this,Ye,o0).call(this,e).closest(".textLayer");if(!r){h(this,Bo)&&((a=h(this,Ya))==null||a.hide(),_(this,Bo,null),j(this,Ye,wr).call(this,{hasSelectedText:!1}));return}if((o=h(this,Ya))==null||o.hide(),_(this,Bo,t),j(this,Ye,wr).call(this,{hasSelectedText:!0}),!(h(this,Ri)!==Ct.HIGHLIGHT&&h(this,Ri)!==Ct.NONE)&&(h(this,Ri)===Ct.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),_(this,uc,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=h(this,Ri)===Ct.HIGHLIGHT?j(this,Ye,PD).call(this,r):null;l==null||l.toggleDrawing();const c=new AbortController,u=this.combinedSignal(c),p=m=>{m.type==="pointerup"&&m.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),m.type==="pointerup"&&j(this,Ye,l0).call(this,"main_toolbar"))};window.addEventListener("pointerup",p,{signal:u}),window.addEventListener("blur",p,{signal:u})}},l0=function(e=""){h(this,Ri)===Ct.HIGHLIGHT?this.highlightSelection(e):h(this,qg)&&j(this,Ye,EO).call(this)},_O=function(){document.addEventListener("selectionchange",j(this,Ye,NO).bind(this),{signal:this._signal})},CO=function(){if(h(this,cc))return;_(this,cc,new AbortController);const e=this.combinedSignal(h(this,cc));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},AO=function(){var e;(e=h(this,cc))==null||e.abort(),_(this,cc,null)},TD=function(){if(h(this,hc))return;_(this,hc,new AbortController);const e=this.combinedSignal(h(this,hc));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},PO=function(){var e;(e=h(this,hc))==null||e.abort(),_(this,hc,null)},ID=function(){if(h(this,oc))return;_(this,oc,new AbortController);const e=this.combinedSignal(h(this,oc));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},RD=function(){var e;(e=h(this,oc))==null||e.abort(),_(this,oc,null)},TO=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},wr=function(e){Object.entries(e).some(([i,r])=>h(this,Jg)[i]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(h(this,Jg),e)}),h(this,Ri)===Ct.HIGHLIGHT&&e.hasSelectedEditor===!1&&j(this,Ye,Ro).call(this,[[Zt.HIGHLIGHT_FREE,!0]]))},Ro=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},IO=async function(){if(!h(this,dc)){_(this,dc,!0);const e=[];for(const t of h(this,Hi).values())e.push(t.enable());await Promise.all(e);for(const t of h(this,ki).values())t.enable()}},RO=function(){if(this.unselectAll(),h(this,dc)){_(this,dc,!1);for(const e of h(this,Hi).values())e.disable();for(const e of h(this,ki).values())e.disable()}},MD=function(e){const t=h(this,Hi).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},MO=function(){let e=null;for(e of h(this,yn));return e},Xm=function(){if(h(this,ki).size===0)return!0;if(h(this,ki).size===1)for(const e of h(this,ki).values())return e.isEmpty();return!1},jD=function(e){for(const t of h(this,yn))t.unselect();h(this,yn).clear();for(const t of e)t.isEmpty()||(h(this,yn).add(t),t.select());j(this,Ye,wr).call(this,{hasSelectedEditor:this.hasSelection})},Me(dp,"TRANSLATE_SMALL",1),Me(dp,"TRANSLATE_BIG",10);let rh=dp;var Mi,Ka,ha,qp,Qa,ls,Gp,Ja,Wr,Wo,Ku,Za,bc,_a,Km,c0;const kr=class kr{constructor(e){M(this,_a);M(this,Mi,null);M(this,Ka,!1);M(this,ha,null);M(this,qp,null);M(this,Qa,null);M(this,ls,null);M(this,Gp,!1);M(this,Ja,null);M(this,Wr,null);M(this,Wo,null);M(this,Ku,null);M(this,Za,!1);_(this,Wr,e),_(this,Za,e._uiManager.useNewAltTextFlow),h(kr,bc)||_(kr,bc,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){kr._l10n??(kr._l10n=e)}async render(){const e=_(this,ha,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=_(this,qp,document.createElement("span"));e.append(t),h(this,Za)?(e.classList.add("new"),e.setAttribute("data-l10n-id",h(kr,bc).missing),t.setAttribute("data-l10n-id",h(kr,bc)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=h(this,Wr)._uiManager._signal;e.addEventListener("contextmenu",ea,{signal:i}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:i});const r=s=>{s.preventDefault(),h(this,Wr)._uiManager.editAltText(h(this,Wr)),h(this,Za)&&h(this,Wr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:h(this,_a,Km)}})};return e.addEventListener("click",r,{capture:!0,signal:i}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(_(this,Gp,!0),r(s))},{signal:i}),await j(this,_a,c0).call(this),e}finish(){h(this,ha)&&(h(this,ha).focus({focusVisible:h(this,Gp)}),_(this,Gp,!1))}isEmpty(){return h(this,Za)?h(this,Mi)===null:!h(this,Mi)&&!h(this,Ka)}hasData(){return h(this,Za)?h(this,Mi)!==null||!!h(this,Wo):this.isEmpty()}get guessedText(){return h(this,Wo)}async setGuessedText(e){h(this,Mi)===null&&(_(this,Wo,e),_(this,Ku,await kr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),j(this,_a,c0).call(this))}toggleAltTextBadge(e=!1){var t;if(!h(this,Za)||h(this,Mi)){(t=h(this,Ja))==null||t.remove(),_(this,Ja,null);return}if(!h(this,Ja)){const i=_(this,Ja,document.createElement("div"));i.className="noAltTextBadge",h(this,Wr).div.append(i)}h(this,Ja).classList.toggle("hidden",!e)}serialize(e){let t=h(this,Mi);return!e&&h(this,Wo)===t&&(t=h(this,Ku)),{altText:t,decorative:h(this,Ka),guessedText:h(this,Wo),textWithDisclaimer:h(this,Ku)}}get data(){return{altText:h(this,Mi),decorative:h(this,Ka)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:r,cancel:s=!1}){i&&(_(this,Wo,i),_(this,Ku,r)),!(h(this,Mi)===e&&h(this,Ka)===t)&&(s||(_(this,Mi,e),_(this,Ka,t)),j(this,_a,c0).call(this))}toggle(e=!1){h(this,ha)&&(!e&&h(this,ls)&&(clearTimeout(h(this,ls)),_(this,ls,null)),h(this,ha).disabled=!e)}shown(){h(this,Wr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:h(this,_a,Km)}})}destroy(){var e,t;(e=h(this,ha))==null||e.remove(),_(this,ha,null),_(this,qp,null),_(this,Qa,null),(t=h(this,Ja))==null||t.remove(),_(this,Ja,null)}};Mi=new WeakMap,Ka=new WeakMap,ha=new WeakMap,qp=new WeakMap,Qa=new WeakMap,ls=new WeakMap,Gp=new WeakMap,Ja=new WeakMap,Wr=new WeakMap,Wo=new WeakMap,Ku=new WeakMap,Za=new WeakMap,bc=new WeakMap,_a=new WeakSet,Km=function(){return h(this,Mi)&&"added"||h(this,Mi)===null&&this.guessedText&&"review"||"missing"},c0=async function(){var r,s,a;const e=h(this,ha);if(!e)return;if(h(this,Za)){if(e.classList.toggle("done",!!h(this,Mi)),e.setAttribute("data-l10n-id",h(kr,bc)[h(this,_a,Km)]),(r=h(this,qp))==null||r.setAttribute("data-l10n-id",h(kr,bc)[`${h(this,_a,Km)}-label`]),!h(this,Mi)){(s=h(this,Qa))==null||s.remove();return}}else{if(!h(this,Mi)&&!h(this,Ka)){e.classList.remove("done"),(a=h(this,Qa))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=h(this,Qa);if(!t){_(this,Qa,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${h(this,Wr).id}`;const o=100,l=h(this,Wr)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(h(this,ls)),_(this,ls,null)},{once:!0}),e.addEventListener("mouseenter",()=>{_(this,ls,setTimeout(()=>{_(this,ls,null),h(this,Qa).classList.add("show"),h(this,Wr)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var c;h(this,ls)&&(clearTimeout(h(this,ls)),_(this,ls,null)),(c=h(this,Qa))==null||c.classList.remove("show")},{signal:l})}h(this,Ka)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=h(this,Mi)),t.parentNode||e.append(t);const i=h(this,Wr).getElementForAltText();i==null||i.setAttribute("aria-describedby",t.id)},M(kr,bc,null),Me(kr,"_l10n",null);let ix=kr;var eo,Qu,pa,tb,Ho,Yp,yc;class Fv{constructor(e){M(this,eo,null);M(this,Qu,!1);M(this,pa,null);M(this,tb,null);M(this,Ho,null);M(this,Yp,null);M(this,yc,!1);_(this,pa,e),this.toolbar=null}render(){if(!h(this,pa)._uiManager.hasCommentManager())return null;const e=_(this,eo,document.createElement("button"));e.className="comment",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const t=h(this,pa)._uiManager._signal;e.addEventListener("contextmenu",ea,{signal:t}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:t});const i=r=>{r.preventDefault(),this.edit()};return e.addEventListener("click",i,{capture:!0,signal:t}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(_(this,Qu,!0),i(r))},{signal:t}),e}edit(){const{bottom:e,left:t,right:i}=h(this,pa).getClientDimensions(),r={top:e};h(this,pa)._uiManager.direction==="ltr"?r.right=i:r.left=t,h(this,pa)._uiManager.editComment(h(this,pa),r)}finish(){h(this,eo)&&(h(this,eo).focus({focusVisible:h(this,Qu)}),_(this,Qu,!1))}isDeleted(){return h(this,yc)||h(this,Ho)===""}hasBeenEdited(){return this.isDeleted()||h(this,Ho)!==h(this,tb)}serialize(){return this.data}get data(){return{text:h(this,Ho),date:h(this,Yp),deleted:h(this,yc)}}set data(e){if(e===null){_(this,Ho,""),_(this,yc,!0);return}_(this,Ho,e),_(this,Yp,new Date),_(this,yc,!1)}setInitialText(e){_(this,tb,e),this.data=e}toggle(e=!1){h(this,eo)&&(h(this,eo).disabled=!e)}shown(){}destroy(){var e;(e=h(this,eo))==null||e.remove(),_(this,eo,null),_(this,Ho,""),_(this,Yp,null),_(this,pa,null),_(this,Qu,!1),_(this,yc,!1)}}eo=new WeakMap,Qu=new WeakMap,pa=new WeakMap,tb=new WeakMap,Ho=new WeakMap,Yp=new WeakMap,yc=new WeakMap;var Xp,Ju,nb,ib,rb,sb,ab,qo,Zu,Go,ed,Yo,eu,jO,OO,LO;const RN=class RN{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:r=null,onPinching:s=null,onPinchEnd:a=null,signal:o}){M(this,eu);M(this,Xp);M(this,Ju,!1);M(this,nb,null);M(this,ib);M(this,rb);M(this,sb);M(this,ab);M(this,qo,null);M(this,Zu);M(this,Go,null);M(this,ed);M(this,Yo,null);_(this,Xp,e),_(this,nb,i),_(this,ib,t),_(this,rb,r),_(this,sb,s),_(this,ab,a),_(this,ed,new AbortController),_(this,Zu,AbortSignal.any([o,h(this,ed).signal])),e.addEventListener("touchstart",j(this,eu,jO).bind(this),{passive:!1,signal:h(this,Zu)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/go.pixelRatio}destroy(){var e,t;(e=h(this,ed))==null||e.abort(),_(this,ed,null),(t=h(this,qo))==null||t.abort(),_(this,qo,null)}};Xp=new WeakMap,Ju=new WeakMap,nb=new WeakMap,ib=new WeakMap,rb=new WeakMap,sb=new WeakMap,ab=new WeakMap,qo=new WeakMap,Zu=new WeakMap,Go=new WeakMap,ed=new WeakMap,Yo=new WeakMap,eu=new WeakSet,jO=function(e){var r,s,a;if((r=h(this,ib))!=null&&r.call(this))return;if(e.touches.length===1){if(h(this,qo))return;const o=_(this,qo,new AbortController),l=AbortSignal.any([h(this,Zu),o.signal]),c=h(this,Xp),u={capture:!0,signal:l,passive:!1},p=m=>{var g;m.pointerType==="touch"&&((g=h(this,qo))==null||g.abort(),_(this,qo,null))};c.addEventListener("pointerdown",m=>{m.pointerType==="touch"&&(hi(m),p(m))},u),c.addEventListener("pointerup",p,u),c.addEventListener("pointercancel",p,u);return}if(!h(this,Yo)){_(this,Yo,new AbortController);const o=AbortSignal.any([h(this,Zu),h(this,Yo).signal]),l=h(this,Xp),c={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",j(this,eu,OO).bind(this),c);const u=j(this,eu,LO).bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",hi,c),l.addEventListener("pointermove",hi,c),l.addEventListener("pointercancel",hi,c),l.addEventListener("pointerup",hi,c),(s=h(this,rb))==null||s.call(this)}if(hi(e),e.touches.length!==2||(a=h(this,nb))!=null&&a.call(this)){_(this,Go,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),_(this,Go,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},OO=function(e){var P;if(!h(this,Go)||e.touches.length!==2)return;hi(e);let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:r,screenY:s}=t,{screenX:a,screenY:o}=i,l=h(this,Go),{touch0X:c,touch0Y:u,touch1X:p,touch1Y:m}=l,g=p-c,y=m-u,v=a-r,w=o-s,k=Math.hypot(v,w)||1,S=Math.hypot(g,y)||1;if(!h(this,Ju)&&Math.abs(S-k)<=RN.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=r,l.touch0Y=s,l.touch1X=a,l.touch1Y=o,!h(this,Ju)){_(this,Ju,!0);return}const E=[(r+a)/2,(s+o)/2];(P=h(this,sb))==null||P.call(this,E,S,k)},LO=function(e){var t;e.touches.length>=2||(h(this,Yo)&&(h(this,Yo).abort(),_(this,Yo,null),(t=h(this,ab))==null||t.call(this)),h(this,Go)&&(hi(e),_(this,Go,null),_(this,Ju,!1)))};let rx=RN;var td,fa,Vn,qi,Kp,vc,ob,nd,Gi,id,Xo,xc,lb,rd,cs,cb,sd,Ko,to,Qp,Jp,$s,ad,ub,wx,xt,OD,db,LD,u0,FO,VO,FD,d0,VD,UO,zO,BO,UD,$O,zD,WO,HO,qO,BD,Qm;const Lt=class Lt{constructor(e){M(this,xt);M(this,td,null);M(this,fa,null);M(this,Vn,null);M(this,qi,null);M(this,Kp,!1);M(this,vc,null);M(this,ob,"");M(this,nd,!1);M(this,Gi,null);M(this,id,null);M(this,Xo,null);M(this,xc,null);M(this,lb,"");M(this,rd,!1);M(this,cs,null);M(this,cb,!1);M(this,sd,!1);M(this,Ko,!1);M(this,to,null);M(this,Qp,0);M(this,Jp,0);M(this,$s,null);M(this,ad,null);Me(this,"isSelected",!1);Me(this,"_isCopy",!1);Me(this,"_editToolbar",null);Me(this,"_initialOptions",Object.create(null));Me(this,"_initialData",null);Me(this,"_isVisible",!0);Me(this,"_uiManager",null);Me(this,"_focusEventsAllowed",!0);M(this,ub,!1);M(this,wx,Lt._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:r,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[s,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Lt.prototype._resizeWithKeyboard,t=rh.TRANSLATE_SMALL,i=rh.TRANSLATE_BIG;return Wt(this,"_resizerKeyboardManager",new Ey([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],Lt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Wt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new VK({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Lt._l10n??(Lt._l10n=e),Lt._l10nResizer||(Lt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Lt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Lt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Sn("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return h(this,ub)}set _isDraggable(e){var t;_(this,ub,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=h(this,wx)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):j(this,xt,Qm).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(h(this,rd)?_(this,rd,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,r){const[s,a]=this.parentDimensions;[i,r]=this.screenToPageTranslation(i,r),this.x=(e+i)/s,this.y=(t+r)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[i,r]=this.parentDimensions;this.setAt(e*i,t*r,this.width*i,this.height*r),this._onTranslated()}translate(e,t){j(this,xt,OD).call(this,this.parentDimensions,e,t)}translateInPage(e,t){h(this,cs)||_(this,cs,[this.x,this.y,this.width,this.height]),j(this,xt,OD).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){h(this,cs)||_(this,cs,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[r,s]}=this;if(this.x+=e/r,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:u}=i;u.left=`${(100*a).toFixed(2)}%`,u.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!h(this,cs)&&(h(this,cs)[0]!==this.x||h(this,cs)[1]!==this.y)}get _hasBeenResized(){return!!h(this,cs)&&(h(this,cs)[2]!==this.width||h(this,cs)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=Lt,r=i/e,s=i/t;switch(this.rotation){case 90:return[-r,s];case 180:return[r,s];case 270:return[r,-s];default:return[-r,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,r]}=this;let{x:s,y:a,width:o,height:l}=this;if(o*=i,l*=r,s*=i,a*=r,this._mustFixPosition)switch(e){case 0:s=Ar(s,0,i-o),a=Ar(a,0,r-l);break;case 90:s=Ar(s,0,i-l),a=Ar(a,o,r);break;case 180:s=Ar(s,o,i),a=Ar(a,l,r);break;case 270:s=Ar(s,l,i),a=Ar(a,0,r-o);break}this.x=s/=i,this.y=a/=r;const[c,u]=this.getBaseTranslation();s+=c,a+=u,t.left=`${(100*s).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return j(i=Lt,db,LD).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return j(i=Lt,db,LD).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,r]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*e/i).toFixed(2)}%`,h(this,nd)||(s.height=`${(100*t/r).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,r=i.endsWith("%"),s=!h(this,nd)&&t.endsWith("%");if(r&&s)return;const[a,o]=this.parentDimensions;r||(e.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!h(this,nd)&&!s&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=h(this,Vn))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||h(this,sd))return this._editToolbar;this._editToolbar=new _D(this),this.div.append(this._editToolbar.render()),this._editToolbar.addButton("comment",this.addCommentButton());const{toolbarButtons:e}=this;if(e)for(const[t,i]of e)await this._editToolbar.addButton(t,i);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=h(this,Vn))==null||e.destroy())}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return h(this,Vn)||(ix.initialize(Lt._l10n),_(this,Vn,new ix(this)),h(this,td)&&(h(this,Vn).data=h(this,td),_(this,td,null))),h(this,Vn)}get altTextData(){var e;return(e=h(this,Vn))==null?void 0:e.data}set altTextData(e){h(this,Vn)&&(h(this,Vn).data=e)}get guessedAltText(){var e;return(e=h(this,Vn))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=h(this,Vn))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=h(this,Vn))==null?void 0:t.serialize(e)}hasAltText(){return!!h(this,Vn)&&!h(this,Vn).isEmpty()}hasAltTextData(){var e;return((e=h(this,Vn))==null?void 0:e.hasData())??!1}addCommentButton(){return h(this,qi)?h(this,qi):_(this,qi,new Fv(this))}get commentColor(){return null}get comment(){const e=h(this,qi);return{text:e.data.text,date:e.data.date,deleted:e.isDeleted(),color:this.commentColor}}set comment(e){h(this,qi)||_(this,qi,new Fv(this)),h(this,qi).data=e}setCommentData(e){h(this,qi)||_(this,qi,new Fv(this)),h(this,qi).setInitialText(e)}get hasEditedComment(){var e;return(e=h(this,qi))==null?void 0:e.hasBeenEdited()}async editComment(){h(this,qi)||_(this,qi,new Fv(this)),h(this,qi).edit()}addComment(e){this.hasEditedComment&&(e.popup={contents:this.comment.text,deleted:this.comment.deleted})}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=h(this,Kp)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),j(this,xt,zD).call(this);const[t,i]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*i/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/i).toFixed(2)}%`);const[r,s]=this.getInitialTranslation();return this.translate(r,s),DO(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(h(this,ad)||_(this,ad,new rx({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:j(this,xt,UO).bind(this),onPinching:j(this,xt,zO).bind(this),onPinchEnd:j(this,xt,BO).bind(this),signal:this._uiManager._signal}))),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=nr.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(_(this,rd,!0),this._isDraggable){j(this,xt,$O).call(this,e);return}j(this,xt,UD).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){h(this,to)&&clearTimeout(h(this,to)),_(this,to,setTimeout(()=>{var e;_(this,to,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const r=this.parentScale,[s,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/r,u=t/r,p=this.x*s,m=this.y*a,g=this.width*s,y=this.height*a;switch(i){case 0:return[p+c+o,a-m-u-y+l,p+c+g+o,a-m-u+l];case 90:return[p+u+o,a-m+c+l,p+u+y+o,a-m+c+g+l];case 180:return[p-c-g+o,a-m+u+l,p-c+o,a-m+u+y+l];case 270:return[p-u-y+o,a-m-c-g+l,p-u+o,a-m-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,r,s,a]=e,o=s-i,l=a-r;switch(this.rotation){case 0:return[i,t-a,o,l];case 90:return[i,t-r,l,o];case 180:return[s,t-r,o,l];case 270:return[s,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),_(this,sd,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),_(this,sd,!1),!0):!1}isInEditMode(){return h(this,sd)}shouldGetKeyboardEvents(){return h(this,Ko)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:r}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return t<a&&r>0&&e<s&&i>0}rebuild(){j(this,xt,zD).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Sn("An editor must be serializable")}static async deserialize(e,t,i){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i,annotationElementId:e.annotationElementId});r.rotation=e.rotation,_(r,td,e.accessibilityData),r._isCopy=e.isCopy||!1;const[s,a]=r.pageDimensions,[o,l,c,u]=r.getRectInCurrentCoords(e.rect,a);return r.x=o/s,r.y=l/a,r.width=c/s,r.height=u/a,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=h(this,xc))==null||e.abort(),_(this,xc,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),h(this,to)&&(clearTimeout(h(this,to)),_(this,to,null)),j(this,xt,Qm).call(this),this.removeEditToolbar(),h(this,$s)){for(const i of h(this,$s).values())clearTimeout(i);_(this,$s,null)}this.parent=null,(t=h(this,ad))==null||t.destroy(),_(this,ad,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(j(this,xt,FO).call(this),h(this,Gi).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),_(this,Xo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=h(this,Gi).children;if(!h(this,fa)){_(this,fa,Array.from(t));const a=j(this,xt,WO).bind(this),o=j(this,xt,HO).bind(this),l=this._uiManager._signal;for(const c of h(this,fa)){const u=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",j(this,xt,qO).bind(this,u),{signal:l}),c.setAttribute("data-l10n-id",Lt._l10nResizer[u])}}const i=h(this,fa)[0];let r=0;for(const a of t){if(a===i)break;r++}const s=(360-this.rotation+this.parentRotation)%360/90*(h(this,fa).length/4);if(s!==r){if(s<r)for(let o=0;o<r-s;o++)h(this,Gi).append(h(this,Gi).firstChild);else if(s>r)for(let o=0;o<s-r;o++)h(this,Gi).firstChild.before(h(this,Gi).lastChild);let a=0;for(const o of t){const c=h(this,fa)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Lt._l10nResizer[c])}}j(this,xt,BD).call(this,0),_(this,Ko,!0),h(this,Gi).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){h(this,Ko)&&j(this,xt,VD).call(this,h(this,lb),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){j(this,xt,Qm).call(this),this.div.focus()}select(){var e,t,i;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var r,s;(r=this.div)!=null&&r.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(t=this._editToolbar)==null||t.show(),(i=h(this,Vn))==null||i.toggleAltTextBadge(!1)}}unselect(){var e,t,i,r,s;this.isSelected&&(this.isSelected=!1,(e=h(this,Gi))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(r=this._editToolbar)==null||r.hide(),(s=h(this,Vn))==null||s.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return h(this,cb)}set isEditing(e){_(this,cb,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){_(this,nd,!0);const i=e/t,{style:r}=this.div;r.aspectRatio=i,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){h(this,$s)||_(this,$s,new Map);const{action:i}=e;let r=h(this,$s).get(i);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),h(this,$s).delete(i),h(this,$s).size===0&&_(this,$s,null)},Lt._telemetryTimeout),h(this,$s).set(i,r);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),_(this,Kp,!1)}disable(){this.div&&(this.div.tabIndex=-1),_(this,Kp,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};td=new WeakMap,fa=new WeakMap,Vn=new WeakMap,qi=new WeakMap,Kp=new WeakMap,vc=new WeakMap,ob=new WeakMap,nd=new WeakMap,Gi=new WeakMap,id=new WeakMap,Xo=new WeakMap,xc=new WeakMap,lb=new WeakMap,rd=new WeakMap,cs=new WeakMap,cb=new WeakMap,sd=new WeakMap,Ko=new WeakMap,to=new WeakMap,Qp=new WeakMap,Jp=new WeakMap,$s=new WeakMap,ad=new WeakMap,ub=new WeakMap,wx=new WeakMap,xt=new WeakSet,OD=function([e,t],i,r){[i,r]=this.screenToPageTranslation(i,r),this.x+=i/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},db=new WeakSet,LD=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},u0=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},FO=function(){if(h(this,Gi))return;_(this,Gi,document.createElement("div")),h(this,Gi).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const r=document.createElement("div");h(this,Gi).append(r),r.classList.add("resizer",i),r.setAttribute("data-resizer-name",i),r.addEventListener("pointerdown",j(this,xt,VO).bind(this,i),{signal:t}),r.addEventListener("contextmenu",ea,{signal:t}),r.tabIndex=-1}this.div.prepend(h(this,Gi))},VO=function(e,t){var u;t.preventDefault();const{isMac:i}=nr.platform;if(t.button!==0||t.ctrlKey&&i)return;(u=h(this,Vn))==null||u.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,_(this,id,[t.screenX,t.screenY]);const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",j(this,xt,VD).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",hi,{passive:!1,signal:a}),window.addEventListener("contextmenu",ea,{signal:a}),_(this,Xo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var p;s.abort(),this.parent.togglePointerEvents(!0),(p=h(this,Vn))==null||p.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=o,this.div.style.cursor=l,j(this,xt,d0).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})},FD=function(e,t,i,r){this.width=i,this.height=r,this.x=e,this.y=t;const[s,a]=this.parentDimensions;this.setDims(s*i,a*r),this.fixAndSetPosition(),this._onResized()},d0=function(){if(!h(this,Xo))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:r}=h(this,Xo);_(this,Xo,null);const s=this.x,a=this.y,o=this.width,l=this.height;s===e&&a===t&&o===i&&l===r||this.addCommands({cmd:j(this,xt,FD).bind(this,s,a,o,l),undo:j(this,xt,FD).bind(this,e,t,i,r),mustExec:!0})},VD=function(e,t){const[i,r]=this.parentDimensions,s=this.x,a=this.y,o=this.width,l=this.height,c=Lt.MIN_SIZE/i,u=Lt.MIN_SIZE/r,p=j(this,xt,u0).call(this,this.rotation),m=(J,ee)=>[p[0]*J+p[2]*ee,p[1]*J+p[3]*ee],g=j(this,xt,u0).call(this,360-this.rotation),y=(J,ee)=>[g[0]*J+g[2]*ee,g[1]*J+g[3]*ee];let v,w,k=!1,S=!1;switch(e){case"topLeft":k=!0,v=(J,ee)=>[0,0],w=(J,ee)=>[J,ee];break;case"topMiddle":v=(J,ee)=>[J/2,0],w=(J,ee)=>[J/2,ee];break;case"topRight":k=!0,v=(J,ee)=>[J,0],w=(J,ee)=>[0,ee];break;case"middleRight":S=!0,v=(J,ee)=>[J,ee/2],w=(J,ee)=>[0,ee/2];break;case"bottomRight":k=!0,v=(J,ee)=>[J,ee],w=(J,ee)=>[0,0];break;case"bottomMiddle":v=(J,ee)=>[J/2,ee],w=(J,ee)=>[J/2,0];break;case"bottomLeft":k=!0,v=(J,ee)=>[0,ee],w=(J,ee)=>[J,0];break;case"middleLeft":S=!0,v=(J,ee)=>[0,ee/2],w=(J,ee)=>[J,ee/2];break}const E=v(o,l),P=w(o,l);let A=m(...P);const N=Lt._round(s+A[0]),R=Lt._round(a+A[1]);let V=1,B=1,L,W;if(t.fromKeyboard)({deltaX:L,deltaY:W}=t);else{const{screenX:J,screenY:ee}=t,[fe,ae]=h(this,id);[L,W]=this.screenToPageTranslation(J-fe,ee-ae),h(this,id)[0]=J,h(this,id)[1]=ee}if([L,W]=y(L/i,W/r),k){const J=Math.hypot(o,l);V=B=Math.max(Math.min(Math.hypot(P[0]-E[0]-L,P[1]-E[1]-W)/J,1/o,1/l),c/o,u/l)}else S?V=Ar(Math.abs(P[0]-E[0]-L),c,1)/o:B=Ar(Math.abs(P[1]-E[1]-W),u,1)/l;const q=Lt._round(o*V),X=Lt._round(l*B);A=m(...w(q,X));const G=N-A[0],K=R-A[1];h(this,cs)||_(this,cs,[this.x,this.y,this.width,this.height]),this.width=q,this.height=X,this.x=G,this.y=K,this.setDims(i*q,r*X),this.fixAndSetPosition(),this._onResizing()},UO=function(){var e;_(this,Xo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=h(this,Vn))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},zO=function(e,t,i){let s=.7*(i/t)+1-.7;if(s===1)return;const a=j(this,xt,u0).call(this,this.rotation),o=(N,R)=>[a[0]*N+a[2]*R,a[1]*N+a[3]*R],[l,c]=this.parentDimensions,u=this.x,p=this.y,m=this.width,g=this.height,y=Lt.MIN_SIZE/l,v=Lt.MIN_SIZE/c;s=Math.max(Math.min(s,1/m,1/g),y/m,v/g);const w=Lt._round(m*s),k=Lt._round(g*s);if(w===m&&k===g)return;h(this,cs)||_(this,cs,[u,p,m,g]);const S=o(m/2,g/2),E=Lt._round(u+S[0]),P=Lt._round(p+S[1]),A=o(w/2,k/2);this.x=E-A[0],this.y=P-A[1],this.width=w,this.height=k,this.setDims(l*w,c*k),this.fixAndSetPosition(),this._onResizing()},BO=function(){var e;(e=h(this,Vn))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),j(this,xt,d0).call(this)},UD=function(e){const{isMac:t}=nr.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},$O=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const r=new AbortController,s=this._uiManager.combinedSignal(r),a={capture:!0,passive:!1,signal:s},o=c=>{r.abort(),_(this,vc,null),_(this,rd,!1),this._uiManager.endDragSession()||j(this,xt,UD).call(this,c),i&&this._onStopDragging()};t&&(_(this,Qp,e.clientX),_(this,Jp,e.clientY),_(this,vc,e.pointerId),_(this,ob,e.pointerType),window.addEventListener("pointermove",c=>{i||(i=!0,this._onStartDragging());const{clientX:u,clientY:p,pointerId:m}=c;if(m!==h(this,vc)){hi(c);return}const[g,y]=this.screenToPageTranslation(u-h(this,Qp),p-h(this,Jp));_(this,Qp,u),_(this,Jp,p),this._uiManager.dragSelectedEditors(g,y)},a),window.addEventListener("touchmove",hi,a),window.addEventListener("pointerdown",c=>{c.pointerType===h(this,ob)&&(h(this,ad)||c.isPrimary)&&o(c),hi(c)},a));const l=c=>{if(!h(this,vc)||h(this,vc)===c.pointerId){o(c);return}hi(c)};window.addEventListener("pointerup",l,{signal:s}),window.addEventListener("blur",l,{signal:s})},zD=function(){if(h(this,xc)||!this.div)return;_(this,xc,new AbortController);const e=this._uiManager.combinedSignal(h(this,xc));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},WO=function(e){Lt._resizerKeyboardManager.exec(this,e)},HO=function(e){var t;h(this,Ko)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==h(this,Gi)&&j(this,xt,Qm).call(this)},qO=function(e){_(this,lb,h(this,Ko)?e:"")},BD=function(e){if(h(this,fa))for(const t of h(this,fa))t.tabIndex=e},Qm=function(){_(this,Ko,!1),j(this,xt,BD).call(this,-1),j(this,xt,d0).call(this)},M(Lt,db),Me(Lt,"_l10n",null),Me(Lt,"_l10nResizer",null),Me(Lt,"_borderLineWidth",-1),Me(Lt,"_colorManager",new AD),Me(Lt,"_zIndex",1),Me(Lt,"_telemetryTimeout",1e3);let In=Lt;class VK extends In{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const VT=3285377520,Fs=4294901760,Fa=65535;class GO{constructor(e){this.h1=e?e&4294967295:VT,this.h2=e?e&4294967295:VT}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let v=0,w=e.length;v<w;v++){const k=e.charCodeAt(v);k<=255?t[i++]=k:(t[i++]=k>>>8,t[i++]=k&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=i>>2,s=i-r*4,a=new Uint32Array(t.buffer,0,r);let o=0,l=0,c=this.h1,u=this.h2;const p=3432918353,m=461845907,g=p&Fa,y=m&Fa;for(let v=0;v<r;v++)v&1?(o=a[v],o=o*p&Fs|o*g&Fa,o=o<<15|o>>>17,o=o*m&Fs|o*y&Fa,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[v],l=l*p&Fs|l*g&Fa,l=l<<15|l>>>17,l=l*m&Fs|l*y&Fa,u^=l,u=u<<13|u>>>19,u=u*5+3864292196);switch(o=0,s){case 3:o^=t[r*4+2]<<16;case 2:o^=t[r*4+1]<<8;case 1:o^=t[r*4],o=o*p&Fs|o*g&Fa,o=o<<15|o>>>17,o=o*m&Fs|o*y&Fa,r&1?c^=o:u^=o}this.h1=c,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Fs|e*36045&Fa,t=t*4283543511&Fs|((t<<16|e>>>16)*2950163797&Fs)>>>16,e^=t>>>1,e=e*444984403&Fs|e*60499&Fa,t=t*3301882366&Fs|((t<<16|e>>>16)*3120437893&Fs)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const $D=Object.freeze({map:null,hash:"",transfer:void 0});var od,ld,Yi,kx,YO;class tN{constructor(){M(this,kx);M(this,od,!1);M(this,ld,null);M(this,Yi,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=h(this,Yi).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return h(this,Yi).get(e)}remove(e){if(h(this,Yi).delete(e),h(this,Yi).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of h(this,Yi).values())if(t instanceof In)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=h(this,Yi).get(e);let r=!1;if(i!==void 0)for(const[s,a]of Object.entries(t))i[s]!==a&&(r=!0,i[s]=a);else r=!0,h(this,Yi).set(e,t);r&&j(this,kx,YO).call(this),t instanceof In&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return h(this,Yi).has(e)}get size(){return h(this,Yi).size}resetModified(){h(this,od)&&(_(this,od,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new XO(this)}get serializable(){if(h(this,Yi).size===0)return $D;const e=new Map,t=new GO,i=[],r=Object.create(null);let s=!1;for(const[a,o]of h(this,Yi)){const l=o instanceof In?o.serialize(!1,r):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),s||(s=!!l.bitmap))}if(s)for(const a of e.values())a.bitmap&&i.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:$D}get editorStats(){let e=null;const t=new Map;for(const i of h(this,Yi).values()){if(!(i instanceof In))continue;const r=i.telemetryFinalData;if(!r)continue;const{type:s}=r;t.has(s)||t.set(s,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const a=e[s]||(e[s]=new Map);for(const[o,l]of Object.entries(r)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const u=c.get(l)??0;c.set(l,u+1)}}for(const[i,r]of t)e[i]=r.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){_(this,ld,null)}get modifiedIds(){if(h(this,ld))return h(this,ld);const e=[];for(const t of h(this,Yi).values())!(t instanceof In)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return _(this,ld,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return h(this,Yi).entries()}}od=new WeakMap,ld=new WeakMap,Yi=new WeakMap,kx=new WeakSet,YO=function(){h(this,od)||(_(this,od,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var hb;class XO extends tN{constructor(t){super();M(this,hb);const{map:i,hash:r,transfer:s}=t.serializable,a=structuredClone(i,s?{transfer:s}:null);_(this,hb,{map:a,hash:r,transfer:s})}get print(){Sn("Should not call PrintAnnotationStorage.print")}get serializable(){return h(this,hb)}get modifiedIds(){return Wt(this,"modifiedIds",{ids:new Set,hash:""})}}hb=new WeakMap;var Zp;class UK{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){M(this,Zp,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),h(this,Zp).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:i}){if(!(!e||h(this,Zp).has(e.loadedName))){if(fi(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:s,style:a}=e,o=new FontFace(r,s,a);this.addNativeFontFace(o);try{await o.load(),h(this,Zp).add(r),i==null||i(e)}catch{At(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Sn("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(r){throw At(`Failed to load font '${i.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const r=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Wt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Wt(this,"isSyncFontLoadingSupported",Cr||nr.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(fi(!r.done,"completeRequest() cannot be called twice."),r.done=!0;i.length>0&&i[0].done;){const s=i.shift();setTimeout(s.callback,0)}}const{loadingRequests:i}=this,r={done:!1,complete:t,callback:e};return i.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Wt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(P,A){return P.charCodeAt(A)<<24|P.charCodeAt(A+1)<<16|P.charCodeAt(A+2)<<8|P.charCodeAt(A+3)&255}function r(P,A,N,R){const V=P.substring(0,A),B=P.substring(A+N);return V+R+B}let s,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function u(P,A){if(++c>30){At("Load test font never loaded."),A();return}if(l.font="30px "+P,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){A();return}setTimeout(u.bind(null,P,A))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=r(m,976,p.length,p);const y=16,v=1482184792;let w=i(m,y);for(s=0,a=p.length-3;s<a;s+=4)w=w-v+i(p,s)|0;s<p.length&&(w=w-v+i(p+"XXX",s)|0),m=r(m,y,4,SK(w));const k=`url(data:font/opentype;base64,${btoa(m)});`,S=`@font-face {font-family:"${p}";src:${k}}`;this.insertRule(S);const E=this._document.createElement("div");E.style.visibility="hidden",E.style.width=E.style.height="10px",E.style.position="absolute",E.style.top=E.style.left="0px";for(const P of[e.loadedName,p]){const A=this._document.createElement("span");A.textContent="Hi",A.style.fontFamily=P,E.append(A)}this._document.body.append(E),u(p,()=>{E.remove(),t.complete()})}}Zp=new WeakMap;class zK{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${gO(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let r;try{r=e.get(i)}catch(a){At(`getPathGenerator - ignoring character: "${a}".`)}const s=new Path2D(r||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=s}}function BK(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Cr)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function $K(n){if(Cr&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return ky(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Vv(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const WD=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,WK=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",HK=AK.bind(null,WD,WK);var Qo,Dx;class qK{constructor(){M(this,Qo,new Map);M(this,Dx,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};h(this,Dx).then(()=>{for(const[r]of h(this,Qo))r.call(this,i)})}addEventListener(e,t,i=null){let r=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:s}=i;if(s.aborted){At("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);r=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}h(this,Qo).set(t,r)}removeEventListener(e,t){const i=h(this,Qo).get(t);i==null||i(),h(this,Qo).delete(t)}terminate(){for(const[,e]of h(this,Qo))e==null||e();h(this,Qo).clear()}}Qo=new WeakMap,Dx=new WeakMap;const Uv={DATA:1,ERROR:2},ci={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function UT(){}function Ur(n){if(n instanceof Xc||n instanceof SD||n instanceof OT||n instanceof tx||n instanceof Kk)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Sn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Xc(n.message);case"InvalidPDFException":return new SD(n.message);case"PasswordException":return new OT(n.message,n.code);case"ResponseException":return new tx(n.message,n.status,n.missing);case"UnknownErrorException":return new Kk(n.message,n.details)}return new Kk(n.message,n.toString())}var ef,Zs,KO,QO,JO,h0;class Jm{constructor(e,t,i){M(this,Zs);M(this,ef,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",j(this,Zs,KO).bind(this),{signal:h(this,ef).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const r=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[r]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},i)}catch(a){s.reject(a)}return s.promise}sendWithStream(e,t,i,r){const s=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const u=Promise.withResolvers();return this.streamControllers[s]={controller:c,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:s,data:t,desiredSize:c.desiredSize},r),u.promise},pull:c=>{const u=Promise.withResolvers();return this.streamControllers[s].pullCall=u,l.postMessage({sourceName:a,targetName:o,stream:ci.PULL,streamId:s,desiredSize:c.desiredSize}),u.promise},cancel:c=>{fi(c instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[s].cancelCall=u,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:ci.CANCEL,streamId:s,reason:Ur(c)}),u.promise}},i)}destroy(){var e;(e=h(this,ef))==null||e.abort(),_(this,ef,null)}}ef=new WeakMap,Zs=new WeakSet,KO=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){j(this,Zs,JO).call(this,e);return}if(e.callback){const i=e.callbackId,r=this.callbackCapabilities[i];if(!r)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Uv.DATA)r.resolve(e.data);else if(e.callback===Uv.ERROR)r.reject(Ur(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,r=e.sourceName,s=this.comObj;Promise.try(t,e.data).then(function(a){s.postMessage({sourceName:i,targetName:r,callback:Uv.DATA,callbackId:e.callbackId,data:a})},function(a){s.postMessage({sourceName:i,targetName:r,callback:Uv.ERROR,callbackId:e.callbackId,reason:Ur(a)})});return}if(e.streamId){j(this,Zs,QO).call(this,e);return}t(e.data)},QO=function(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,s=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,u=1,p){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=u,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:i,targetName:r,stream:ci.ENQUEUE,streamId:t,chunk:c},p)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:r,stream:ci.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){fi(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:r,stream:ci.ERROR,streamId:t,reason:Ur(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){s.postMessage({sourceName:i,targetName:r,stream:ci.START_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:i,targetName:r,stream:ci.START_COMPLETE,streamId:t,reason:Ur(c)})})},JO=function(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,s=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case ci.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Ur(e.reason));break;case ci.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Ur(e.reason));break;case ci.PULL:if(!o){s.postMessage({sourceName:i,targetName:r,stream:ci.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||UT).then(function(){s.postMessage({sourceName:i,targetName:r,stream:ci.PULL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:i,targetName:r,stream:ci.PULL_COMPLETE,streamId:t,reason:Ur(c)})});break;case ci.ENQUEUE:if(fi(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case ci.CLOSE:if(fi(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),j(this,Zs,h0).call(this,a,t);break;case ci.ERROR:fi(a,"error should have stream controller"),a.controller.error(Ur(e.reason)),j(this,Zs,h0).call(this,a,t);break;case ci.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Ur(e.reason)),j(this,Zs,h0).call(this,a,t);break;case ci.CANCEL:if(!o)break;const l=Ur(e.reason);Promise.try(o.onCancel||UT,l).then(function(){s.postMessage({sourceName:i,targetName:r,stream:ci.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:i,targetName:r,stream:ci.CANCEL_COMPLETE,streamId:t,reason:Ur(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},h0=async function(e,t){var i,r,s;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(r=e.pullCall)==null?void 0:r.promise,(s=e.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[t]};var pb;class ZO{constructor({enableHWA:e=!1}){M(this,pb,!1);_(this,pb,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!h(this,pb)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Sn("Abstract method `_createCanvas` called.")}}pb=new WeakMap;class GK extends ZO{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class eL{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Sn("Abstract method `_fetch` called.")}}class zT extends eL{async _fetch(e){const t=await Dy(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):ky(t)}}class tL{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,r,s){return"none"}destroy(e=!1){}}var cd,tf,Jo,Zo,dr,ud,dd,tt,lr,Zm,tp,p0,np,nL,HD,ip,eg,tg,qD,ng;class YK extends tL{constructor({docId:t,ownerDocument:i=globalThis.document}){super();M(this,tt);M(this,cd);M(this,tf);M(this,Jo);M(this,Zo);M(this,dr);M(this,ud);M(this,dd,0);_(this,Zo,t),_(this,dr,i)}addFilter(t){if(!t)return"none";let i=h(this,tt,lr).get(t);if(i)return i;const[r,s,a]=j(this,tt,p0).call(this,t),o=t.length===1?r:`${r}${s}${a}`;if(i=h(this,tt,lr).get(o),i)return h(this,tt,lr).set(t,i),i;const l=`g_${h(this,Zo)}_transfer_map_${Ti(this,dd)._++}`,c=j(this,tt,np).call(this,l);h(this,tt,lr).set(t,c),h(this,tt,lr).set(o,c);const u=j(this,tt,ip).call(this,l);return j(this,tt,tg).call(this,r,s,a,u),c}addHCMFilter(t,i){var y;const r=`${t}-${i}`,s="base";let a=h(this,tt,Zm).get(s);if((a==null?void 0:a.key)===r||(a?((y=a.filter)==null||y.remove(),a.key=r,a.url="none",a.filter=null):(a={key:r,url:"none",filter:null},h(this,tt,Zm).set(s,a)),!t||!i))return a.url;const o=j(this,tt,ng).call(this,t);t=gt.makeHexColor(...o);const l=j(this,tt,ng).call(this,i);if(i=gt.makeHexColor(...l),h(this,tt,tp).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return a.url;const c=new Array(256);for(let v=0;v<=255;v++){const w=v/255;c[v]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const u=c.join(","),p=`g_${h(this,Zo)}_hcm_filter`,m=a.filter=j(this,tt,ip).call(this,p);j(this,tt,tg).call(this,u,u,u,m),j(this,tt,HD).call(this,m);const g=(v,w)=>{const k=o[v]/255,S=l[v]/255,E=new Array(w+1);for(let P=0;P<=w;P++)E[P]=k+P/w*(S-k);return E.join(",")};return j(this,tt,tg).call(this,g(0,5),g(1,5),g(2,5),m),a.url=j(this,tt,np).call(this,p),a.url}addAlphaFilter(t){let i=h(this,tt,lr).get(t);if(i)return i;const[r]=j(this,tt,p0).call(this,[t]),s=`alpha_${r}`;if(i=h(this,tt,lr).get(s),i)return h(this,tt,lr).set(t,i),i;const a=`g_${h(this,Zo)}_alpha_map_${Ti(this,dd)._++}`,o=j(this,tt,np).call(this,a);h(this,tt,lr).set(t,o),h(this,tt,lr).set(s,o);const l=j(this,tt,ip).call(this,a);return j(this,tt,qD).call(this,r,l),o}addLuminosityFilter(t){let i=h(this,tt,lr).get(t||"luminosity");if(i)return i;let r,s;if(t?([r]=j(this,tt,p0).call(this,[t]),s=`luminosity_${r}`):s="luminosity",i=h(this,tt,lr).get(s),i)return h(this,tt,lr).set(t,i),i;const a=`g_${h(this,Zo)}_luminosity_map_${Ti(this,dd)._++}`,o=j(this,tt,np).call(this,a);h(this,tt,lr).set(t,o),h(this,tt,lr).set(s,o);const l=j(this,tt,ip).call(this,a);return j(this,tt,nL).call(this,l),t&&j(this,tt,qD).call(this,r,l),o}addHighlightHCMFilter(t,i,r,s,a){var S;const o=`${i}-${r}-${s}-${a}`;let l=h(this,tt,Zm).get(t);if((l==null?void 0:l.key)===o||(l?((S=l.filter)==null||S.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},h(this,tt,Zm).set(t,l)),!i||!r))return l.url;const[c,u]=[i,r].map(j(this,tt,ng).bind(this));let p=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),m=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[g,y]=[s,a].map(j(this,tt,ng).bind(this));m<p&&([p,m,g,y]=[m,p,y,g]),h(this,tt,tp).style.color="";const v=(E,P,A)=>{const N=new Array(256),R=(m-p)/A,V=E/255,B=(P-E)/(255*A);let L=0;for(let W=0;W<=A;W++){const q=Math.round(p+W*R),X=V+W*B;for(let G=L;G<=q;G++)N[G]=X;L=q+1}for(let W=L;W<256;W++)N[W]=N[L-1];return N.join(",")},w=`g_${h(this,Zo)}_hcm_${t}_filter`,k=l.filter=j(this,tt,ip).call(this,w);return j(this,tt,HD).call(this,k),j(this,tt,tg).call(this,v(g[0],y[0],5),v(g[1],y[1],5),v(g[2],y[2],5),k),l.url=j(this,tt,np).call(this,w),l.url}destroy(t=!1){var i,r,s,a;t&&((i=h(this,ud))!=null&&i.size)||((r=h(this,Jo))==null||r.parentNode.parentNode.remove(),_(this,Jo,null),(s=h(this,tf))==null||s.clear(),_(this,tf,null),(a=h(this,ud))==null||a.clear(),_(this,ud,null),_(this,dd,0))}}cd=new WeakMap,tf=new WeakMap,Jo=new WeakMap,Zo=new WeakMap,dr=new WeakMap,ud=new WeakMap,dd=new WeakMap,tt=new WeakSet,lr=function(){return h(this,tf)||_(this,tf,new Map)},Zm=function(){return h(this,ud)||_(this,ud,new Map)},tp=function(){if(!h(this,Jo)){const t=h(this,dr).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const r=h(this,dr).createElementNS(Io,"svg");r.setAttribute("width",0),r.setAttribute("height",0),_(this,Jo,h(this,dr).createElementNS(Io,"defs")),t.append(r),r.append(h(this,Jo)),h(this,dr).body.append(t)}return h(this,Jo)},p0=function(t){if(t.length===1){const c=t[0],u=new Array(256);for(let m=0;m<256;m++)u[m]=c[m]/255;const p=u.join(",");return[p,p,p]}const[i,r,s]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=i[c]/255,o[c]=r[c]/255,l[c]=s[c]/255;return[a.join(","),o.join(","),l.join(",")]},np=function(t){if(h(this,cd)===void 0){_(this,cd,"");const i=h(this,dr).URL;i!==h(this,dr).baseURI&&(nw(i)?At('#createUrl: ignore "data:"-URL for performance reasons.'):_(this,cd,pO(i,"")))}return`url(${h(this,cd)}#${t})`},nL=function(t){const i=h(this,dr).createElementNS(Io,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},HD=function(t){const i=h(this,dr).createElementNS(Io,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},ip=function(t){const i=h(this,dr).createElementNS(Io,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),h(this,tt,tp).append(i),i},eg=function(t,i,r){const s=h(this,dr).createElementNS(Io,i);s.setAttribute("type","discrete"),s.setAttribute("tableValues",r),t.append(s)},tg=function(t,i,r,s){const a=h(this,dr).createElementNS(Io,"feComponentTransfer");s.append(a),j(this,tt,eg).call(this,a,"feFuncR",t),j(this,tt,eg).call(this,a,"feFuncG",i),j(this,tt,eg).call(this,a,"feFuncB",r)},qD=function(t,i){const r=h(this,dr).createElementNS(Io,"feComponentTransfer");i.append(r),j(this,tt,eg).call(this,r,"feFuncA",t)},ng=function(t){return h(this,tt,tp).style.color=t,iw(getComputedStyle(h(this,tt,tp)).getPropertyValue("color"))};class iL{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Sn("Abstract method `_fetch` called.")}}class BT extends iL{async _fetch(e){const t=await Dy(e,"arraybuffer");return new Uint8Array(t)}}class rL{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Sn("Abstract method `_fetch` called.")}}class $T extends rL{async _fetch(e){const t=await Dy(e,"arraybuffer");return new Uint8Array(t)}}Cr&&At("Please use the `legacy` build in Node.js environments.");async function nN(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class XK extends tL{}class KK extends ZO{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class QK extends eL{async _fetch(e){return nN(e)}}class JK extends iL{async _fetch(e){return nN(e)}}class ZK extends rL{async _fetch(e){return nN(e)}}const Qi={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function GD(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,i),n.clip(r)}class iN{isModifyingCurrentTransform(){return!1}getPattern(){Sn("Abstract method `getPattern` called.")}}class eQ extends iN{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,r){let s;if(r===Qi.STROKE||r===Qi.FILL){const a=t.current.getClippedPathBoundingBox(r,qn(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),u=c.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-a[0],-a[1]),i=gt.transform(i,[1,0,0,1,a[0],a[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),GD(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),s=e.createPattern(c.canvas,"no-repeat");const p=new DOMMatrix(i);s.setTransform(p)}else GD(e,this._bbox),s=this._createGradient(e);return s}}function Zk(n,e,t,i,r,s,a,o){const l=e.coords,c=e.colors,u=n.data,p=n.width*4;let m;l[t+1]>l[i+1]&&(m=t,t=i,i=m,m=s,s=a,a=m),l[i+1]>l[r+1]&&(m=i,i=r,r=m,m=a,a=o,o=m),l[t+1]>l[i+1]&&(m=t,t=i,i=m,m=s,s=a,a=m);const g=(l[t]+e.offsetX)*e.scaleX,y=(l[t+1]+e.offsetY)*e.scaleY,v=(l[i]+e.offsetX)*e.scaleX,w=(l[i+1]+e.offsetY)*e.scaleY,k=(l[r]+e.offsetX)*e.scaleX,S=(l[r+1]+e.offsetY)*e.scaleY;if(y>=S)return;const E=c[s],P=c[s+1],A=c[s+2],N=c[a],R=c[a+1],V=c[a+2],B=c[o],L=c[o+1],W=c[o+2],q=Math.round(y),X=Math.round(S);let G,K,J,ee,fe,ae,U,he;for(let ie=q;ie<=X;ie++){if(ie<w){const xe=ie<y?0:(y-ie)/(y-w);G=g-(g-v)*xe,K=E-(E-N)*xe,J=P-(P-R)*xe,ee=A-(A-V)*xe}else{let xe;ie>S?xe=1:w===S?xe=0:xe=(w-ie)/(w-S),G=v-(v-k)*xe,K=N-(N-B)*xe,J=R-(R-L)*xe,ee=V-(V-W)*xe}let $;ie<y?$=0:ie>S?$=1:$=(y-ie)/(y-S),fe=g-(g-k)*$,ae=E-(E-B)*$,U=P-(P-L)*$,he=A-(A-W)*$;const Y=Math.round(Math.min(G,fe)),oe=Math.round(Math.max(G,fe));let be=p*ie+Y*4;for(let xe=Y;xe<=oe;xe++)$=(G-xe)/(G-fe),$<0?$=0:$>1&&($=1),u[be++]=K-(K-ae)*$|0,u[be++]=J-(J-U)*$|0,u[be++]=ee-(ee-he)*$|0,u[be++]=255}}function tQ(n,e,t){const i=e.coords,r=e.colors;let s,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(s=0;s<l;s++){let u=s*o;for(let p=0;p<c;p++,u++)Zk(n,t,i[u],i[u+1],i[u+o],r[u],r[u+1],r[u+o]),Zk(n,t,i[u+o+1],i[u+1],i[u+o],r[u+o+1],r[u+1],r[u+o])}break;case"triangles":for(s=0,a=i.length;s<a;s+=3)Zk(n,t,i[s],i[s+1],i[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}class nQ extends iN{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,u=Math.ceil(this._bounds[3])-l,p=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(u*e[1]*1.1)),3e3),g=c/p,y=u/m,v={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/g,scaleY:1/y},w=p+2*2,k=m+2*2,S=i.getCanvas("mesh",w,k),E=S.context,P=E.createImageData(p,m);if(t){const N=P.data;for(let R=0,V=N.length;R<V;R+=4)N[R]=t[0],N[R+1]=t[1],N[R+2]=t[2],N[R+3]=255}for(const N of this._figures)tQ(P,N,v);return E.putImageData(P,2,2),{canvas:S.canvas,offsetX:o-2*g,offsetY:l-2*y,scaleX:g,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(e,t,i,r){GD(e,this._bbox);const s=new Float32Array(2);if(r===Qi.SHADING)gt.singularValueDecompose2dScale(qn(e),s);else if(this.matrix){gt.singularValueDecompose2dScale(this.matrix,s);const[o,l]=s;gt.singularValueDecompose2dScale(t.baseTransform,s),s[0]*=o,s[1]*=l}else gt.singularValueDecompose2dScale(t.baseTransform,s);const a=this._createMeshCanvas(s,r===Qi.SHADING?null:this._background,t.cachedCanvases);return r!==Qi.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class iQ extends iN{getPattern(){return"hotpink"}}function rQ(n){switch(n[0]){case"RadialAxial":return new eQ(n);case"Mesh":return new nQ(n);case"Dummy":return new iQ}throw new Error(`Unknown IR type: ${n[0]}`)}const WT={COLORED:1,UNCOLORED:2},Sx=class Sx{constructor(e,t,i,r){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:r,tilingType:s,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),tw("TilingType: "+s);const u=t[0],p=t[1],m=t[2],g=t[3],y=m-u,v=g-p,w=new Float32Array(2);gt.singularValueDecompose2dScale(this.matrix,w);const[k,S]=w;gt.singularValueDecompose2dScale(this.baseTransform,w);const E=k*w[0],P=S*w[1];let A=y,N=v,R=!1,V=!1;const B=Math.ceil(l*E),L=Math.ceil(c*P),W=Math.ceil(y*E),q=Math.ceil(v*P);B>=W?A=l:R=!0,L>=q?N=c:V=!0;const X=this.getSizeAndScale(A,this.ctx.canvas.width,E),G=this.getSizeAndScale(N,this.ctx.canvas.height,P),K=e.cachedCanvases.getCanvas("pattern",X.size,G.size),J=K.context,ee=o.createCanvasGraphics(J);if(ee.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ee,r,a),J.translate(-X.scale*u,-G.scale*p),ee.transform(X.scale,0,0,G.scale,0,0),J.save(),this.clipBbox(ee,u,p,m,g),ee.baseTransform=qn(ee.ctx),ee.executeOperatorList(i),ee.endDrawing(),J.restore(),R||V){const fe=K.canvas;R&&(A=l),V&&(N=c);const ae=this.getSizeAndScale(A,this.ctx.canvas.width,E),U=this.getSizeAndScale(N,this.ctx.canvas.height,P),he=ae.size,ie=U.size,$=e.cachedCanvases.getCanvas("pattern-workaround",he,ie),Y=$.context,oe=R?Math.floor(y/l):0,be=V?Math.floor(v/c):0;for(let xe=0;xe<=oe;xe++)for(let je=0;je<=be;je++)Y.drawImage(fe,he*xe,ie*je,he,ie,0,0,he,ie);return{canvas:$.canvas,scaleX:ae.scale,scaleY:U.scale,offsetX:u,offsetY:p}}return{canvas:K.canvas,scaleX:X.scale,scaleY:G.scale,offsetX:u,offsetY:p}}getSizeAndScale(e,t,i){const r=Math.max(Sx.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*i);return s>=r?s=r:i=s/e,{scale:i,size:s}}clipBbox(e,t,i,r,s){const a=r-t,o=s-i;e.ctx.rect(t,i,a,o),gt.axialAlignedBoundingBox([t,i,r,s],qn(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const r=e.ctx,s=e.current;switch(t){case WT.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;r.fillStyle=s.fillColor=a,r.strokeStyle=s.strokeColor=o;break;case WT.UNCOLORED:r.fillStyle=r.strokeStyle=i,s.fillColor=s.strokeColor=i;break;default:throw new DK(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,i,r){let s=i;r!==Qi.SHADING&&(s=gt.transform(s,t.baseTransform),this.matrix&&(s=gt.transform(s,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(s);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};Me(Sx,"MAX_PATTERN_SIZE",3e3);let YD=Sx;function sQ({src:n,srcPos:e=0,dest:t,width:i,height:r,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const o=nr.isLittleEndian?4278190080:255,[l,c]=a?[s,o]:[o,s],u=i>>3,p=i&7,m=n.length;t=new Uint32Array(t.buffer);let g=0;for(let y=0;y<r;y++){for(const w=e+u;e<w;e++){const k=e<m?n[e]:255;t[g++]=k&128?c:l,t[g++]=k&64?c:l,t[g++]=k&32?c:l,t[g++]=k&16?c:l,t[g++]=k&8?c:l,t[g++]=k&4?c:l,t[g++]=k&2?c:l,t[g++]=k&1?c:l}if(p===0)continue;const v=e<m?n[e++]:255;for(let w=0;w<p;w++)t[g++]=v&1<<7-w?c:l}return{srcPos:e,destPos:g}}const HT=16,qT=100,aQ=15,GT=10,Gr=16,e1=new DOMMatrix,Ds=new Float32Array(2),up=new Float32Array([1/0,1/0,-1/0,-1/0]);function oQ(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,i){e.translate(t,i),this.__originalTranslate(t,i)},n.scale=function(t,i){e.scale(t,i),this.__originalScale(t,i)},n.transform=function(t,i,r,s,a,o){e.transform(t,i,r,s,a,o),this.__originalTransform(t,i,r,s,a,o)},n.setTransform=function(t,i,r,s,a,o){e.setTransform(t,i,r,s,a,o),this.__originalSetTransform(t,i,r,s,a,o)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,r,s,a,o){e.bezierCurveTo(t,i,r,s,a,o),this.__originalBezierCurveTo(t,i,r,s,a,o)},n.rect=function(t,i,r,s){e.rect(t,i,r,s),this.__originalRect(t,i,r,s)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class lQ{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,i)):(r=this.canvasFactory.create(t,i),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function zv(n,e,t,i,r,s,a,o,l,c){const[u,p,m,g,y,v]=qn(n);if(p===0&&m===0){const S=a*u+y,E=Math.round(S),P=o*g+v,A=Math.round(P),N=(a+l)*u+y,R=Math.abs(Math.round(N)-E)||1,V=(o+c)*g+v,B=Math.abs(Math.round(V)-A)||1;return n.setTransform(Math.sign(u),0,0,Math.sign(g),E,A),n.drawImage(e,t,i,r,s,0,0,R,B),n.setTransform(u,p,m,g,y,v),[R,B]}if(u===0&&g===0){const S=o*m+y,E=Math.round(S),P=a*p+v,A=Math.round(P),N=(o+c)*m+y,R=Math.abs(Math.round(N)-E)||1,V=(a+l)*p+v,B=Math.abs(Math.round(V)-A)||1;return n.setTransform(0,Math.sign(p),Math.sign(m),0,E,A),n.drawImage(e,t,i,r,s,0,0,B,R),n.setTransform(u,p,m,g,y,v),[B,R]}n.drawImage(e,t,i,r,s,a,o,l,c);const w=Math.hypot(u,p),k=Math.hypot(m,g);return[w*l,k*c]}class YT{constructor(e,t){Me(this,"alphaIsShape",!1);Me(this,"fontSize",0);Me(this,"fontSizeScale",1);Me(this,"textMatrix",null);Me(this,"textMatrixScale",1);Me(this,"fontMatrix",DD);Me(this,"leading",0);Me(this,"x",0);Me(this,"y",0);Me(this,"lineX",0);Me(this,"lineY",0);Me(this,"charSpacing",0);Me(this,"wordSpacing",0);Me(this,"textHScale",1);Me(this,"textRenderingMode",or.FILL);Me(this,"textRise",0);Me(this,"fillColor","#000000");Me(this,"strokeColor","#000000");Me(this,"patternFill",!1);Me(this,"patternStroke",!1);Me(this,"fillAlpha",1);Me(this,"strokeAlpha",1);Me(this,"lineWidth",1);Me(this,"activeSMask",null);Me(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,e,t]),this.minMax=up.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Qi.FILL,t=null){const i=this.minMax.slice();if(e===Qi.STROKE){t||Sn("Stroke bounding box must include transform."),gt.singularValueDecompose2dScale(t,Ds);const r=Ds[0]*this.lineWidth/2,s=Ds[1]*this.lineWidth/2;i[0]-=r,i[1]-=s,i[2]+=r,i[3]+=s}return i}updateClipFromPath(){const e=gt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(up,0)}getClippedPathBoundingBox(e=Qi.FILL,t=null){return gt.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function XT(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,r=t%Gr,s=(t-r)/Gr,a=r===0?s:s+1,o=n.createImageData(i,Gr);let l=0,c;const u=e.data,p=o.data;let m,g,y,v;if(e.kind===r0.GRAYSCALE_1BPP){const w=u.byteLength,k=new Uint32Array(p.buffer,0,p.byteLength>>2),S=k.length,E=i+7>>3,P=4294967295,A=nr.isLittleEndian?4278190080:255;for(m=0;m<a;m++){for(y=m<s?Gr:r,c=0,g=0;g<y;g++){const N=w-l;let R=0;const V=N>E?i:N*8-7,B=V&-8;let L=0,W=0;for(;R<B;R+=8)W=u[l++],k[c++]=W&128?P:A,k[c++]=W&64?P:A,k[c++]=W&32?P:A,k[c++]=W&16?P:A,k[c++]=W&8?P:A,k[c++]=W&4?P:A,k[c++]=W&2?P:A,k[c++]=W&1?P:A;for(;R<V;R++)L===0&&(W=u[l++],L=128),k[c++]=W&L?P:A,L>>=1}for(;c<S;)k[c++]=0;n.putImageData(o,0,m*Gr)}}else if(e.kind===r0.RGBA_32BPP){for(g=0,v=i*Gr*4,m=0;m<s;m++)p.set(u.subarray(l,l+v)),l+=v,n.putImageData(o,0,g),g+=Gr;m<a&&(v=i*r*4,p.set(u.subarray(l,l+v)),n.putImageData(o,0,g))}else if(e.kind===r0.RGB_24BPP)for(y=Gr,v=i*y,m=0;m<a;m++){for(m>=s&&(y=r,v=i*y),c=0,g=v;g--;)p[c++]=u[l++],p[c++]=u[l++],p[c++]=u[l++],p[c++]=255;n.putImageData(o,0,m*Gr)}else throw new Error(`bad image kind: ${e.kind}`)}function KT(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,r=t%Gr,s=(t-r)/Gr,a=r===0?s:s+1,o=n.createImageData(i,Gr);let l=0;const c=e.data,u=o.data;for(let p=0;p<a;p++){const m=p<s?Gr:r;({srcPos:l}=sQ({src:c,srcPos:l,dest:u,width:i,height:m,nonBlackColor:0})),n.putImageData(o,0,p*Gr)}}function Im(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Bv(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function QT(n,e){if(e)return!0;gt.singularValueDecompose2dScale(n,Ds);const t=Math.fround(go.pixelRatio*Kc.PDF_TO_CSS_UNITS);return Ds[0]<=t&&Ds[1]<=t}const cQ=["butt","round","square"],uQ=["miter","round","bevel"],dQ={},JT={};var Pa,XD,KD,QD;const MN=class MN{constructor(e,t,i,r,s,{optionalContentConfig:a,markedContentStack:o=null},l,c){M(this,Pa);this.ctx=e,this.current=new YT(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=r,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new lQ(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:r=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...qn(this.compositeCtx))}this.ctx.save(),Bv(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=qn(this.ctx)}executeOperatorList(e,t,i,r){const s=e.argsArray,a=e.fnArray;let o=t||0;const l=s.length;if(l===o)return o;const c=l-o>GT&&typeof i=="function",u=c?Date.now()+aQ:0;let p=0;const m=this.commonObjs,g=this.objs;let y;for(;;){if(r!==void 0&&o===r.nextBreakPoint)return r.breakIt(o,i),o;if(y=a[o],y!==ex.dependency)this[y].apply(this,s[o]);else for(const v of s[o]){const w=v.startsWith("g_")?m:g;if(!w.has(v))return w.get(v,i),o}if(o++,o===l)return o;if(c&&++p>GT){if(Date.now()>u)return i(),o;p=0}}}endDrawing(){j(this,Pa,XD).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),j(this,Pa,KD).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,r=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=i,l=r,c="prescale1",u,p;for(;s>2&&o>1||a>2&&l>1;){let m=o,g=l;s>2&&o>1&&(m=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),s/=o/m),a>2&&l>1&&(g=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/g),u=this.cachedCanvases.getCanvas(c,m,g),p=u.context,p.clearRect(0,0,m,g),p.drawImage(e,0,0,o,l,0,0,m,g),e=u.canvas,o=m,l=g,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:r}=e,s=this.current.fillColor,a=this.current.patternFill,o=qn(t);let l,c,u,p;if((e.bitmap||e.data)&&e.count>1){const B=e.bitmap||e.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),s]),l=this._cachedBitmapsMap.get(B),l||(l=new Map,this._cachedBitmapsMap.set(B,l));const L=l.get(c);if(L&&!a){const W=Math.round(Math.min(o[0],o[2])+o[4]),q=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:L,offsetX:W,offsetY:q}}u=L}u||(p=this.cachedCanvases.getCanvas("maskCanvas",i,r),KT(p.context,e));let m=gt.transform(o,[1/i,0,0,-1/r,0,0]);m=gt.transform(m,[1,0,0,1,0,-r]);const g=up.slice();gt.axialAlignedBoundingBox([0,0,i,r],m,g);const[y,v,w,k]=g,S=Math.round(w-y)||1,E=Math.round(k-v)||1,P=this.cachedCanvases.getCanvas("fillCanvas",S,E),A=P.context,N=y,R=v;A.translate(-N,-R),A.transform(...m),u||(u=this._scaleImage(p.canvas,La(A)),u=u.img,l&&a&&l.set(c,u)),A.imageSmoothingEnabled=QT(qn(A),e.interpolate),zv(A,u,0,0,u.width,u.height,0,0,i,r),A.globalCompositeOperation="source-in";const V=gt.transform(La(A),[1,0,0,1,-N,-R]);return A.fillStyle=a?s.getPattern(t,this,V,Qi.FILL):s,A.fillRect(0,0,i,r),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,P.canvas)),{canvas:P.canvas,offsetX:Math.round(N),offsetY:Math.round(R)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=cQ[e]}setLineJoin(e){this.ctx.lineJoin=uQ[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx;const s=this.ctx=r.context;s.setTransform(this.suspendedCtx.getTransform()),Im(this.suspendedCtx,s),oQ(s,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Im(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,r){const s=r[0],a=r[1],o=r[2]-s,l=r[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,i,o,l,t.subtype,t.backdrop,t.transferMap,s,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,r,s,a,o,l,c,u,p){let m=e.canvas,g=l-u,y=c-p;if(a)if(g<0||y<0||g+i>m.width||y+r>m.height){const w=this.cachedCanvases.getCanvas("maskExtension",i,r),k=w.context;k.drawImage(m,-g,-y),k.globalCompositeOperation="destination-atop",k.fillStyle=a,k.fillRect(0,0,i,r),k.globalCompositeOperation="source-over",m=w.canvas,g=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const w=new Path2D;w.rect(g,y,i,r),e.clip(w),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(g,y,i,r),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const v=new Path2D;v.rect(l,c,i,r),t.clip(v),t.globalCompositeOperation="destination-in",t.drawImage(m,g,y,i,r,l,c,i,r),t.restore()}save(){this.inSMaskMode&&Im(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Im(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,i,r,s,a){this.ctx.transform(e,t,i,r,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){let[r]=t;if(!i){r||(r=t[0]=new Path2D),this[e](r);return}if(!(r instanceof Path2D)){const s=t[0]=new Path2D;for(let a=0,o=r.length;a<o;)switch(r[a++]){case Lv.moveTo:s.moveTo(r[a++],r[a++]);break;case Lv.lineTo:s.lineTo(r[a++],r[a++]);break;case Lv.curveTo:s.bezierCurveTo(r[a++],r[a++],r[a++],r[a++],r[a++],r[a++]);break;case Lv.closePath:s.closePath();break;default:At(`Unrecognized drawing path operator: ${r[a-1]}`);break}r=s}gt.axialAlignedBoundingBox(i,qn(this.ctx),this.current.minMax),this[e](r)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const i=this.ctx,r=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&(r!=null&&r.getPattern)){const s=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=r.getPattern(i,this,La(i),Qi.STROKE),s){const a=new Path2D;a.addPath(e,i.getTransform().invertSelf().multiplySelf(s)),e=a}this.rescaleAndStroke(e,!1),i.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(Qi.STROKE,qn(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const i=this.ctx,r=this.current.fillColor,s=this.current.patternFill;let a=!1;if(s){const l=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.fillStyle=r.getPattern(i,this,La(i),Qi.FILL),l){const c=new Path2D;c.addPath(e,i.getTransform().invertSelf().multiplySelf(l)),e=c}a=!0}const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(i.fill(e,"evenodd"),this.pendingEOFill=!1):i.fill(e)),a&&i.restore(),t&&this.consumePath(e,o)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=dQ}eoClip(){this.pendingClip=JT}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const i=new Path2D,r=t.getTransform().invertSelf();for(const{transform:s,x:a,y:o,fontSize:l,path:c}of e)c&&i.addPath(c,new DOMMatrix(s).preMultiplySelf(r).translate(a,o).scale(l,-l));t.clip(i),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var u;const i=this.commonObjs.get(e),r=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=i.fontMatrix||DD,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&At("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const s=i.loadedName||"sans-serif",a=((u=i.systemFontInfo)==null?void 0:u.css)||`"${s}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let c=t;t<HT?c=HT:t>qT&&(c=qT),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,i,r,s){const a=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,u=o.fontSize/o.fontSizeScale,p=c&or.FILL_STROKE_MASK,m=!!(c&or.ADD_TO_PATH_FLAG),g=o.patternFill&&!l.missingFile,y=o.patternStroke&&!l.missingFile;let v;if((l.disableFontFace||m||g||y)&&!l.missingFile&&(v=l.getPathGenerator(this.commonObjs,e)),v&&(l.disableFontFace||g||y)){a.save(),a.translate(t,i),a.scale(u,-u);let w;if((p===or.FILL||p===or.FILL_STROKE)&&(r?(w=a.getTransform(),a.setTransform(...r),a.fill(j(this,Pa,QD).call(this,v,w,r))):a.fill(v)),p===or.STROKE||p===or.FILL_STROKE)if(s){w||(w=a.getTransform()),a.setTransform(...s);const{a:k,b:S,c:E,d:P}=w,A=gt.inverseTransform(s),N=gt.transform([k,S,E,P,0,0],A);gt.singularValueDecompose2dScale(N,Ds),a.lineWidth*=Math.max(Ds[0],Ds[1])/u,a.stroke(j(this,Pa,QD).call(this,v,w,s))}else a.lineWidth/=u,a.stroke(v);a.restore()}else(p===or.FILL||p===or.FILL_STROKE)&&a.fillText(e,t,i),(p===or.STROKE||p===or.FILL_STROKE)&&a.strokeText(e,t,i);m&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:qn(a),x:t,y:i,fontSize:u,path:v})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){i=!0;break}return Wt(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const r=t.fontSize;if(r===0)return;const s=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,u=t.textHScale*c,p=e.length,m=i.vertical,g=m?1:-1,y=i.defaultVMetrics,v=r*t.fontMatrix[0],w=t.textRenderingMode===or.FILL&&!i.disableFontFace&&!t.patternFill;s.save(),t.textMatrix&&s.transform(...t.textMatrix),s.translate(t.x,t.y+t.textRise),c>0?s.scale(u,-1):s.scale(u,1);let k,S;if(t.patternFill){s.save();const R=t.fillColor.getPattern(s,this,La(s),Qi.FILL);k=qn(s),s.restore(),s.fillStyle=R}if(t.patternStroke){s.save();const R=t.strokeColor.getPattern(s,this,La(s),Qi.STROKE);S=qn(s),s.restore(),s.strokeStyle=R}let E=t.lineWidth;const P=t.textMatrixScale;if(P===0||E===0){const R=t.textRenderingMode&or.FILL_STROKE_MASK;(R===or.STROKE||R===or.FILL_STROKE)&&(E=this.getSinglePixelWidth())}else E/=P;if(a!==1&&(s.scale(a,a),E/=a),s.lineWidth=E,i.isInvalidPDFjsFont){const R=[];let V=0;for(const B of e)R.push(B.unicode),V+=B.width;s.fillText(R.join(""),0,0),t.x+=V*v*u,s.restore(),this.compose();return}let A=0,N;for(N=0;N<p;++N){const R=e[N];if(typeof R=="number"){A+=g*R*r/1e3;continue}let V=!1;const B=(R.isSpace?l:0)+o,L=R.fontChar,W=R.accent;let q,X,G=R.width;if(m){const J=R.vmetric||y,ee=-(R.vmetric?J[1]:G*.5)*v,fe=J[2]*v;G=J?-J[0]:G,q=ee/a,X=(A+fe)/a}else q=A/a,X=0;if(i.remeasure&&G>0){const J=s.measureText(L).width*1e3/r*a;if(G<J&&this.isFontSubpixelAAEnabled){const ee=G/J;V=!0,s.save(),s.scale(ee,1),q/=ee}else G!==J&&(q+=(G-J)/2e3*r/a)}if(this.contentVisible&&(R.isInFont||i.missingFile)){if(w&&!W)s.fillText(L,q,X);else if(this.paintChar(L,q,X,k,S),W){const J=q+r*W.offset.x/a,ee=X-r*W.offset.y/a;this.paintChar(W.fontChar,J,ee,k,S)}}const K=m?G*v-B*c:G*v+B*c;A+=K,V&&s.restore()}m?t.y-=A:t.x+=A*u,s.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,r=i.font,s=i.fontSize,a=i.fontDirection,o=r.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,u=i.textHScale*a,p=i.fontMatrix||DD,m=e.length,g=i.textRenderingMode===or.INVISIBLE;let y,v,w,k;if(!(g||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),i.textMatrix&&t.transform(...i.textMatrix),t.translate(i.x,i.y+i.textRise),t.scale(u,a),y=0;y<m;++y){if(v=e[y],typeof v=="number"){k=o*v*s/1e3,this.ctx.translate(k,0),i.x+=k*u;continue}const S=(v.isSpace?c:0)+l,E=r.charProcOperatorList[v.operatorListId];E?this.contentVisible&&(this.save(),t.scale(s,s),t.transform(...p),this.executeOperatorList(E),this.restore()):At(`Type3 character "${v.operatorListId}" is not available.`);const P=[v.width,0];gt.applyTransform(P,p),w=P[0]*s+S,t.translate(w,0),i.x+=w*u}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,r,s,a){const o=new Path2D;o.rect(i,r,s-i,a-r),this.ctx.clip(o),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=this.baseTransform||qn(this.ctx),r={createCanvasGraphics:s=>new MN(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new YD(e,this.ctx,r,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=rQ(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,La(t),Qi.SHADING);const r=La(t);if(r){const{width:s,height:a}=t.canvas,o=up.slice();gt.axialAlignedBoundingBox([0,0,s,a],r,o);const[l,c,u,p]=o;this.ctx.fillRect(l,c,u-l,p-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Sn("Should not call beginInlineImage")}beginImageData(){Sn("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=qn(this.ctx),t)){gt.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[i,r,s,a]=t,o=new Path2D;o.rect(i,r,s-i,a-r),this.ctx.clip(o),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||tw("TODO: Support non-isolated groups."),e.knockout&&At("Knockout groups not supported.");const i=qn(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=up.slice();gt.axialAlignedBoundingBox(e.bbox,qn(t),r);const s=[0,0,t.canvas.width,t.canvas.height];r=gt.intersect(r,s)||[0,0,0,0];const a=Math.floor(r[0]),o=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-a,1),c=Math.max(Math.ceil(r[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let u="groupAt"+this.groupLevel;e.smask&&(u+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(u,l,c),m=p.context;m.translate(-a,-o),m.transform(...i);let g=new Path2D;const[y,v,w,k]=e.bbox;if(g.rect(y,v,w-y,k-v),e.matrix){const S=new Path2D;S.addPath(g,new DOMMatrix(e.matrix)),g=S}m.clip(g),e.smask?this.smaskStack.push({canvas:p.canvas,context:m,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Im(t,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=qn(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const s=up.slice();gt.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],r,s),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,i,r,s){if(j(this,Pa,XD).call(this),Bv(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(s&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o,gt.singularValueDecompose2dScale(qn(this.ctx),Ds);const{viewportScale:l}=this,c=Math.ceil(a*this.outputScaleX*l),u=Math.ceil(o*this.outputScaleY*l);this.annotationCanvas=this.canvasFactory.create(c,u);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(e,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(Ds[0],0,0,-Ds[1],0,o*Ds[1]),Bv(this.ctx)}else{Bv(this.ctx),this.endPath();const l=new Path2D;l.rect(t[0],t[1],a,o),this.ctx.clip(l)}}this.current=new YT(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),j(this,Pa,KD).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,r=this._createMaskCanvas(e),s=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(s,r.offsetX,r.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,r=0,s,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=qn(o);o.transform(t,i,r,s,0,0);const c=this._createMaskCanvas(e);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let u=0,p=a.length;u<p;u+=2){const m=gt.transform(l,[t,i,r,s,a[u],a[u+1]]);o.drawImage(c.canvas,m[4],m[5])}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,r=this.current.patternFill;for(const s of e){const{data:a,width:o,height:l,transform:c}=s,u=this.cachedCanvases.getCanvas("maskCanvas",o,l),p=u.context;p.save();const m=this.getObject(a,s);KT(p,m),p.globalCompositeOperation="source-in",p.fillStyle=r?i.getPattern(p,this,La(t),Qi.FILL):i,p.fillRect(0,0,o,l),p.restore(),t.save(),t.transform(...c),t.scale(1,-1),zv(t,u.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){At("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,r){if(!this.contentVisible)return;const s=this.getObject(e);if(!s){At("Dependent image isn't ready yet");return}const a=s.width,o=s.height,l=[];for(let c=0,u=r.length;c<u;c+=2)l.push({transform:[t,0,0,i,r[c],r[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(s,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:r}=e,s=this.cachedCanvases.getCanvas("inlineImage",i,r),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",s.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,r=this.ctx;this.save();const{filter:s}=r;s!=="none"&&s!==""&&(r.filter="none"),r.scale(1/t,-1/i);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,i).context;XT(c,e),a=this.applyTransferMapsToCanvas(c)}const o=this._scaleImage(a,La(r));r.imageSmoothingEnabled=QT(qn(r),e.interpolate),zv(r,o.img,0,0,o.paintWidth,o.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const s=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",s,a).context;XT(l,e),r=this.applyTransferMapsToCanvas(l)}for(const s of t)i.save(),i.transform(...s.transform),i.scale(1,-1),zv(i,r,s.x,s.y,s.w,s.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const r=this.ctx;this.pendingClip&&(i||(this.pendingClip===JT?r.clip(e,"evenodd"):r.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=qn(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:r,d:s}=this.ctx.getTransform();let a,o;if(i===0&&r===0){const l=Math.abs(t),c=Math.abs(s);if(l===c)if(e===0)a=o=1/l;else{const u=l*e;a=o=u<1?1/u:1}else if(e===0)a=1/l,o=1/c;else{const u=l*e,p=c*e;a=u<1?1/u:1,o=p<1?1/p:1}}else{const l=Math.abs(t*s-i*r),c=Math.hypot(t,i),u=Math.hypot(r,s);if(e===0)a=u/l,o=c/l;else{const p=e*l;a=u>p?u/p:1,o=c>p?c/p:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:i,current:{lineWidth:r}}=this,[s,a]=this.getScaleForStroking();if(s===a){i.lineWidth=(r||1)*s,i.stroke(e);return}const o=i.getLineDash();t&&i.save(),i.scale(s,a),e1.a=1/s,e1.d=1/a;const l=new Path2D;if(l.addPath(e,e1),o.length>0){const c=Math.max(s,a);i.setLineDash(o.map(u=>u/c)),i.lineDashOffset/=c}i.lineWidth=r||1,i.stroke(l),t&&i.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Pa=new WeakSet,XD=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},KD=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},QD=function(e,t,i){const r=new Path2D;return r.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),r};let xp=MN;for(const n in ex)xp.prototype[n]!==void 0&&(xp.prototype[ex[n]]=xp.prototype[n]);var fb,mb;class fo{static get workerPort(){return h(this,fb)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");_(this,fb,e)}static get workerSrc(){return h(this,mb)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");_(this,mb,e)}}fb=new WeakMap,mb=new WeakMap,M(fo,fb,null),M(fo,mb,"");var nf,gb;class hQ{constructor({parsedData:e,rawData:t}){M(this,nf);M(this,gb);_(this,nf,e),_(this,gb,t)}getRaw(){return h(this,gb)}get(e){return h(this,nf).get(e)??null}[Symbol.iterator](){return h(this,nf).entries()}}nf=new WeakMap,gb=new WeakMap;const rp=Symbol("INTERNAL");var bb,yb,vb,rf;class pQ{constructor(e,{name:t,intent:i,usage:r,rbGroups:s}){M(this,bb,!1);M(this,yb,!1);M(this,vb,!1);M(this,rf,!0);_(this,bb,!!(e&ks.DISPLAY)),_(this,yb,!!(e&ks.PRINT)),this.name=t,this.intent=i,this.usage=r,this.rbGroups=s}get visible(){if(h(this,vb))return h(this,rf);if(!h(this,rf))return!1;const{print:e,view:t}=this.usage;return h(this,bb)?(t==null?void 0:t.viewState)!=="OFF":h(this,yb)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==rp&&Sn("Internal method `_setVisible` called."),_(this,vb,i),_(this,rf,t)}}bb=new WeakMap,yb=new WeakMap,vb=new WeakMap,rf=new WeakMap;var wc,wn,sf,af,xb,JD;class fQ{constructor(e,t=ks.DISPLAY){M(this,xb);M(this,wc,null);M(this,wn,new Map);M(this,sf,null);M(this,af,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,_(this,af,e.order);for(const i of e.groups)h(this,wn).set(i.id,new pQ(t,i));if(e.baseState==="OFF")for(const i of h(this,wn).values())i._setVisible(rp,!1);for(const i of e.on)h(this,wn).get(i)._setVisible(rp,!0);for(const i of e.off)h(this,wn).get(i)._setVisible(rp,!1);_(this,sf,this.getHash())}}isVisible(e){if(h(this,wn).size===0)return!0;if(!e)return tw("Optional content group not defined."),!0;if(e.type==="OCG")return h(this,wn).has(e.id)?h(this,wn).get(e.id).visible:(At(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return j(this,xb,JD).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!h(this,wn).has(t))return At(`Optional content group not found: ${t}`),!0;if(h(this,wn).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!h(this,wn).has(t))return At(`Optional content group not found: ${t}`),!0;if(!h(this,wn).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!h(this,wn).has(t))return At(`Optional content group not found: ${t}`),!0;if(!h(this,wn).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!h(this,wn).has(t))return At(`Optional content group not found: ${t}`),!0;if(h(this,wn).get(t).visible)return!1}return!0}return At(`Unknown optional content policy ${e.policy}.`),!0}return At(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var s;const r=h(this,wn).get(e);if(!r){At(`Optional content group not found: ${e}`);return}if(i&&t&&r.rbGroups.length)for(const a of r.rbGroups)for(const o of a)o!==e&&((s=h(this,wn).get(o))==null||s._setVisible(rp,!1,!0));r._setVisible(rp,!!t,!0),_(this,wc,null)}setOCGState({state:e,preserveRB:t}){let i;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":i=r;continue}const s=h(this,wn).get(r);if(s)switch(i){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!s.visible,t);break}}_(this,wc,null)}get hasInitialVisibility(){return h(this,sf)===null||this.getHash()===h(this,sf)}getOrder(){return h(this,wn).size?h(this,af)?h(this,af).slice():[...h(this,wn).keys()]:null}getGroup(e){return h(this,wn).get(e)||null}getHash(){if(h(this,wc)!==null)return h(this,wc);const e=new GO;for(const[t,i]of h(this,wn))e.update(`${t}:${i.visible}`);return _(this,wc,e.hexdigest())}[Symbol.iterator](){return h(this,wn).entries()}}wc=new WeakMap,wn=new WeakMap,sf=new WeakMap,af=new WeakMap,xb=new WeakSet,JD=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let r=1;r<t;r++){const s=e[r];let a;if(Array.isArray(s))a=j(this,xb,JD).call(this,s);else if(h(this,wn).has(s))a=h(this,wn).get(s).visible;else return At(`Optional content group not found: ${s}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class mQ{constructor(e,{disableRange:t=!1,disableStream:i=!1}){fi(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:s,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(s==null?void 0:s.length)>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(i),!0)});fi(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,i,r,s;e.total===void 0?(i=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||i.call(t,{loaded:e.loaded}):(s=(r=this._fullRequestReader)==null?void 0:r.onProgress)==null||s.call(r,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){fi(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new gQ(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new bQ(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeReaders.slice(0))i.cancel(e);this._pdfDataRangeTransport.abort()}}class gQ{constructor(e,t,i=!1,r=null){this._stream=e,this._done=i||!1,this._filename=eN(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class bQ{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function yQ(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let u=o(t);return u=unescape(u),u=l(u),u=c(u),s(u)}if(t=a(n),t){const u=c(t);return s(u)}if(t=i("filename","i").exec(n),t){t=t[1];let u=o(t);return u=c(u),s(u)}function i(u,p){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function r(u,p){if(u){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const m=new TextDecoder(u,{fatal:!0}),g=ky(p);p=m.decode(g),e=!1}catch{}}return p}function s(u){return e&&/[\x80-\xff]/.test(u)&&(u=r("utf-8",u),e&&(u=r("iso-8859-1",u))),u}function a(u){const p=[];let m;const g=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=g.exec(u))!==null;){let[,v,w,k]=m;if(v=parseInt(v,10),v in p){if(v===0)break;continue}p[v]=[w,k]}const y=[];for(let v=0;v<p.length&&v in p;++v){let[w,k]=p[v];k=o(k),w&&(k=unescape(k),v===0&&(k=l(k))),y.push(k)}return y.join("")}function o(u){if(u.startsWith('"')){const p=u.slice(1).split('\\"');for(let m=0;m<p.length;++m){const g=p[m].indexOf('"');g!==-1&&(p[m]=p[m].slice(0,g),p.length=m+1),p[m]=p[m].replaceAll(/\\(.)/g,"$1")}u=p.join('"')}return u}function l(u){const p=u.indexOf("'");if(p===-1)return u;const m=u.slice(0,p),y=u.slice(p+1).replace(/^[^']*'/,"");return r(m,y)}function c(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,m,g,y){if(g==="q"||g==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,w){return String.fromCharCode(parseInt(w,16))}),r(m,y);try{y=atob(y)}catch{}return r(m,y)})}return""}function sL(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const r=e[i];r!==void 0&&t.append(i,r)}return t}function rw(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function aL({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(r.suggestedLength=s,s<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function oL(n){const e=n.get("Content-Disposition");if(e){let t=yQ(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(eN(t))return t}return null}function Ny(n,e){return new tx(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function lL(n){return n===200||n===206}function cL(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function uL(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(At(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class vQ{constructor(e){Me(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=sL(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return fi(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new xQ(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new wQ(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class xQ{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),r=t.url;fetch(r,cL(i,this._withCredentials,this._abortController)).then(s=>{if(e._responseOrigin=rw(s.url),!lL(s.status))throw Ny(s.status,r);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:o,suggestedLength:l}=aL({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=oL(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Xc("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:uL(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class wQ{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${t}-${i-1}`);const a=r.url;fetch(a,cL(s,this._withCredentials,this._abortController)).then(o=>{const l=rw(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!lL(o.status))throw Ny(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:uL(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const t1=200,n1=206;function kQ(n){const e=n.response;return typeof e!="string"?e:ky(e).buffer}class DQ{constructor({url:e,httpHeaders:t,withCredentials:i}){Me(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=sL(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,r=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,a]of this.headers)t.setRequestHeader(s,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=n1):r.expectedStatus=t1,t.responseType="arraybuffer",fi(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){var r;const i=this.pendingRequests[e];i&&((r=i.onProgress)==null||r.call(i,t))}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const r=i.xhr;if(r.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){i.onError(r.status);return}const s=r.status||t1;if(!(s===t1&&i.expectedStatus===n1)&&s!==i.expectedStatus){i.onError(r.status);return}const o=kQ(r);if(s===n1){const l=r.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?i.onDone({begin:parseInt(c[1],10),chunk:o}):(At('Missing or invalid "Content-Range" header.'),i.onError(0))}else o?i.onDone({begin:0,chunk:o}):i.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class SQ{constructor(e){this._source=e,this._manager=new DQ(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return fi(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new EQ(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new NQ(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class EQ{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=rw(t.responseURL);const i=t.getAllResponseHeaders(),r=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=aL({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=oL(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Ny(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class NQ{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=rw((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Ny(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const _Q=/^[a-z][a-z0-9\-+.]+:/i;function CQ(n){if(_Q.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class AQ{constructor(e){this.source=e,this.url=CQ(e.url),fi(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return fi(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new PQ(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new TQ(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class PQ{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=Ny(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Xc("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class TQ{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Rm=Symbol("INITIAL_DATA");var us,wb,ZD;class dL{constructor(){M(this,wb);M(this,us,Object.create(null))}get(e,t=null){if(t){const r=j(this,wb,ZD).call(this,e);return r.promise.then(()=>t(r.data)),null}const i=h(this,us)[e];if(!i||i.data===Rm)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=h(this,us)[e];return!!t&&t.data!==Rm}delete(e){const t=h(this,us)[e];return!t||t.data===Rm?!1:(delete h(this,us)[e],!0)}resolve(e,t=null){const i=j(this,wb,ZD).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in h(this,us)){const{data:i}=h(this,us)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}_(this,us,Object.create(null))}*[Symbol.iterator](){for(const e in h(this,us)){const{data:t}=h(this,us)[e];t!==Rm&&(yield[e,t])}}}us=new WeakMap,wb=new WeakSet,ZD=function(e){var t;return(t=h(this,us))[e]||(t[e]={...Promise.withResolvers(),data:Rm})};const IQ=1e5,ZT=30;var kR,kc,Hr,kb,Db,hd,el,Sb,Eb,pd,of,lf,Dc,cf,Nb,uf,fd,_b,Cb,df,md,Ab,Sc,hf,Sl,hL,pL,eS,_s,f0,tS,fL,mL;const xi=class xi{constructor({textContentSource:e,container:t,viewport:i}){M(this,Sl);M(this,kc,Promise.withResolvers());M(this,Hr,null);M(this,kb,!1);M(this,Db,!!((kR=globalThis.FontInspector)!=null&&kR.enabled));M(this,hd,null);M(this,el,null);M(this,Sb,0);M(this,Eb,0);M(this,pd,null);M(this,of,null);M(this,lf,0);M(this,Dc,0);M(this,cf,Object.create(null));M(this,Nb,[]);M(this,uf,null);M(this,fd,[]);M(this,_b,new WeakMap);M(this,Cb,null);var l;if(e instanceof ReadableStream)_(this,uf,e);else if(typeof e=="object")_(this,uf,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');_(this,Hr,_(this,of,t)),_(this,Dc,i.scale*go.pixelRatio),_(this,lf,i.rotation),_(this,el,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:s,pageX:a,pageY:o}=i.rawDims;_(this,Cb,[1,0,0,-1,-a,o+s]),_(this,Eb,r),_(this,Sb,s),j(l=xi,_s,fL).call(l),ih(t,i),h(this,kc).promise.finally(()=>{h(xi,hf).delete(this),_(this,el,null),_(this,cf,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=nr.platform;return Wt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{h(this,pd).read().then(({value:t,done:i})=>{if(i){h(this,kc).resolve();return}h(this,hd)??_(this,hd,t.lang),Object.assign(h(this,cf),t.styles),j(this,Sl,hL).call(this,t.items),e()},h(this,kc).reject)};return _(this,pd,h(this,uf).getReader()),h(xi,hf).add(this),e(),h(this,kc).promise}update({viewport:e,onBefore:t=null}){var s;const i=e.scale*go.pixelRatio,r=e.rotation;if(r!==h(this,lf)&&(t==null||t(),_(this,lf,r),ih(h(this,of),{rotation:r})),i!==h(this,Dc)){t==null||t(),_(this,Dc,i);const a={div:null,properties:null,ctx:j(s=xi,_s,f0).call(s,h(this,hd))};for(const o of h(this,fd))a.properties=h(this,_b).get(o),a.div=o,j(this,Sl,eS).call(this,a)}}cancel(){var t;const e=new Xc("TextLayer task cancelled.");(t=h(this,pd))==null||t.cancel(e).catch(()=>{}),_(this,pd,null),h(this,kc).reject(e)}get textDivs(){return h(this,fd)}get textContentItemsStr(){return h(this,Nb)}static cleanup(){if(!(h(this,hf).size>0)){h(this,df).clear();for(const{canvas:e}of h(this,md).values())e.remove();h(this,md).clear()}}};kc=new WeakMap,Hr=new WeakMap,kb=new WeakMap,Db=new WeakMap,hd=new WeakMap,el=new WeakMap,Sb=new WeakMap,Eb=new WeakMap,pd=new WeakMap,of=new WeakMap,lf=new WeakMap,Dc=new WeakMap,cf=new WeakMap,Nb=new WeakMap,uf=new WeakMap,fd=new WeakMap,_b=new WeakMap,Cb=new WeakMap,df=new WeakMap,md=new WeakMap,Ab=new WeakMap,Sc=new WeakMap,hf=new WeakMap,Sl=new WeakSet,hL=function(e){var r,s;if(h(this,kb))return;(s=h(this,el)).ctx??(s.ctx=j(r=xi,_s,f0).call(r,h(this,hd)));const t=h(this,fd),i=h(this,Nb);for(const a of e){if(t.length>IQ){At("Ignoring additional textDivs for performance reasons."),_(this,kb,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=h(this,Hr);_(this,Hr,document.createElement("span")),h(this,Hr).classList.add("markedContent"),a.id&&h(this,Hr).setAttribute("id",`${a.id}`),o.append(h(this,Hr))}else a.type==="endMarkedContent"&&_(this,Hr,h(this,Hr).parentNode);continue}i.push(a.str),j(this,Sl,pL).call(this,a)}},pL=function(e){var v;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};h(this,fd).push(t);const r=gt.transform(h(this,Cb),e.transform);let s=Math.atan2(r[1],r[0]);const a=h(this,cf)[e.fontName];a.vertical&&(s+=Math.PI/2);let o=h(this,Db)&&a.fontSubstitution||a.fontFamily;o=xi.fontFamilyMap.get(o)||o;const l=Math.hypot(r[2],r[3]),c=l*j(v=xi,_s,mL).call(v,o,a,h(this,hd));let u,p;s===0?(u=r[4],p=r[5]-c):(u=r[4]+c*Math.sin(s),p=r[5]-c*Math.cos(s));const m="calc(var(--total-scale-factor) *",g=t.style;h(this,Hr)===h(this,of)?(g.left=`${(100*u/h(this,Eb)).toFixed(2)}%`,g.top=`${(100*p/h(this,Sb)).toFixed(2)}%`):(g.left=`${m}${u.toFixed(2)}px)`,g.top=`${m}${p.toFixed(2)}px)`),g.fontSize=`${m}${(h(xi,Sc)*l).toFixed(2)}px)`,g.fontFamily=o,i.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,h(this,Db)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),s!==0&&(i.angle=s*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const w=Math.abs(e.transform[0]),k=Math.abs(e.transform[3]);w!==k&&Math.max(w,k)/Math.min(w,k)>1.5&&(y=!0)}if(y&&(i.canvasWidth=a.vertical?e.height:e.width),h(this,_b).set(t,i),h(this,el).div=t,h(this,el).properties=i,j(this,Sl,eS).call(this,h(this,el)),i.hasText&&h(this,Hr).append(t),i.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),h(this,Hr).append(w)}},eS=function(e){var o;const{div:t,properties:i,ctx:r}=e,{style:s}=t;let a="";if(h(xi,Sc)>1&&(a=`scale(${1/h(xi,Sc)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=s,{canvasWidth:c,fontSize:u}=i;j(o=xi,_s,tS).call(o,r,u*h(this,Dc),l);const{width:p}=r.measureText(t.textContent);p>0&&(a=`scaleX(${c*h(this,Dc)/p}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(s.transform=a)},_s=new WeakSet,f0=function(e=null){let t=h(this,md).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),h(this,md).set(e,t),h(this,Ab).set(t,{size:0,family:""})}return t},tS=function(e,t,i){const r=h(this,Ab).get(e);t===r.size&&i===r.family||(e.font=`${t}px ${i}`,r.size=t,r.family=i)},fL=function(){if(h(this,Sc)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),_(this,Sc,e.getBoundingClientRect().height),e.remove()},mL=function(e,t,i){const r=h(this,df).get(e);if(r)return r;const s=j(this,_s,f0).call(this,i);s.canvas.width=s.canvas.height=ZT,j(this,_s,tS).call(this,s,ZT,e);const a=s.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let c=.8;return o?c=o/(o+l):(nr.platform.isFirefox&&At("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),h(this,df).set(e,c),c},M(xi,_s),M(xi,df,new Map),M(xi,md,new Map),M(xi,Ab,new WeakMap),M(xi,Sc,null),M(xi,hf,new Set);let Pg=xi;class Tg{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function r(s){var l;if(!s)return;let a=null;const o=s.name;if(o==="#text")a=s.value;else if(Tg.shouldBuildText(o))(l=s==null?void 0:s.attributes)!=null&&l.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&t.push({str:a}),!!s.children)for(const c of s.children)r(c)}return r(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const RQ=100;function gL(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new nS,{docId:t}=e,i=n.url?BK(n.url):null,r=n.data?$K(n.data):null,s=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof bL?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let u=n.worker instanceof Ig?n.worker:null;const p=n.verbosity,m=typeof n.docBaseUrl=="string"&&!nw(n.docBaseUrl)?n.docBaseUrl:null,g=Vv(n.cMapUrl),y=n.cMapPacked!==!1,v=n.CMapReaderFactory||(Cr?QK:zT),w=Vv(n.iccUrl),k=Vv(n.standardFontDataUrl),S=n.StandardFontDataFactory||(Cr?JK:BT),E=Vv(n.wasmUrl),P=n.WasmFactory||(Cr?ZK:$T),A=n.stopAtErrors!==!0,N=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,R=n.isEvalSupported!==!1,V=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Cr,B=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Cr&&(nr.platform.isFirefox||!globalThis.chrome),L=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,W=typeof n.disableFontFace=="boolean"?n.disableFontFace:Cr,q=n.fontExtraProperties===!0,X=n.enableXfa===!0,G=n.ownerDocument||globalThis.document,K=n.disableRange===!0,J=n.disableStream===!0,ee=n.disableAutoFetch===!0,fe=n.pdfBug===!0,ae=n.CanvasFactory||(Cr?KK:GK),U=n.FilterFactory||(Cr?XK:YK),he=n.enableHWA===!0,ie=n.useWasm!==!1,$=l?l.length:n.length??NaN,Y=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Cr&&!W,oe=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(v===zT&&S===BT&&P===$T&&g&&k&&E&&Gm(g,document.baseURI)&&Gm(k,document.baseURI)&&Gm(E,document.baseURI)),be=null;xK(p);const xe={canvasFactory:new ae({ownerDocument:G,enableHWA:he}),filterFactory:new U({docId:t,ownerDocument:G}),cMapReaderFactory:oe?null:new v({baseUrl:g,isCompressed:y}),standardFontDataFactory:oe?null:new S({baseUrl:k}),wasmFactory:oe?null:new P({baseUrl:E})};u||(u=Ig.create({verbosity:p,port:fo.workerPort}),e._worker=u);const je={docId:t,apiVersion:"5.4.54",data:r,password:o,disableAutoFetch:ee,rangeChunkSize:c,length:$,docBaseUrl:m,enableXfa:X,evaluatorOptions:{maxImageSize:N,disableFontFace:W,ignoreErrors:A,isEvalSupported:R,isOffscreenCanvasSupported:V,isImageDecoderSupported:B,canvasMaxAreaInBytes:L,fontExtraProperties:q,useSystemFonts:Y,useWasm:ie,useWorkerFetch:oe,cMapUrl:g,iccUrl:w,standardFontDataUrl:k,wasmUrl:E}},ze={ownerDocument:G,pdfBug:fe,styleElement:be,loadingParams:{disableAutoFetch:ee,enableXfa:X}};return u.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const Ve=u.messageHandler.sendWithPromise("GetDocRequest",je,r?[r.buffer]:null);let we;if(l)we=new mQ(l,{disableRange:K,disableStream:J});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Ae=Gm(i)?vQ:Cr?AQ:SQ;we=new Ae({url:i,length:$,httpHeaders:s,withCredentials:a,rangeChunkSize:c,disableRange:K,disableStream:J})}return Ve.then(Ae=>{if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const _e=new Jm(t,Ae,u.port),ye=new OQ(_e,e,we,ze,xe,he);e._transport=ye,_e.send("Ready",null)})}).catch(e._capability.reject),e}var Ex;const Nx=class Nx{constructor(){Me(this,"_capability",Promise.withResolvers());Me(this,"_transport",null);Me(this,"_worker",null);Me(this,"docId",`d${Ti(Nx,Ex)._++}`);Me(this,"destroyed",!1);Me(this,"onPassword",null);Me(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,i,r;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(s){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,s}this._transport=null,(r=this._worker)==null||r.destroy(),this._worker=null}async getData(){return this._transport.getData()}};Ex=new WeakMap,M(Nx,Ex,0);let nS=Nx;var gd,Pb,Tb,Ib,Rb;class bL{constructor(e,t,i=!1,r=null){M(this,gd,Promise.withResolvers());M(this,Pb,[]);M(this,Tb,[]);M(this,Ib,[]);M(this,Rb,[]);this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=r}addRangeListener(e){h(this,Rb).push(e)}addProgressListener(e){h(this,Ib).push(e)}addProgressiveReadListener(e){h(this,Tb).push(e)}addProgressiveDoneListener(e){h(this,Pb).push(e)}onDataRange(e,t){for(const i of h(this,Rb))i(e,t)}onDataProgress(e,t){h(this,gd).promise.then(()=>{for(const i of h(this,Ib))i(e,t)})}onDataProgressiveRead(e){h(this,gd).promise.then(()=>{for(const t of h(this,Tb))t(e)})}onDataProgressiveDone(){h(this,gd).promise.then(()=>{for(const e of h(this,Pb))e()})}transportReady(){h(this,gd).resolve()}requestDataRange(e,t){Sn("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}gd=new WeakMap,Pb=new WeakMap,Tb=new WeakMap,Ib=new WeakMap,Rb=new WeakMap;class MQ{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Wt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var tl,bd,ig;class jQ{constructor(e,t,i,r=!1){M(this,bd);M(this,tl,!1);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=r?new FT:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new dL,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:r=0,dontFlip:s=!1}={}){return new Sy({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Wt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:i,intent:r="display",annotationMode:s=Gl.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:p=null,isEditing:m=!1}){var A,N;(A=this._stats)==null||A.time("Overall");const g=this._transport.getRenderingIntent(r,s,p,m),{renderingIntent:y,cacheKey:v}=g;_(this,tl,!1),l||(l=this._transport.getOptionalContentConfig(y));let w=this._intentStates.get(v);w||(w=Object.create(null),this._intentStates.set(v,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const k=!!(y&ks.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(N=this._stats)==null||N.time("Page Request"),this._pumpOperatorList(g));const S=R=>{var V;w.renderTasks.delete(E),k&&_(this,tl,!0),j(this,bd,ig).call(this),R?(E.capability.reject(R),this._abortOperatorList({intentState:w,reason:R instanceof Error?R:new Error(R)})):E.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(V=globalThis.Stats)!=null&&V.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},E=new iS({callback:S,params:{canvas:t,canvasContext:e,viewport:i,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:u,enableHWA:this._transport.enableHWA});(w.renderTasks||(w.renderTasks=new Set)).add(E);const P=E.task;return Promise.all([w.displayReadyCapability.promise,l]).then(([R,V])=>{var B;if(this.destroyed){S();return}if((B=this._stats)==null||B.time("Rendering"),!(V.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");E.initializeGraphics({transparency:R,optionalContentConfig:V}),E.operatorListChanged()}).catch(S),P}getOperatorList({intent:e="display",annotationMode:t=Gl.ENABLE,printAnnotationStorage:i=null,isEditing:r=!1}={}){var c;function s(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,i,r,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Tg.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,r){function s(){a.read().then(function({value:l,done:c}){if(c){i(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),s()},r)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),_(this,tl,!1),Promise.all(e)}cleanup(e=!1){_(this,tl,!0);const t=j(this,bd,ig).call(this);return e&&t&&this._stats&&(this._stats=new FT),t}_startRenderPage(e,t){var r,s;const i=this._intentStates.get(t);i&&((r=this._stats)==null||r.timeEnd("Page Request"),(s=i.displayReadyCapability)==null||s.resolve(e))}_renderPageChunk(e,t){for(let i=0,r=e.length;i<r;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&j(this,bd,ig).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:r}){const{map:s,transfer:a}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:r},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const u=()=>{l.read().then(({value:p,done:m})=>{if(m){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,c),u())},p=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const m of c.renderTasks)m.operatorListChanged();j(this,bd,ig).call(this)}if(c.displayReadyCapability)c.displayReadyCapability.reject(p);else if(c.opListReadCapability)c.opListReadCapability.reject(p);else throw p}})};u()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof ZE){let r=RQ;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new Xc(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,s]of this._intentStates)if(s===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}tl=new WeakMap,bd=new WeakSet,ig=function(){if(!h(this,tl)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),_(this,tl,!1),!0};var Ec,ma,nl,yd,_x,vd,xd,Ir,m0,yL,vL,rg,pf,g0;const Fn=class Fn{constructor({name:e=null,port:t=null,verbosity:i=wK()}={}){M(this,Ir);M(this,Ec,Promise.withResolvers());M(this,ma,null);M(this,nl,null);M(this,yd,null);if(this.name=e,this.destroyed=!1,this.verbosity=i,t){if(h(Fn,xd).has(t))throw new Error("Cannot use more than one PDFWorker per port.");h(Fn,xd).set(t,this),j(this,Ir,yL).call(this,t)}else j(this,Ir,vL).call(this)}get promise(){return h(this,Ec).promise}get port(){return h(this,nl)}get messageHandler(){return h(this,ma)}destroy(){var e,t;this.destroyed=!0,(e=h(this,yd))==null||e.terminate(),_(this,yd,null),h(Fn,xd).delete(h(this,nl)),_(this,nl,null),(t=h(this,ma))==null||t.destroy(),_(this,ma,null)}static create(e){const t=h(this,xd).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Fn(e)}static get workerSrc(){if(fo.workerSrc)return fo.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Wt(this,"_setupFakeWorkerGlobal",(async()=>h(this,pf,g0)?h(this,pf,g0):(await import(this.workerSrc)).WorkerMessageHandler)())}};Ec=new WeakMap,ma=new WeakMap,nl=new WeakMap,yd=new WeakMap,_x=new WeakMap,vd=new WeakMap,xd=new WeakMap,Ir=new WeakSet,m0=function(){h(this,Ec).resolve(),h(this,ma).send("configure",{verbosity:this.verbosity})},yL=function(e){_(this,nl,e),_(this,ma,new Jm("main","worker",e)),h(this,ma).on("ready",()=>{}),j(this,Ir,m0).call(this)},vL=function(){if(h(Fn,vd)||h(Fn,pf,g0)){j(this,Ir,rg).call(this);return}let{workerSrc:e}=Fn;try{Fn._isSameOrigin(window.location,e)||(e=Fn._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new Jm("main","worker",t),r=()=>{s.abort(),i.destroy(),t.terminate(),this.destroyed?h(this,Ec).reject(new Error("Worker was destroyed")):j(this,Ir,rg).call(this)},s=new AbortController;t.addEventListener("error",()=>{h(this,yd)||r()},{signal:s.signal}),i.on("test",o=>{if(s.abort(),this.destroyed||!o){r();return}_(this,ma,i),_(this,nl,t),_(this,yd,t),j(this,Ir,m0).call(this)}),i.on("ready",o=>{if(s.abort(),this.destroyed){r();return}try{a()}catch{j(this,Ir,rg).call(this)}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{tw("The worker has been disabled.")}j(this,Ir,rg).call(this)},rg=function(){h(Fn,vd)||(At("Setting up fake worker."),_(Fn,vd,!0)),Fn._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){h(this,Ec).reject(new Error("Worker was destroyed"));return}const t=new qK;_(this,nl,t);const i=`fake${Ti(Fn,_x)._++}`,r=new Jm(i+"_worker",i,t);e.setup(r,t),_(this,ma,new Jm(i,i+"_worker",t)),j(this,Ir,m0).call(this)}).catch(e=>{h(this,Ec).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},pf=new WeakSet,g0=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},M(Fn,pf),M(Fn,_x,0),M(Fn,vd,!1),M(Fn,xd,new WeakMap),Cr&&(_(Fn,vd,!0),fo.workerSrc||(fo.workerSrc="./pdf.worker.mjs")),Fn._isSameOrigin=(e,t)=>{const i=URL.parse(e);if(!(i!=null&&i.origin)||i.origin==="null")return!1;const r=new URL(t,i);return i.origin===r.origin},Fn._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Fn.fromPort=e=>{if(RK("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Fn.create(e)};let Ig=Fn;var il,no,ff,mf,rl,wd,sg;class OQ{constructor(e,t,i,r,s,a){M(this,wd);M(this,il,new Map);M(this,no,new Map);M(this,ff,new Map);M(this,mf,new Map);M(this,rl,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new dL,this.fontLoader=new UK({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}get annotationStorage(){return Wt(this,"annotationStorage",new tN)}getRenderingIntent(e,t=Gl.ENABLE,i=null,r=!1,s=!1){let a=ks.DISPLAY,o=$D;switch(e){case"any":a=ks.ANY;break;case"display":break;case"print":a=ks.PRINT;break;default:At(`getRenderingIntent - invalid intent: ${e}`)}const l=a&ks.PRINT&&i instanceof XO?i:this.annotationStorage;switch(t){case Gl.DISABLE:a+=ks.ANNOTATIONS_DISABLE;break;case Gl.ENABLE:break;case Gl.ENABLE_FORMS:a+=ks.ANNOTATIONS_FORMS;break;case Gl.ENABLE_STORAGE:a+=ks.ANNOTATIONS_STORAGE,o=l.serializable;break;default:At(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(a+=ks.IS_EDITING),s&&(a+=ks.OPLIST);const{ids:c,hash:u}=l.modifiedIds,p=[a,o.hash,u];return{renderingIntent:a,cacheKey:p.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=h(this,rl))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const r of h(this,no).values())e.push(r._destroy());h(this,no).clear(),h(this,ff).clear(),h(this,mf).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var r,s;this.commonObjs.clear(),this.fontLoader.clear(),h(this,il).clear(),this.filterFactory.destroy(),Pg.cleanup(),(r=this._networkStream)==null||r.cancelAllRequests(new Xc("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,r)=>{fi(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},r.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){r.close();return}fi(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{r.error(s)})},r.onCancel=s=>{this._fullReader.cancel(s),r.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async i=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:s,contentLength:a}=this._fullReader;return(!r||!s)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:r,isRangeSupported:s,contentLength:a}}),e.on("GetRangeReader",(i,r)=>{fi(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(i.begin,i.end);if(!s){r.close();return}r.onPull=()=>{s.read().then(function({value:a,done:o}){if(o){r.close();return}fi(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{s.cancel(a),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new MQ(i,this))}),e.on("DocException",i=>{t._capability.reject(Ur(i))}),e.on("PasswordRequest",i=>{_(this,rl,Promise.withResolvers());try{if(!t.onPassword)throw Ur(i);const r=s=>{s instanceof Error?h(this,rl).reject(s):h(this,rl).resolve({password:s})};t.onPassword(r,i.code)}catch(r){h(this,rl).reject(r)}return h(this,rl).promise}),e.on("DataLoaded",i=>{var r;(r=t.onProgress)==null||r.call(t,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;h(this,no).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,r,s])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(r){case"Font":if("error"in s){const u=s.error;At(`Error during font loading: ${u}`),this.commonObjs.resolve(i,u);break}const o=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(u,p)=>globalThis.FontInspector.fontAdded(u,p):null,l=new zK(s,o);this.fontLoader.bind(l).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(i,l)});break;case"CopyLocalImage":const{imageRef:c}=s;fi(c,"The imageRef must be defined.");for(const u of h(this,no).values())for(const[,p]of u.objs)if((p==null?void 0:p.ref)===c)return p.dataLen?(this.commonObjs.resolve(i,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,s);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([i,r,s,a])=>{var l;if(this.destroyed)return;const o=h(this,no).get(r);if(!o.objs.has(i)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(s){case"Image":case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",i=>{var r;this.destroyed||(r=t.onProgress)==null||r.call(t,{loaded:i.loaded,total:i.total})}),e.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[i.type];if(!r)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&At("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=this._fullReader)==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=h(this,ff).get(t);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&h(this,mf).set(s.refStr,e);const a=new jQ(t,s,this,this._params.pdfBug);return h(this,no).set(t,a),a});return h(this,ff).set(t,r),r}getPageIndex(e){return WD(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return j(this,wd,sg).call(this,"GetFieldObjects")}hasJSActions(){return j(this,wd,sg).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return j(this,wd,sg).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return j(this,wd,sg).call(this,"GetOptionalContentConfig").then(t=>new fQ(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=h(this,il).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(r=>{var s,a;return{info:r[0],metadata:r[1]?new hQ(r[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return h(this,il).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of h(this,no).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),h(this,il).clear(),this.filterFactory.destroy(!0),Pg.cleanup()}}cachedPageNumber(e){if(!WD(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return h(this,mf).get(t)??null}}il=new WeakMap,no=new WeakMap,ff=new WeakMap,mf=new WeakMap,rl=new WeakMap,wd=new WeakSet,sg=function(e,t=null){const i=h(this,il).get(e);if(i)return i;const r=this.messageHandler.sendWithPromise(e,t);return h(this,il).set(e,r),r};var Nc;class LQ{constructor(e){M(this,Nc,null);Me(this,"onContinue",null);Me(this,"onError",null);_(this,Nc,e)}get promise(){return h(this,Nc).capability.promise}cancel(e=0){h(this,Nc).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=h(this,Nc).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=h(this,Nc);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Nc=new WeakMap;var _c,kd;const Mu=class Mu{constructor({callback:e,params:t,objs:i,commonObjs:r,annotationCanvasMap:s,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:p=!1,pageColors:m=null,enableHWA:g=!1}){M(this,_c,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=p,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new LQ(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=g}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,l;if(this.cancelled)return;if(this._canvas){if(h(Mu,kd).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");h(Mu,kd).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:r,background:s}=this.params,a=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new xp(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var i,r,s;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),h(this,_c)&&(window.cancelAnimationFrame(h(this,_c)),_(this,_c,null)),h(Mu,kd).delete(this._canvas),e||(e=new ZE(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(s=(r=this.task).onError)==null||s.call(r,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?_(this,_c,window.requestAnimationFrame(()=>{_(this,_c,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),h(Mu,kd).delete(this._canvas),this.callback())))}};_c=new WeakMap,kd=new WeakMap,M(Mu,kd,new WeakSet);let iS=Mu;const FQ="5.4.54",VQ="295fb3ec4";var ds,Dd,gf,Di,Mb,bf,sl,jb,Cc,ga,Ob,kn,rS,sS,aS,Cu,xL,Bl;const zr=class zr{constructor({editor:e=null,uiManager:t=null}){M(this,kn);M(this,ds,null);M(this,Dd,null);M(this,gf);M(this,Di,null);M(this,Mb,!1);M(this,bf,!1);M(this,sl,null);M(this,jb);M(this,Cc,null);M(this,ga,null);var i,r;e?(_(this,bf,!1),_(this,sl,e)):_(this,bf,!0),_(this,ga,(e==null?void 0:e._uiManager)||t),_(this,jb,h(this,ga)._eventBus),_(this,gf,((i=e==null?void 0:e.color)==null?void 0:i.toUpperCase())||((r=h(this,ga))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),h(zr,Ob)||_(zr,Ob,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Wt(this,"_keyboardManager",new Ey([[["Escape","mac+Escape"],zr.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],zr.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],zr.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],zr.prototype._moveToPrevious],[["Home","mac+Home"],zr.prototype._moveToBeginning],[["End","mac+End"],zr.prototype._moveToEnd]]))}renderButton(){const e=_(this,ds,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",h(this,sl)&&(e.ariaControls=`${h(this,sl).id}_colorpicker_dropdown`);const t=h(this,ga)._signal;e.addEventListener("click",j(this,kn,Cu).bind(this),{signal:t}),e.addEventListener("keydown",j(this,kn,aS).bind(this),{signal:t});const i=_(this,Dd,document.createElement("span"));return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=h(this,gf),e.append(i),e}renderMainDropdown(){const e=_(this,Di,j(this,kn,rS).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===h(this,ds)){j(this,kn,Cu).call(this,e);return}const t=e.target.getAttribute("data-color");t&&j(this,kn,sS).call(this,t,e)}_moveToNext(e){var t,i;if(!h(this,kn,Bl)){j(this,kn,Cu).call(this,e);return}if(e.target===h(this,ds)){(t=h(this,Di).firstChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=h(this,Di))==null?void 0:t.firstChild)||e.target===h(this,ds)){h(this,kn,Bl)&&this._hideDropdownFromKeyboard();return}h(this,kn,Bl)||j(this,kn,Cu).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!h(this,kn,Bl)){j(this,kn,Cu).call(this,e);return}(t=h(this,Di).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!h(this,kn,Bl)){j(this,kn,Cu).call(this,e);return}(t=h(this,Di).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=h(this,Di))==null||e.classList.add("hidden"),h(this,ds).ariaExpanded="false",(t=h(this,Cc))==null||t.abort(),_(this,Cc,null)}_hideDropdownFromKeyboard(){var e;if(!h(this,bf)){if(!h(this,kn,Bl)){(e=h(this,sl))==null||e.unselect();return}this.hideDropdown(),h(this,ds).focus({preventScroll:!0,focusVisible:h(this,Mb)})}}updateColor(e){if(h(this,Dd)&&(h(this,Dd).style.backgroundColor=e),!h(this,Di))return;const t=h(this,ga).highlightColors.values();for(const i of h(this,Di).children)i.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=h(this,ds))==null||e.remove(),_(this,ds,null),_(this,Dd,null),(t=h(this,Di))==null||t.remove(),_(this,Di,null)}};ds=new WeakMap,Dd=new WeakMap,gf=new WeakMap,Di=new WeakMap,Mb=new WeakMap,bf=new WeakMap,sl=new WeakMap,jb=new WeakMap,Cc=new WeakMap,ga=new WeakMap,Ob=new WeakMap,kn=new WeakSet,rS=function(){const e=document.createElement("div"),t=h(this,ga)._signal;e.addEventListener("contextmenu",ea,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),h(this,sl)&&(e.id=`${h(this,sl).id}_colorpicker_dropdown`);for(const[i,r]of h(this,ga).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",r),s.title=i,s.setAttribute("data-l10n-id",h(zr,Ob)[i]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=r,s.ariaSelected=r===h(this,gf),s.addEventListener("click",j(this,kn,sS).bind(this,r),{signal:t}),e.append(s)}return e.addEventListener("keydown",j(this,kn,aS).bind(this),{signal:t}),e},sS=function(e,t){t.stopPropagation(),h(this,jb).dispatch("switchannotationeditorparams",{source:this,type:Zt.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},aS=function(e){zr._keyboardManager.exec(this,e)},Cu=function(e){if(h(this,kn,Bl)){this.hideDropdown();return}if(_(this,Mb,e.detail===0),h(this,Cc)||(_(this,Cc,new AbortController),window.addEventListener("pointerdown",j(this,kn,xL).bind(this),{signal:h(this,ga).combinedSignal(h(this,Cc))})),h(this,ds).ariaExpanded="true",h(this,Di)){h(this,Di).classList.remove("hidden");return}const t=_(this,Di,j(this,kn,rS).call(this));h(this,ds).append(t)},xL=function(e){var t;(t=h(this,Di))!=null&&t.contains(e.target)||this.hideDropdown()},Bl=function(){return h(this,Di)&&!h(this,Di).classList.contains("hidden")},M(zr,Ob,null);let sx=zr;var io,Lb,yf,Fb;const ju=class ju{constructor(e){M(this,io,null);M(this,Lb,null);M(this,yf,null);_(this,Lb,e),_(this,yf,e._uiManager),h(ju,Fb)||_(ju,Fb,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(h(this,io))return h(this,io);const{editorType:e,colorType:t,colorValue:i}=h(this,Lb),r=_(this,io,document.createElement("input"));return r.type="color",r.value=i||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",h(ju,Fb)[e]),r.addEventListener("input",()=>{h(this,yf).updateParams(t,r.value)},{signal:h(this,yf)._signal}),r}update(e){h(this,io)&&(h(this,io).value=e)}destroy(){var e;(e=h(this,io))==null||e.remove(),_(this,io,null)}hideDropdown(){}};io=new WeakMap,Lb=new WeakMap,yf=new WeakMap,Fb=new WeakMap,M(ju,Fb,null);let ax=ju;function eI(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Mm(n){return Math.max(0,Math.min(255,255*n))}class tI{static CMYK_G([e,t,i,r]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Mm(e),[e,e,e]}static G_HTML([e]){const t=eI(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(Mm)}static RGB_HTML(e){return`#${e.map(eI).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,i+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,i,r]){return[Mm(1-Math.min(1,e+r)),Mm(1-Math.min(1,i+r)),Mm(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const r=1-e,s=1-t,a=1-i,o=Math.min(r,s,a);return["CMYK",r,s,a,o]}}class UQ{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),i||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Sn("Abstract method `_createSVG` called.")}}class ox extends UQ{_createSVG(e){return document.createElementNS(Io,e)}}class wL{static setupStorage(e,t,i,r,s){const a=r.getValue(t,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),s==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?e.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",o=>{r.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),s==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;r.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:r,linkService:s}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${r}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&s.addLinkAttributes(e,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(e,a.dataId,t,i)}static render(e){var p,m;const t=e.annotationStorage,i=e.linkService,r=e.xfaHtml,s=e.intent||"display",a=document.createElement(r.name);r.attributes&&this.setAttributes({html:a,element:r,intent:s,linkService:i});const o=s!=="richText",l=e.div;if(l.append(a),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=g}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(r.children.length===0){if(r.value){const g=document.createTextNode(r.value);a.append(g),o&&Tg.shouldBuildText(r.name)&&c.push(g)}return{textDivs:c}}const u=[[r,-1,a]];for(;u.length>0;){const[g,y,v]=u.at(-1);if(y+1===g.children.length){u.pop();continue}const w=g.children[++u.at(-1)[1]];if(w===null)continue;const{name:k}=w;if(k==="#text"){const E=document.createTextNode(w.value);c.push(E),v.append(E);continue}const S=(p=w==null?void 0:w.attributes)!=null&&p.xmlns?document.createElementNS(w.attributes.xmlns,k):document.createElement(k);if(v.append(S),w.attributes&&this.setAttributes({html:S,element:w,storage:t,intent:s,linkService:i}),((m=w.children)==null?void 0:m.length)>0)u.push([w,-1,S]);else if(w.value){const E=document.createTextNode(w.value);o&&Tg.shouldBuildText(k)&&c.push(E),S.append(E)}}for(const g of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const zQ=9,sh=new WeakSet,BQ=new Date().getTimezoneOffset()*60*1e3;class nI{static create(e){switch(e.data.annotationType){case ui.LINK:return new rN(e);case ui.TEXT:return new $Q(e);case ui.WIDGET:switch(e.data.fieldType){case"Tx":return new WQ(e);case"Btn":return e.data.radioButton?new SL(e):e.data.checkBox?new qQ(e):new GQ(e);case"Ch":return new YQ(e);case"Sig":return new HQ(e)}return new gh(e);case ui.POPUP:return new lS(e);case ui.FREETEXT:return new AL(e);case ui.LINE:return new KQ(e);case ui.SQUARE:return new QQ(e);case ui.CIRCLE:return new JQ(e);case ui.POLYLINE:return new PL(e);case ui.CARET:return new eJ(e);case ui.INK:return new sN(e);case ui.POLYGON:return new ZQ(e);case ui.HIGHLIGHT:return new TL(e);case ui.UNDERLINE:return new tJ(e);case ui.SQUIGGLY:return new nJ(e);case ui.STRIKEOUT:return new iJ(e);case ui.STAMP:return new IL(e);case ui.FILEATTACHMENT:return new rJ(e);default:return new ai(e)}}}var Sd,vf,al,Vb,oS;const jN=class jN{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:r=!1}={}){M(this,Vb);M(this,Sd,null);M(this,vf,!1);M(this,al,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return jN._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;e.rect&&(h(this,Sd)||_(this,Sd,{rect:this.data.rect.slice(0)}));const{rect:t,popup:i}=e;t&&j(this,Vb,oS).call(this,t);let r=((s=h(this,al))==null?void 0:s.popup)||this.popup;!r&&(i!=null&&i.text)&&(this._createPopup(i),r=h(this,al).popup),r&&(r.updateEdited(e),i!=null&&i.deleted&&(r.remove(),_(this,al,null),this.popup=null))}resetEdited(){var e;h(this,Sd)&&(j(this,Vb,oS).call(this,h(this,Sd).rect),(e=h(this,al))==null||e.popup.resetEdited(),_(this,Sd,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:r}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),!(this instanceof gh)&&!(this instanceof rN)&&(s.tabIndex=0);const{style:a}=s;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof lS){const{rotation:v}=t;return!t.hasOwnCanvas&&v!==0&&this.setRotation(v,s),s}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const v=t.borderStyle.horizontalCornerRadius,w=t.borderStyle.verticalCornerRadius;if(v>0||w>0){const S=`calc(${v}px * var(--total-scale-factor)) / calc(${w}px * var(--total-scale-factor))`;a.borderRadius=S}else if(this instanceof SL){const S=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=S}switch(t.borderStyle.style){case Zh.SOLID:a.borderStyle="solid";break;case Zh.DASHED:a.borderStyle="dashed";break;case Zh.BEVELED:At("Unimplemented border style: beveled");break;case Zh.INSET:At("Unimplemented border style: inset");break;case Zh.UNDERLINE:a.borderBottomStyle="solid";break}const k=t.borderColor||null;k?(_(this,vf,!0),a.borderColor=gt.makeHexColor(k[0]|0,k[1]|0,k[2]|0)):a.borderWidth=0}const c=gt.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:u,pageHeight:p,pageX:m,pageY:g}=r.rawDims;a.left=`${100*(c[0]-m)/u}%`,a.top=`${100*(c[1]-g)/p}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(a.width=`${100*o/u}%`,a.height=`${100*l/p}%`):this.setRotation(y,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:r}=this.parent.viewport.rawDims;let{width:s,height:a}=this;e%180!==0&&([s,a]=[a,s]),t.style.width=`${100*s/i}%`,t.style.height=`${100*a/r}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,r)=>{const s=r.detail[t],a=s[0],o=s.slice(1);r.target.style[i]=tI[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:tI[`${a}_rgb`](o)})};return Wt(this,"_commonActions",{display:t=>{const{display:i}=t.detail,r=i%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const r of Object.keys(t.detail)){const s=e[r]||i[r];s==null||s(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[r,s]of Object.entries(t)){const a=i[r];if(a){const o={detail:{[r]:s},target:e};a(o),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,r,s]=this.data.rect.map(v=>Math.fround(v));if(e.length===8){const[v,w,k,S]=e.subarray(2,6);if(r===v&&s===w&&t===k&&i===S)return}const{style:a}=this.container;let o;if(h(this,vf)){const{borderColor:v,borderWidth:w}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${v}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const l=r-t,c=s-i,{svgFactory:u}=this,p=u.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0),p.role="none";const m=u.createElement("defs");p.append(m);const g=u.createElement("clipPath"),y=`clippath_${this.data.id}`;g.setAttribute("id",y),g.setAttribute("clipPathUnits","objectBoundingBox"),m.append(g);for(let v=2,w=e.length;v<w;v+=8){const k=e[v],S=e[v+1],E=e[v+2],P=e[v+3],A=u.createElement("rect"),N=(E-t)/l,R=(s-S)/c,V=(k-E)/l,B=(S-P)/c;A.setAttribute("x",N),A.setAttribute("y",R),A.setAttribute("width",V),A.setAttribute("height",B),g.append(A),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${R}" width="${V}" height="${B}"/>`)}h(this,vf)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(p),this.container.style.clipPath=`url(#${y})`}_createPopup(e=null){const{data:t}=this;let i,r;e?(i={str:e.text},r=e.date):(i=t.contentsObj,r=t.modificationDate);const s=_(this,al,new lS({data:{color:t.color,titleObj:t.titleObj,modificationDate:r,contentsObj:i,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent.div.append(s.render())}get hasPopupElement(){return!!(h(this,al)||this.popup||this.data.popupRef)}render(){Sn("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:s,id:a,exportValues:o}of r){if(s===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!sh.has(c)){At(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:c})}return i}for(const r of document.getElementsByName(e)){const{exportValue:s}=r,a=r.getAttribute("data-element-id");a!==t&&sh.has(r)&&i.push({id:a,exportValue:s,domElement:r})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Sd=new WeakMap,vf=new WeakMap,al=new WeakMap,Vb=new WeakSet,oS=function(e){const{container:{style:t},data:{rect:i,rotation:r},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}}=this;i==null||i.splice(0,4,...e),t.left=`${100*(e[0]-o)/s}%`,t.top=`${100*(a-e[3]+l)/a}%`,r===0?(t.width=`${100*(e[2]-e[0])/s}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(r)};let ai=jN;var Ss,Au,kL,DL;class rN extends ai{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});M(this,Ss);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,r=document.createElement("a");r.setAttribute("data-element-id",t.id);let s=!1;return t.url?(i.addLinkAttributes(r,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(r,t.action,t.overlaidText),s=!0):t.attachment?(j(this,Ss,kL).call(this,r,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(j(this,Ss,DL).call(this,r,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(r,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,t),s=!0),t.resetForm?(this._bindResetFormAction(r,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(r,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(r),this.container}_bindLink(t,i,r=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&j(this,Ss,Au).call(this),r&&(t.title=r)}_bindNamedAction(t,i,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),r&&(t.title=r),j(this,Ss,Au).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(i.actions)){const a=r.get(s);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:s}}),!1})}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),j(this,Ss,Au).call(this)}_bindResetFormAction(t,i){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),j(this,Ss,Au).call(this),!this._fieldObjects){At('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{var p;r==null||r();const{fields:s,refs:a,include:o}=i,l=[];if(s.length!==0||a.length!==0){const m=new Set(a);for(const g of s){const y=this._fieldObjects[g]||[];for(const{id:v}of y)m.add(v)}for(const g of Object.values(this._fieldObjects))for(const y of g)m.has(y.id)===o&&l.push(y)}else for(const m of Object.values(this._fieldObjects))l.push(...m);const c=this.annotationStorage,u=[];for(const m of l){const{id:g}=m;switch(u.push(g),m.type){case"text":{const v=m.defaultValue||"";c.setValue(g,{value:v});break}case"checkbox":case"radiobutton":{const v=m.defaultValue===m.exportValues;c.setValue(g,{value:v});break}case"combobox":case"listbox":{const v=m.defaultValue||"";c.setValue(g,{value:v});break}default:continue}const y=document.querySelector(`[data-element-id="${g}"]`);if(y){if(!sh.has(y)){At(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}})),!1}}}Ss=new WeakSet,Au=function(){this.container.setAttribute("data-internal-link","")},kL=function(t,i,r="",s=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:r&&(t.title=r),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(i.content,i.filename,s),!1},j(this,Ss,Au).call(this)},DL=function(t,i,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),r&&(t.title=r),j(this,Ss,Au).call(this)};class $Q extends ai{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class gh extends ai{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return nr.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,r,s){i.includes("mouse")?e.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(i,a=>{var o;if(i==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}s&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(a)}}))})}_setEventListeners(e,t,i,r){var s,a,o;for(const[l,c]of i)(c==="Action"||(s=this.data.actions)!=null&&s[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,c,r),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":gt.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||zQ,s=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),u=Math.round(c/(Xk*r))||1,p=c/u;a=Math.min(r,l(p/Xk))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(r,l(c/Xk))}s.fontSize=`calc(${a}px * var(--total-scale-factor))`,s.color=gt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class WQ extends gh{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,r){const s=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=i),s.setValue(a.id,{[r]:i})}render(){var r,s;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((r=this.data.textContent)==null?void 0:r.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const u={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",c??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),sh.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:p,datetimeType:m,timeStep:g}=this.data,y=!!m&&this.enableScripting;p&&(i.title=p),this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",w=>{e.setValue(t,{value:w.target.value}),this.setPropertyOnSiblings(i,"value",w.target.value,"value"),u.formattedValue=null}),i.addEventListener("resetform",w=>{const k=this.data.defaultFieldValue??"";i.value=u.userValue=k,u.formattedValue=null});let v=w=>{const{formattedValue:k}=u;k!=null&&(w.target.value=k),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",k=>{var E;if(u.focused)return;const{target:S}=k;if(y&&(S.type=m,g&&(S.step=g)),u.userValue){const P=u.userValue;if(y)if(m==="time"){const A=new Date(P),N=[A.getHours(),A.getMinutes(),A.getSeconds()];S.value=N.map(R=>R.toString().padStart(2,"0")).join(":")}else S.value=new Date(P-BQ).toISOString().split(m==="date"?"T":".",1)[0];else S.value=P}u.lastCommittedValue=S.value,u.commitKey=1,(E=this.data.actions)!=null&&E.Focus||(u.focused=!0)}),i.addEventListener("updatefromsandbox",k=>{this.showElementAndHideCanvas(k.target);const S={value(E){u.userValue=E.detail.value??"",y||e.setValue(t,{value:u.userValue.toString()}),E.target.value=u.userValue},formattedValue(E){const{formattedValue:P}=E.detail;u.formattedValue=P,P!=null&&E.target!==document.activeElement&&(E.target.value=P);const A={formattedValue:P};y&&(A.value=P),e.setValue(t,A)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{var R;const{charLimit:P}=E.detail,{target:A}=E;if(P===0){A.removeAttribute("maxLength");return}A.setAttribute("maxLength",P);let N=u.userValue;!N||N.length<=P||(N=N.slice(0,P),A.value=u.userValue=N,e.setValue(t,{value:N}),(R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:N,willCommit:!0,commitKey:1,selStart:A.selectionStart,selEnd:A.selectionEnd}}))}};this._dispatchEventFromSandbox(S,k)}),i.addEventListener("keydown",k=>{var P;u.commitKey=1;let S=-1;if(k.key==="Escape"?S=0:k.key==="Enter"&&!this.data.multiLine?S=2:k.key==="Tab"&&(u.commitKey=3),S===-1)return;const{value:E}=k.target;u.lastCommittedValue!==E&&(u.lastCommittedValue=E,u.userValue=E,(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:S,selStart:k.target.selectionStart,selEnd:k.target.selectionEnd}}))});const w=v;v=null,i.addEventListener("blur",k=>{var P,A;if(!u.focused||!k.relatedTarget)return;(P=this.data.actions)!=null&&P.Blur||(u.focused=!1);const{target:S}=k;let{value:E}=S;if(y){if(E&&m==="time"){const N=E.split(":").map(R=>parseInt(R,10));E=new Date(2e3,0,1,N[0],N[1],N[2]||0).valueOf(),S.step=""}else E=new Date(E).valueOf();S.type="text"}u.userValue=E,u.lastCommittedValue!==E&&((A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:u.commitKey,selStart:k.target.selectionStart,selEnd:k.target.selectionEnd}})),w(k)}),(s=this.data.actions)!=null&&s.Keystroke&&i.addEventListener("beforeinput",k=>{var B;u.lastCommittedValue=null;const{data:S,target:E}=k,{value:P,selectionStart:A,selectionEnd:N}=E;let R=A,V=N;switch(k.inputType){case"deleteWordBackward":{const L=P.substring(0,A).match(/\w*[^\w]*$/);L&&(R-=L[0].length);break}case"deleteWordForward":{const L=P.substring(A).match(/^[^\w]*\w*/);L&&(V+=L[0].length);break}case"deleteContentBackward":A===N&&(R-=1);break;case"deleteContentForward":A===N&&(V+=1);break}k.preventDefault(),(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:P,change:S||"",willCommit:!1,selStart:R,selEnd:V}})}),this._setEventListeners(i,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],k=>k.target.value)}if(v&&i.addEventListener("blur",v),this.data.comb){const k=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${k}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class HQ extends gh{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class qQ extends gh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return sh.add(s),s.setAttribute("data-element-id",i),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=0,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i)){const u=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=u),e.setValue(c.id,{value:u})}e.setValue(i,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class SL extends gh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(i,{value:r})),r)for(const a of this._getElementsByName(t.fieldName,i))e.setValue(a.id,{value:!1});const s=document.createElement("input");if(sh.add(s),s.setAttribute("data-element-id",i),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i))e.setValue(c.id,{value:!1});e.setValue(i,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;s.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const u=a===c.detail.value;for(const p of this._getElementsByName(c.target.name)){const m=u&&p.id===i;p.domElement&&(p.domElement.checked=m),e.setValue(p.id,{value:m})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class GQ extends rN{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class YQ extends gh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");sh.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",u=>{const p=this.data.defaultFieldValue;for(const m of r.options)m.selected=m.value===p});for(const u of this.data.options){const p=document.createElement("option");p.textContent=u.displayValue,p.value=u.exportValue,i.value.includes(u.exportValue)&&(p.setAttribute("selected",!0),s=!1),r.append(p)}let a=null;if(s){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),r.prepend(u),a=()=>{u.remove(),r.removeEventListener("input",a),a=null},r.addEventListener("input",a)}const o=u=>{const p=u?"value":"textContent",{options:m,multiple:g}=r;return g?Array.prototype.filter.call(m,y=>y.selected).map(y=>y[p]):m.selectedIndex===-1?null:m[m.selectedIndex][p]};let l=o(!1);const c=u=>{const p=u.target.options;return Array.prototype.map.call(p,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",u=>{const p={value(m){a==null||a();const g=m.detail.value,y=new Set(Array.isArray(g)?g:[g]);for(const v of r.options)v.selected=y.has(v.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(m){r.multiple=!0},remove(m){const g=r.options,y=m.detail.remove;g[y].selected=!1,r.remove(y),g.length>0&&Array.prototype.findIndex.call(g,w=>w.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:o(!0),items:c(m)}),l=o(!1)},clear(m){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(m){const{index:g,displayValue:y,exportValue:v}=m.detail.insert,w=r.children[g],k=document.createElement("option");k.textContent=y,k.value=v,w?w.before(k):r.append(k),e.setValue(t,{value:o(!0),items:c(m)}),l=o(!1)},items(m){const{items:g}=m.detail;for(;r.length!==0;)r.remove(0);for(const y of g){const{displayValue:v,exportValue:w}=y,k=document.createElement("option");k.textContent=v,k.value=w,r.append(k)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(m)}),l=o(!1)},indices(m){const g=new Set(m.detail.indices);for(const y of m.target.options)y.selected=g.has(y.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(p,u)}),r.addEventListener("input",u=>{var g;const p=o(!0),m=o(!1);e.setValue(t,{value:p}),u.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:m,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):r.addEventListener("input",function(u){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class lS extends ai{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:ai._hasPopupData(t)}),this.elements=i,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new XQ({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),i=[];for(const r of this.elements)r.popup=t,r.container.ariaHasPopup="dialog",i.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(r=>`${JE}${r}`).join(",")),this.container}}var xf,Cx,Ax,wf,kf,Jn,ol,Ac,Df,Ub,Sf,ro,hs,Pc,ll,zb,cl,Ef,Ed,Tc,ln,b0,y0,cS,EL,NL,_L,CL,v0,x0,uS;class XQ{constructor({container:e,color:t,elements:i,titleObj:r,modificationDate:s,contentsObj:a,richText:o,parent:l,rect:c,parentRect:u,open:p}){M(this,ln);M(this,xf,j(this,ln,_L).bind(this));M(this,Cx,j(this,ln,uS).bind(this));M(this,Ax,j(this,ln,x0).bind(this));M(this,wf,j(this,ln,v0).bind(this));M(this,kf,null);M(this,Jn,null);M(this,ol,null);M(this,Ac,null);M(this,Df,null);M(this,Ub,null);M(this,Sf,null);M(this,ro,!1);M(this,hs,null);M(this,Pc,null);M(this,ll,null);M(this,zb,null);M(this,cl,null);M(this,Ef,null);M(this,Ed,null);M(this,Tc,!1);_(this,Jn,e),_(this,Ef,r),_(this,ol,a),_(this,cl,o),_(this,Ub,l),_(this,kf,t),_(this,zb,c),_(this,Sf,u),_(this,Df,i),_(this,Ac,nx.toDateObject(s)),this.trigger=i.flatMap(m=>m.getElementsToTriggerPopup()),j(this,ln,b0).call(this),h(this,Jn).hidden=!0,p&&j(this,ln,v0).call(this)}render(){var r;if(h(this,hs))return;const e=_(this,hs,document.createElement("div"));if(e.className="popup",h(this,kf)){const s=e.style.outlineColor=gt.makeHexColor(...h(this,kf));e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const t=document.createElement("span");if(t.className="header",(r=h(this,Ef))!=null&&r.str){const s=document.createElement("span");s.className="title",t.append(s),{dir:s.dir,str:s.textContent}=h(this,Ef)}if(e.append(t),h(this,Ac)){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:h(this,Ac).valueOf()})),s.dateTime=h(this,Ac).toISOString(),t.append(s)}const i=h(this,ln,y0);if(i)wL.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(h(this,ol));e.append(s)}h(this,Jn).append(e)}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const r=e.split(/(?:\r\n?|\n)/);for(let s=0,a=r.length;s<a;++s){const o=r[s];i.append(document.createTextNode(o)),s<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:e,popup:t,deleted:i}){var r;if(i||t!=null&&t.deleted){this.remove();return}j(this,ln,b0).call(this),h(this,Ed)||_(this,Ed,{contentsObj:h(this,ol),richText:h(this,cl)}),e&&_(this,ll,null),t&&(_(this,cl,j(this,ln,NL).call(this,t.text)),_(this,Ac,nx.toDateObject(t.date)),_(this,ol,null)),(r=h(this,hs))==null||r.remove(),_(this,hs,null)}resetEdited(){var e;h(this,Ed)&&({contentsObj:Ti(this,ol)._,richText:Ti(this,cl)._}=h(this,Ed),_(this,Ed,null),(e=h(this,hs))==null||e.remove(),_(this,hs,null),_(this,ll,null))}remove(){var e,t;(e=h(this,Pc))==null||e.abort(),_(this,Pc,null),(t=h(this,hs))==null||t.remove(),_(this,hs,null),_(this,Tc,!1),_(this,ro,!1);for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){_(this,Tc,this.isVisible),h(this,Tc)&&(h(this,Jn).hidden=!0)}maybeShow(){j(this,ln,b0).call(this),h(this,Tc)&&(h(this,hs)||j(this,ln,x0).call(this),_(this,Tc,!1),h(this,Jn).hidden=!1)}get isVisible(){return h(this,Jn).hidden===!1}}xf=new WeakMap,Cx=new WeakMap,Ax=new WeakMap,wf=new WeakMap,kf=new WeakMap,Jn=new WeakMap,ol=new WeakMap,Ac=new WeakMap,Df=new WeakMap,Ub=new WeakMap,Sf=new WeakMap,ro=new WeakMap,hs=new WeakMap,Pc=new WeakMap,ll=new WeakMap,zb=new WeakMap,cl=new WeakMap,Ef=new WeakMap,Ed=new WeakMap,Tc=new WeakMap,ln=new WeakSet,b0=function(){var t;if(h(this,Pc))return;_(this,Pc,new AbortController);const{signal:e}=h(this,Pc);for(const i of this.trigger)i.addEventListener("click",h(this,wf),{signal:e}),i.addEventListener("mouseenter",h(this,Ax),{signal:e}),i.addEventListener("mouseleave",h(this,Cx),{signal:e}),i.classList.add("popupTriggerArea");for(const i of h(this,Df))(t=i.container)==null||t.addEventListener("keydown",h(this,xf),{signal:e})},y0=function(){const e=h(this,cl),t=h(this,ol);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&h(this,cl).html||null},cS=function(){var e,t,i;return((i=(t=(e=h(this,ln,y0))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},EL=function(){var e,t,i;return((i=(t=(e=h(this,ln,y0))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},NL=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:h(this,ln,EL),fontSize:h(this,ln,cS)?`calc(${h(this,ln,cS)}px * var(--total-scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:r});return i},_L=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&h(this,ro))&&j(this,ln,v0).call(this)},CL=function(){if(h(this,ll)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:r,pageY:s}}}=h(this,Ub);let a=!!h(this,Sf),o=a?h(this,Sf):h(this,zb);for(const y of h(this,Df))if(!o||gt.intersect(y.data.rect,o)!==null){o=y.data.rect,a=!0;break}const l=gt.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),u=a?o[2]-o[0]+5:0,p=l[0]+u,m=l[1];_(this,ll,[100*(p-r)/t,100*(m-s)/i]);const{style:g}=h(this,Jn);g.left=`${h(this,ll)[0]}%`,g.top=`${h(this,ll)[1]}%`},v0=function(){_(this,ro,!h(this,ro)),h(this,ro)?(j(this,ln,x0).call(this),h(this,Jn).addEventListener("click",h(this,wf)),h(this,Jn).addEventListener("keydown",h(this,xf))):(j(this,ln,uS).call(this),h(this,Jn).removeEventListener("click",h(this,wf)),h(this,Jn).removeEventListener("keydown",h(this,xf)))},x0=function(){h(this,hs)||this.render(),this.isVisible?h(this,ro)&&h(this,Jn).classList.add("focused"):(j(this,ln,CL).call(this),h(this,Jn).hidden=!1,h(this,Jn).style.zIndex=parseInt(h(this,Jn).style.zIndex)+1e3)},uS=function(){h(this,Jn).classList.remove("focused"),!(h(this,ro)||!this.isVisible)&&(h(this,Jn).hidden=!0,h(this,Jn).style.zIndex=parseInt(h(this,Jn).style.zIndex)-1e3)};class AL extends ai{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ct.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Bb;class KQ extends ai{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});M(this,Bb,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:r}=this,s=this.svgFactory.create(i,r,!0),a=_(this,Bb,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return h(this,Bb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Bb=new WeakMap;var $b;class QQ extends ai{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});M(this,$b,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:r}=this,s=this.svgFactory.create(i,r,!0),a=t.borderStyle.width,o=_(this,$b,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",r-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return h(this,$b)}addHighlightArea(){this.container.classList.add("highlightArea")}}$b=new WeakMap;var Wb;class JQ extends ai{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});M(this,Wb,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:r}=this,s=this.svgFactory.create(i,r,!0),a=t.borderStyle.width,o=_(this,Wb,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",r/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",r/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return h(this,Wb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Wb=new WeakMap;var Hb;class PL extends ai{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});M(this,Hb,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:r,popupRef:s},width:a,height:o}=this;if(!i)return this.container;const l=this.svgFactory.create(a,o,!0);let c=[];for(let p=0,m=i.length;p<m;p+=2){const g=i[p]-t[0],y=t[3]-i[p+1];c.push(`${g},${y}`)}c=c.join(" ");const u=_(this,Hb,this.svgFactory.createElement(this.svgElementName));return u.setAttribute("points",c),u.setAttribute("stroke-width",r.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),l.append(u),this.container.append(l),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return h(this,Hb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Hb=new WeakMap;class ZQ extends PL{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class eJ extends ai{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var qb,Nd,Gb,dS;class sN extends ai{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});M(this,Gb);M(this,qb,null);M(this,Nd,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ct.HIGHLIGHT:Ct.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:r,borderStyle:s,popupRef:a}}=this,{transform:o,width:l,height:c}=j(this,Gb,dS).call(this,i,t),u=this.svgFactory.create(l,c,!0),p=_(this,qb,this.svgFactory.createElement("svg:g"));u.append(p),p.setAttribute("stroke-width",s.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",o);for(let m=0,g=r.length;m<g;m++){const y=this.svgFactory.createElement(this.svgElementName);h(this,Nd).push(y),y.setAttribute("points",r[m].join(",")),p.append(y)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:r,rect:s}=t,a=h(this,qb);if(i>=0&&a.setAttribute("stroke-width",i||1),r)for(let o=0,l=h(this,Nd).length;o<l;o++)h(this,Nd)[o].setAttribute("points",r[o].join(","));if(s){const{transform:o,width:l,height:c}=j(this,Gb,dS).call(this,this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return h(this,Nd)}addHighlightArea(){this.container.classList.add("highlightArea")}}qb=new WeakMap,Nd=new WeakMap,Gb=new WeakSet,dS=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class TL extends ai{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ct.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class tJ extends ai{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class nJ extends ai{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class iJ extends ai{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class IL extends ai{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ct.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Yb,Xb,hS;class rJ extends ai{constructor(t){var r;super(t,{isRenderable:!0});M(this,Xb);M(this,Yb,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(r=this.linkService.eventBus)==null||r.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let r;i.hasAppearance||i.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),r.addEventListener("dblclick",j(this,Xb,hS).bind(this)),_(this,Yb,r);const{isMac:s}=nr.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&j(this,Xb,hS).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),t.append(r),t}getElementsToTriggerPopup(){return h(this,Yb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Yb=new WeakMap,Xb=new WeakSet,hS=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Kb,_d,Ic,Qb,tu,fS,mS;const ON=class ON{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:r,page:s,viewport:a,structTreeLayer:o}){M(this,tu);M(this,Kb,null);M(this,_d,null);M(this,Ic,new Map);M(this,Qb,null);this.div=e,_(this,Kb,t),_(this,_d,i),_(this,Qb,o||null),this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return h(this,Ic).size>0}async render(e){var a;const{annotations:t}=e,i=this.div;ih(i,this.viewport);const r=new Map,s={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new ox,annotationStorage:e.annotationStorage||new tN,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const l=o.annotationType===ui.POPUP;if(l){const p=r.get(o.id);if(!p)continue;s.elements=p}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;s.data=o;const c=nI.create(s);if(!c.isRenderable)continue;if(!l&&o.popupRef){const p=r.get(o.popupRef);p?p.push(c):r.set(o.popupRef,[c])}const u=c.render();o.hidden&&(u.style.visibility="hidden"),await j(this,tu,fS).call(this,u,o.id,s.elements),c._isEditable&&(h(this,Ic).set(c.data.id,c),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(c))}j(this,tu,mS).call(this)}async addLinkAnnotations(e,t){const i={data:null,layer:this.div,linkService:t,svgFactory:new ox,parent:this};for(const r of e){r.borderStyle||(r.borderStyle=ON._defaultBorderStyle),i.data=r;const s=nI.create(i);if(!s.isRenderable)continue;const a=s.render();await j(this,tu,fS).call(this,a,r.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,ih(t,{rotation:e.rotation}),j(this,tu,mS).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(h(this,Ic).values())}getEditableAnnotation(e){return h(this,Ic).get(e)}static get _defaultBorderStyle(){return Wt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Zh.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};Kb=new WeakMap,_d=new WeakMap,Ic=new WeakMap,Qb=new WeakMap,tu=new WeakSet,fS=async function(e,t,i){var o,l;const r=e.firstChild||e,s=r.id=`${JE}${t}`,a=await((o=h(this,Qb))==null?void 0:o.getAriaAttributes(s));if(a)for(const[c,u]of a)r.setAttribute(c,u);i?i.at(-1).container.after(e):(this.div.append(e),(l=h(this,Kb))==null||l.moveElementInDOM(this.div,e,r,!1))},mS=function(){var t;if(!h(this,_d))return;const e=this.div;for(const[i,r]of h(this,_d)){const s=e.querySelector(`[data-annotation-id="${i}"]`);if(!s)continue;r.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(r):a.classList.contains("annotationContent")?a.after(r):a.before(r):s.append(r);const o=h(this,Ic).get(i);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(i,s.id,r),o._hasNoCanvas=!1):o.canvas=r)}h(this,_d).clear()};let pS=ON;const $v=/\r\n?|\n/g;var Ws,ps,Jb,Cd,fs,mi,RL,ML,jL,w0,kl,k0,D0,OL,bS,LL;const An=class An extends In{constructor(t){super({...t,name:"freeTextEditor"});M(this,mi);M(this,Ws);M(this,ps,"");M(this,Jb,`${this.id}-editor`);M(this,Cd,null);M(this,fs);Me(this,"_colorPicker",null);_(this,Ws,t.color||An._defaultColor||In._defaultLineColor),_(this,fs,t.fontSize||An._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=An.prototype,i=a=>a.isEmpty(),r=rh.TRANSLATE_SMALL,s=rh.TRANSLATE_BIG;return Wt(this,"_keyboardManager",new Ey([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}]]))}static initialize(t,i){In.initialize(t,i);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Zt.FREETEXT_SIZE:An._defaultFontSize=i;break;case Zt.FREETEXT_COLOR:An._defaultColor=i;break}}updateParams(t,i){switch(t){case Zt.FREETEXT_SIZE:j(this,mi,RL).call(this,i);break;case Zt.FREETEXT_COLOR:j(this,mi,ML).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Zt.FREETEXT_SIZE,An._defaultFontSize],[Zt.FREETEXT_COLOR,An._defaultColor||In._defaultLineColor]]}get propertiesToUpdate(){return[[Zt.FREETEXT_SIZE,h(this,fs)],[Zt.FREETEXT_COLOR,h(this,Ws)]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new ax(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Zt.FREETEXT_COLOR}get colorValue(){return h(this,Ws)}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-An._internalPadding*t,-(An._internalPadding+h(this,fs))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),_(this,Cd,new AbortController);const t=this._uiManager.combinedSignal(h(this,Cd));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",h(this,Jb)),this._isDraggable=!0,(t=h(this,Cd))==null||t.abort(),_(this,Cd,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var i;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=h(this,ps),i=_(this,ps,j(this,mi,jL).call(this).trimEnd());if(t===i)return;const r=s=>{if(_(this,ps,s),!s){this.remove();return}j(this,mi,D0).call(this),this._uiManager.rebuild(this),j(this,mi,w0).call(this)};this.addCommands({cmd:()=>{r(i)},undo:()=>{r(t)},mustExec:!1}),j(this,mi,w0).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){An._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",h(this,Jb)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${h(this,fs)}px * var(--total-scale-factor))`,r.color=h(this,Ws),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[u,p]=this.pageDimensions,[m,g]=this.pageTranslation;let y,v;switch(this.rotation){case 0:y=t+(o[0]-m)/u,v=i+this.height-(o[1]-g)/p;break;case 90:y=t+(o[0]-m)/u,v=i-(o[1]-g)/p,[l,c]=[c,-l];break;case 180:y=t-this.width+(o[0]-m)/u,v=i-(o[1]-g)/p,[l,c]=[-l,-c];break;case 270:y=t+(o[0]-m-this.height*p)/u,v=i+(o[1]-g-this.width*u)/p,[l,c]=[-c,l];break}this.setAt(y*s,v*a,l,c)}else this._moveAfterPaste(t,i);j(this,mi,D0).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var y,v,w;const i=t.clipboardData||window.clipboardData,{types:r}=i;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const s=j(y=An,kl,bS).call(y,i.getData("text")||"").replaceAll($v,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,u=[],p=[];if(l.nodeType===Node.TEXT_NODE){const k=l.parentElement;if(p.push(l.nodeValue.slice(c).replaceAll($v,"")),k!==this.editorDiv){let S=u;for(const E of this.editorDiv.childNodes){if(E===k){S=p;continue}S.push(j(v=An,kl,k0).call(v,E))}}u.push(l.nodeValue.slice(0,c).replaceAll($v,""))}else if(l===this.editorDiv){let k=u,S=0;for(const E of this.editorDiv.childNodes)S++===c&&(k=p),k.push(j(w=An,kl,k0).call(w,E))}_(this,ps,`${u.join(`
`)}${s}${p.join(`
`)}`),j(this,mi,D0).call(this);const m=new Range;let g=Math.sumPrecise(u.map(k=>k.length));for(const{firstChild:k}of this.editorDiv.childNodes)if(k.nodeType===Node.TEXT_NODE){const S=k.nodeValue.length;if(g<=S){m.setStart(k,g),m.setEnd(k,g);break}g-=S}a.removeAllRanges(),a.addRange(m)}get contentDiv(){return this.editorDiv}static async deserialize(t,i,r){var o;let s=null;if(t instanceof AL){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:u,rotation:p,id:m,popupRef:g,contentsObj:y},textContent:v,textPosition:w,parent:{page:{pageNumber:k}}}=t;if(!v||v.length===0)return null;s=t={annotationType:Ct.FREETEXT,color:Array.from(c),fontSize:l,value:v.join(`
`),position:w,pageIndex:k-1,rect:u.slice(0),rotation:p,annotationElementId:m,id:m,deleted:!1,popupRef:g,comment:(y==null?void 0:y.str)||null}}const a=await super.deserialize(t,i,r);return _(a,fs,t.fontSize),_(a,Ws,gt.makeHexColor(...t.color)),_(a,ps,j(o=An,kl,bS).call(o,t.value)),a._initialData=s,t.comment&&a.setCommentData(t.comment),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=An._internalPadding*this.parentScale,r=this.getRect(i,i),s=In._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:h(this,Ws)),a={annotationType:Ct.FREETEXT,color:s,fontSize:h(this,fs),value:j(this,mi,OL).call(this),pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(a),t?(a.isCopy=!0,a):this.annotationElementId&&!j(this,mi,LL).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t),{style:r}=i;r.fontSize=`calc(${h(this,fs)}px * var(--total-scale-factor))`,r.color=h(this,Ws),i.replaceChildren();for(const o of h(this,ps).split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),i.append(l)}const s=An._internalPadding*this.parentScale,a={rect:this.getRect(s,s)};return a.popup=this.hasEditedComment?this.comment:{text:h(this,ps)},t.updateEdited(a),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Ws=new WeakMap,ps=new WeakMap,Jb=new WeakMap,Cd=new WeakMap,fs=new WeakMap,mi=new WeakSet,RL=function(t){const i=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-h(this,fs))*this.parentScale),_(this,fs,s),j(this,mi,w0).call(this)},r=h(this,fs);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Zt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ML=function(t){const i=s=>{var a;_(this,Ws,this.editorDiv.style.color=s),(a=this._colorPicker)==null||a.update(s)},r=h(this,Ws);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Zt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},jL=function(){var r;const t=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(j(r=An,kl,k0).call(r,s)),i=s);return t.join(`
`)},w0=function(){const[t,i]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),r=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=r.width/t,this.height=r.height/i):(this.width=r.height/t,this.height=r.width/i),this.fixAndSetPosition()},kl=new WeakSet,k0=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll($v,"")},D0=function(){if(this.editorDiv.replaceChildren(),!!h(this,ps))for(const t of h(this,ps).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},OL=function(){return h(this,ps).replaceAll(" "," ")},bS=function(t){return t.replaceAll(" "," ")},LL=function(t){const{value:i,fontSize:r,color:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==r||t.color.some((o,l)=>o!==s[l])||t.pageIndex!==a},M(An,kl),Me(An,"_freeTextDefaultContent",""),Me(An,"_internalPadding",0),Me(An,"_defaultColor",null),Me(An,"_defaultFontSize",10),Me(An,"_type","freetext"),Me(An,"_editorType",Ct.FREETEXT);let gS=An;class it{toSVGPath(){Sn("Abstract method `toSVGPath` must be implemented.")}get box(){Sn("Abstract getter `box` must be implemented.")}serialize(e,t){Sn("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,r,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*r,a[o+1]=i+e[o+1]*s;return a}static _rescaleAndSwap(e,t,i,r,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*r,a[o+1]=i+e[o]*s;return a}static _translate(e,t,i,r){r||(r=new Float32Array(e.length));for(let s=0,a=e.length;s<a;s+=2)r[s]=t+e[s],r[s+1]=i+e[s+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,r,s){switch(s){case 90:return[1-t/i,e/r];case 180:return[1-e/i,1-t/r];case 270:return[t/i,1-e/r];default:return[e/i,t/r]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,r,s,a){return[(e+5*i)/6,(t+5*r)/6,(5*i+s)/6,(5*r+a)/6,(i+s)/2,(r+a)/2]}}Me(it,"PRECISION",1e-4);var ms,ba,Nf,_f,so,$t,Ad,Pd,Zb,ey,Cf,Af,Rc,ty,Px,Tx,_i,ag,FL,VL,UL,zL,BL,$L;const Lo=class Lo{constructor({x:e,y:t},i,r,s,a,o=0){M(this,_i);M(this,ms);M(this,ba,[]);M(this,Nf);M(this,_f);M(this,so,[]);M(this,$t,new Float32Array(18));M(this,Ad);M(this,Pd);M(this,Zb);M(this,ey);M(this,Cf);M(this,Af);M(this,Rc,[]);_(this,ms,i),_(this,Af,s*r),_(this,_f,a),h(this,$t).set([NaN,NaN,NaN,NaN,e,t],6),_(this,Nf,o),_(this,ey,h(Lo,ty)*r),_(this,Zb,h(Lo,Tx)*r),_(this,Cf,r),h(this,Rc).push(e,t)}isEmpty(){return isNaN(h(this,$t)[8])}add({x:e,y:t}){var B;_(this,Ad,e),_(this,Pd,t);const[i,r,s,a]=h(this,ms);let[o,l,c,u]=h(this,$t).subarray(8,12);const p=e-c,m=t-u,g=Math.hypot(p,m);if(g<h(this,Zb))return!1;const y=g-h(this,ey),v=y/g,w=v*p,k=v*m;let S=o,E=l;o=c,l=u,c+=w,u+=k,(B=h(this,Rc))==null||B.push(e,t);const P=-k/y,A=w/y,N=P*h(this,Af),R=A*h(this,Af);return h(this,$t).set(h(this,$t).subarray(2,8),0),h(this,$t).set([c+N,u+R],4),h(this,$t).set(h(this,$t).subarray(14,18),12),h(this,$t).set([c-N,u-R],16),isNaN(h(this,$t)[6])?(h(this,so).length===0&&(h(this,$t).set([o+N,l+R],2),h(this,so).push(NaN,NaN,NaN,NaN,(o+N-i)/s,(l+R-r)/a),h(this,$t).set([o-N,l-R],14),h(this,ba).push(NaN,NaN,NaN,NaN,(o-N-i)/s,(l-R-r)/a)),h(this,$t).set([S,E,o,l,c,u],6),!this.isEmpty()):(h(this,$t).set([S,E,o,l,c,u],6),Math.abs(Math.atan2(E-l,S-o)-Math.atan2(k,w))<Math.PI/2?([o,l,c,u]=h(this,$t).subarray(2,6),h(this,so).push(NaN,NaN,NaN,NaN,((o+c)/2-i)/s,((l+u)/2-r)/a),[o,l,S,E]=h(this,$t).subarray(14,18),h(this,ba).push(NaN,NaN,NaN,NaN,((S+o)/2-i)/s,((E+l)/2-r)/a),!0):([S,E,o,l,c,u]=h(this,$t).subarray(0,6),h(this,so).push(((S+5*o)/6-i)/s,((E+5*l)/6-r)/a,((5*o+c)/6-i)/s,((5*l+u)/6-r)/a,((o+c)/2-i)/s,((l+u)/2-r)/a),[c,u,o,l,S,E]=h(this,$t).subarray(12,18),h(this,ba).push(((S+5*o)/6-i)/s,((E+5*l)/6-r)/a,((5*o+c)/6-i)/s,((5*l+u)/6-r)/a,((o+c)/2-i)/s,((l+u)/2-r)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=h(this,so),t=h(this,ba);if(isNaN(h(this,$t)[6])&&!this.isEmpty())return j(this,_i,FL).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?i.push(`L${e[r+4]} ${e[r+5]}`):i.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);j(this,_i,UL).call(this,i);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?i.push(`L${t[r+4]} ${t[r+5]}`):i.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return j(this,_i,VL).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,r,s,a){return new WL(e,t,i,r,s,a)}getOutlines(){var p;const e=h(this,so),t=h(this,ba),i=h(this,$t),[r,s,a,o]=h(this,ms),l=new Float32Array((((p=h(this,Rc))==null?void 0:p.length)??0)+2);for(let m=0,g=l.length-2;m<g;m+=2)l[m]=(h(this,Rc)[m]-r)/a,l[m+1]=(h(this,Rc)[m+1]-s)/o;if(l[l.length-2]=(h(this,Ad)-r)/a,l[l.length-1]=(h(this,Pd)-s)/o,isNaN(i[6])&&!this.isEmpty())return j(this,_i,zL).call(this,l);const c=new Float32Array(h(this,so).length+24+h(this,ba).length);let u=e.length;for(let m=0;m<u;m+=2){if(isNaN(e[m])){c[m]=c[m+1]=NaN;continue}c[m]=e[m],c[m+1]=e[m+1]}u=j(this,_i,$L).call(this,c,u);for(let m=t.length-6;m>=6;m-=6)for(let g=0;g<6;g+=2){if(isNaN(t[m+g])){c[u]=c[u+1]=NaN,u+=2;continue}c[u]=t[m+g],c[u+1]=t[m+g+1],u+=2}return j(this,_i,BL).call(this,c,u),this.newFreeDrawOutline(c,l,h(this,ms),h(this,Cf),h(this,Nf),h(this,_f))}};ms=new WeakMap,ba=new WeakMap,Nf=new WeakMap,_f=new WeakMap,so=new WeakMap,$t=new WeakMap,Ad=new WeakMap,Pd=new WeakMap,Zb=new WeakMap,ey=new WeakMap,Cf=new WeakMap,Af=new WeakMap,Rc=new WeakMap,ty=new WeakMap,Px=new WeakMap,Tx=new WeakMap,_i=new WeakSet,ag=function(){const e=h(this,$t).subarray(4,6),t=h(this,$t).subarray(16,18),[i,r,s,a]=h(this,ms);return[(h(this,Ad)+(e[0]-t[0])/2-i)/s,(h(this,Pd)+(e[1]-t[1])/2-r)/a,(h(this,Ad)+(t[0]-e[0])/2-i)/s,(h(this,Pd)+(t[1]-e[1])/2-r)/a]},FL=function(){const[e,t,i,r]=h(this,ms),[s,a,o,l]=j(this,_i,ag).call(this);return`M${(h(this,$t)[2]-e)/i} ${(h(this,$t)[3]-t)/r} L${(h(this,$t)[4]-e)/i} ${(h(this,$t)[5]-t)/r} L${s} ${a} L${o} ${l} L${(h(this,$t)[16]-e)/i} ${(h(this,$t)[17]-t)/r} L${(h(this,$t)[14]-e)/i} ${(h(this,$t)[15]-t)/r} Z`},VL=function(e){const t=h(this,ba);e.push(`L${t[4]} ${t[5]} Z`)},UL=function(e){const[t,i,r,s]=h(this,ms),a=h(this,$t).subarray(4,6),o=h(this,$t).subarray(16,18),[l,c,u,p]=j(this,_i,ag).call(this);e.push(`L${(a[0]-t)/r} ${(a[1]-i)/s} L${l} ${c} L${u} ${p} L${(o[0]-t)/r} ${(o[1]-i)/s}`)},zL=function(e){const t=h(this,$t),[i,r,s,a]=h(this,ms),[o,l,c,u]=j(this,_i,ag).call(this),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(t[2]-i)/s,(t[3]-r)/a,NaN,NaN,NaN,NaN,(t[4]-i)/s,(t[5]-r)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,(t[16]-i)/s,(t[17]-r)/a,NaN,NaN,NaN,NaN,(t[14]-i)/s,(t[15]-r)/a],0),this.newFreeDrawOutline(p,e,h(this,ms),h(this,Cf),h(this,Nf),h(this,_f))},BL=function(e,t){const i=h(this,ba);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},$L=function(e,t){const i=h(this,$t).subarray(4,6),r=h(this,$t).subarray(16,18),[s,a,o,l]=h(this,ms),[c,u,p,m]=j(this,_i,ag).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-s)/o,(i[1]-a)/l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(r[0]-s)/o,(r[1]-a)/l],t),t+=24},M(Lo,ty,8),M(Lo,Px,2),M(Lo,Tx,h(Lo,ty)+h(Lo,Px));let lx=Lo;var Pf,Td,ul,ny,gs,iy,ri,Ix,HL;class WL extends it{constructor(t,i,r,s,a,o){super();M(this,Ix);M(this,Pf);M(this,Td,new Float32Array(4));M(this,ul);M(this,ny);M(this,gs);M(this,iy);M(this,ri);_(this,ri,t),_(this,gs,i),_(this,Pf,r),_(this,iy,s),_(this,ul,a),_(this,ny,o),this.lastPoint=[NaN,NaN],j(this,Ix,HL).call(this,o);const[l,c,u,p]=h(this,Td);for(let m=0,g=t.length;m<g;m+=2)t[m]=(t[m]-l)/u,t[m+1]=(t[m+1]-c)/p;for(let m=0,g=i.length;m<g;m+=2)i[m]=(i[m]-l)/u,i[m+1]=(i[m+1]-c)/p}toSVGPath(){const t=[`M${h(this,ri)[4]} ${h(this,ri)[5]}`];for(let i=6,r=h(this,ri).length;i<r;i+=6){if(isNaN(h(this,ri)[i])){t.push(`L${h(this,ri)[i+4]} ${h(this,ri)[i+5]}`);continue}t.push(`C${h(this,ri)[i]} ${h(this,ri)[i+1]} ${h(this,ri)[i+2]} ${h(this,ri)[i+3]} ${h(this,ri)[i+4]} ${h(this,ri)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,r,s],a){const o=r-t,l=s-i;let c,u;switch(a){case 0:c=it._rescale(h(this,ri),t,s,o,-l),u=it._rescale(h(this,gs),t,s,o,-l);break;case 90:c=it._rescaleAndSwap(h(this,ri),t,i,o,l),u=it._rescaleAndSwap(h(this,gs),t,i,o,l);break;case 180:c=it._rescale(h(this,ri),r,i,-o,l),u=it._rescale(h(this,gs),r,i,-o,l);break;case 270:c=it._rescaleAndSwap(h(this,ri),r,s,-o,-l),u=it._rescaleAndSwap(h(this,gs),r,s,-o,-l);break}return{outline:Array.from(c),points:[Array.from(u)]}}get box(){return h(this,Td)}newOutliner(t,i,r,s,a,o=0){return new lx(t,i,r,s,a,o)}getNewOutline(t,i){const[r,s,a,o]=h(this,Td),[l,c,u,p]=h(this,Pf),m=a*u,g=o*p,y=r*u+l,v=s*p+c,w=this.newOutliner({x:h(this,gs)[0]*m+y,y:h(this,gs)[1]*g+v},h(this,Pf),h(this,iy),t,h(this,ny),i??h(this,ul));for(let k=2;k<h(this,gs).length;k+=2)w.add({x:h(this,gs)[k]*m+y,y:h(this,gs)[k+1]*g+v});return w.getOutlines()}}Pf=new WeakMap,Td=new WeakMap,ul=new WeakMap,ny=new WeakMap,gs=new WeakMap,iy=new WeakMap,ri=new WeakMap,Ix=new WeakSet,HL=function(t){const i=h(this,ri);let r=i[4],s=i[5];const a=[r,s,r,s];let o=r,l=s;const c=t?Math.max:Math.min;for(let p=6,m=i.length;p<m;p+=6){const g=i[p+4],y=i[p+5];if(isNaN(i[p]))gt.pointBoundingBox(g,y,a),l<y?(o=g,l=y):l===y&&(o=c(o,g));else{const v=[1/0,1/0,-1/0,-1/0];gt.bezierBoundingBox(r,s,...i.slice(p,p+6),v),gt.rectBoundingBox(...v,a),l<v[3]?(o=v[2],l=v[3]):l===v[3]&&(o=c(o,v[2]))}r=g,s=y}const u=h(this,Td);u[0]=a[0]-h(this,ul),u[1]=a[1]-h(this,ul),u[2]=a[2]-a[0]+2*h(this,ul),u[3]=a[3]-a[1]+2*h(this,ul),this.lastPoint=[o,l]};var ry,sy,Mc,ya,Rr,qL,S0,GL,YL,vS;class yS{constructor(e,t=0,i=0,r=!0){M(this,Rr);M(this,ry);M(this,sy);M(this,Mc,[]);M(this,ya,[]);const s=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:g,y,width:v,height:w}of e){const k=Math.floor((g-t)/a)*a,S=Math.ceil((g+v+t)/a)*a,E=Math.floor((y-t)/a)*a,P=Math.ceil((y+w+t)/a)*a,A=[k,E,P,!0],N=[S,E,P,!1];h(this,Mc).push(A,N),gt.rectBoundingBox(k,E,S,P,s)}const o=s[2]-s[0]+2*i,l=s[3]-s[1]+2*i,c=s[0]-i,u=s[1]-i,p=h(this,Mc).at(r?-1:-2),m=[p[0],p[2]];for(const g of h(this,Mc)){const[y,v,w]=g;g[0]=(y-c)/o,g[1]=(v-u)/l,g[2]=(w-u)/l}_(this,ry,new Float32Array([c,u,o,l])),_(this,sy,m)}getOutlines(){h(this,Mc).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of h(this,Mc))t[3]?(e.push(...j(this,Rr,vS).call(this,t)),j(this,Rr,GL).call(this,t)):(j(this,Rr,YL).call(this,t),e.push(...j(this,Rr,vS).call(this,t)));return j(this,Rr,qL).call(this,e)}}ry=new WeakMap,sy=new WeakMap,Mc=new WeakMap,ya=new WeakMap,Rr=new WeakSet,qL=function(e){const t=[],i=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),i.add(l),i.add(c)}const r=[];let s;for(;i.size>0;){const a=i.values().next().value;let[o,l,c,u,p]=a;i.delete(a);let m=o,g=l;for(s=[o,c],r.push(s);;){let y;if(i.has(u))y=u;else if(i.has(p))y=p;else break;i.delete(y),[o,l,c,u,p]=y,m!==o&&(s.push(m,g,o,g===l?l:c),m=o),g=g===l?c:l}s.push(m,g)}return new sJ(r,h(this,ry),h(this,sy))},S0=function(e){const t=h(this,ya);let i=0,r=t.length-1;for(;i<=r;){const s=i+r>>1,a=t[s][0];if(a===e)return s;a<e?i=s+1:r=s-1}return r+1},GL=function([,e,t]){const i=j(this,Rr,S0).call(this,e);h(this,ya).splice(i,0,[e,t])},YL=function([,e,t]){const i=j(this,Rr,S0).call(this,e);for(let r=i;r<h(this,ya).length;r++){const[s,a]=h(this,ya)[r];if(s!==e)break;if(s===e&&a===t){h(this,ya).splice(r,1);return}}for(let r=i-1;r>=0;r--){const[s,a]=h(this,ya)[r];if(s!==e)break;if(s===e&&a===t){h(this,ya).splice(r,1);return}}},vS=function(e){const[t,i,r]=e,s=[[t,i,r]],a=j(this,Rr,S0).call(this,r);for(let o=0;o<a;o++){const[l,c]=h(this,ya)[o];for(let u=0,p=s.length;u<p;u++){const[,m,g]=s[u];if(!(c<=m||g<=l)){if(m>=l){if(g>c)s[u][1]=c;else{if(p===1)return[];s.splice(u,1),u--,p--}continue}s[u][2]=l,g>c&&s.push([t,c,g])}}}return s};var ay,Tf;class sJ extends it{constructor(t,i,r){super();M(this,ay);M(this,Tf);_(this,Tf,t),_(this,ay,i),this.lastPoint=r}toSVGPath(){const t=[];for(const i of h(this,Tf)){let[r,s]=i;t.push(`M${r} ${s}`);for(let a=2;a<i.length;a+=2){const o=i[a],l=i[a+1];o===r?(t.push(`V${l}`),s=l):l===s&&(t.push(`H${o}`),r=o)}t.push("Z")}return t.join(" ")}serialize([t,i,r,s],a){const o=[],l=r-t,c=s-i;for(const u of h(this,Tf)){const p=new Array(u.length);for(let m=0;m<u.length;m+=2)p[m]=t+u[m]*l,p[m+1]=s-u[m+1]*c;o.push(p)}return o}get box(){return h(this,ay)}get classNamesForOutlining(){return["highlightOutline"]}}ay=new WeakMap,Tf=new WeakMap;class xS extends lx{newFreeDrawOutline(e,t,i,r,s,a){return new aJ(e,t,i,r,s,a)}}class aJ extends WL{newOutliner(e,t,i,r,s,a=0){return new xS(e,t,i,r,s,a)}}var If,oy,dl,Id,ly,qr,cy,uy,Rd,Hs,bs,Xi,Rf,hl,hr,Mf,qs,dy,Rt,wS,E0,XL,KL,QL,kS,Pu,Ks,sp,JL,N0,og,ZL,eF,tF,nF,iF;const un=class un extends In{constructor(t){super({...t,name:"highlightEditor"});M(this,Rt);M(this,If,null);M(this,oy,0);M(this,dl);M(this,Id,null);M(this,ly,null);M(this,qr,null);M(this,cy,null);M(this,uy,0);M(this,Rd,null);M(this,Hs,null);M(this,bs,null);M(this,Xi,!1);M(this,Rf,null);M(this,hl);M(this,hr,null);M(this,Mf,"");M(this,qs);M(this,dy,"");this.color=t.color||un._defaultColor,_(this,qs,t.thickness||un._defaultThickness),_(this,hl,t.opacity||un._defaultOpacity),_(this,dl,t.boxes||null),_(this,dy,t.methodOfCreation||""),_(this,Mf,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(_(this,Xi,!0),j(this,Rt,E0).call(this,t),j(this,Rt,Pu).call(this)):h(this,dl)&&(_(this,If,t.anchorNode),_(this,oy,t.anchorOffset),_(this,cy,t.focusNode),_(this,uy,t.focusOffset),j(this,Rt,wS).call(this),j(this,Rt,Pu).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=un.prototype;return Wt(this,"_keyboardManager",new Ey([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:h(this,Xi)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:h(this,qs),methodOfCreation:h(this,dy)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var r;In.initialize(t,i),un._defaultColor||(un._defaultColor=((r=i.highlightColors)==null?void 0:r.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case Zt.HIGHLIGHT_COLOR:un._defaultColor=i;break;case Zt.HIGHLIGHT_THICKNESS:un._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return h(this,Rf)}updateParams(t,i){switch(t){case Zt.HIGHLIGHT_COLOR:j(this,Rt,XL).call(this,i);break;case Zt.HIGHLIGHT_THICKNESS:j(this,Rt,KL).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Zt.HIGHLIGHT_COLOR,un._defaultColor],[Zt.HIGHLIGHT_THICKNESS,un._defaultThickness]]}get propertiesToUpdate(){return[[Zt.HIGHLIGHT_COLOR,this.color||un._defaultColor],[Zt.HIGHLIGHT_THICKNESS,h(this,qs)||un._defaultThickness],[Zt.HIGHLIGHT_FREE,h(this,Xi)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",_(this,ly,new sx({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(j(this,Rt,og).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,j(this,Rt,og).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){j(this,Rt,kS).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(j(this,Rt,Pu).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let i=!1;this.parent&&!t?j(this,Rt,kS).call(this):t&&(j(this,Rt,Pu).call(this,t),i=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var s,a,o;const{drawLayer:i}=this.parent;let r;h(this,Xi)?(t=(t-this.rotation+360)%360,r=j(s=un,Ks,sp).call(s,h(this,Hs).box,t)):r=j(a=un,Ks,sp).call(a,[this.x,this.y,this.width,this.height],t),i.updateProperties(h(this,bs),{bbox:r,root:{"data-main-rotation":t}}),i.updateProperties(h(this,hr),{bbox:j(o=un,Ks,sp).call(o,h(this,qr).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();h(this,Mf)&&(t.setAttribute("aria-label",h(this,Mf)),t.setAttribute("role","mark")),h(this,Xi)?t.classList.add("free"):this.div.addEventListener("keydown",j(this,Rt,JL).bind(this),{signal:this._uiManager._signal});const i=_(this,Rd,document.createElement("div"));t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=h(this,Id);const[r,s]=this.parentDimensions;return this.setDims(this.width*r,this.height*s),DO(this,h(this,Rd),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(h(this,hr),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(h(this,hr),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:j(this,Rt,N0).call(this,!0);break;case 1:case 3:j(this,Rt,N0).call(this,!1);break}}select(){var t;super.select(),h(this,hr)&&((t=this.parent)==null||t.drawLayer.updateProperties(h(this,hr),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),h(this,hr)&&((t=this.parent)==null||t.drawLayer.updateProperties(h(this,hr),{rootClass:{selected:!1}}),h(this,Xi)||j(this,Rt,N0).call(this,!1))}get _mustFixPosition(){return!h(this,Xi)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(h(this,bs),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(h(this,hr),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:r,x:s,y:a}){const{x:o,y:l,width:c,height:u}=r.getBoundingClientRect(),p=new AbortController,m=t.combinedSignal(p),g=y=>{p.abort(),j(this,Ks,nF).call(this,t,y)};window.addEventListener("blur",g,{signal:m}),window.addEventListener("pointerup",g,{signal:m}),window.addEventListener("pointerdown",hi,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",ea,{signal:m}),r.addEventListener("pointermove",j(this,Ks,tF).bind(this,t),{signal:m}),this._freeHighlight=new xS({x:s,y:a},[o,l,c,u],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,r){var v,w,k,S;let s=null;if(t instanceof TL){const{data:{quadPoints:E,rect:P,rotation:A,id:N,color:R,opacity:V,popupRef:B,contentsObj:L},parent:{page:{pageNumber:W}}}=t;s=t={annotationType:Ct.HIGHLIGHT,color:Array.from(R),opacity:V,quadPoints:E,boxes:null,pageIndex:W-1,rect:P.slice(0),rotation:A,annotationElementId:N,id:N,deleted:!1,popupRef:B,comment:(L==null?void 0:L.str)||null}}else if(t instanceof sN){const{data:{inkLists:E,rect:P,rotation:A,id:N,color:R,borderStyle:{rawWidth:V},popupRef:B,contentsObj:L},parent:{page:{pageNumber:W}}}=t;s=t={annotationType:Ct.HIGHLIGHT,color:Array.from(R),thickness:V,inkLists:E,boxes:null,pageIndex:W-1,rect:P.slice(0),rotation:A,annotationElementId:N,id:N,deleted:!1,popupRef:B,comment:(L==null?void 0:L.str)||null}}const{color:a,quadPoints:o,inkLists:l,opacity:c}=t,u=await super.deserialize(t,i,r);u.color=gt.makeHexColor(...a),_(u,hl,c||1),l&&_(u,qs,t.thickness),u._initialData=s,t.comment&&u.setCommentData(t.comment);const[p,m]=u.pageDimensions,[g,y]=u.pageTranslation;if(o){const E=_(u,dl,[]);for(let P=0;P<o.length;P+=8)E.push({x:(o[P]-g)/p,y:1-(o[P+1]-y)/m,width:(o[P+2]-o[P])/p,height:(o[P+1]-o[P+5])/m});j(v=u,Rt,wS).call(v),j(w=u,Rt,Pu).call(w),u.rotate(u.rotation)}else if(l){_(u,Xi,!0);const E=l[0],P={x:E[0]-g,y:m-(E[1]-y)},A=new xS(P,[0,0,p,m],1,h(u,qs)/2,!0,.001);for(let V=0,B=E.length;V<B;V+=2)P.x=E[V]-g,P.y=m-(E[V+1]-y),A.add(P);const{id:N,clipPathId:R}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:A.toSVGPath()}},!0,!0);j(k=u,Rt,E0).call(k,{highlightOutlines:A.getOutlines(),highlightId:N,clipPathId:R}),j(S=u,Rt,Pu).call(S),u.rotate(u.parentRotation)}return u}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),r=In._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s={annotationType:Ct.HIGHLIGHT,color:r,opacity:h(this,hl),thickness:h(this,qs),quadPoints:j(this,Rt,ZL).call(this),outlines:j(this,Rt,eF).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:j(this,Rt,og).call(this),structTreeParentId:this._structTreeParentId};return this.addComment(s),this.annotationElementId&&!j(this,Rt,iF).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){const i={rect:this.getRect(0,0)};return this.hasEditedComment&&(i.popup=this.comment),t.updateEdited(i),null}static canCreateNewEmptyEditor(){return!1}};If=new WeakMap,oy=new WeakMap,dl=new WeakMap,Id=new WeakMap,ly=new WeakMap,qr=new WeakMap,cy=new WeakMap,uy=new WeakMap,Rd=new WeakMap,Hs=new WeakMap,bs=new WeakMap,Xi=new WeakMap,Rf=new WeakMap,hl=new WeakMap,hr=new WeakMap,Mf=new WeakMap,qs=new WeakMap,dy=new WeakMap,Rt=new WeakSet,wS=function(){const t=new yS(h(this,dl),.001);_(this,Hs,t.getOutlines()),[this.x,this.y,this.width,this.height]=h(this,Hs).box;const i=new yS(h(this,dl),.0025,.001,this._uiManager.direction==="ltr");_(this,qr,i.getOutlines());const{lastPoint:r}=h(this,qr);_(this,Rf,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},E0=function({highlightOutlines:t,highlightId:i,clipPathId:r}){var p,m;if(_(this,Hs,t),_(this,qr,t.getNewOutline(h(this,qs)/2+1.5,.0025)),i>=0)_(this,bs,i),_(this,Id,r),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),_(this,hr,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:h(this,qr).box,path:{d:h(this,qr).toSVGPath()}},!0));else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(h(this,bs),{bbox:j(p=un,Ks,sp).call(p,h(this,Hs).box,(g-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(h(this,hr),{bbox:j(m=un,Ks,sp).call(m,h(this,qr).box,g),path:{d:h(this,qr).toSVGPath()}})}const[a,o,l,c]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[g,y]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*y/g,this.height=c*g/y;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[g,y]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*y/g,this.height=c*g/y;break}}const{lastPoint:u}=h(this,qr);_(this,Rf,[(u[0]-a)/l,(u[1]-o)/c])},XL=function(t){const i=(a,o)=>{var l,c;this.color=a,_(this,hl,o),(l=this.parent)==null||l.drawLayer.updateProperties(h(this,bs),{root:{fill:a,"fill-opacity":o}}),(c=h(this,ly))==null||c.updateColor(a)},r=this.color,s=h(this,hl);this.addCommands({cmd:i.bind(this,t,un._defaultOpacity),undo:i.bind(this,r,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Zt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},KL=function(t){const i=h(this,qs),r=s=>{_(this,qs,s),j(this,Rt,QL).call(this,s)};this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Zt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},QL=function(t){if(!h(this,Xi))return;j(this,Rt,E0).call(this,{highlightOutlines:h(this,Hs).getNewOutline(t/2)}),this.fixAndSetPosition();const[i,r]=this.parentDimensions;this.setDims(this.width*i,this.height*r)},kS=function(){h(this,bs)===null||!this.parent||(this.parent.drawLayer.remove(h(this,bs)),_(this,bs,null),this.parent.drawLayer.remove(h(this,hr)),_(this,hr,null))},Pu=function(t=this.parent){h(this,bs)===null&&({id:Ti(this,bs)._,clipPathId:Ti(this,Id)._}=t.drawLayer.draw({bbox:h(this,Hs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":h(this,hl)},rootClass:{highlight:!0,free:h(this,Xi)},path:{d:h(this,Hs).toSVGPath()}},!1,!0),_(this,hr,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:h(this,Xi)},bbox:h(this,qr).box,path:{d:h(this,qr).toSVGPath()}},h(this,Xi))),h(this,Rd)&&(h(this,Rd).style.clipPath=h(this,Id)))},Ks=new WeakSet,sp=function([t,i,r,s],a){switch(a){case 90:return[1-i-s,t,s,r];case 180:return[1-t-r,1-i-s,r,s];case 270:return[i,1-t-r,s,r]}return[t,i,r,s]},JL=function(t){un._keyboardManager.exec(this,t)},N0=function(t){if(!h(this,If))return;const i=window.getSelection();t?i.setPosition(h(this,If),h(this,oy)):i.setPosition(h(this,cy),h(this,uy))},og=function(){return h(this,Xi)?this.rotation:0},ZL=function(){if(h(this,Xi))return null;const[t,i]=this.pageDimensions,[r,s]=this.pageTranslation,a=h(this,dl),o=new Float32Array(a.length*8);let l=0;for(const{x:c,y:u,width:p,height:m}of a){const g=c*t+r,y=(1-u)*i+s;o[l]=o[l+4]=g,o[l+1]=o[l+3]=y,o[l+2]=o[l+6]=g+p*t,o[l+5]=o[l+7]=y-m*i,l+=8}return o},eF=function(t){return h(this,Hs).serialize(t,j(this,Rt,og).call(this))},tF=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},nF=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},iF=function(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((r,s)=>r!==i[s])},M(un,Ks),Me(un,"_defaultColor",null),Me(un,"_defaultOpacity",1),Me(un,"_defaultThickness",12),Me(un,"_type","highlight"),Me(un,"_editorType",Ct.HIGHLIGHT),Me(un,"_freeHighlightId",-1),Me(un,"_freeHighlight",null),Me(un,"_freeHighlightClipId","");let cx=un;var Md;class rF{constructor(){M(this,Md,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,i)}updateSVGProperty(e,t){h(this,Md)[e]=t}toSVGProperties(){const e=h(this,Md);return _(this,Md,Object.create(null)),{root:e}}reset(){_(this,Md,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Sn("Not implemented")}}Md=new WeakMap;var ys,jf,ji,jd,Od,jc,Oc,Lc,Ld,rn,DS,SS,ES,lg,sF,_0,cg,ap;const at=class at extends In{constructor(t){super(t);M(this,rn);M(this,ys,null);M(this,jf);Me(this,"_colorPicker",null);Me(this,"_drawId",null);_(this,jf,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(j(this,rn,DS).call(this,t),j(this,rn,lg).call(this))}static _mergeSVGProperties(t,i){const r=new Set(Object.keys(t));for(const[s,a]of Object.entries(i))r.has(s)?Object.assign(t[s],a):t[s]=a;return t}static getDefaultDrawingOptions(t){Sn("Not implemented")}static get typesMap(){Sn("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,i),this._currentParent&&(h(at,ji).updateProperty(r,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const r=this.constructor.typesMap.get(t);r&&this._updateProperty(t,r,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[r,s]of this.typesMap)t.push([r,i[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[r,s]of this.constructor.typesMap)t.push([r,i[s]]);return t}_updateProperty(t,i,r){const s=this._drawingOptions,a=s[i],o=l=>{var u,p;s.updateProperty(i,l);const c=h(this,ys).updateProperty(i,l);c&&j(this,rn,cg).call(this,c),(u=this.parent)==null||u.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&((p=this._colorPicker)==null||p.update(l))};this.addCommands({cmd:o.bind(this,r),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,at._mergeSVGProperties(h(this,ys).getPathResizingSVGProperties(j(this,rn,_0).call(this)),{bbox:j(this,rn,ap).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,at._mergeSVGProperties(h(this,ys).getPathResizedSVGProperties(j(this,rn,_0).call(this)),{bbox:j(this,rn,ap).call(this)}))}_onTranslating(t,i){var r;(r=this.parent)==null||r.drawLayer.updateProperties(this._drawId,{bbox:j(this,rn,ap).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,at._mergeSVGProperties(h(this,ys).getPathTranslatedSVGProperties(j(this,rn,_0).call(this),this.parentDimensions),{bbox:j(this,rn,ap).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,h(this,jf)&&(_(this,jf,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){j(this,rn,ES).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(j(this,rn,lg).call(this),j(this,rn,cg).call(this,h(this,ys).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),j(this,rn,ES).call(this)):t&&(this._uiManager.addShouldRescale(this),j(this,rn,lg).call(this,t),i=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,at._mergeSVGProperties({bbox:j(this,rn,ap).call(this)},h(this,ys).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&j(this,rn,cg).call(this,h(this,ys).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const r=super.render();r.classList.add("draw");const s=document.createElement("div");r.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[a,o]=this.parentDimensions;return this.setDims(this.width*a,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),r}static createDrawerInstance(t,i,r,s,a){Sn("Not implemented")}static startDrawing(t,i,r,s){var w;const{target:a,offsetX:o,offsetY:l,pointerId:c,pointerType:u}=s;if(h(at,Oc)&&h(at,Oc)!==u)return;const{viewport:{rotation:p}}=t,{width:m,height:g}=a.getBoundingClientRect(),y=_(at,jd,new AbortController),v=t.combinedSignal(y);if(h(at,jc)||_(at,jc,c),h(at,Oc)??_(at,Oc,u),window.addEventListener("pointerup",k=>{var S;h(at,jc)===k.pointerId?this._endDraw(k):(S=h(at,Lc))==null||S.delete(k.pointerId)},{signal:v}),window.addEventListener("pointercancel",k=>{var S;h(at,jc)===k.pointerId?this._currentParent.endDrawingSession():(S=h(at,Lc))==null||S.delete(k.pointerId)},{signal:v}),window.addEventListener("pointerdown",k=>{h(at,Oc)===k.pointerType&&((h(at,Lc)||_(at,Lc,new Set)).add(k.pointerId),h(at,ji).isCancellable()&&(h(at,ji).removeLastElement(),h(at,ji).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",ea,{signal:v}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:v}),a.addEventListener("touchmove",k=>{k.timeStamp===h(at,Ld)&&hi(k)},{signal:v}),t.toggleDrawing(),(w=i._editorUndoBar)==null||w.hide(),h(at,ji)){t.drawLayer.updateProperties(this._currentDrawId,h(at,ji).startNew(o,l,m,g,p));return}i.updateUIForDefaultProperties(this),_(at,ji,this.createDrawerInstance(o,l,m,g,p)),_(at,Od,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(h(at,Od).toSVGProperties(),h(at,ji).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(_(at,Ld,-1),!h(at,ji))return;const{offsetX:i,offsetY:r,pointerId:s}=t;if(h(at,jc)===s){if(((a=h(at,Lc))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,h(at,ji).add(i,r)),_(at,Ld,t.timeStamp),hi(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,_(at,ji,null),_(at,Od,null),_(at,Oc,null),_(at,Ld,NaN)),h(at,jd)&&(h(at,jd).abort(),_(at,jd,null),_(at,jc,NaN),_(at,Lc,null))}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===i.div&&i.drawLayer.updateProperties(this._currentDrawId,h(at,ji).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const r=h(at,ji),s=this._currentDrawId,a=r.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(s,r.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(s,r.removeLastElement())},mustExec:!1,type:Zt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Zt.DRAW_STEP),!h(at,ji).isEmpty()){const{pageDimensions:[r,s],scale:a}=i,o=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:h(at,ji).getOutlines(r*a,s*a,a,this._INNER_MARGIN),drawingOptions:h(at,Od),mustBeCommitted:!t});return this._cleanup(!0),o}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,r,s,a,o){Sn("Not implemented")}static async deserialize(t,i,r){var p,m;const{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=i.viewport,c=this.deserializeDraw(o,l,s,a,this._INNER_MARGIN,t),u=await super.deserialize(t,i,r);return u.createDrawingOptions(t),j(p=u,rn,DS).call(p,{drawOutlines:c}),j(m=u,rn,lg).call(m),u.onScaleChanging(),u.rotate(),u}serializeDraw(t){const[i,r]=this.pageTranslation,[s,a]=this.pageDimensions;return h(this,ys).serialize([i,r,s,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ys=new WeakMap,jf=new WeakMap,ji=new WeakMap,jd=new WeakMap,Od=new WeakMap,jc=new WeakMap,Oc=new WeakMap,Lc=new WeakMap,Ld=new WeakMap,rn=new WeakSet,DS=function({drawOutlines:t,drawId:i,drawingOptions:r}){_(this,ys,t),this._drawingOptions||(this._drawingOptions=r),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=j(this,rn,SS).call(this,t,this.parent),j(this,rn,cg).call(this,t.box)},SS=function(t,i){const{id:r}=i.drawLayer.draw(at._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r},ES=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},lg=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=j(this,rn,SS).call(this,h(this,ys),t)}},sF=function([t,i,r,s]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[i,1-t,r*(o/a),s*(a/o)];case 180:return[1-t,1-i,r,s];case 270:return[1-i,t,r*(o/a),s*(a/o)];default:return[t,i,r,s]}},_0=function(){const{x:t,y:i,width:r,height:s,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-i,t,r*(a/o),s*(o/a)];case 180:return[1-t,1-i,r,s];case 270:return[i,1-t,r*(a/o),s*(o/a)];default:return[t,i,r,s]}},cg=function(t){if([this.x,this.y,this.width,this.height]=j(this,rn,sF).call(this,t),this.div){this.fixAndSetPosition();const[i,r]=this.parentDimensions;this.setDims(this.width*i,this.height*r)}this._onResized()},ap=function(){const{x:t,y:i,width:r,height:s,rotation:a,parentRotation:o,parentDimensions:[l,c]}=this;switch((a*4+o)/90){case 1:return[1-i-s,t,s,r];case 2:return[1-t-r,1-i-s,r,s];case 3:return[i,1-t-r,s,r];case 4:return[t,i-r*(l/c),s*(c/l),r*(l/c)];case 5:return[1-i,t,r*(l/c),s*(c/l)];case 6:return[1-t-s*(c/l),1-i,s*(c/l),r*(l/c)];case 7:return[i-r*(l/c),1-t-s*(c/l),r*(l/c),s*(c/l)];case 8:return[t-r,i-s,r,s];case 9:return[1-i,t-r,s,r];case 10:return[1-t,1-i,r,s];case 11:return[i-s,1-t,s,r];case 12:return[t-s*(c/l),i,s*(c/l),r*(l/c)];case 13:return[1-i-r*(l/c),t-s*(c/l),r*(l/c),s*(c/l)];case 14:return[1-t,1-i-r*(l/c),s*(c/l),r*(l/c)];case 15:return[i,1-t,r*(l/c),s*(c/l)];default:return[t,i,r,s]}},Me(at,"_currentDrawId",-1),Me(at,"_currentParent",null),M(at,ji,null),M(at,jd,null),M(at,Od,null),M(at,jc,NaN),M(at,Oc,null),M(at,Lc,null),M(at,Ld,NaN),Me(at,"_INNER_MARGIN",3);let ux=at;var ao,Oi,Li,Fd,Of,Er,Ki,Gs,Vd,Ud,zd,Lf,C0;class oJ{constructor(e,t,i,r,s,a){M(this,Lf);M(this,ao,new Float64Array(6));M(this,Oi);M(this,Li);M(this,Fd);M(this,Of);M(this,Er);M(this,Ki,"");M(this,Gs,0);M(this,Vd,new _y);M(this,Ud);M(this,zd);_(this,Ud,i),_(this,zd,r),_(this,Fd,s),_(this,Of,a),[e,t]=j(this,Lf,C0).call(this,e,t);const o=_(this,Oi,[NaN,NaN,NaN,NaN,e,t]);_(this,Er,[e,t]),_(this,Li,[{line:o,points:h(this,Er)}]),h(this,ao).set(o,0)}updateProperty(e,t){e==="stroke-width"&&_(this,Of,t)}isEmpty(){return!h(this,Li)||h(this,Li).length===0}isCancellable(){return h(this,Er).length<=10}add(e,t){[e,t]=j(this,Lf,C0).call(this,e,t);const[i,r,s,a]=h(this,ao).subarray(2,6),o=e-s,l=t-a;return Math.hypot(h(this,Ud)*o,h(this,zd)*l)<=2?null:(h(this,Er).push(e,t),isNaN(i)?(h(this,ao).set([s,a,e,t],2),h(this,Oi).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(h(this,ao)[0])&&h(this,Oi).splice(6,6),h(this,ao).set([i,r,s,a,e,t],0),h(this,Oi).push(...it.createBezierPoints(i,r,s,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(h(this,Er).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,r,s){_(this,Ud,i),_(this,zd,r),_(this,Fd,s),[e,t]=j(this,Lf,C0).call(this,e,t);const a=_(this,Oi,[NaN,NaN,NaN,NaN,e,t]);_(this,Er,[e,t]);const o=h(this,Li).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),h(this,Li).push({line:a,points:h(this,Er)}),h(this,ao).set(a,0),_(this,Gs,0),this.toSVGPath(),null}getLastElement(){return h(this,Li).at(-1)}setLastElement(e){return h(this,Li)?(h(this,Li).push(e),_(this,Oi,e.line),_(this,Er,e.points),_(this,Gs,0),{path:{d:this.toSVGPath()}}):h(this,Vd).setLastElement(e)}removeLastElement(){if(!h(this,Li))return h(this,Vd).removeLastElement();h(this,Li).pop(),_(this,Ki,"");for(let e=0,t=h(this,Li).length;e<t;e++){const{line:i,points:r}=h(this,Li)[e];_(this,Oi,i),_(this,Er,r),_(this,Gs,0),this.toSVGPath()}return{path:{d:h(this,Ki)}}}toSVGPath(){const e=it.svgRound(h(this,Oi)[4]),t=it.svgRound(h(this,Oi)[5]);if(h(this,Er).length===2)return _(this,Ki,`${h(this,Ki)} M ${e} ${t} Z`),h(this,Ki);if(h(this,Er).length<=6){const r=h(this,Ki).lastIndexOf("M");_(this,Ki,`${h(this,Ki).slice(0,r)} M ${e} ${t}`),_(this,Gs,6)}if(h(this,Er).length===4){const r=it.svgRound(h(this,Oi)[10]),s=it.svgRound(h(this,Oi)[11]);return _(this,Ki,`${h(this,Ki)} L ${r} ${s}`),_(this,Gs,12),h(this,Ki)}const i=[];h(this,Gs)===0&&(i.push(`M ${e} ${t}`),_(this,Gs,6));for(let r=h(this,Gs),s=h(this,Oi).length;r<s;r+=6){const[a,o,l,c,u,p]=h(this,Oi).slice(r,r+6).map(it.svgRound);i.push(`C${a} ${o} ${l} ${c} ${u} ${p}`)}return _(this,Ki,h(this,Ki)+i.join(" ")),_(this,Gs,h(this,Oi).length),h(this,Ki)}getOutlines(e,t,i,r){const s=h(this,Li).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),h(this,Vd).build(h(this,Li),e,t,i,h(this,Fd),h(this,Of),r),_(this,ao,null),_(this,Oi,null),_(this,Li,null),_(this,Ki,null),h(this,Vd)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}ao=new WeakMap,Oi=new WeakMap,Li=new WeakMap,Fd=new WeakMap,Of=new WeakMap,Er=new WeakMap,Ki=new WeakMap,Gs=new WeakMap,Vd=new WeakMap,Ud=new WeakMap,zd=new WeakMap,Lf=new WeakSet,C0=function(e,t){return it._normalizePoint(e,t,h(this,Ud),h(this,zd),h(this,Fd))};var Nr,hy,py,vs,oo,lo,Ff,Vf,Bd,Ji,Mo,aF,oF,lF;class _y extends it{constructor(){super(...arguments);M(this,Ji);M(this,Nr);M(this,hy,0);M(this,py);M(this,vs);M(this,oo);M(this,lo);M(this,Ff);M(this,Vf);M(this,Bd)}build(t,i,r,s,a,o,l){_(this,oo,i),_(this,lo,r),_(this,Ff,s),_(this,Vf,a),_(this,Bd,o),_(this,py,l??0),_(this,vs,t),j(this,Ji,oF).call(this)}get thickness(){return h(this,Bd)}setLastElement(t){return h(this,vs).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return h(this,vs).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of h(this,vs)){if(t.push(`M${it.svgRound(i[4])} ${it.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${it.svgRound(i[10])} ${it.svgRound(i[11])}`);continue}for(let r=6,s=i.length;r<s;r+=6){const[a,o,l,c,u,p]=i.subarray(r,r+6).map(it.svgRound);t.push(`C${a} ${o} ${l} ${c} ${u} ${p}`)}}return t.join("")}serialize([t,i,r,s],a){const o=[],l=[],[c,u,p,m]=j(this,Ji,aF).call(this);let g,y,v,w,k,S,E,P,A;switch(h(this,Vf)){case 0:A=it._rescale,g=t,y=i+s,v=r,w=-s,k=t+c*r,S=i+(1-u-m)*s,E=t+(c+p)*r,P=i+(1-u)*s;break;case 90:A=it._rescaleAndSwap,g=t,y=i,v=r,w=s,k=t+u*r,S=i+c*s,E=t+(u+m)*r,P=i+(c+p)*s;break;case 180:A=it._rescale,g=t+r,y=i,v=-r,w=s,k=t+(1-c-p)*r,S=i+u*s,E=t+(1-c)*r,P=i+(u+m)*s;break;case 270:A=it._rescaleAndSwap,g=t+r,y=i+s,v=-r,w=-s,k=t+(1-u-m)*r,S=i+(1-c-p)*s,E=t+(1-u)*r,P=i+(1-c)*s;break}for(const{line:N,points:R}of h(this,vs))o.push(A(N,g,y,v,w,a?new Array(N.length):null)),l.push(A(R,g,y,v,w,a?new Array(R.length):null));return{lines:o,points:l,rect:[k,S,E,P]}}static deserialize(t,i,r,s,a,{paths:{lines:o,points:l},rotation:c,thickness:u}){const p=[];let m,g,y,v,w;switch(c){case 0:w=it._rescale,m=-t/r,g=i/s+1,y=1/r,v=-1/s;break;case 90:w=it._rescaleAndSwap,m=-i/s,g=-t/r,y=1/s,v=1/r;break;case 180:w=it._rescale,m=t/r+1,g=-i/s,y=-1/r,v=1/s;break;case 270:w=it._rescaleAndSwap,m=i/s+1,g=t/r+1,y=-1/s,v=-1/r;break}if(!o){o=[];for(const S of l){const E=S.length;if(E===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1]]));continue}if(E===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1],NaN,NaN,NaN,NaN,S[2],S[3]]));continue}const P=new Float32Array(3*(E-2));o.push(P);let[A,N,R,V]=S.subarray(0,4);P.set([NaN,NaN,NaN,NaN,A,N],0);for(let B=4;B<E;B+=2){const L=S[B],W=S[B+1];P.set(it.createBezierPoints(A,N,R,V,L,W),(B-2)*3),[A,N,R,V]=[R,V,L,W]}}}for(let S=0,E=o.length;S<E;S++)p.push({line:w(o[S].map(P=>P??NaN),m,g,y,v),points:w(l[S].map(P=>P??NaN),m,g,y,v)});const k=new this.prototype.constructor;return k.build(p,r,s,1,c,u,a),k}get box(){return h(this,Nr)}updateProperty(t,i){return t==="stroke-width"?j(this,Ji,lF).call(this,i):null}updateParentDimensions([t,i],r){const[s,a]=j(this,Ji,Mo).call(this);_(this,oo,t),_(this,lo,i),_(this,Ff,r);const[o,l]=j(this,Ji,Mo).call(this),c=o-s,u=l-a,p=h(this,Nr);return p[0]-=c,p[1]-=u,p[2]+=2*c,p[3]+=2*u,p}updateRotation(t){return _(this,hy,t),{path:{transform:this.rotationTransform}}}get viewBox(){return h(this,Nr).map(it.svgRound).join(" ")}get defaultProperties(){const[t,i]=h(this,Nr);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=h(this,Nr);let r=0,s=0,a=0,o=0,l=0,c=0;switch(h(this,hy)){case 90:s=i/t,a=-t/i,l=t;break;case 180:r=-1,o=-1,l=t,c=i;break;case 270:s=-i/t,a=t/i,c=i;break;default:return""}return`matrix(${r} ${s} ${a} ${o} ${it.svgRound(l)} ${it.svgRound(c)})`}getPathResizingSVGProperties([t,i,r,s]){const[a,o]=j(this,Ji,Mo).call(this),[l,c,u,p]=h(this,Nr);if(Math.abs(u-a)<=it.PRECISION||Math.abs(p-o)<=it.PRECISION){const w=t+r/2-(l+u/2),k=i+s/2-(c+p/2);return{path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`,transform:`${this.rotationTransform} translate(${w} ${k})`}}}const m=(r-2*a)/(u-2*a),g=(s-2*o)/(p-2*o),y=u/r,v=p/s;return{path:{"transform-origin":`${it.svgRound(l)} ${it.svgRound(c)}`,transform:`${this.rotationTransform} scale(${y} ${v}) translate(${it.svgRound(a)} ${it.svgRound(o)}) scale(${m} ${g}) translate(${it.svgRound(-a)} ${it.svgRound(-o)})`}}}getPathResizedSVGProperties([t,i,r,s]){const[a,o]=j(this,Ji,Mo).call(this),l=h(this,Nr),[c,u,p,m]=l;if(l[0]=t,l[1]=i,l[2]=r,l[3]=s,Math.abs(p-a)<=it.PRECISION||Math.abs(m-o)<=it.PRECISION){const k=t+r/2-(c+p/2),S=i+s/2-(u+m/2);for(const{line:E,points:P}of h(this,vs))it._translate(E,k,S,E),it._translate(P,k,S,P);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(r-2*a)/(p-2*a),y=(s-2*o)/(m-2*o),v=-g*(c+a)+t+a,w=-y*(u+o)+i+o;if(g!==1||y!==1||v!==0||w!==0)for(const{line:k,points:S}of h(this,vs))it._rescale(k,v,w,g,y,k),it._rescale(S,v,w,g,y,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],r){const[s,a]=r,o=h(this,Nr),l=t-o[0],c=i-o[1];if(h(this,oo)===s&&h(this,lo)===a)for(const{line:u,points:p}of h(this,vs))it._translate(u,l,c,u),it._translate(p,l,c,p);else{const u=h(this,oo)/s,p=h(this,lo)/a;_(this,oo,s),_(this,lo,a);for(const{line:m,points:g}of h(this,vs))it._rescale(m,l,c,u,p,m),it._rescale(g,l,c,u,p,g);o[2]*=u,o[3]*=p}return o[0]=t,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`}}}get defaultSVGProperties(){const t=h(this,Nr);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${it.svgRound(t[0])} ${it.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}Nr=new WeakMap,hy=new WeakMap,py=new WeakMap,vs=new WeakMap,oo=new WeakMap,lo=new WeakMap,Ff=new WeakMap,Vf=new WeakMap,Bd=new WeakMap,Ji=new WeakSet,Mo=function(t=h(this,Bd)){const i=h(this,py)+t/2*h(this,Ff);return h(this,Vf)%180===0?[i/h(this,oo),i/h(this,lo)]:[i/h(this,lo),i/h(this,oo)]},aF=function(){const[t,i,r,s]=h(this,Nr),[a,o]=j(this,Ji,Mo).call(this,0);return[t+a,i+o,r-2*a,s-2*o]},oF=function(){const t=_(this,Nr,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of h(this,vs)){if(s.length<=12){for(let l=4,c=s.length;l<c;l+=6)gt.pointBoundingBox(s[l],s[l+1],t);continue}let a=s[4],o=s[5];for(let l=6,c=s.length;l<c;l+=6){const[u,p,m,g,y,v]=s.subarray(l,l+6);gt.bezierBoundingBox(a,o,u,p,m,g,y,v,t),a=y,o=v}}const[i,r]=j(this,Ji,Mo).call(this);t[0]=Ar(t[0]-i,0,1),t[1]=Ar(t[1]-r,0,1),t[2]=Ar(t[2]+i,0,1),t[3]=Ar(t[3]+r,0,1),t[2]-=t[0],t[3]-=t[1]},lF=function(t){const[i,r]=j(this,Ji,Mo).call(this);_(this,Bd,t);const[s,a]=j(this,Ji,Mo).call(this),[o,l]=[s-i,a-r],c=h(this,Nr);return c[0]-=o,c[1]-=l,c[2]+=2*o,c[3]+=2*l,c};class sw extends rF{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:In._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new sw(this._viewParameters);return e.updateAll(this),e}}var Rx,cF;const hp=class hp extends ux{constructor(t){super({...t,name:"inkEditor"});M(this,Rx);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){In.initialize(t,i),this._defaultDrawingOptions=new sw(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return Wt(this,"typesMap",new Map([[Zt.INK_THICKNESS,"stroke-width"],[Zt.INK_COLOR,"stroke"],[Zt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,r,s,a){return new oJ(t,i,r,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,r,s,a,o){return _y.deserialize(t,i,r,s,a,o)}static async deserialize(t,i,r){let s=null;if(t instanceof sN){const{data:{inkLists:o,rect:l,rotation:c,id:u,color:p,opacity:m,borderStyle:{rawWidth:g},popupRef:y,contentsObj:v},parent:{page:{pageNumber:w}}}=t;s=t={annotationType:Ct.INK,color:Array.from(p),thickness:g,opacity:m,paths:{points:o},boxes:null,pageIndex:w-1,rect:l.slice(0),rotation:c,annotationElementId:u,id:u,deleted:!1,popupRef:y,comment:(v==null?void 0:v.str)||null}}const a=await super.deserialize(t,i,r);return a._initialData=s,t.comment&&a.setCommentData(t.comment),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new ax(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Zt.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:r}=this;i.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:r}){this._drawingOptions=hp.getDefaultDrawingOptions({stroke:gt.makeHexColor(...t),"stroke-width":i,"stroke-opacity":r})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:r,rect:s}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,c={annotationType:Ct.INK,color:In._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:i,points:r},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(c),t?(c.isCopy=!0,c):this.annotationElementId&&!j(this,Rx,cF).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){const{points:i,rect:r}=this.serializeDraw(!1),s={rect:r,thickness:this._drawingOptions["stroke-width"],points:i};return this.hasEditedComment&&(s.popup=this.comment),t.updateEdited(s),null}};Rx=new WeakSet,cF=function(t){const{color:i,thickness:r,opacity:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==i[l])||t.thickness!==r||t.opacity!==s||t.pageIndex!==a},Me(hp,"_type","ink"),Me(hp,"_editorType",Ct.INK),Me(hp,"_defaultDrawingOptions",null);let NS=hp;class _S extends _y{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Wv=8,jm=3;var $d,mn,CS,va,uF,dF,AS,A0,hF,pF,fF,PS,TS,mF;class yl{static extractContoursFromText(e,{fontFamily:t,fontStyle:i,fontWeight:r},s,a,o,l){let c=new OffscreenCanvas(1,1),u=c.getContext("2d",{alpha:!1});const p=200,m=u.font=`${i} ${r} ${p}px ${t}`,{actualBoundingBoxLeft:g,actualBoundingBoxRight:y,actualBoundingBoxAscent:v,actualBoundingBoxDescent:w,fontBoundingBoxAscent:k,fontBoundingBoxDescent:S,width:E}=u.measureText(e),P=1.5,A=Math.ceil(Math.max(Math.abs(g)+Math.abs(y)||0,E)*P),N=Math.ceil(Math.max(Math.abs(v)+Math.abs(w)||p,Math.abs(k)+Math.abs(S)||p)*P);c=new OffscreenCanvas(A,N),u=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),u.font=m,u.filter="grayscale(1)",u.fillStyle="white",u.fillRect(0,0,A,N),u.fillStyle="black",u.fillText(e,A*(P-1)/2,N*(3-P)/2);const R=j(this,mn,PS).call(this,u.getImageData(0,0,A,N).data),V=j(this,mn,fF).call(this,R),B=j(this,mn,TS).call(this,V),L=j(this,mn,AS).call(this,R,A,N,B);return this.processDrawnLines({lines:{curves:L,width:A,height:N},pageWidth:s,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,i,r,s){const[a,o,l]=j(this,mn,mF).call(this,e),[c,u]=j(this,mn,pF).call(this,a,o,l,Math.hypot(o,l)*h(this,$d).sigmaSFactor,h(this,$d).sigmaR,h(this,$d).kernelSize),p=j(this,mn,TS).call(this,u),m=j(this,mn,AS).call(this,c,o,l,p);return this.processDrawnLines({lines:{curves:m,width:o,height:l},pageWidth:t,pageHeight:i,rotation:r,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:i,rotation:r,innerMargin:s,mustSmooth:a,areContours:o}){r%180!==0&&([t,i]=[i,t]);const{curves:l,width:c,height:u}=e,p=e.thickness??0,m=[],g=Math.min(t/c,i/u),y=g/t,v=g/i,w=[];for(const{points:S}of l){const E=a?j(this,mn,hF).call(this,S):S;if(!E)continue;w.push(E);const P=E.length,A=new Float32Array(P),N=new Float32Array(3*(P===2?2:P-2));if(m.push({line:N,points:A}),P===2){A[0]=E[0]*y,A[1]=E[1]*v,N.set([NaN,NaN,NaN,NaN,A[0],A[1]],0);continue}let[R,V,B,L]=E;R*=y,V*=v,B*=y,L*=v,A.set([R,V,B,L],0),N.set([NaN,NaN,NaN,NaN,R,V],0);for(let W=4;W<P;W+=2){const q=A[W]=E[W]*y,X=A[W+1]=E[W+1]*v;N.set(it.createBezierPoints(R,V,B,L,q,X),(W-2)*3),[R,V,B,L]=[B,L,q,X]}}if(m.length===0)return null;const k=o?new _S:new _y;return k.build(m,t,i,1,r,o?0:p,s),{outline:k,newCurves:w,areContours:o,thickness:p,width:c,height:u}}static async compressSignature({outlines:e,areContours:t,thickness:i,width:r,height:s}){let a=1/0,o=-1/0,l=0;for(const E of e){l+=E.length;for(let P=2,A=E.length;P<A;P++){const N=E[P]-E[P-2];a=Math.min(a,N),o=Math.max(o,N)}}let c;a>=-128&&o<=127?c=Int8Array:a>=-32768&&o<=32767?c=Int16Array:c=Int32Array;const u=e.length,p=Wv+jm*u,m=new Uint32Array(p);let g=0;m[g++]=p*Uint32Array.BYTES_PER_ELEMENT+(l-2*u)*c.BYTES_PER_ELEMENT,m[g++]=0,m[g++]=r,m[g++]=s,m[g++]=t?0:1,m[g++]=Math.max(0,Math.floor(i??0)),m[g++]=u,m[g++]=c.BYTES_PER_ELEMENT;for(const E of e)m[g++]=E.length-2,m[g++]=E[0],m[g++]=E[1];const y=new CompressionStream("deflate-raw"),v=y.writable.getWriter();await v.ready,v.write(m);const w=c.prototype.constructor;for(const E of e){const P=new w(E.length-2);for(let A=2,N=E.length;A<N;A++)P[A-2]=E[A]-E[A-2];v.write(P)}v.close();const k=await new Response(y.readable).arrayBuffer(),S=new Uint8Array(k);return gO(S)}static async decompressSignature(e){try{const t=PK(e),{readable:i,writable:r}=new DecompressionStream("deflate-raw"),s=r.getWriter();await s.ready,s.write(t).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let a=null,o=0;for await(const E of i)a||(a=new Uint8Array(new Uint32Array(E.buffer,0,4)[0])),a.set(E,o),o+=E.length;const l=new Uint32Array(a.buffer,0,a.length>>2),c=l[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const u=l[2],p=l[3],m=l[4]===0,g=l[5],y=l[6],v=l[7],w=[],k=(Wv+jm*y)*Uint32Array.BYTES_PER_ELEMENT;let S;switch(v){case Int8Array.BYTES_PER_ELEMENT:S=new Int8Array(a.buffer,k);break;case Int16Array.BYTES_PER_ELEMENT:S=new Int16Array(a.buffer,k);break;case Int32Array.BYTES_PER_ELEMENT:S=new Int32Array(a.buffer,k);break}o=0;for(let E=0;E<y;E++){const P=l[jm*E+Wv],A=new Float32Array(P+2);w.push(A);for(let N=0;N<jm-1;N++)A[N]=l[jm*E+Wv+N+1];for(let N=0;N<P;N++)A[N+2]=A[N]+S[o++]}return{areContours:m,thickness:g,outlines:w,width:u,height:p}}catch(t){return At(`decompressSignature: ${t}`),null}}}$d=new WeakMap,mn=new WeakSet,CS=function(e,t,i,r){return i-=e,r-=t,i===0?r>0?0:4:i===1?r+6:2-r},va=new WeakMap,uF=function(e,t,i,r,s,a,o){const l=j(this,mn,CS).call(this,i,r,s,a);for(let c=0;c<8;c++){const u=(-c+l-o+16)%8,p=h(this,va)[2*u],m=h(this,va)[2*u+1];if(e[(i+p)*t+(r+m)]!==0)return u}return-1},dF=function(e,t,i,r,s,a,o){const l=j(this,mn,CS).call(this,i,r,s,a);for(let c=0;c<8;c++){const u=(c+l+o+16)%8,p=h(this,va)[2*u],m=h(this,va)[2*u+1];if(e[(i+p)*t+(r+m)]!==0)return u}return-1},AS=function(e,t,i,r){const s=e.length,a=new Int32Array(s);for(let u=0;u<s;u++)a[u]=e[u]<=r?1:0;for(let u=1;u<i-1;u++)a[u*t]=a[u*t+t-1]=0;for(let u=0;u<t;u++)a[u]=a[t*i-1-u]=0;let o=1,l;const c=[];for(let u=1;u<i-1;u++){l=1;for(let p=1;p<t-1;p++){const m=u*t+p,g=a[m];if(g===0)continue;let y=u,v=p;if(g===1&&a[m-1]===0)o+=1,v-=1;else if(g>=1&&a[m+1]===0)o+=1,v+=1,g>1&&(l=g);else{g!==1&&(l=Math.abs(g));continue}const w=[p,u],k=v===p+1,S={isHole:k,points:w,id:o,parent:0};c.push(S);let E;for(const W of c)if(W.id===l){E=W;break}E?E.isHole?S.parent=k?E.parent:l:S.parent=k?l:E.parent:S.parent=k?l:0;const P=j(this,mn,uF).call(this,a,t,u,p,y,v,0);if(P===-1){a[m]=-o,a[m]!==1&&(l=Math.abs(a[m]));continue}let A=h(this,va)[2*P],N=h(this,va)[2*P+1];const R=u+A,V=p+N;y=R,v=V;let B=u,L=p;for(;;){const W=j(this,mn,dF).call(this,a,t,B,L,y,v,1);A=h(this,va)[2*W],N=h(this,va)[2*W+1];const q=B+A,X=L+N;w.push(X,q);const G=B*t+L;if(a[G+1]===0?a[G]=-o:a[G]===1&&(a[G]=o),q===u&&X===p&&B===R&&L===V){a[m]!==1&&(l=Math.abs(a[m]));break}else y=B,v=L,B=q,L=X}}}return c},A0=function(e,t,i,r){if(i-t<=4){for(let R=t;R<i-2;R+=2)r.push(e[R],e[R+1]);return}const s=e[t],a=e[t+1],o=e[i-4]-s,l=e[i-3]-a,c=Math.hypot(o,l),u=o/c,p=l/c,m=u*a-p*s,g=l/o,y=1/c,v=Math.atan(g),w=Math.cos(v),k=Math.sin(v),S=y*(Math.abs(w)+Math.abs(k)),E=y*(1-S+S**2),P=Math.max(Math.atan(Math.abs(k+w)*E),Math.atan(Math.abs(k-w)*E));let A=0,N=t;for(let R=t+2;R<i-2;R+=2){const V=Math.abs(m-u*e[R+1]+p*e[R]);V>A&&(N=R,A=V)}A>(c*P)**2?(j(this,mn,A0).call(this,e,t,N+2,r),j(this,mn,A0).call(this,e,N,i,r)):r.push(s,a)},hF=function(e){const t=[],i=e.length;return j(this,mn,A0).call(this,e,0,i,t),t.push(e[i-2],e[i-1]),t.length<=4?null:t},pF=function(e,t,i,r,s,a){const o=new Float32Array(a**2),l=-2*r**2,c=a>>1;for(let v=0;v<a;v++){const w=(v-c)**2;for(let k=0;k<a;k++)o[v*a+k]=Math.exp((w+(k-c)**2)/l)}const u=new Float32Array(256),p=-2*s**2;for(let v=0;v<256;v++)u[v]=Math.exp(v**2/p);const m=e.length,g=new Uint8Array(m),y=new Uint32Array(256);for(let v=0;v<i;v++)for(let w=0;w<t;w++){const k=v*t+w,S=e[k];let E=0,P=0;for(let N=0;N<a;N++){const R=v+N-c;if(!(R<0||R>=i))for(let V=0;V<a;V++){const B=w+V-c;if(B<0||B>=t)continue;const L=e[R*t+B],W=o[N*a+V]*u[Math.abs(L-S)];E+=L*W,P+=W}}const A=g[k]=Math.round(E/P);y[A]++}return[g,y]},fF=function(e){const t=new Uint32Array(256);for(const i of e)t[i]++;return t},PS=function(e){const t=e.length,i=new Uint8ClampedArray(t>>2);let r=-1/0,s=1/0;for(let o=0,l=i.length;o<l;o++){const c=i[o]=e[o<<2];r=Math.max(r,c),s=Math.min(s,c)}const a=255/(r-s);for(let o=0,l=i.length;o<l;o++)i[o]=(i[o]-s)*a;return i},TS=function(e){let t,i=-1/0,r=-1/0;const s=e.findIndex(l=>l!==0);let a=s,o=s;for(t=s;t<256;t++){const l=e[t];l>i&&(t-a>r&&(r=t-a,o=t-1),i=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},mF=function(e){const t=e,{width:i,height:r}=e,{maxDim:s}=h(this,$d);let a=i,o=r;if(i>s||r>s){let m=i,g=r,y=Math.log2(Math.max(i,r)/s);const v=Math.floor(y);y=y===v?v-1:v;for(let k=0;k<y;k++){a=Math.ceil(m/2),o=Math.ceil(g/2);const S=new OffscreenCanvas(a,o);S.getContext("2d").drawImage(e,0,0,m,g,0,0,a,o),m=a,g=o,e!==t&&e.close(),e=S.transferToImageBitmap()}const w=Math.min(s/a,s/o);a=Math.round(a*w),o=Math.round(o*w)}const c=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});c.fillStyle="white",c.fillRect(0,0,a,o),c.filter="grayscale(1)",c.drawImage(e,0,0,e.width,e.height,0,0,a,o);const u=c.getImageData(0,0,a,o).data;return[j(this,mn,PS).call(this,u),a,o]},M(yl,mn),M(yl,$d,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),M(yl,va,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class aN extends rF{constructor(){super(),super.updateProperties({fill:In._defaultLineColor,"stroke-width":0})}clone(){const e=new aN;return e.updateAll(this),e}}class oN extends sw{constructor(e){super(e),super.updateProperties({stroke:In._defaultLineColor,"stroke-width":1})}clone(){const e=new oN(this._viewParameters);return e.updateAll(this),e}}var Fc,co,Vc,Wd;const as=class as extends ux{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});M(this,Fc,!1);M(this,co,null);M(this,Vc,null);M(this,Wd,null);this._willKeepAspectRatio=!0,_(this,Vc,t.signatureData||null),_(this,co,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){In.initialize(t,i),this._defaultDrawingOptions=new aN,this._defaultDrawnSignatureOptions=new oN(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return Wt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!h(this,co)}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:r}=this;if(r&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(h(this,Vc)){const{lines:s,mustSmooth:a,areContours:o,description:l,uuid:c,heightInPage:u}=h(this,Vc),{rawDims:{pageWidth:p,pageHeight:m},rotation:g}=this.parent.viewport,y=yl.processDrawnLines({lines:s,pageWidth:p,pageHeight:m,rotation:g,innerMargin:as._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(y,u,l,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:h(this,co)||""}));return r&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){_(this,Wd,t),this.addEditToolbar()}getUuid(){return h(this,Wd)}get description(){return h(this,co)}set description(t){_(this,co,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i==null||i.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:r,width:s,height:a}=h(this,Vc),o=Math.max(s,a),l=yl.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:r,width:s,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,r,s){const{x:a,y:o}=this,{outline:l}=_(this,Vc,t);_(this,Fc,l instanceof _S),this.description=r;let c;h(this,Fc)?c=as.getDefaultDrawingOptions():(c=as._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:c});const[u,p]=this.parentDimensions,[,m]=this.pageDimensions;let g=i/m;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(u*this.width,p*this.height),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:r},rotation:s}=this.parent.viewport;return yl.process(t,i,r,s,as._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:r,pageHeight:s},rotation:a}=this.parent.viewport;return yl.extractContoursFromText(t,i,r,s,a,as._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:r},rotation:s}=this.parent.viewport;return yl.processDrawnLines({lines:t,pageWidth:i,pageHeight:r,rotation:s,innerMargin:as._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=as.getDefaultDrawingOptions():(this._drawingOptions=as._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:r,rect:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,o={annotationType:Ct.SIGNATURE,isSignature:!0,areContours:h(this,Fc),color:[0,0,0],thickness:h(this,Fc)?0:a,pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(o),t?(o.paths={lines:i,points:r},o.uuid=h(this,Wd),o.isCopy=!0):o.lines=i,h(this,co)&&(o.accessibilityData={type:"Figure",alt:h(this,co)}),o}static deserializeDraw(t,i,r,s,a,o){return o.areContours?_S.deserialize(t,i,r,s,a,o):_y.deserialize(t,i,r,s,a,o)}static async deserialize(t,i,r){var a;const s=await super.deserialize(t,i,r);return _(s,Fc,t.areContours),s.description=((a=t.accessibilityData)==null?void 0:a.alt)||"",_(s,Wd,t.uuid),s}};Fc=new WeakMap,co=new WeakMap,Vc=new WeakMap,Wd=new WeakMap,Me(as,"_type","signature"),Me(as,"_editorType",Ct.SIGNATURE),Me(as,"_defaultDrawingOptions",null);let IS=as;var Un,Fi,Uc,pl,zc,Uf,fl,Hd,uo,xs,zf,an,ug,dg,P0,T0,I0,MS,R0,gF;class RS extends In{constructor(t){super({...t,name:"stampEditor"});M(this,an);M(this,Un,null);M(this,Fi,null);M(this,Uc,null);M(this,pl,null);M(this,zc,null);M(this,Uf,"");M(this,fl,null);M(this,Hd,!1);M(this,uo,null);M(this,xs,!1);M(this,zf,!1);_(this,pl,t.bitmapUrl),_(this,zc,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){In.initialize(t,i)}static isHandlingMimeForPasting(t){return ND.includes(t)}static paste(t,i){i.pasteEditor({mode:Ct.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await r.guess({name:"altText",request:{data:s,width:a,height:o,channels:s.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),i&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;h(this,Fi)&&(_(this,Un,null),this._uiManager.imageManager.deleteId(h(this,Fi)),(t=h(this,fl))==null||t.remove(),_(this,fl,null),h(this,uo)&&(clearTimeout(h(this,uo)),_(this,uo,null))),super.remove()}rebuild(){if(!this.parent){h(this,Fi)&&j(this,an,P0).call(this);return}super.rebuild(),this.div!==null&&(h(this,Fi)&&h(this,fl)===null&&j(this,an,P0).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(h(this,Uc)||h(this,Un)||h(this,pl)||h(this,zc)||h(this,Fi)||h(this,Hd))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),h(this,Hd)||(h(this,Un)?j(this,an,T0).call(this):j(this,an,P0).call(this)),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:r,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),r&&this._uiManager.imageManager.isValidId(r)&&(_(this,Fi,r),s&&_(this,Un,s),_(this,Hd,!1),j(this,an,T0).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;h(this,uo)!==null&&clearTimeout(h(this,uo)),_(this,uo,setTimeout(()=>{_(this,uo,null),j(this,an,MS).call(this)},200))}copyCanvas(t,i,r=!1){var g;t||(t=224);const{width:s,height:a}=h(this,Un),o=new go;let l=h(this,Un),c=s,u=a,p=null;if(i){if(s>i||a>i){const V=Math.min(i/s,i/a);c=Math.floor(s*V),u=Math.floor(a*V)}p=document.createElement("canvas");const y=p.width=Math.ceil(c*o.sx),v=p.height=Math.ceil(u*o.sy);h(this,xs)||(l=j(this,an,I0).call(this,y,v));const w=p.getContext("2d");w.filter=this._uiManager.hcmFilter;let k="white",S="#cfcfd8";this._uiManager.hcmFilter!=="none"?S="black":(g=window.matchMedia)!=null&&g.call(window,"(prefers-color-scheme: dark)").matches&&(k="#8f8f9d",S="#42414d");const E=15,P=E*o.sx,A=E*o.sy,N=new OffscreenCanvas(P*2,A*2),R=N.getContext("2d");R.fillStyle=k,R.fillRect(0,0,P*2,A*2),R.fillStyle=S,R.fillRect(0,0,P,A),R.fillRect(P,A,P,A),w.fillStyle=w.createPattern(N,"repeat"),w.fillRect(0,0,y,v),w.drawImage(l,0,0,l.width,l.height,0,0,y,v)}let m=null;if(r){let y,v;if(o.symmetric&&l.width<t&&l.height<t)y=l.width,v=l.height;else if(l=h(this,Un),s>t||a>t){const S=Math.min(t/s,t/a);y=Math.floor(s*S),v=Math.floor(a*S),h(this,xs)||(l=j(this,an,I0).call(this,y,v))}const k=new OffscreenCanvas(y,v).getContext("2d",{willReadFrequently:!0});k.drawImage(l,0,0,l.width,l.height,0,0,y,v),m={width:y,height:v,data:k.getImageData(0,0,y,v).data}}return{canvas:p,width:c,height:u,imageData:m}}static async deserialize(t,i,r){var w;let s=null,a=!1;if(t instanceof IL){const{data:{rect:k,rotation:S,id:E,structParent:P,popupRef:A,contentsObj:N},container:R,parent:{page:{pageNumber:V}},canvas:B}=t;let L,W;B?(delete t.canvas,{id:L,bitmap:W}=r.imageManager.getFromCanvas(R.id,B),B.remove()):(a=!0,t._hasNoCanvas=!0);const q=((w=await i._structTree.getAriaAttributes(`${JE}${E}`))==null?void 0:w.get("aria-label"))||"";s=t={annotationType:Ct.STAMP,bitmapId:L,bitmap:W,pageIndex:V-1,rect:k.slice(0),rotation:S,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:q},isSvg:!1,structParent:P,popupRef:A,comment:(N==null?void 0:N.str)||null}}const o=await super.deserialize(t,i,r),{rect:l,bitmap:c,bitmapUrl:u,bitmapId:p,isSvg:m,accessibilityData:g}=t;a?(r.addMissingCanvas(t.id,o),_(o,Hd,!0)):p&&r.imageManager.isValidId(p)?(_(o,Fi,p),c&&_(o,Un,c)):_(o,pl,u),_(o,xs,m);const[y,v]=o.pageDimensions;return o.width=(l[2]-l[0])/y,o.height=(l[3]-l[1])/v,g&&(o.altTextData=g),o._initialData=s,t.comment&&o.setCommentData(t.comment),_(o,zf,!!s),o}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r={annotationType:Ct.STAMP,bitmapId:h(this,Fi),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:h(this,xs),structTreeParentId:this._structTreeParentId};if(this.addComment(r),t)return r.bitmapUrl=j(this,an,R0).call(this,!0),r.accessibilityData=this.serializeAltText(!0),r.isCopy=!0,r;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(r.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=j(this,an,gF).call(this,r);if(l.isSame)return null;l.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1}if(r.id=this.annotationElementId,i===null)return r;i.stamps||(i.stamps=new Map);const o=h(this,xs)?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!i.stamps.has(h(this,Fi)))i.stamps.set(h(this,Fi),{area:o,serialized:r}),r.bitmap=j(this,an,R0).call(this,!1);else if(h(this,xs)){const l=i.stamps.get(h(this,Fi));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=j(this,an,R0).call(this,!1))}return r}renderAnnotationElement(t){const i={rect:this.getRect(0,0)};return this.hasEditedComment&&(i.popup=this.comment),t.updateEdited(i),null}}Un=new WeakMap,Fi=new WeakMap,Uc=new WeakMap,pl=new WeakMap,zc=new WeakMap,Uf=new WeakMap,fl=new WeakMap,Hd=new WeakMap,uo=new WeakMap,xs=new WeakMap,zf=new WeakMap,an=new WeakSet,ug=function(t,i=!1){if(!t){this.remove();return}_(this,Un,t.bitmap),i||(_(this,Fi,t.id),_(this,xs,t.isSvg)),t.file&&_(this,Uf,t.file.name),j(this,an,T0).call(this)},dg=function(){if(_(this,Uc,null),this._uiManager.enableWaiting(!1),!!h(this,fl)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&h(this,Un)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&h(this,Un)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},P0=function(){if(h(this,Fi)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(h(this,Fi)).then(r=>j(this,an,ug).call(this,r,!0)).finally(()=>j(this,an,dg).call(this));return}if(h(this,pl)){const r=h(this,pl);_(this,pl,null),this._uiManager.enableWaiting(!0),_(this,Uc,this._uiManager.imageManager.getFromUrl(r).then(s=>j(this,an,ug).call(this,s)).finally(()=>j(this,an,dg).call(this)));return}if(h(this,zc)){const r=h(this,zc);_(this,zc,null),this._uiManager.enableWaiting(!0),_(this,Uc,this._uiManager.imageManager.getFromFile(r).then(s=>j(this,an,ug).call(this,s)).finally(()=>j(this,an,dg).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=ND.join(",");const i=this._uiManager._signal;_(this,Uc,new Promise(r=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),j(this,an,ug).call(this,s)}r()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),r()},{signal:i})}).finally(()=>j(this,an,dg).call(this))),t.click()},T0=function(){var p;const{div:t}=this;let{width:i,height:r}=h(this,Un);const[s,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*s,r=this.height*a;else if(i>o*s||r>o*a){const m=Math.min(o*s/i,o*a/r);i*=m,r*=m}const[l,c]=this.parentDimensions;this.setDims(i*l/s,r*c/a),this._uiManager.enableWaiting(!1);const u=_(this,fl,document.createElement("canvas"));u.setAttribute("role","img"),this.addContainer(u),this.width=i/s,this.height=r/a,(p=this._initialOptions)!=null&&p.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),j(this,an,MS).call(this),h(this,zf)||(this.parent.addUndoableEditor(this),_(this,zf,!0)),this._reportTelemetry({action:"inserted_image"}),h(this,Uf)&&this.div.setAttribute("aria-description",h(this,Uf)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},I0=function(t,i){const{width:r,height:s}=h(this,Un);let a=r,o=s,l=h(this,Un);for(;a>2*t||o>2*i;){const c=a,u=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const p=new OffscreenCanvas(a,o);p.getContext("2d").drawImage(l,0,0,c,u,0,0,a,o),l=p.transferToImageBitmap()}return l},MS=function(){const[t,i]=this.parentDimensions,{width:r,height:s}=this,a=new go,o=Math.ceil(r*t*a.sx),l=Math.ceil(s*i*a.sy),c=h(this,fl);if(!c||c.width===o&&c.height===l)return;c.width=o,c.height=l;const u=h(this,xs)?h(this,Un):j(this,an,I0).call(this,o,l),p=c.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(u,0,0,u.width,u.height,0,0,o,l)},R0=function(t){if(t){if(h(this,xs)){const s=this._uiManager.imageManager.getSvgUrl(h(this,Fi));if(s)return s}const i=document.createElement("canvas");return{width:i.width,height:i.height}=h(this,Un),i.getContext("2d").drawImage(h(this,Un),0,0),i.toDataURL()}if(h(this,xs)){const[i,r]=this.pageDimensions,s=Math.round(this.width*i*Kc.PDF_TO_CSS_UNITS),a=Math.round(this.height*r*Kc.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,a);return o.getContext("2d").drawImage(h(this,Un),0,0,h(this,Un).width,h(this,Un).height,0,0,s,a),o.transferToImageBitmap()}return structuredClone(h(this,Un))},gF=function(t){var o;const{pageIndex:i,accessibilityData:{altText:r}}=this._initialData,s=t.pageIndex===i,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===r;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}},Me(RS,"_type","stamp"),Me(RS,"_editorType",Ct.STAMP);var qd,Bf,ho,Bc,ml,ws,$c,$f,Gd,xa,gl,Vi,bl,Wc,Wf,ft,Hc,Bn,bF,Va,OS,LS,M0;const la=class la{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:r,accessibilityManager:s,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:u}){M(this,Bn);M(this,qd);M(this,Bf,!1);M(this,ho,null);M(this,Bc,null);M(this,ml,null);M(this,ws,new Map);M(this,$c,!1);M(this,$f,!1);M(this,Gd,!1);M(this,xa,null);M(this,gl,null);M(this,Vi,null);M(this,bl,null);M(this,Wc,null);M(this,Wf,-1);M(this,ft);const p=[...h(la,Hc).values()];if(!la._initialized){la._initialized=!0;for(const m of p)m.initialize(u,e)}e.registerEditorTypes(p),_(this,ft,e),this.pageIndex=t,this.div=i,_(this,qd,s),_(this,ho,a),this.viewport=c,_(this,Vi,l),this.drawLayer=o,this._structTree=r,h(this,ft).addLayer(this)}get isEmpty(){return h(this,ws).size===0}get isInvisible(){return this.isEmpty&&h(this,ft).getMode()===Ct.NONE}updateToolbar(e){h(this,ft).updateToolbar(e)}updateMode(e=h(this,ft).getMode()){switch(j(this,Bn,M0).call(this),e){case Ct.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ct.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ct.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of h(la,Hc).values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=h(this,Vi))==null?void 0:t.div)}setEditingState(e){h(this,ft).setEditingState(e)}addCommands(e){h(this,ft).addCommands(e)}cleanUndoStack(e){h(this,ft).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=h(this,ho))==null||t.div.classList.toggle("disabled",!e)}async enable(){var i;_(this,Gd,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),(i=h(this,Wc))==null||i.abort(),_(this,Wc,null);const e=new Set;for(const r of h(this,ws).values())r.enableEditing(),r.show(!0),r.annotationElementId&&(h(this,ft).removeChangedExistingAnnotation(r),e.add(r.annotationElementId));if(!h(this,ho)){_(this,Gd,!1);return}const t=h(this,ho).getEditableAnnotations();for(const r of t){if(r.hide(),h(this,ft).isDeletedAnnotationElement(r.data.id)||e.has(r.data.id))continue;const s=await this.deserialize(r);s&&(this.addOrRebuild(s),s.enableEditing())}_(this,Gd,!1)}disable(){var r;if(_(this,$f,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),h(this,Vi)&&!h(this,Wc)){_(this,Wc,new AbortController);const s=h(this,ft).combinedSignal(h(this,Wc));h(this,Vi).div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:c,timeStamp:u}=a,p=h(this,Wf);if(u-p>500){_(this,Wf,u);return}_(this,Wf,-1);const{classList:m}=this.div;m.toggle("getElements",!0);const g=document.elementsFromPoint(l,c);if(m.toggle("getElements",!1),!this.div.contains(g[0]))return;let y;const v=new RegExp(`^${dO}[0-9]+$`);for(const k of g)if(v.test(k.id)){y=k.id;break}if(!y)return;const w=h(this,ws).get(y);(w==null?void 0:w.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),w.dblclick())},{signal:s,capture:!0})}const e=new Map,t=new Map;for(const s of h(this,ws).values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){e.set(s.annotationElementId,s);continue}else t.set(s.annotationElementId,s);(r=this.getEditableAnnotation(s.annotationElementId))==null||r.show(),s.remove()}if(h(this,ho)){const s=h(this,ho).getEditableAnnotations();for(const a of s){const{id:o}=a.data;if(h(this,ft).isDeletedAnnotationElement(o)){a.updateEdited({deleted:!0});continue}let l=t.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=e.get(o),l&&(h(this,ft).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}j(this,Bn,M0).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of h(la,Hc).values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),_(this,$f,!1)}getEditableAnnotation(e){var t;return((t=h(this,ho))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){h(this,ft).getActive()!==e&&h(this,ft).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=h(this,Vi))!=null&&e.div&&!h(this,bl)){_(this,bl,new AbortController);const t=h(this,ft).combinedSignal(h(this,bl));h(this,Vi).div.addEventListener("pointerdown",j(this,Bn,bF).bind(this),{signal:t}),h(this,Vi).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=h(this,Vi))!=null&&e.div&&h(this,bl)&&(h(this,bl).abort(),_(this,bl,null),h(this,Vi).div.classList.remove("highlighting"))}enableClick(){if(h(this,Bc))return;_(this,Bc,new AbortController);const e=h(this,ft).combinedSignal(h(this,Bc));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=h(this,Bc))==null||e.abort(),_(this,Bc,null)}attach(e){h(this,ws).set(e.id,e);const{annotationElementId:t}=e;t&&h(this,ft).isDeletedAnnotationElement(t)&&h(this,ft).removeDeletedAnnotationElement(e)}detach(e){var t;h(this,ws).delete(e.id),(t=h(this,qd))==null||t.removePointerInTextLayer(e.contentDiv),!h(this,$f)&&e.annotationElementId&&h(this,ft).addDeletedAnnotationElement(e)}remove(e){this.detach(e),h(this,ft).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(h(this,ft).addDeletedAnnotationElement(e.annotationElementId),In.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),h(this,ft).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!h(this,Gd)),h(this,ft).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!h(this,ml)&&(e._focusEventsAllowed=!1,_(this,ml,setTimeout(()=>{_(this,ml,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:h(this,ft)._signal}),t.focus())},0))),e._structTreeParentId=(i=h(this,qd))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return h(this,ft).getId()}combinedSignal(e){return h(this,ft).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=h(this,Bn,Va))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await h(this,ft).updateMode(e.mode);const{offsetX:i,offsetY:r}=j(this,Bn,LS).call(this),s=this.getNextId(),a=j(this,Bn,OS).call(this,{parent:this,id:s,x:i,y:r,uiManager:h(this,ft),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=h(la,Hc).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,h(this,ft)))||null}createAndAddNewEditor(e,t,i={}){const r=this.getNextId(),s=j(this,Bn,OS).call(this,{parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:h(this,ft),isCentered:t,...i});return s&&this.add(s),s}addNewEditor(e={}){this.createAndAddNewEditor(j(this,Bn,LS).call(this),!0,e)}setSelected(e){h(this,ft).setSelected(e)}toggleSelected(e){h(this,ft).toggleSelected(e)}unselect(e){h(this,ft).unselect(e)}pointerup(e){var r;const{isMac:t}=nr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!h(this,$c)||(_(this,$c,!1),(r=h(this,Bn,Va))!=null&&r.isDrawer&&h(this,Bn,Va).supportMultipleDrawings))return;if(!h(this,Bf)){_(this,Bf,!0);return}const i=h(this,ft).getMode();if(i===Ct.STAMP||i===Ct.SIGNATURE){h(this,ft).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var r;if(h(this,ft).getMode()===Ct.HIGHLIGHT&&this.enableTextSelection(),h(this,$c)){_(this,$c,!1);return}const{isMac:t}=nr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(_(this,$c,!0),(r=h(this,Bn,Va))!=null&&r.isDrawer){this.startDrawingSession(e);return}const i=h(this,ft).getActive();_(this,Bf,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),h(this,xa)){h(this,Bn,Va).startDrawing(this,h(this,ft),!1,e);return}h(this,ft).setCurrentDrawingSession(this),_(this,xa,new AbortController);const t=h(this,ft).combinedSignal(h(this,xa));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(_(this,gl,null),this.commitOrRemove())},{signal:t}),h(this,Bn,Va).startDrawing(this,h(this,ft),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&_(this,gl,t);return}h(this,gl)&&setTimeout(()=>{var t;(t=h(this,gl))==null||t.focus(),_(this,gl,null)},0)}endDrawingSession(e=!1){return h(this,xa)?(h(this,ft).setCurrentDrawingSession(null),h(this,xa).abort(),_(this,xa,null),_(this,gl,null),h(this,Bn,Va).endDrawing(e)):null}findNewParent(e,t,i){const r=h(this,ft).findParent(t,i);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return h(this,xa)?(this.endDrawingSession(),!0):!1}onScaleChanging(){h(this,xa)&&h(this,Bn,Va).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=h(this,ft).getActive())==null?void 0:e.parent)===this&&(h(this,ft).commitOrRemove(),h(this,ft).setActiveEditor(null)),h(this,ml)&&(clearTimeout(h(this,ml)),_(this,ml,null));for(const i of h(this,ws).values())(t=h(this,qd))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,h(this,ws).clear(),h(this,ft).removeLayer(this)}render({viewport:e}){this.viewport=e,ih(this.div,e);for(const t of h(this,ft).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){h(this,ft).commitOrRemove(),j(this,Bn,M0).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,ih(this.div,{rotation:i}),t!==i)for(const r of h(this,ws).values())r.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return h(this,ft).viewParameters.realScale}};qd=new WeakMap,Bf=new WeakMap,ho=new WeakMap,Bc=new WeakMap,ml=new WeakMap,ws=new WeakMap,$c=new WeakMap,$f=new WeakMap,Gd=new WeakMap,xa=new WeakMap,gl=new WeakMap,Vi=new WeakMap,bl=new WeakMap,Wc=new WeakMap,Wf=new WeakMap,ft=new WeakMap,Hc=new WeakMap,Bn=new WeakSet,bF=function(e){h(this,ft).unselectAll();const{target:t}=e;if(t===h(this,Vi).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&h(this,Vi).div.contains(t)){const{isMac:i}=nr.platform;if(e.button!==0||e.ctrlKey&&i)return;h(this,ft).showAllEditors("highlight",!0,!0),h(this,Vi).div.classList.add("free"),this.toggleDrawing(),cx.startHighlighting(this,h(this,ft).direction==="ltr",{target:h(this,Vi).div,x:e.x,y:e.y}),h(this,Vi).div.addEventListener("pointerup",()=>{h(this,Vi).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:h(this,ft)._signal}),e.preventDefault()}},Va=function(){return h(la,Hc).get(h(this,ft).getMode())},OS=function(e){const t=h(this,Bn,Va);return t?new t.prototype.constructor(e):null},LS=function(){const{x:e,y:t,width:i,height:r}=this.div.getBoundingClientRect(),s=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+i),l=Math.min(window.innerHeight,t+r),c=(s+o)/2-e,u=(a+l)/2-t,[p,m]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:p,offsetY:m}},M0=function(){for(const e of h(this,ws).values())e.isEmpty()&&e.remove()},Me(la,"_initialized",!1),M(la,Hc,new Map([gS,NS,RS,cx,IS].map(e=>[e._editorType,e])));let jS=la;var wa,_r,Yd,fy,Mx,yF,bo,VS,vF,US;const wi=class wi{constructor({pageIndex:e}){M(this,bo);M(this,wa,null);M(this,_r,new Map);M(this,Yd,new Map);this.pageIndex=e}setParent(e){if(!h(this,wa)){_(this,wa,e);return}if(h(this,wa)!==e){if(h(this,_r).size>0)for(const t of h(this,_r).values())t.remove(),e.append(t);_(this,wa,e)}}static get _svgFactory(){return Wt(this,"_svgFactory",new ox)}draw(e,t=!1,i=!1){const r=Ti(wi,fy)._++,s=j(this,bo,VS).call(this),a=wi._svgFactory.createElement("defs");s.append(a);const o=wi._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&h(this,Yd).set(r,o);const c=i?j(this,bo,vF).call(this,a,l):null,u=wi._svgFactory.createElement("use");return s.append(u),u.setAttribute("href",`#${l}`),this.updateProperties(s,e),h(this,_r).set(r,s),{id:r,clipPathId:`url(#${c})`}}drawOutline(e,t){const i=Ti(wi,fy)._++,r=j(this,bo,VS).call(this),s=wi._svgFactory.createElement("defs");r.append(s);const a=wi._svgFactory.createElement("path");s.append(a);const o=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const p=wi._svgFactory.createElement("mask");s.append(p),l=`mask_p${this.pageIndex}_${i}`,p.setAttribute("id",l),p.setAttribute("maskUnits","objectBoundingBox");const m=wi._svgFactory.createElement("rect");p.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const g=wi._svgFactory.createElement("use");p.append(g),g.setAttribute("href",`#${o}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const c=wi._svgFactory.createElement("use");r.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const u=c.cloneNode();return r.append(u),c.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(r,e),h(this,_r).set(i,r),i}finalizeDraw(e,t){h(this,Yd).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:i,bbox:r,rootClass:s,path:a}=t,o=typeof e=="number"?h(this,_r).get(e):e;if(o){if(i&&j(this,bo,US).call(this,o,i),r&&j(l=wi,Mx,yF).call(l,o,r),s){const{classList:c}=o;for(const[u,p]of Object.entries(s))c.toggle(u,p)}if(a){const u=o.firstChild.firstChild;j(this,bo,US).call(this,u,a)}}}updateParent(e,t){if(t===this)return;const i=h(this,_r).get(e);i&&(h(t,wa).append(i),h(this,_r).delete(e),h(t,_r).set(e,i))}remove(e){h(this,Yd).delete(e),h(this,wa)!==null&&(h(this,_r).get(e).remove(),h(this,_r).delete(e))}destroy(){_(this,wa,null);for(const e of h(this,_r).values())e.remove();h(this,_r).clear(),h(this,Yd).clear()}};wa=new WeakMap,_r=new WeakMap,Yd=new WeakMap,fy=new WeakMap,Mx=new WeakSet,yF=function(e,[t,i,r,s]){const{style:a}=e;a.top=`${100*i}%`,a.left=`${100*t}%`,a.width=`${100*r}%`,a.height=`${100*s}%`},bo=new WeakSet,VS=function(){const e=wi._svgFactory.create(1,1,!0);return h(this,wa).append(e),e.setAttribute("aria-hidden",!0),e},vF=function(e,t){const i=wi._svgFactory.createElement("clipPath");e.append(i);const r=`clip_${t}`;i.setAttribute("id",r),i.setAttribute("clipPathUnits","objectBoundingBox");const s=wi._svgFactory.createElement("use");return i.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),r},US=function(e,t){for(const[i,r]of Object.entries(t))r===null?e.removeAttribute(i):e.setAttribute(i,r)},M(wi,Mx),M(wi,fy,0);let FS=wi;globalThis._pdfjsTestingUtils={HighlightOutliner:yS};globalThis.pdfjsLib={AbortException:Xc,AnnotationEditorLayer:jS,AnnotationEditorParamsType:Zt,AnnotationEditorType:Ct,AnnotationEditorUIManager:rh,AnnotationLayer:pS,AnnotationMode:Gl,AnnotationType:ui,build:VQ,ColorPicker:sx,createValidAbsoluteUrl:hO,DOMSVGFactory:ox,DrawLayer:FS,FeatureTest:nr,fetchData:Dy,getDocument:gL,getFilenameFromUrl:TK,getPdfFilenameFromUrl:IK,getRGB:iw,getUuid:mO,getXfaPageViewport:MK,GlobalWorkerOptions:fo,ImageKind:r0,InvalidPDFException:SD,isDataScheme:nw,isPdfFile:eN,isValidExplicitDest:HK,MathClamp:Ar,noContextMenu:ea,normalizeUnicode:CK,OPS:ex,OutputScale:go,PasswordResponses:vK,PDFDataRangeTransport:bL,PDFDateString:nx,PDFWorker:Ig,PermissionFlag:yK,PixelsPerInch:Kc,RenderingCancelledException:ZE,ResponseException:tx,setLayerDimensions:ih,shadow:Wt,SignatureExtractor:yl,stopEvent:hi,SupportedImageMimeTypes:ND,TextLayer:Pg,TouchManager:rx,updateUrlHash:pO,Util:gt,VerbosityLevel:Zx,version:FQ,XfaLayer:wL};fo.workerSrc="/pdf/pdf.worker.min.js";const iI=({url:n,fileName:e="document.pdf"})=>{const[t,i]=T.useState(null),[r,s]=T.useState(1),[a,o]=T.useState(0),[l,c]=T.useState(1),[u,p]=T.useState(!0),[m,g]=T.useState(null),[y,v]=T.useState(""),[w,k]=T.useState(!1),[S,E]=T.useState(!0),[P,A]=T.useState(null),N=T.useRef(null),R=T.useRef(null),V=T.useRef(null),B=We(oe=>oe.linkActivation),L=We(oe=>oe.setLinkActivation);T.useEffect(()=>{(B==null?void 0:B.type)==="citation"&&B.targetPage&&(s(B.targetPage),L(null))},[B,L]),T.useEffect(()=>(n&&(async()=>{try{p(!0),g(null);const xe=await gL(n).promise;i(xe),o(xe.numPages),s(1)}catch(be){console.error("Error loading PDF:",be),g("Failed to load PDF document")}finally{p(!1)}})(),()=>{t&&t.destroy()}),[n]);const W=T.useCallback(async(oe,be)=>{if(!(!t||!N.current))try{const xe=await t.getPage(oe),je=N.current,ze=je.getContext("2d");if(!ze)return;const Ve=be||l,we=xe.getViewport({scale:Ve});je.height=we.height,je.width=we.width;const Ae={canvasContext:ze,viewport:we};await xe.render(Ae).promise}catch(xe){console.error("Error rendering page:",xe)}},[t,l]);T.useEffect(()=>{t&&W(r)},[t,r,l,W]);const q=oe=>{oe>=1&&oe<=a&&s(oe)},X=()=>q(r+1),G=()=>q(r-1),K=()=>c(oe=>Math.min(oe*1.25,3)),J=()=>c(oe=>Math.max(oe/1.25,.5)),ee=()=>{if(R.current){const oe=R.current.clientWidth-(S?200:0)-40;c(oe/600)}},fe=()=>{if(R.current){const oe=R.current.clientHeight-80,xe=(R.current.clientWidth-(S?200:0)-40)/600,je=oe/800;c(Math.min(xe,je))}},ae=()=>{var oe;w?document.exitFullscreen():(oe=R.current)==null||oe.requestFullscreen(),k(!w)},U=()=>{const oe=document.createElement("a");oe.href=n,oe.download=e,document.body.appendChild(oe),oe.click(),document.body.removeChild(oe)},he=()=>{window.open(n,"_blank")},ie=()=>{console.log("Searching for:",y)},$=oe=>{const be=parseInt(oe.target.value);isNaN(be)||q(be)},Y=()=>{if(!S||!t)return null;const oe=Array.from({length:a},(be,xe)=>xe+1);return b.jsxDEV(re,{ref:V,sx:{width:180,height:"100%",overflowY:"auto",backgroundColor:"#f8f9fa",borderRight:"1px solid #e5e7eb",p:1},children:[b.jsxDEV(ge,{variant:"caption",sx:{mb:1,display:"block",textAlign:"center"},children:"Pages"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:234,columnNumber:9},void 0),oe.map(be=>b.jsxDEV(sn,{elevation:r===be?2:0,sx:{mb:1,p:1,cursor:"pointer",border:r===be?"2px solid #2563eb":"1px solid #e5e7eb",backgroundColor:r===be?"#eff6ff":"white",transition:"all 0.2s ease","&:hover":{backgroundColor:"#f3f4f6",elevation:1}},onClick:()=>q(be),children:[b.jsxDEV(ge,{variant:"caption",sx:{textAlign:"center",display:"block"},children:be},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:255,columnNumber:13},void 0),b.jsxDEV(re,{sx:{width:"100%",height:60,backgroundColor:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center",mt:.5},children:b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:["Page ",be]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:272,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:259,columnNumber:13},void 0)]},be,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:238,columnNumber:11},void 0))]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:223,columnNumber:7},void 0)};return u?b.jsxDEV(re,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",backgroundColor:"#f8f9fa"},children:[b.jsxDEV(Yr,{size:48,thickness:4,sx:{color:"#2563eb"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:292,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"body2",sx:{mt:2,color:"#666666"},children:"Loading PDF document..."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:293,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:284,columnNumber:7},void 0):m?b.jsxDEV(re,{sx:{p:3,height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:b.jsxDEV(Aa,{severity:"error",sx:{width:"100%",maxWidth:400},children:m},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:303,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:302,columnNumber:7},void 0):b.jsxDEV(re,{ref:R,sx:{height:"100%",display:"flex",flexDirection:"column",backgroundColor:"#ffffff",overflow:"hidden"},children:[b.jsxDEV(sn,{elevation:0,sx:{borderBottom:"1px solid #e5e7eb"},children:b.jsxDEV(gy,{variant:"dense",sx:{minHeight:56,px:2},children:[b.jsxDEV(hg,{size:"small",variant:"outlined",sx:{mr:2},children:[b.jsxDEV(Nt,{title:"Previous page",children:b.jsxDEV("span",{children:b.jsxDEV(ut,{onClick:G,disabled:r<=1,size:"small",children:b.jsxDEV($R,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:333,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:328,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:327,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:326,columnNumber:13},void 0),b.jsxDEV(Nt,{title:"Next page",children:b.jsxDEV("span",{children:b.jsxDEV(ut,{onClick:X,disabled:r>=a,size:"small",children:b.jsxDEV(P4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:344,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:339,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:338,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:337,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:325,columnNumber:11},void 0),b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",mr:3},children:[b.jsxDEV(Ni,{size:"small",value:r,onChange:$,inputProps:{min:1,max:a,type:"number",style:{width:"60px",textAlign:"center"}},sx:{"& .MuiOutlinedInput-root":{height:"32px"}}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:352,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"body2",sx:{ml:1,color:"#666666"},children:["of ",a]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:368,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:351,columnNumber:11},void 0),b.jsxDEV(Pr,{orientation:"vertical",flexItem:!0,sx:{mr:2}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:373,columnNumber:11},void 0),b.jsxDEV(hg,{size:"small",variant:"outlined",sx:{mr:2},children:[b.jsxDEV(Nt,{title:"Zoom out",children:b.jsxDEV(ut,{onClick:J,size:"small",children:b.jsxDEV(mE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:379,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:378,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:377,columnNumber:13},void 0),b.jsxDEV(Nt,{title:"Zoom in",children:b.jsxDEV(ut,{onClick:K,size:"small",children:b.jsxDEV(gE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:384,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:383,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:382,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:376,columnNumber:11},void 0),b.jsxDEV(hg,{size:"small",variant:"outlined",sx:{mr:2},children:[b.jsxDEV(Nt,{title:"Fit to width",children:b.jsxDEV(vt,{onClick:ee,size:"small",sx:{minWidth:"auto",px:1},children:b.jsxDEV(T4,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:393,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:392,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:391,columnNumber:13},void 0),b.jsxDEV(Nt,{title:"Fit to page",children:b.jsxDEV(vt,{onClick:fe,size:"small",sx:{minWidth:"auto",px:1},children:b.jsxDEV(WR,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:398,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:397,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:396,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:390,columnNumber:11},void 0),b.jsxDEV(ge,{variant:"body2",sx:{mr:2,minWidth:"50px",color:"#666666"},children:[Math.round(l*100),"%"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:404,columnNumber:11},void 0),b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",mr:2,flexGrow:1,maxWidth:300},children:b.jsxDEV(Ni,{size:"small",placeholder:"Search in document...",value:y,onChange:oe=>v(oe.target.value),onKeyPress:oe=>oe.key==="Enter"&&ie(),sx:{flexGrow:1,"& .MuiOutlinedInput-root":{height:"32px"}},InputProps:{endAdornment:b.jsxDEV(ut,{onClick:ie,size:"small",edge:"end",children:b.jsxDEV(VR,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:425,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:424,columnNumber:19},void 0)}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:410,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:409,columnNumber:11},void 0),b.jsxDEV(ut,{onClick:oe=>A(oe.currentTarget),size:"small",children:b.jsxDEV(my,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:437,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:433,columnNumber:11},void 0),b.jsxDEV(ru,{anchorEl:P,open:!!P,onClose:()=>A(null),children:[b.jsxDEV(Dn,{onClick:ae,children:[b.jsxDEV(Ui,{children:w?b.jsxDEV(pE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:447,columnNumber:33},void 0):b.jsxDEV(fE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:447,columnNumber:54},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:446,columnNumber:15},void 0),b.jsxDEV(si,{children:w?"Exit Fullscreen":"Fullscreen"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:449,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:445,columnNumber:13},void 0),b.jsxDEV(Dn,{onClick:()=>E(!S),children:b.jsxDEV(si,{children:S?"Hide Thumbnails":"Show Thumbnails"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:454,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:453,columnNumber:13},void 0),b.jsxDEV(Dn,{onClick:U,children:[b.jsxDEV(Ui,{children:b.jsxDEV(Vx,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:460,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:459,columnNumber:15},void 0),b.jsxDEV(si,{children:"Download"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:462,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:458,columnNumber:13},void 0),b.jsxDEV(Dn,{onClick:he,children:[b.jsxDEV(Ui,{children:b.jsxDEV(BR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:466,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:465,columnNumber:15},void 0),b.jsxDEV(si,{children:"Print"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:468,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:464,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:440,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:323,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:322,columnNumber:7},void 0),b.jsxDEV(re,{sx:{display:"flex",flex:1,overflow:"hidden"},children:[Y(),b.jsxDEV(re,{sx:{flex:1,overflow:"auto",backgroundColor:"#f8f9fa",display:"flex",justifyContent:"center",alignItems:"flex-start",p:2},children:b.jsxDEV(sn,{elevation:3,sx:{display:"inline-block",backgroundColor:"white",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"},children:b.jsxDEV("canvas",{ref:N,style:{display:"block",maxWidth:"100%",height:"auto"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:499,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:491,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:480,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:475,columnNumber:7},void 0),b.jsxDEV(sn,{elevation:0,sx:{borderTop:"1px solid #e5e7eb",py:.5,px:2},children:b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:[e," • Page ",r," of ",a," • ",Math.round(l*100),"% zoom"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:513,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:512,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalPdfViewer.tsx",lineNumber:311,columnNumber:5},void 0)};var Qs=function(n,e){return Number(n.toFixed(e))},lJ=function(n,e){return e},zn=function(n,e,t){t&&typeof t=="function"&&t(n,e)},cJ=function(n){return-Math.cos(n*Math.PI)/2+.5},uJ=function(n){return n},dJ=function(n){return n*n},hJ=function(n){return n*(2-n)},pJ=function(n){return n<.5?2*n*n:-1+(4-2*n)*n},fJ=function(n){return n*n*n},mJ=function(n){return--n*n*n+1},gJ=function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},bJ=function(n){return n*n*n*n},yJ=function(n){return 1- --n*n*n*n},vJ=function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},xJ=function(n){return n*n*n*n*n},wJ=function(n){return 1+--n*n*n*n*n},kJ=function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n},xF={easeOut:cJ,linear:uJ,easeInQuad:dJ,easeOutQuad:hJ,easeInOutQuad:pJ,easeInCubic:fJ,easeOutCubic:mJ,easeInOutCubic:gJ,easeInQuart:bJ,easeOutQuart:yJ,easeInOutQuart:vJ,easeInQuint:xJ,easeOutQuint:wJ,easeInOutQuint:kJ},wF=function(n){typeof n=="number"&&cancelAnimationFrame(n)},Ea=function(n){n.mounted&&(wF(n.animation),n.animate=!1,n.animation=null,n.velocity=null)};function kF(n,e,t,i){if(n.mounted){var r=new Date().getTime(),s=1;Ea(n),n.animation=function(){if(!n.mounted)return wF(n.animation);var a=new Date().getTime()-r,o=a/t,l=xF[e],c=l(o);a>=t?(i(s),n.animation=null):n.animation&&(i(c),requestAnimationFrame(n.animation))},requestAnimationFrame(n.animation)}}function DJ(n){var e=n.scale,t=n.positionX,i=n.positionY;return!(Number.isNaN(e)||Number.isNaN(t)||Number.isNaN(i))}function ou(n,e,t,i){var r=DJ(e);if(!(!n.mounted||!r)){var s=n.setTransformState,a=n.transformState,o=a.scale,l=a.positionX,c=a.positionY,u=e.scale-o,p=e.positionX-l,m=e.positionY-c;t===0?s(e.scale,e.positionX,e.positionY):kF(n,i,t,function(g){var y=o+u*g,v=l+p*g,w=c+m*g;s(y,v,w)})}}function SJ(n,e,t){var i=n.offsetWidth,r=n.offsetHeight,s=e.offsetWidth,a=e.offsetHeight,o=s*t,l=a*t,c=i-o,u=r-l;return{wrapperWidth:i,wrapperHeight:r,newContentWidth:o,newDiffWidth:c,newContentHeight:l,newDiffHeight:u}}var EJ=function(n,e,t,i,r,s,a){var o=n>e?t*(a?1:.5):0,l=i>r?s*(a?1:.5):0,c=n-e-o,u=o,p=i-r-l,m=l;return{minPositionX:c,maxPositionX:u,minPositionY:p,maxPositionY:m}},lN=function(n,e){var t=n.wrapperComponent,i=n.contentComponent,r=n.setup.centerZoomedOut;if(!t||!i)throw new Error("Components are not mounted");var s=SJ(t,i,e),a=s.wrapperWidth,o=s.wrapperHeight,l=s.newContentWidth,c=s.newDiffWidth,u=s.newContentHeight,p=s.newDiffHeight,m=EJ(a,l,c,o,u,p,!!r);return m},zS=function(n,e,t,i){return i?n<e?Qs(e,2):n>t?Qs(t,2):Qs(n,2):Qs(n,2)},Kd=function(n,e){var t=lN(n,e);return n.bounds=t,t};function Cy(n,e,t,i,r,s,a){var o=t.minPositionX,l=t.minPositionY,c=t.maxPositionX,u=t.maxPositionY,p=0,m=0;a&&(p=r,m=s);var g=zS(n,o-p,c+p,i),y=zS(e,l-m,u+m,i);return{x:g,y}}function aw(n,e,t,i,r,s){var a=n.transformState,o=a.scale,l=a.positionX,c=a.positionY,u=i-o;if(typeof e!="number"||typeof t!="number")return console.error("Mouse X and Y position were not provided!"),{x:l,y:c};var p=l-e*u,m=c-t*u,g=Cy(p,m,r,s,0,0,null);return g}function Ay(n,e,t,i,r){var s=r?i:0,a=e-s;return!Number.isNaN(t)&&n>=t?t:!Number.isNaN(e)&&n<=a?a:n}var rI=function(n,e){var t=n.setup.panning.excluded,i=n.isInitialized,r=n.wrapperComponent,s=e.target,a="shadowRoot"in s&&"composedPath"in e,o=a?e.composedPath().some(function(u){return u instanceof Element?r==null?void 0:r.contains(u):!1}):r==null?void 0:r.contains(s),l=i&&s&&o;if(!l)return!1;var c=ow(s,t);return!c},sI=function(n){var e=n.isInitialized,t=n.isPanning,i=n.setup,r=i.panning.disabled,s=e&&t&&!r;return!!s},NJ=function(n,e){var t=n.transformState,i=t.positionX,r=t.positionY;n.isPanning=!0;var s=e.clientX,a=e.clientY;n.startCoords={x:s-i,y:a-r}},_J=function(n,e){var t=e.touches,i=n.transformState,r=i.positionX,s=i.positionY;n.isPanning=!0;var a=t.length===1;if(a){var o=t[0].clientX,l=t[0].clientY;n.startCoords={x:o-r,y:l-s}}};function CJ(n){var e=n.transformState,t=e.positionX,i=e.positionY,r=e.scale,s=n.setup,a=s.disabled,o=s.limitToBounds,l=s.centerZoomedOut,c=n.wrapperComponent;if(!(a||!c||!n.bounds)){var u=n.bounds,p=u.maxPositionX,m=u.minPositionX,g=u.maxPositionY,y=u.minPositionY,v=t>p||t<m,w=i>g||i<y,k=t>p?c.offsetWidth:n.setup.minPositionX||0,S=i>g?c.offsetHeight:n.setup.minPositionY||0,E=aw(n,k,S,r,n.bounds,o||l),P=E.x,A=E.y;return{scale:r,positionX:v?P:t,positionY:w?A:i}}}function DF(n,e,t,i,r){var s=n.setup.limitToBounds,a=n.wrapperComponent,o=n.bounds,l=n.transformState,c=l.scale,u=l.positionX,p=l.positionY;if(!(a===null||o===null||e===u&&t===p)){var m=Cy(e,t,o,s,i,r,a),g=m.x,y=m.y;n.setTransformState(c,g,y)}}var AJ=function(n,e,t){var i=n.startCoords,r=n.transformState,s=n.setup.panning,a=s.lockAxisX,o=s.lockAxisY,l=r.positionX,c=r.positionY;if(!i)return{x:l,y:c};var u=e-i.x,p=t-i.y,m=a?l:u,g=o?c:p;return{x:m,y:g}},Qc=function(n,e){var t=n.setup,i=n.transformState,r=i.scale,s=t.minScale,a=t.disablePadding;return e>0&&r>=s&&!a?e:0},PJ=function(n){var e=n.mounted,t=n.setup,i=t.disabled,r=t.velocityAnimation,s=n.transformState.scale,a=r.disabled,o=!a||s>1||!i||e;return!!o},TJ=function(n){var e=n.mounted,t=n.velocity,i=n.bounds,r=n.setup,s=r.disabled,a=r.velocityAnimation,o=n.transformState.scale,l=a.disabled,c=!l||o>1||!s||e;return!(!c||!t||!i)};function IJ(n,e){var t=n.setup.velocityAnimation,i=t.equalToMove,r=t.animationTime,s=t.sensitivity;return i?r*e*s:r}function aI(n,e,t,i,r,s,a,o,l,c){if(r){if(e>a&&t>a){var u=a+(n-a)*c;return u>l?l:u<a?a:u}if(e<s&&t<s){var u=s+(n-s)*c;return u<o?o:u>s?s:u}}return i?e:zS(n,s,a,r)}function RJ(n,e){var t=1;return e?Math.min(t,n.offsetWidth/window.innerWidth):t}function MJ(n,e){var t=PJ(n);if(t){var i=n.lastMousePosition,r=n.velocityTime,s=n.setup,a=n.wrapperComponent,o=s.velocityAnimation.equalToMove,l=Date.now();if(i&&r&&a){var c=RJ(a,o),u=e.x-i.x,p=e.y-i.y,m=u/c,g=p/c,y=l-r,v=u*u+p*p,w=Math.sqrt(v)/y;n.velocity={velocityX:m,velocityY:g,total:w}}n.lastMousePosition=e,n.velocityTime=l}}function jJ(n){var e=n.velocity,t=n.bounds,i=n.setup,r=n.wrapperComponent,s=TJ(n);if(!(!s||!e||!t||!r)){var a=e.velocityX,o=e.velocityY,l=e.total,c=t.maxPositionX,u=t.minPositionX,p=t.maxPositionY,m=t.minPositionY,g=i.limitToBounds,y=i.alignmentAnimation,v=i.zoomAnimation,w=i.panning,k=w.lockAxisY,S=w.lockAxisX,E=v.animationType,P=y.sizeX,A=y.sizeY,N=y.velocityAlignmentTime,R=N,V=IJ(n,l),B=Math.max(V,R),L=Qc(n,P),W=Qc(n,A),q=L*r.offsetWidth/100,X=W*r.offsetHeight/100,G=c+q,K=u-q,J=p+X,ee=m-X,fe=n.transformState,ae=new Date().getTime();kF(n,E,B,function(U){var he=n.transformState,ie=he.scale,$=he.positionX,Y=he.positionY,oe=new Date().getTime()-ae,be=oe/R,xe=xF[y.animationType],je=1-xe(Math.min(1,be)),ze=1-U,Ve=$+a*ze,we=Y+o*ze,Ae=aI(Ve,fe.positionX,$,S,g,u,c,K,G,je),_e=aI(we,fe.positionY,Y,k,g,m,p,ee,J,je);($!==Ve||Y!==we)&&n.setTransformState(ie,Ae,_e)})}}function oI(n,e){var t=n.transformState.scale;Ea(n),Kd(n,t),window.TouchEvent!==void 0&&e instanceof TouchEvent?_J(n,e):NJ(n,e)}function cN(n,e){var t=n.transformState.scale,i=n.setup,r=i.minScale,s=i.alignmentAnimation,a=s.disabled,o=s.sizeX,l=s.sizeY,c=s.animationTime,u=s.animationType,p=a||t<r||!o&&!l;if(!p){var m=CJ(n);m&&ou(n,m,e??c,u)}}function lI(n,e,t){var i=n.startCoords,r=n.setup,s=r.alignmentAnimation,a=s.sizeX,o=s.sizeY;if(i){var l=AJ(n,e,t),c=l.x,u=l.y,p=Qc(n,a),m=Qc(n,o);MJ(n,{x:c,y:u}),DF(n,c,u,p,m)}}function OJ(n){if(n.isPanning){var e=n.setup.panning.velocityDisabled,t=n.velocity,i=n.wrapperComponent,r=n.contentComponent;n.isPanning=!1,n.animate=!1,n.animation=null;var s=i==null?void 0:i.getBoundingClientRect(),a=r==null?void 0:r.getBoundingClientRect(),o=(s==null?void 0:s.width)||0,l=(s==null?void 0:s.height)||0,c=(a==null?void 0:a.width)||0,u=(a==null?void 0:a.height)||0,p=o<c||l<u,m=!e&&t&&(t==null?void 0:t.total)>.1&&p;m?jJ(n):cN(n)}}function uN(n,e,t,i){var r=n.setup,s=r.minScale,a=r.maxScale,o=r.limitToBounds,l=Ay(Qs(e,2),s,a,0,!1),c=Kd(n,l),u=aw(n,t,i,l,c,o),p=u.x,m=u.y;return{scale:l,positionX:p,positionY:m}}function SF(n,e,t){var i=n.transformState.scale,r=n.wrapperComponent,s=n.setup,a=s.minScale,o=s.limitToBounds,l=s.zoomAnimation,c=l.disabled,u=l.animationTime,p=l.animationType,m=c||i>=a;if((i>=1||o)&&cN(n),!(m||!r||!n.mounted)){var g=e||r.offsetWidth/2,y=t||r.offsetHeight/2,v=uN(n,a,g,y);v&&ou(n,v,u,p)}}var Gc=function(){return Gc=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Gc.apply(this,arguments)};function cI(n,e,t){for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return n.concat(s||Array.prototype.slice.call(e))}var Hv={scale:1,positionX:0,positionY:0},Om={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},BS={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},EF=function(n){var e,t,i,r;return{previousScale:(e=n.initialScale)!==null&&e!==void 0?e:Hv.scale,scale:(t=n.initialScale)!==null&&t!==void 0?t:Hv.scale,positionX:(i=n.initialPositionX)!==null&&i!==void 0?i:Hv.positionX,positionY:(r=n.initialPositionY)!==null&&r!==void 0?r:Hv.positionY}},uI=function(n){var e=Gc({},Om);return Object.keys(n).forEach(function(t){var i=typeof n[t]<"u",r=typeof Om[t]<"u";if(r&&i){var s=Object.prototype.toString.call(Om[t]),a=s==="[object Object]",o=s==="[object Array]";a?e[t]=Gc(Gc({},Om[t]),n[t]):o?e[t]=cI(cI([],Om[t],!0),n[t]):e[t]=n[t]}}),e},NF=function(n,e,t){var i=n.transformState.scale,r=n.wrapperComponent,s=n.setup,a=s.maxScale,o=s.minScale,l=s.zoomAnimation,c=s.smooth,u=l.size;if(!r)throw new Error("Wrapper is not mounted");var p=c?i*Math.exp(e*t):i+e*t,m=Ay(Qs(p,3),o,a,u,!1);return m};function _F(n,e,t,i,r){var s=n.wrapperComponent,a=n.transformState,o=a.scale,l=a.positionX,c=a.positionY;if(!s)return console.error("No WrapperComponent found");var u=s.offsetWidth,p=s.offsetHeight,m=(u/2-l)/o,g=(p/2-c)/o,y=NF(n,e,t),v=uN(n,y,m,g);if(!v)return console.error("Error during zoom event. New transformation state was not calculated.");ou(n,v,i,r)}function CF(n,e,t,i){var r=n.setup,s=n.wrapperComponent,a=r.limitToBounds,o=EF(n.props),l=n.transformState,c=l.scale,u=l.positionX,p=l.positionY;if(s){var m=lN(n,o.scale),g=Cy(o.positionX,o.positionY,m,a,0,0,s),y={scale:o.scale,positionX:g.x,positionY:g.y};c===o.scale&&u===o.positionX&&p===o.positionY||(i==null||i(),ou(n,y,e,t))}}function LJ(n,e,t,i){var r=n.getBoundingClientRect(),s=e.getBoundingClientRect(),a=t.getBoundingClientRect(),o=s.x*i.scale,l=s.y*i.scale;return{x:(r.x-a.x+o)/i.scale,y:(r.y-a.y+l)/i.scale}}function FJ(n,e,t){var i=n.wrapperComponent,r=n.contentComponent,s=n.transformState,a=n.setup,o=a.limitToBounds,l=a.minScale,c=a.maxScale;if(!i||!r)return s;var u=i.getBoundingClientRect(),p=e.getBoundingClientRect(),m=LJ(e,i,r,s),g=m.x,y=m.y,v=p.width/s.scale,w=p.height/s.scale,k=i.offsetWidth/v,S=i.offsetHeight/w,E=Ay(t||Math.min(k,S),l,c,0,!1),P=(u.width-v*E)/2,A=(u.height-w*E)/2,N=(u.left-g)*E+P,R=(u.top-y)*E+A,V=lN(n,E),B=Cy(N,R,V,o,0,0,i),L=B.x,W=B.y;return{positionX:L,positionY:W,scale:E}}var VJ=function(n){return function(e,t,i){e===void 0&&(e=.5),t===void 0&&(t=300),i===void 0&&(i="easeOut"),_F(n,1,e,t,i)}},UJ=function(n){return function(e,t,i){e===void 0&&(e=.5),t===void 0&&(t=300),i===void 0&&(i="easeOut"),_F(n,-1,e,t,i)}},zJ=function(n){return function(e,t,i,r,s){r===void 0&&(r=300),s===void 0&&(s="easeOut");var a=n.transformState,o=a.positionX,l=a.positionY,c=a.scale,u=n.wrapperComponent,p=n.contentComponent,m=n.setup.disabled;if(!(m||!u||!p)){var g={positionX:Number.isNaN(e)?o:e,positionY:Number.isNaN(t)?l:t,scale:Number.isNaN(i)?c:i};ou(n,g,r,s)}}},BJ=function(n){return function(e,t){e===void 0&&(e=200),t===void 0&&(t="easeOut"),CF(n,e,t)}},$J=function(n){return function(e,t,i){t===void 0&&(t=200),i===void 0&&(i="easeOut");var r=n.transformState,s=n.wrapperComponent,a=n.contentComponent;if(s&&a){var o=AF(e||r.scale,s,a);ou(n,o,t,i)}}},WJ=function(n){return function(e,t,i,r){i===void 0&&(i=600),r===void 0&&(r="easeOut"),Ea(n);var s=n.wrapperComponent,a=typeof e=="string"?document.getElementById(e):e;if(s&&a&&s.contains(a)){var o=FJ(n,a,t);ou(n,o,i,r)}}},$S=function(n){return{instance:n,zoomIn:VJ(n),zoomOut:UJ(n),setTransform:zJ(n),resetTransform:BJ(n),centerView:$J(n),zoomToElement:WJ(n)}},HJ=function(n){return{instance:n,state:n.transformState}},Tn=function(n){var e={};return Object.assign(e,HJ(n)),Object.assign(e,$S(n)),e},i1=!1;function r1(){try{var n={get passive(){return i1=!0,!1}};return n}catch{return i1=!1,i1}}var qv=".".concat(BS.wrapperClass),ow=function(n,e){return e.some(function(t){return n.matches("".concat(qv," ").concat(t,", ").concat(qv," .").concat(t,", ").concat(qv," ").concat(t," *, ").concat(qv," .").concat(t," *"))})},WS=function(n){n&&clearTimeout(n)},qJ=function(n,e,t){return"translate(".concat(n,"px, ").concat(e,"px) scale(").concat(t,")")},AF=function(n,e,t){var i=t.offsetWidth*n,r=t.offsetHeight*n,s=(e.offsetWidth-i)/2,a=(e.offsetHeight-r)/2;return{scale:n,positionX:s,positionY:a}};function GJ(n){return function(e){n.forEach(function(t){typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var YJ=function(n,e){var t=n.setup.wheel,i=t.disabled,r=t.wheelDisabled,s=t.touchPadDisabled,a=t.excluded,o=n.isInitialized,l=n.isPanning,c=e.target,u=o&&!l&&!i&&c;if(!u||r&&!e.ctrlKey||s&&e.ctrlKey)return!1;var p=ow(c,a);return!p},XJ=function(n){return n?n.deltaY<0?1:-1:0};function KJ(n,e){var t=XJ(n),i=lJ(e,t);return i}function PF(n,e,t){var i=e.getBoundingClientRect(),r=0,s=0;if("clientX"in n)r=(n.clientX-i.left)/t,s=(n.clientY-i.top)/t;else{var a=n.touches[0];r=(a.clientX-i.left)/t,s=(a.clientY-i.top)/t}return(Number.isNaN(r)||Number.isNaN(s))&&console.error("No mouse or touch offset found"),{x:r,y:s}}var QJ=function(n,e,t,i,r){var s=n.transformState.scale,a=n.wrapperComponent,o=n.setup,l=o.maxScale,c=o.minScale,u=o.zoomAnimation,p=o.disablePadding,m=u.size,g=u.disabled;if(!a)throw new Error("Wrapper is not mounted");var y=s+e*t,v=i?!1:!g,w=Ay(Qs(y,3),c,l,m,v&&!p);return w},JJ=function(n,e){var t=n.previousWheelEvent,i=n.transformState.scale,r=n.setup,s=r.maxScale,a=r.minScale;return t?i<s||i>a||Math.sign(t.deltaY)!==Math.sign(e.deltaY)||t.deltaY>0&&t.deltaY<e.deltaY||t.deltaY<0&&t.deltaY>e.deltaY||Math.sign(t.deltaY)!==Math.sign(e.deltaY):!1},ZJ=function(n,e){var t=n.setup.pinch,i=t.disabled,r=t.excluded,s=n.isInitialized,a=e.target,o=s&&!i&&a;if(!o)return!1;var l=ow(a,r);return!l},eZ=function(n){var e=n.setup.pinch.disabled,t=n.isInitialized,i=n.pinchStartDistance,r=t&&!e&&i;return!!r},tZ=function(n,e,t){var i=t.getBoundingClientRect(),r=n.touches,s=Qs(r[0].clientX-i.left,5),a=Qs(r[0].clientY-i.top,5),o=Qs(r[1].clientX-i.left,5),l=Qs(r[1].clientY-i.top,5);return{x:(s+o)/2/e,y:(a+l)/2/e}},TF=function(n){return Math.sqrt(Math.pow(n.touches[0].pageX-n.touches[1].pageX,2)+Math.pow(n.touches[0].pageY-n.touches[1].pageY,2))},nZ=function(n,e){var t=n.pinchStartScale,i=n.pinchStartDistance,r=n.setup,s=r.maxScale,a=r.minScale,o=r.zoomAnimation,l=r.disablePadding,c=o.size,u=o.disabled;if(!t||i===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return n.transformState.scale;var p=e/i,m=p*t;return Ay(Qs(m,2),a,s,c,!u&&!l)},iZ=160,rZ=100,sZ=function(n,e){var t=n.props,i=t.onWheelStart,r=t.onZoomStart;n.wheelStopEventTimer||(Ea(n),zn(Tn(n),e,i),zn(Tn(n),e,r))},aZ=function(n,e){var t=n.props,i=t.onWheel,r=t.onZoom,s=n.contentComponent,a=n.setup,o=n.transformState,l=o.scale,c=a.limitToBounds,u=a.centerZoomedOut,p=a.zoomAnimation,m=a.wheel,g=a.disablePadding,y=a.smooth,v=p.size,w=p.disabled,k=m.step,S=m.smoothStep;if(!s)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var E=KJ(e,null),P=y?S*Math.abs(e.deltaY):k,A=QJ(n,E,P,!e.ctrlKey);if(l!==A){var N=Kd(n,A),R=PF(e,s,l),V=w||v===0||u||g,B=c&&V,L=aw(n,R.x,R.y,A,N,B),W=L.x,q=L.y;n.previousWheelEvent=e,n.setTransformState(A,W,q),zn(Tn(n),e,i),zn(Tn(n),e,r)}},oZ=function(n,e){var t=n.props,i=t.onWheelStop,r=t.onZoomStop;WS(n.wheelAnimationTimer),n.wheelAnimationTimer=setTimeout(function(){n.mounted&&(SF(n,e.x,e.y),n.wheelAnimationTimer=null)},rZ);var s=JJ(n,e);s&&(WS(n.wheelStopEventTimer),n.wheelStopEventTimer=setTimeout(function(){n.mounted&&(n.wheelStopEventTimer=null,zn(Tn(n),e,i),zn(Tn(n),e,r))},iZ))},IF=function(n){for(var e=0,t=0,i=0;i<2;i+=1)e+=n.touches[i].clientX,t+=n.touches[i].clientY;var r=e/2,s=t/2;return{x:r,y:s}},lZ=function(n,e){var t=TF(e);n.pinchStartDistance=t,n.lastDistance=t,n.pinchStartScale=n.transformState.scale,n.isPanning=!1;var i=IF(e);n.pinchLastCenterX=i.x,n.pinchLastCenterY=i.y,Ea(n)},cZ=function(n,e){var t=n.contentComponent,i=n.pinchStartDistance,r=n.wrapperComponent,s=n.transformState.scale,a=n.setup,o=a.limitToBounds,l=a.centerZoomedOut,c=a.zoomAnimation,u=a.alignmentAnimation,p=c.disabled,m=c.size;if(!(i===null||!t)){var g=tZ(e,s,t);if(!(!Number.isFinite(g.x)||!Number.isFinite(g.y))){var y=TF(e),v=nZ(n,y),w=IF(e),k=w.x-(n.pinchLastCenterX||0),S=w.y-(n.pinchLastCenterY||0);if(!(v===s&&k===0&&S===0)){n.pinchLastCenterX=w.x,n.pinchLastCenterY=w.y;var E=Kd(n,v),P=p||m===0||l,A=o&&P,N=aw(n,g.x,g.y,v,E,A),R=N.x,V=N.y;n.pinchMidpoint=g,n.lastDistance=y;var B=u.sizeX,L=u.sizeY,W=Qc(n,B),q=Qc(n,L),X=R+k,G=V+S,K=Cy(X,G,E,o,W,q,r),J=K.x,ee=K.y;n.setTransformState(v,J,ee)}}}},uZ=function(n){var e=n.pinchMidpoint;n.velocity=null,n.lastDistance=null,n.pinchMidpoint=null,n.pinchStartScale=null,n.pinchStartDistance=null,SF(n,e==null?void 0:e.x,e==null?void 0:e.y)},RF=function(n,e){var t=n.props.onZoomStop,i=n.setup.doubleClick.animationTime;WS(n.doubleClickStopEventTimer),n.doubleClickStopEventTimer=setTimeout(function(){n.doubleClickStopEventTimer=null,zn(Tn(n),e,t)},i)},dZ=function(n,e){var t=n.props,i=t.onZoomStart,r=t.onZoom,s=n.setup.doubleClick,a=s.animationTime,o=s.animationType;zn(Tn(n),e,i),CF(n,a,o,function(){return zn(Tn(n),e,r)}),RF(n,e)};function hZ(n,e){return n==="toggle"?e===1?1:-1:n==="zoomOut"?-1:1}function pZ(n,e){var t=n.setup,i=n.doubleClickStopEventTimer,r=n.transformState,s=n.contentComponent,a=r.scale,o=n.props,l=o.onZoomStart,c=o.onZoom,u=t.doubleClick,p=u.disabled,m=u.mode,g=u.step,y=u.animationTime,v=u.animationType;if(!p&&!i){if(m==="reset")return dZ(n,e);if(!s)return console.error("No ContentComponent found");var w=hZ(m,n.transformState.scale),k=NF(n,w,g);if(a!==k){zn(Tn(n),e,l);var S=PF(e,s,a),E=uN(n,k,S.x,S.y);if(!E)return console.error("Error during zoom event. New transformation state was not calculated.");zn(Tn(n),e,c),ou(n,E,y,v),RF(n,e)}}}var fZ=function(n,e){var t=n.isInitialized,i=n.setup,r=n.wrapperComponent,s=i.doubleClick,a=s.disabled,o=s.excluded,l=e.target,c=r==null?void 0:r.contains(l),u=t&&l&&c&&!a;if(!u)return!1;var p=ow(l,o);return!p},mZ=function(){function n(e){var t=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){t.initializeWindowEvents()},this.unmount=function(){t.cleanupWindowEvents()},this.update=function(i){t.props=i,Kd(t,t.transformState.scale),t.setup=uI(i)},this.initializeWindowEvents=function(){var i,r,s=r1(),a=(i=t.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,o=a==null?void 0:a.defaultView;(r=t.wrapperComponent)===null||r===void 0||r.addEventListener("wheel",t.onWheelPanning,s),o==null||o.addEventListener("mousedown",t.onPanningStart,s),o==null||o.addEventListener("mousemove",t.onPanning,s),o==null||o.addEventListener("mouseup",t.onPanningStop,s),a==null||a.addEventListener("mouseleave",t.clearPanning,s),o==null||o.addEventListener("keyup",t.setKeyUnPressed,s),o==null||o.addEventListener("keydown",t.setKeyPressed,s)},this.cleanupWindowEvents=function(){var i,r,s=r1(),a=(i=t.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,o=a==null?void 0:a.defaultView;o==null||o.removeEventListener("mousedown",t.onPanningStart,s),o==null||o.removeEventListener("mousemove",t.onPanning,s),o==null||o.removeEventListener("mouseup",t.onPanningStop,s),a==null||a.removeEventListener("mouseleave",t.clearPanning,s),o==null||o.removeEventListener("keyup",t.setKeyUnPressed,s),o==null||o.removeEventListener("keydown",t.setKeyPressed,s),document.removeEventListener("mouseleave",t.clearPanning,s),Ea(t),(r=t.observer)===null||r===void 0||r.disconnect()},this.handleInitializeWrapperEvents=function(i){var r=r1();i.addEventListener("wheel",t.onWheelZoom,r),i.addEventListener("dblclick",t.onDoubleClick,r),i.addEventListener("touchstart",t.onTouchPanningStart,r),i.addEventListener("touchmove",t.onTouchPanning,r),i.addEventListener("touchend",t.onTouchPanningStop,r)},this.handleInitialize=function(i,r){var s=!1,a=t.setup.centerOnInit,o=function(l,c){for(var u=0,p=l;u<p.length;u++){var m=p[u];if(m.target===c)return!0}return!1};t.applyTransformation(),t.onInitCallbacks.forEach(function(l){l(Tn(t))}),t.observer=new ResizeObserver(function(l){if(o(l,i)||o(l,r))if(a&&!s){var c=r.offsetWidth,u=r.offsetHeight;(c>0||u>0)&&(s=!0,t.setCenter())}else Ea(t),Kd(t,t.transformState.scale),cN(t,0)}),t.observer.observe(i),t.observer.observe(r)},this.onWheelZoom=function(i){var r=t.setup.disabled;if(!r){var s=YJ(t,i);if(s){var a=t.isPressingKeys(t.setup.wheel.activationKeys);a&&(sZ(t,i),aZ(t,i),oZ(t,i))}}},this.onWheelPanning=function(i){var r=t.setup,s=r.disabled,a=r.wheel,o=r.panning;if(!(!t.wrapperComponent||!t.contentComponent||s||!a.wheelDisabled||o.disabled||!o.wheelPanning||i.ctrlKey)){i.preventDefault(),i.stopPropagation();var l=t.transformState,c=l.positionX,u=l.positionY,p=c-i.deltaX,m=u-i.deltaY,g=o.lockAxisX?c:p,y=o.lockAxisY?u:m,v=t.setup.alignmentAnimation,w=v.sizeX,k=v.sizeY,S=Qc(t,w),E=Qc(t,k);g===c&&y===u||DF(t,g,y,S,E)}},this.onPanningStart=function(i){var r=t.setup.disabled,s=t.props.onPanningStart;if(!r){var a=rI(t,i);if(a){var o=t.isPressingKeys(t.setup.panning.activationKeys);o&&(i.button===0&&!t.setup.panning.allowLeftClickPan||i.button===1&&!t.setup.panning.allowMiddleClickPan||i.button===2&&!t.setup.panning.allowRightClickPan||(i.preventDefault(),i.stopPropagation(),Ea(t),oI(t,i),zn(Tn(t),i,s)))}}},this.onPanning=function(i){var r=t.setup.disabled,s=t.props.onPanning;if(!r){var a=sI(t);if(a){var o=t.isPressingKeys(t.setup.panning.activationKeys);o&&(i.preventDefault(),i.stopPropagation(),lI(t,i.clientX,i.clientY),zn(Tn(t),i,s))}}},this.onPanningStop=function(i){var r=t.props.onPanningStop;t.isPanning&&(OJ(t),zn(Tn(t),i,r))},this.onPinchStart=function(i){var r=t.setup.disabled,s=t.props,a=s.onPinchingStart,o=s.onZoomStart;if(!r){var l=ZJ(t,i);l&&(lZ(t,i),Ea(t),zn(Tn(t),i,a),zn(Tn(t),i,o))}},this.onPinch=function(i){var r=t.setup.disabled,s=t.props,a=s.onPinching,o=s.onZoom;if(!r){var l=eZ(t);l&&(i.preventDefault(),i.stopPropagation(),cZ(t,i),zn(Tn(t),i,a),zn(Tn(t),i,o))}},this.onPinchStop=function(i){var r=t.props,s=r.onPinchingStop,a=r.onZoomStop;t.pinchStartScale&&(uZ(t),zn(Tn(t),i,s),zn(Tn(t),i,a))},this.onTouchPanningStart=function(i){var r=t.setup.disabled,s=t.props.onPanningStart;if(!r){var a=rI(t,i);if(a){var o=t.lastTouch&&+new Date-t.lastTouch<200&&i.touches.length===1;if(!o){t.lastTouch=+new Date,Ea(t);var l=i.touches,c=l.length===1,u=l.length===2;c&&(Ea(t),oI(t,i),zn(Tn(t),i,s)),u&&t.onPinchStart(i)}}}},this.onTouchPanning=function(i){var r=t.setup.disabled,s=t.props.onPanning;if(t.isPanning&&i.touches.length===1){if(r)return;var a=sI(t);if(!a)return;i.preventDefault(),i.stopPropagation();var o=i.touches[0];lI(t,o.clientX,o.clientY),zn(Tn(t),i,s)}else i.touches.length>1&&t.onPinch(i)},this.onTouchPanningStop=function(i){t.onPanningStop(i),t.onPinchStop(i)},this.onDoubleClick=function(i){var r=t.setup.disabled;if(!r){var s=fZ(t,i);s&&pZ(t,i)}},this.clearPanning=function(i){t.isPanning&&t.onPanningStop(i)},this.setKeyPressed=function(i){t.pressedKeys[i.key]=!0},this.setKeyUnPressed=function(i){t.pressedKeys[i.key]=!1},this.isPressingKeys=function(i){return i.length?!!i.find(function(r){return t.pressedKeys[r]}):!0},this.setTransformState=function(i,r,s){var a=t.props.onTransformed;if(!Number.isNaN(i)&&!Number.isNaN(r)&&!Number.isNaN(s)){i!==t.transformState.scale&&(t.transformState.previousScale=t.transformState.scale,t.transformState.scale=i),t.transformState.positionX=r,t.transformState.positionY=s,t.applyTransformation();var o=Tn(t);t.onChangeCallbacks.forEach(function(l){return l(o)}),zn(o,{scale:i,positionX:r,positionY:s},a)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(t.wrapperComponent&&t.contentComponent){var i=AF(t.transformState.scale,t.wrapperComponent,t.contentComponent);t.setTransformState(i.scale,i.positionX,i.positionY)}},this.handleTransformStyles=function(i,r,s){return t.props.customTransform?t.props.customTransform(i,r,s):qJ(i,r,s)},this.applyTransformation=function(){if(!(!t.mounted||!t.contentComponent)){var i=t.transformState,r=i.scale,s=i.positionX,a=i.positionY,o=t.handleTransformStyles(s,a,r);t.contentComponent.style.transform=o}},this.getContext=function(){return Tn(t)},this.onChange=function(i){return t.onChangeCallbacks.has(i)||t.onChangeCallbacks.add(i),function(){t.onChangeCallbacks.delete(i)}},this.onInit=function(i){return t.onInitCallbacks.has(i)||t.onInitCallbacks.add(i),function(){t.onInitCallbacks.delete(i)}},this.init=function(i,r){t.cleanupWindowEvents(),t.wrapperComponent=i,t.contentComponent=r,Kd(t,t.transformState.scale),t.handleInitializeWrapperEvents(i),t.handleInitialize(i,r),t.initializeWindowEvents(),t.isInitialized=!0;var s=Tn(t);zn(s,void 0,t.props.onInit)},this.props=e,this.setup=uI(this.props),this.transformState=EF(this.props)}return n}(),dN=Xr.createContext(null),gZ=function(n,e){return typeof n=="function"?n(e):n},bZ=Xr.forwardRef(function(n,e){var t=T.useRef(new mZ(n)).current,i=gZ(n.children,$S(t));return T.useImperativeHandle(e,function(){return $S(t)},[t]),T.useEffect(function(){t.update(n)},[t,n]),Xr.createElement(dN.Provider,{value:t},i)});Xr.forwardRef(function(n,e){var t=T.useRef(null),i=T.useContext(dN);return T.useEffect(function(){return i.onChange(function(r){if(t.current){var s=0,a=0;t.current.style.transform=i.handleTransformStyles(s,a,1/r.instance.transformState.scale)}})},[i]),Xr.createElement("div",Gc({},n,{ref:GJ([t,e])}))});function yZ(n,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}}var vZ=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,dI={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};yZ(vZ);var xZ=function(n){var e=n.children,t=n.wrapperClass,i=t===void 0?"":t,r=n.contentClass,s=r===void 0?"":r,a=n.wrapperStyle,o=n.contentStyle,l=n.wrapperProps,c=l===void 0?{}:l,u=n.contentProps,p=u===void 0?{}:u,m=T.useContext(dN),g=m.init,y=m.cleanupWindowEvents,v=T.useRef(null),w=T.useRef(null);return T.useEffect(function(){var k=v.current,S=w.current;return k!==null&&S!==null&&g&&(g==null||g(k,S)),function(){y==null||y()}},[]),Xr.createElement("div",Gc({},c,{ref:v,className:"".concat(BS.wrapperClass," ").concat(dI.wrapper," ").concat(i),style:a}),Xr.createElement("div",Gc({},p,{ref:w,className:"".concat(BS.contentClass," ").concat(dI.content," ").concat(s),style:o}),e))};function Zi(n,e,t,i){return new(t||(t=Promise))(function(r,s){function a(c){try{l(i.next(c))}catch(u){s(u)}}function o(c){try{l(i.throw(c))}catch(u){s(u)}}function l(c){var u;c.done?r(c.value):(u=c.value,u instanceof t?u:new t(function(p){p(u)})).then(a,o)}l((i=i.apply(n,e||[])).next())})}class Py{constructor(){this.listeners={}}on(e,t,i){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),i==null?void 0:i.once){const r=()=>{this.un(e,r),this.un(e,t)};return this.on(e,r),r}return()=>this.un(e,t)}un(e,t){var i;(i=this.listeners[e])===null||i===void 0||i.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}}const Gv={decode:function(n,e){return Zi(this,void 0,void 0,function*(){const t=new AudioContext({sampleRate:e});return t.decodeAudioData(n).finally(()=>t.close())})},createBuffer:function(n,e){return typeof n[0]=="number"&&(n=[n]),function(t){const i=t[0];if(i.some(r=>r>1||r<-1)){const r=i.length;let s=0;for(let a=0;a<r;a++){const o=Math.abs(i[a]);o>s&&(s=o)}for(const a of t)for(let o=0;o<r;o++)a[o]/=s}}(n),{duration:e,length:n[0].length,sampleRate:n[0].length/e,numberOfChannels:n.length,getChannelData:t=>n==null?void 0:n[t],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function MF(n,e){const t=e.xmlns?document.createElementNS(e.xmlns,n):document.createElement(n);for(const[i,r]of Object.entries(e))if(i==="children"&&r)for(const[s,a]of Object.entries(r))a instanceof Node?t.appendChild(a):typeof a=="string"?t.appendChild(document.createTextNode(a)):t.appendChild(MF(s,a));else i==="style"?Object.assign(t.style,r):i==="textContent"?t.textContent=r:t.setAttribute(i,r.toString());return t}function hI(n,e,t){const i=MF(n,e||{});return t==null||t.appendChild(i),i}var wZ=Object.freeze({__proto__:null,createElement:hI,default:hI});const kZ={fetchBlob:function(n,e,t){return Zi(this,void 0,void 0,function*(){const i=yield fetch(n,t);if(i.status>=400)throw new Error(`Failed to fetch ${n}: ${i.status} (${i.statusText})`);return function(r,s){Zi(this,void 0,void 0,function*(){if(!r.body||!r.headers)return;const a=r.body.getReader(),o=Number(r.headers.get("Content-Length"))||0;let l=0;const c=p=>Zi(this,void 0,void 0,function*(){l+=(p==null?void 0:p.length)||0;const m=Math.round(l/o*100);s(m)}),u=()=>Zi(this,void 0,void 0,function*(){let p;try{p=yield a.read()}catch{return}p.done||(c(p.value),yield u())});u()})}(i.clone(),e),i.blob()})}};class DZ extends Py{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)},{once:!0})}onMediaEvent(e,t,i){return this.media.addEventListener(e,t,i),()=>this.media.removeEventListener(e,t,i)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,t){const i=this.getSrc();if(e&&i===e)return;this.revokeSrc();const r=t instanceof Blob&&(this.canPlayType(t.type)||!e)?URL.createObjectURL(t):e;if(i&&this.media.removeAttribute("src"),r||e)try{this.media.src=r}catch{this.media.src=e}}destroy(){this.isExternalMedia||(this.media.pause(),this.media.remove(),this.revokeSrc(),this.media.removeAttribute("src"),this.media.load())}setMediaElement(e){this.media=e}play(){return Zi(this,void 0,void 0,function*(){try{return yield this.media.play()}catch(e){if(e instanceof DOMException&&e.name==="AbortError")return;throw e}})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=Math.max(0,Math.min(e,this.getDuration()))}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,t){t!=null&&(this.media.preservesPitch=t),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}}class Kf extends Py{constructor(e,t){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.unsubscribeOnScroll=[],this.subscriptions=[],this.options=e;const i=this.parentFromOptionsContainer(e.container);this.parent=i;const[r,s]=this.initHtml();i.appendChild(r),this.container=r,this.scrollContainer=s.querySelector(".scroll"),this.wrapper=s.querySelector(".wrapper"),this.canvasWrapper=s.querySelector(".canvases"),this.progressWrapper=s.querySelector(".progress"),this.cursor=s.querySelector(".cursor"),t&&s.appendChild(t),this.initEvents()}parentFromOptionsContainer(e){let t;if(typeof e=="string"?t=document.querySelector(e):e instanceof HTMLElement&&(t=e),!t)throw new Error("Container not found");return t}initEvents(){const e=t=>{const i=this.wrapper.getBoundingClientRect(),r=t.clientX-i.left,s=t.clientY-i.top;return[r/i.width,s/i.height]};if(this.wrapper.addEventListener("click",t=>{const[i,r]=e(t);this.emit("click",i,r)}),this.wrapper.addEventListener("dblclick",t=>{const[i,r]=e(t);this.emit("dblclick",i,r)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:t,scrollWidth:i,clientWidth:r}=this.scrollContainer,s=t/i,a=(t+r)/i;this.emit("scroll",s,a,t,t+r)}),typeof ResizeObserver=="function"){const t=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{t().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){const e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender())}initDrag(){this.subscriptions.push(function(e,t,i,r,s=3,a=0,o=100){if(!e)return()=>{};const l=matchMedia("(pointer: coarse)").matches;let c=()=>{};const u=p=>{if(p.button!==a)return;p.preventDefault(),p.stopPropagation();let m=p.clientX,g=p.clientY,y=!1;const v=Date.now(),w=A=>{if(A.preventDefault(),A.stopPropagation(),l&&Date.now()-v<o)return;const N=A.clientX,R=A.clientY,V=N-m,B=R-g;if(y||Math.abs(V)>s||Math.abs(B)>s){const L=e.getBoundingClientRect(),{left:W,top:q}=L;y||(i==null||i(m-W,g-q),y=!0),t(V,B,N-W,R-q),m=N,g=R}},k=A=>{if(y){const N=A.clientX,R=A.clientY,V=e.getBoundingClientRect(),{left:B,top:L}=V;r==null||r(N-B,R-L)}c()},S=A=>{A.relatedTarget&&A.relatedTarget!==document.documentElement||k(A)},E=A=>{y&&(A.stopPropagation(),A.preventDefault())},P=A=>{y&&A.preventDefault()};document.addEventListener("pointermove",w),document.addEventListener("pointerup",k),document.addEventListener("pointerout",S),document.addEventListener("pointercancel",S),document.addEventListener("touchmove",P,{passive:!1}),document.addEventListener("click",E,{capture:!0}),c=()=>{document.removeEventListener("pointermove",w),document.removeEventListener("pointerup",k),document.removeEventListener("pointerout",S),document.removeEventListener("pointercancel",S),document.removeEventListener("touchmove",P),setTimeout(()=>{document.removeEventListener("click",E,{capture:!0})},10)}};return e.addEventListener("pointerdown",u),()=>{c(),e.removeEventListener("pointerdown",u)}}(this.wrapper,(e,t,i)=>{this.emit("drag",Math.max(0,Math.min(1,i/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))}))}getHeight(e,t){var i;const r=((i=this.audioData)===null||i===void 0?void 0:i.numberOfChannels)||1;if(e==null)return 128;if(!isNaN(Number(e)))return Number(e);if(e==="auto"){const s=this.parent.clientHeight||128;return t!=null&&t.every(a=>!a.overlay)?s/r:s}return 128}initHtml(){const e=document.createElement("div"),t=e.attachShadow({mode:"open"}),i=this.options.cspNonce&&typeof this.options.cspNonce=="string"?this.options.cspNonce.replace(/"/g,""):"";return t.innerHTML=`
      <style${i?` nonce="${i}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,t]}setOptions(e){if(this.options.container!==e.container){const t=this.parentFromOptionsContainer(e.container);t.appendChild(this.container),this.parent=t}e.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){const{scrollWidth:t}=this.scrollContainer,i=t*e;this.setScroll(i)}destroy(){var e,t;this.subscriptions.forEach(i=>i()),this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.unsubscribeOnScroll)===null||t===void 0||t.forEach(i=>i()),this.unsubscribeOnScroll=[]}createDelay(e=10){let t,i;const r=()=>{t&&clearTimeout(t),i&&i()};return this.timeouts.push(r),()=>new Promise((s,a)=>{r(),i=a,t=setTimeout(()=>{t=void 0,i=void 0,s()},e)})}convertColorValues(e){if(!Array.isArray(e))return e||"";if(e.length<2)return e[0]||"";const t=document.createElement("canvas"),i=t.getContext("2d"),r=t.height*(window.devicePixelRatio||1),s=i.createLinearGradient(0,0,0,r),a=1/(e.length-1);return e.forEach((o,l)=>{const c=l*a;s.addColorStop(c,o)}),s}getPixelRatio(){return Math.max(1,window.devicePixelRatio||1)}renderBarWaveform(e,t,i,r){const s=e[0],a=e[1]||e[0],o=s.length,{width:l,height:c}=i.canvas,u=c/2,p=this.getPixelRatio(),m=t.barWidth?t.barWidth*p:1,g=t.barGap?t.barGap*p:t.barWidth?m/2:0,y=t.barRadius||0,v=l/(m+g)/o,w=y&&"roundRect"in i?"roundRect":"rect";i.beginPath();let k=0,S=0,E=0;for(let P=0;P<=o;P++){const A=Math.round(P*v);if(A>k){const V=Math.round(S*u*r),B=V+Math.round(E*u*r)||1;let L=u-V;t.barAlign==="top"?L=0:t.barAlign==="bottom"&&(L=c-B),i[w](k*(m+g),L,m,B,y),k=A,S=0,E=0}const N=Math.abs(s[P]||0),R=Math.abs(a[P]||0);N>S&&(S=N),R>E&&(E=R)}i.fill(),i.closePath()}renderLineWaveform(e,t,i,r){const s=a=>{const o=e[a]||e[0],l=o.length,{height:c}=i.canvas,u=c/2,p=i.canvas.width/l;i.moveTo(0,u);let m=0,g=0;for(let y=0;y<=l;y++){const v=Math.round(y*p);if(v>m){const k=u+(Math.round(g*u*r)||1)*(a===0?-1:1);i.lineTo(m,k),m=v,g=0}const w=Math.abs(o[y]||0);w>g&&(g=w)}i.lineTo(m,u)};i.beginPath(),s(0),s(1),i.fill(),i.closePath()}renderWaveform(e,t,i){if(i.fillStyle=this.convertColorValues(t.waveColor),t.renderFunction)return void t.renderFunction(e,i);let r=t.barHeight||1;if(t.normalize){const s=Array.from(e[0]).reduce((a,o)=>Math.max(a,Math.abs(o)),0);r=s?1/s:1}t.barWidth||t.barGap||t.barAlign?this.renderBarWaveform(e,t,i,r):this.renderLineWaveform(e,t,i,r)}renderSingleCanvas(e,t,i,r,s,a,o){const l=this.getPixelRatio(),c=document.createElement("canvas");c.width=Math.round(i*l),c.height=Math.round(r*l),c.style.width=`${i}px`,c.style.height=`${r}px`,c.style.left=`${Math.round(s)}px`,a.appendChild(c);const u=c.getContext("2d");if(this.renderWaveform(e,t,u),c.width>0&&c.height>0){const p=c.cloneNode(),m=p.getContext("2d");m.drawImage(c,0,0),m.globalCompositeOperation="source-in",m.fillStyle=this.convertColorValues(t.progressColor),m.fillRect(0,0,c.width,c.height),o.appendChild(p)}}renderMultiCanvas(e,t,i,r,s,a){const o=this.getPixelRatio(),{clientWidth:l}=this.scrollContainer,c=i/o;let u=Math.min(Kf.MAX_CANVAS_WIDTH,l,c),p={};if(t.barWidth||t.barGap){const w=t.barWidth||.5,k=w+(t.barGap||w/2);u%k!=0&&(u=Math.floor(u/k)*k)}if(u===0)return;const m=w=>{if(w<0||w>=g||p[w])return;p[w]=!0;const k=w*u;let S=Math.min(c-k,u);if(t.barWidth||t.barGap){const P=t.barWidth||.5,A=P+(t.barGap||P/2);S=Math.floor(S/A)*A}if(S<=0)return;const E=e.map(P=>{const A=Math.floor(k/c*P.length),N=Math.floor((k+S)/c*P.length);return P.slice(A,N)});this.renderSingleCanvas(E,t,S,r,k,s,a)},g=Math.ceil(c/u);if(!this.isScrollable){for(let w=0;w<g;w++)m(w);return}const y=this.scrollContainer.scrollLeft/c,v=Math.floor(y*g);if(m(v-1),m(v),m(v+1),g>1){const w=this.on("scroll",()=>{const{scrollLeft:k}=this.scrollContainer,S=Math.floor(k/c*g);Object.keys(p).length>Kf.MAX_NODES&&(s.innerHTML="",a.innerHTML="",p={}),m(S-1),m(S),m(S+1)});this.unsubscribeOnScroll.push(w)}}renderChannel(e,t,i,r){var{overlay:s}=t,a=function(u,p){var m={};for(var g in u)Object.prototype.hasOwnProperty.call(u,g)&&p.indexOf(g)<0&&(m[g]=u[g]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function"){var y=0;for(g=Object.getOwnPropertySymbols(u);y<g.length;y++)p.indexOf(g[y])<0&&Object.prototype.propertyIsEnumerable.call(u,g[y])&&(m[g[y]]=u[g[y]])}return m}(t,["overlay"]);const o=document.createElement("div"),l=this.getHeight(a.height,a.splitChannels);o.style.height=`${l}px`,s&&r>0&&(o.style.marginTop=`-${l}px`),this.canvasWrapper.style.minHeight=`${l}px`,this.canvasWrapper.appendChild(o);const c=o.cloneNode();this.progressWrapper.appendChild(c),this.renderMultiCanvas(e,a,i,l,o,c)}render(e){return Zi(this,void 0,void 0,function*(){var t;this.timeouts.forEach(l=>l()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const i=this.getPixelRatio(),r=this.scrollContainer.clientWidth,s=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrollable=s>r;const a=this.options.fillParent&&!this.isScrollable,o=(a?r:s)*i;if(this.wrapper.style.width=a?"100%":`${s}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render"),this.options.splitChannels)for(let l=0;l<e.numberOfChannels;l++){const c=Object.assign(Object.assign({},this.options),(t=this.options.splitChannels)===null||t===void 0?void 0:t[l]);this.renderChannel([e.getChannelData(l)],c,o,l)}else{const l=[e.getChannelData(0)];e.numberOfChannels>1&&l.push(e.getChannelData(1)),this.renderChannel(l,this.options,o,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){if(this.unsubscribeOnScroll.forEach(i=>i()),this.unsubscribeOnScroll=[],!this.audioData)return;const{scrollWidth:e}=this.scrollContainer,{right:t}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){const{right:i}=this.progressWrapper.getBoundingClientRect();let r=i-t;r*=2,r=r<0?Math.floor(r):Math.ceil(r),r/=2,this.scrollContainer.scrollLeft+=r}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,t=!1){const{scrollLeft:i,scrollWidth:r,clientWidth:s}=this.scrollContainer,a=e*r,o=i,l=i+s,c=s/2;if(this.isDragging)a+30>l?this.scrollContainer.scrollLeft+=30:a-30<o&&(this.scrollContainer.scrollLeft-=30);else{(a<o||a>l)&&(this.scrollContainer.scrollLeft=a-(this.options.autoCenter?c:0));const u=a-i-c;t&&this.options.autoCenter&&u>0&&(this.scrollContainer.scrollLeft+=Math.min(u,10))}{const u=this.scrollContainer.scrollLeft,p=u/r,m=(u+s)/r;this.emit("scroll",p,m,u,u+s)}}renderProgress(e,t){if(isNaN(e))return;const i=100*e;this.canvasWrapper.style.clipPath=`polygon(${i}% 0%, 100% 0%, 100% 100%, ${i}% 100%)`,this.progressWrapper.style.width=`${i}%`,this.cursor.style.left=`${i}%`,this.cursor.style.transform=this.options.cursorWidth?`translateX(-${e*this.options.cursorWidth}px)`:"",this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(e,t)}exportImage(e,t,i){return Zi(this,void 0,void 0,function*(){const r=this.canvasWrapper.querySelectorAll("canvas");if(!r.length)throw new Error("No waveform data");if(i==="dataURL"){const s=Array.from(r).map(a=>a.toDataURL(e,t));return Promise.resolve(s)}return Promise.all(Array.from(r).map(s=>new Promise((a,o)=>{s.toBlob(l=>{l?a(l):o(new Error("Could not export image"))},e,t)})))})}}Kf.MAX_CANVAS_WIDTH=8e3,Kf.MAX_NODES=10;class SZ extends Py{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}class s1 extends Py{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return Zi(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,this._duration=void 0,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then(t=>{if(t.status>=400)throw new Error(`Failed to fetch ${e}: ${t.status} (${t.statusText})`);return t.arrayBuffer()}).then(t=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(t)).then(t=>{this.currentSrc===e&&(this.buffer=t,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var e;if(!this.paused)return;this.paused=!1,(e=this.bufferNode)===null||e===void 0||e.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let t=this.playedDuration*this._playbackRate;(t>=this.duration||t<0)&&(t=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,t),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return Zi(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){const t=e-this.currentTime,i=this.bufferNode;i==null||i.stop(this.audioContext.currentTime+t),i==null||i.addEventListener("ended",()=>{i===this.bufferNode&&(this.bufferNode=null,this.pause())},{once:!0})}setSinkId(e){return Zi(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){const t=!this.paused;t&&this._pause(),this.playedDuration=e/this._playbackRate,t&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,t;return(e=this._duration)!==null&&e!==void 0?e:((t=this.buffer)===null||t===void 0?void 0:t.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){const e=[];if(!this.buffer)return e;const t=this.buffer.numberOfChannels;for(let i=0;i<t;i++)e.push(this.buffer.getChannelData(i));return e}removeAttribute(e){switch(e){case"src":this.src="";break;case"playbackRate":this.playbackRate=0;break;case"currentTime":this.currentTime=0;break;case"duration":this.duration=0;break;case"volume":this.volume=0;break;case"muted":this.muted=!1}}}const EZ={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class Rg extends DZ{static create(e){return new Rg(e)}constructor(e){const t=e.media||(e.backend==="WebAudio"?new s1:void 0);super({media:t,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.stopAtPosition=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},EZ,e),this.timer=new SZ;const i=t?void 0:this.getMediaElement();this.renderer=new Kf(this.options,i),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const r=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");const{peaks:s,duration:a}=this.options;(r||s&&a)&&this.load(r,s,a).catch(()=>null)})}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e),this.stopAtPosition!=null&&this.isPlaying()&&e>=this.stopAtPosition&&this.pause()}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const e=this.updateProgress();this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("emptied",()=>{this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("ended",()=>{this.emit("timeupdate",this.getDuration()),this.emit("finish"),this.stopAtPosition=null}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",()=>{var e;this.emit("error",(e=this.getMediaElement().error)!==null&&e!==void 0?e:new Error("Media error")),this.stopAtPosition=null}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,t)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,t))}),this.renderer.on("dblclick",(e,t)=>{this.emit("dblclick",e,t)}),this.renderer.on("scroll",(e,t,i,r)=>{const s=this.getDuration();this.emit("scroll",e*s,t*s,i,r)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",e=>{this.emit("dragstart",e)}),this.renderer.on("dragend",e=>{this.emit("dragend",e)}));{let e;this.subscriptions.push(this.renderer.on("drag",t=>{if(!this.options.interact)return;let i;this.renderer.renderProgress(t),clearTimeout(e),this.isPlaying()?i=0:this.options.dragToSeek===!0?i=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(i=this.options.dragToSeek.debounceTime),e=setTimeout(()=>{this.seekTo(t)},i),this.emit("interaction",t*this.getDuration()),this.emit("drag",t)}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(t=>{this.registerPlugin(t)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),e.duration&&!e.peaks&&(this.decodedData=Gv.createBuffer(this.exportPeaks(),e.duration)),e.peaks&&e.duration&&(this.decodedData=Gv.createBuffer(e.peaks,e.duration)),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){if(this.plugins.includes(e))return e;e._init(this),this.plugins.push(e);const t=e.once("destroy",()=>{this.plugins=this.plugins.filter(i=>i!==e),this.subscriptions=this.subscriptions.filter(i=>i!==t)});return this.subscriptions.push(t),e}unregisterPlugin(e){this.plugins=this.plugins.filter(t=>t!==e),e.destroy()}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(e){return this.renderer.setScroll(e)}setScrollTime(e){const t=e/this.getDuration();this.renderer.setScrollPercentage(t)}getActivePlugins(){return this.plugins}loadAudio(e,t,i,r){return Zi(this,void 0,void 0,function*(){var s;if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,this.stopAtPosition=null,!t&&!i){const o=this.options.fetchParams||{};window.AbortController&&!o.signal&&(this.abortController=new AbortController,o.signal=(s=this.abortController)===null||s===void 0?void 0:s.signal);const l=u=>this.emit("loading",u);t=yield kZ.fetchBlob(e,l,o);const c=this.options.blobMimeType;c&&(t=new Blob([t],{type:c}))}this.setSrc(e,t);const a=yield new Promise(o=>{const l=r||this.getDuration();l?o(l):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>o(this.getDuration()),{once:!0}))});if(!e&&!t){const o=this.getMediaElement();o instanceof s1&&(o.duration=a)}if(i)this.decodedData=Gv.createBuffer(i,a||0);else if(t){const o=yield t.arrayBuffer();this.decodedData=yield Gv.decode(o,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(e,t,i){return Zi(this,void 0,void 0,function*(){try{return yield this.loadAudio(e,void 0,t,i)}catch(r){throw this.emit("error",r),r}})}loadBlob(e,t,i){return Zi(this,void 0,void 0,function*(){try{return yield this.loadAudio("",e,t,i)}catch(r){throw this.emit("error",r),r}})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:t=8e3,precision:i=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const r=Math.min(e,this.decodedData.numberOfChannels),s=[];for(let a=0;a<r;a++){const o=this.decodedData.getChannelData(a),l=[],c=o.length/t;for(let u=0;u<t;u++){const p=o.slice(Math.floor(u*c),Math.ceil((u+1)*c));let m=0;for(let g=0;g<p.length;g++){const y=p[g];Math.abs(y)>Math.abs(m)&&(m=y)}l.push(Math.round(m*i)/i)}s.push(l)}return s}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){this.stopAtPosition=null,super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){const t=this.getDuration()*e;this.setTime(t)}play(e,t){const i=Object.create(null,{play:{get:()=>super.play}});return Zi(this,void 0,void 0,function*(){e!=null&&this.setTime(e);const r=yield i.play.call(this);return t!=null&&(this.media instanceof s1?this.media.stopAt(t):this.stopAtPosition=t),r})}playPause(){return Zi(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(){return Zi(this,arguments,void 0,function*(e="image/png",t=1,i="dataURL"){return this.renderer.exportImage(e,t,i)})}destroy(){var e;this.emit("destroy"),(e=this.abortController)===null||e===void 0||e.abort(),this.plugins.forEach(t=>t.destroy()),this.subscriptions.forEach(t=>t()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}Rg.BasePlugin=class extends Py{constructor(n){super(),this.subscriptions=[],this.isDestroyed=!1,this.options=n}onInit(){}_init(n){this.isDestroyed&&(this.subscriptions=[],this.isDestroyed=!1),this.wavesurfer=n,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(n=>n()),this.subscriptions=[],this.isDestroyed=!0,this.wavesurfer=void 0}},Rg.dom=wZ;const a1=({url:n,fileType:e,fileName:t="media-file"})=>{const[i,r]=T.useState(!0),[s,a]=T.useState(null),[o,l]=T.useState(!1),[c,u]=T.useState(null),[p,m]=T.useState(0),[g,y]=T.useState([]),[v,w]=T.useState(!1),[k,S]=T.useState("rectangle"),[E,P]=T.useState(!1),[A,N]=T.useState(0),[R,V]=T.useState(0),[B,L]=T.useState(1),[W,q]=T.useState(!1),[X,G]=T.useState(1),K=T.useRef(null),J=T.useRef(null),ee=T.useRef(null);T.useRef(null);const fe=T.useRef(null);T.useRef(null);const ae=We(ye=>ye.linkActivation),U=We(ye=>ye.setLinkActivation);T.useEffect(()=>{if((ae==null?void 0:ae.type)==="citation"&&ae.timestamp!==void 0){if(e==="audio"&&fe.current){const ye=typeof ae.timestamp=="string"?he(ae.timestamp):ae.timestamp;fe.current.seekTo(ye/A)}else if(e==="video"&&ee.current){const ye=typeof ae.timestamp=="string"?he(ae.timestamp):ae.timestamp;ee.current.currentTime=ye}U(null)}},[ae,U,A,e]),T.useEffect(()=>((async()=>{r(!0),a(null);try{e==="image"?r(!1):e==="audio"?await $():e==="video"&&Y()}catch{a(`Failed to load ${e} file`),r(!1)}})(),()=>{fe.current&&(fe.current.destroy(),fe.current=null)}),[n,e]);const he=ye=>{const He=ye.split(":").map(Number);return He.length===2?He[0]*60+He[1]:He.length===3?He[0]*3600+He[1]*60+He[2]:0},ie=ye=>{const He=Math.floor(ye/3600),Re=Math.floor(ye%3600/60),et=Math.floor(ye%60);return He>0?`${He}:${Re.toString().padStart(2,"0")}:${et.toString().padStart(2,"0")}`:`${Re}:${et.toString().padStart(2,"0")}`},$=async()=>{if(!K.current)return;const ye=K.current.querySelector(".waveform-container");ye&&(fe.current=Rg.create({container:ye,waveColor:"#2563eb",progressColor:"#1d4ed8",barWidth:2,barRadius:1,responsive:!0,height:100,normalize:!0,backend:"WebAudio",mediaControls:!1}),fe.current.load(n),fe.current.on("ready",()=>{N(fe.current.getDuration()),r(!1)}),fe.current.on("audioprocess",()=>{V(fe.current.getCurrentTime())}),fe.current.on("play",()=>P(!0)),fe.current.on("pause",()=>P(!1)))},Y=()=>{if(!ee.current)return;const ye=ee.current;ye.addEventListener("loadedmetadata",()=>{N(ye.duration),r(!1)}),ye.addEventListener("timeupdate",()=>{V(ye.currentTime)}),ye.addEventListener("play",()=>P(!0)),ye.addEventListener("pause",()=>P(!1))},oe=()=>{e==="audio"&&fe.current?fe.current.playPause():e==="video"&&ee.current&&(E?ee.current.pause():ee.current.play())},be=ye=>{e==="audio"&&fe.current?fe.current.seekTo(ye/A):e==="video"&&ee.current&&(ee.current.currentTime=ye)},xe=ye=>{L(ye),e==="audio"&&fe.current?fe.current.setVolume(ye):e==="video"&&ee.current&&(ee.current.volume=ye)},je=()=>{const ye=!W;q(ye),e==="audio"&&fe.current?fe.current.setVolume(ye?0:B):e==="video"&&ee.current&&(ee.current.muted=ye)},ze=ye=>{const He=ye==="left"?p-90:p+90;m(He%360)},Ve=()=>{const ye=JSON.stringify(g,null,2),He=new Blob([ye],{type:"application/json"}),Re=URL.createObjectURL(He),et=document.createElement("a");et.href=Re,et.download=`${t}-annotations.json`,document.body.appendChild(et),et.click(),document.body.removeChild(et),URL.revokeObjectURL(Re)},we=()=>{const ye=document.createElement("a");ye.href=n,ye.download=t,document.body.appendChild(ye),ye.click(),document.body.removeChild(ye)};if(i)return b.jsxDEV(re,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",backgroundColor:"#f8f9fa"},children:[b.jsxDEV(Yr,{size:48,thickness:4,sx:{color:"#2563eb"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:321,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"body2",sx:{mt:2,color:"#666666"},children:["Loading ",e," file..."]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:322,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:313,columnNumber:7},void 0);if(s)return b.jsxDEV(re,{sx:{p:3,height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:b.jsxDEV(Aa,{severity:"error",sx:{width:"100%",maxWidth:400},children:s},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:332,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:331,columnNumber:7},void 0);const Ae=()=>b.jsxDEV(sn,{elevation:0,sx:{borderBottom:"1px solid #e5e7eb"},children:b.jsxDEV(gy,{variant:"dense",sx:{minHeight:56,px:2},children:[e==="image"&&b.jsxDEV(b.Fragment,{children:[b.jsxDEV(hg,{size:"small",variant:"outlined",sx:{mr:2},children:[b.jsxDEV(Nt,{title:"Zoom in",children:b.jsxDEV(ut,{size:"small",children:b.jsxDEV(gE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:348,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:347,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:346,columnNumber:15},void 0),b.jsxDEV(Nt,{title:"Zoom out",children:b.jsxDEV(ut,{size:"small",children:b.jsxDEV(mE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:353,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:352,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:351,columnNumber:15},void 0),b.jsxDEV(Nt,{title:"Reset zoom",children:b.jsxDEV(ut,{size:"small",children:b.jsxDEV(I4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:358,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:357,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:356,columnNumber:15},void 0),b.jsxDEV(Nt,{title:"Fit to screen",children:b.jsxDEV(ut,{size:"small",children:b.jsxDEV(WR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:363,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:362,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:361,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:345,columnNumber:13},void 0),b.jsxDEV(hg,{size:"small",variant:"outlined",sx:{mr:2},children:[b.jsxDEV(Nt,{title:"Rotate left",children:b.jsxDEV(ut,{onClick:()=>ze("left"),size:"small",children:b.jsxDEV(HR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:371,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:370,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:369,columnNumber:15},void 0),b.jsxDEV(Nt,{title:"Rotate right",children:b.jsxDEV(ut,{onClick:()=>ze("right"),size:"small",children:b.jsxDEV(qR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:376,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:375,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:374,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:368,columnNumber:13},void 0),b.jsxDEV(vt,{size:"small",variant:v?"contained":"outlined",startIcon:b.jsxDEV(R4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:384,columnNumber:26},void 0),onClick:()=>w(!v),sx:{mr:2},children:"Annotate"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:381,columnNumber:13},void 0),g.length>0&&b.jsxDEV(vt,{size:"small",variant:"outlined",startIcon:b.jsxDEV(UR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:395,columnNumber:28},void 0),onClick:Ve,sx:{mr:2},children:"Export Annotations"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:392,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:344,columnNumber:11},void 0),(e==="audio"||e==="video")&&b.jsxDEV(b.Fragment,{children:[b.jsxDEV(ut,{onClick:oe,sx:{mr:2},children:E?b.jsxDEV(M4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:408,columnNumber:28},void 0):b.jsxDEV(jR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:408,columnNumber:40},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:407,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"body2",sx:{mr:2,minWidth:80},children:[ie(R)," / ",ie(A)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:411,columnNumber:13},void 0),b.jsxDEV(bA,{value:R,max:A,onChange:(ye,He)=>be(He),sx:{mr:2,flexGrow:1,maxWidth:300}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:415,columnNumber:13},void 0),b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",mr:2},children:[b.jsxDEV(ut,{onClick:je,size:"small",children:W?b.jsxDEV(j4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:424,columnNumber:28},void 0):b.jsxDEV(O4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:424,columnNumber:44},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:423,columnNumber:15},void 0),b.jsxDEV(bA,{value:W?0:B,onChange:(ye,He)=>xe(He),min:0,max:1,step:.1,sx:{width:80,ml:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:426,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:422,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:406,columnNumber:11},void 0),b.jsxDEV(re,{sx:{flexGrow:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:438,columnNumber:9},void 0),b.jsxDEV(ut,{onClick:ye=>u(ye.currentTarget),size:"small",children:b.jsxDEV(my,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:441,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:440,columnNumber:9},void 0),b.jsxDEV(ru,{anchorEl:c,open:!!c,onClose:()=>u(null),children:[b.jsxDEV(Dn,{onClick:()=>l(!o),children:[b.jsxDEV(Ui,{children:o?b.jsxDEV(pE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:451,columnNumber:31},void 0):b.jsxDEV(fE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:451,columnNumber:52},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:450,columnNumber:13},void 0),b.jsxDEV(si,{children:o?"Exit Fullscreen":"Fullscreen"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:453,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:449,columnNumber:11},void 0),b.jsxDEV(Dn,{onClick:we,children:[b.jsxDEV(Ui,{children:b.jsxDEV(Vx,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:458,columnNumber:13},void 0),b.jsxDEV(si,{children:"Download"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:461,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:457,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:444,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:342,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:341,columnNumber:5},void 0),_e=()=>e==="image"?b.jsxDEV(bZ,{initialScale:1,minScale:.25,maxScale:4,centerOnInit:!0,children:b.jsxDEV(xZ,{wrapperStyle:{width:"100%",height:"100%"},contentStyle:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:[b.jsxDEV("img",{ref:J,src:n,alt:t,style:{maxWidth:"100%",maxHeight:"100%",transform:`rotate(${p}deg)`,transition:"transform 0.3s ease"},onLoad:()=>r(!1),onError:()=>a("Failed to load image")},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:491,columnNumber:13},void 0),g.map(ye=>b.jsxDEV("div",{style:{position:"absolute",left:ye.x,top:ye.y,width:ye.width,height:ye.height,border:`2px solid ${ye.color}`,backgroundColor:"rgba(255, 68, 68, 0.1)",pointerEvents:"none"}},ye.id,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:507,columnNumber:15},void 0))]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:478,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:472,columnNumber:9},void 0):e==="audio"?b.jsxDEV(re,{sx:{p:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[b.jsxDEV(re,{className:"waveform-container",sx:{width:"100%",maxWidth:800,mb:4}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:527,columnNumber:11},void 0),b.jsxDEV(sn,{elevation:2,sx:{p:3,width:"100%",maxWidth:400,textAlign:"center"},children:[b.jsxDEV(ge,{variant:"h6",gutterBottom:!0,children:t},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:533,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"body2",color:"text.secondary",children:[ie(R)," / ",ie(A)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:536,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:532,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:526,columnNumber:9},void 0):e==="video"?b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",p:2},children:b.jsxDEV("video",{ref:ee,src:n,controls:!1,style:{maxWidth:"100%",maxHeight:"100%",backgroundColor:"black"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:545,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:544,columnNumber:9},void 0):null;return b.jsxDEV(re,{ref:K,sx:{height:"100%",display:"flex",flexDirection:"column",backgroundColor:e==="image"?"#f8f9fa":"#ffffff",overflow:"hidden"},children:[Ae(),b.jsxDEV(re,{sx:{flex:1,overflow:"hidden"},children:_e()},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:575,columnNumber:7},void 0),b.jsxDEV(sn,{elevation:0,sx:{borderTop:"1px solid #e5e7eb",py:.5,px:2},children:b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:[t," • ",e.charAt(0).toUpperCase()+e.slice(1),(e==="audio"||e==="video")&&` • ${ie(A)}`,e==="image"&&p!==0&&` • Rotated ${p}°`]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:580,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/EnhancedMediaViewer.tsx",lineNumber:563,columnNumber:5},void 0)},NZ=({children:n})=>{const e=We(u=>u.linkActivation),t=We(u=>u.setLinkActivation),i=We(u=>u.selectedFileId),r=We(u=>u.setSelectedFile),s=We(u=>u.files);T.useEffect(()=>{e&&(async p=>{if(console.log("[LinkActivationHandler] Processing activation:",p),!p.fileId)return;const m=s.find(g=>g.id===p.fileId);if(!m){console.warn("[LinkActivationHandler] Target file not found:",p.fileId),t({...p,fileId:null,error:"Referenced file not found"});return}if(i===p.fileId){console.log("[LinkActivationHandler] Same file, navigating to position");return}console.log("[LinkActivationHandler] Switching to file:",m.name),r(p.fileId),setTimeout(()=>{t({...p,timestamp:Date.now()})},100)})(e)},[e,i,s,t,r]);const a=u=>{if(u.exhibitReference){const p=u.exhibitReference.match(/^(\d+[A-Z]?)(?:-(.+))?$/);if(p){const m=p[1],g=p[2],y=s.find(v=>v.exhibit_id===m);if(y){let v,w;if(g){const k=g.match(/^p?(\d+)$/);k&&(v=parseInt(k[1])),g.match(/^(\d{1,2}):(\d{2})(?::(\d{2}))?$/)&&(w=g)}return{file:y,targetPage:v,timestamp:w,exhibitId:m}}}}return null},o=()=>{if(!e||!e.fileId)return null;const u=s.find(m=>m.id===e.fileId);if(!u)return null;const p=a(e);return b.jsxDEV(sn,{elevation:1,sx:{p:2,mb:2,backgroundColor:"#eff6ff",border:"1px solid #2563eb"},children:b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center"},children:[b.jsxDEV($R,{sx:{mr:1,color:"#2563eb"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:138,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"body2",sx:{color:"#1d4ed8"},children:["Citation Link:",p&&b.jsxDEV(b.Fragment,{children:[b.jsxDEV("strong",{children:[" Exhibit ",p.exhibitId]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:143,columnNumber:19},void 0),p.targetPage&&` - Page ${p.targetPage}`,p.timestamp&&` - ${p.timestamp}`]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:142,columnNumber:17},void 0),!p&&b.jsxDEV(b.Fragment,{children:[b.jsxDEV("strong",{children:[" ",u.exhibit_id||u.name]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:150,columnNumber:19},void 0),e.targetPage&&` - Page ${e.targetPage}`,e.timestamp&&` - ${e.timestamp}`]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:149,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:139,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:137,columnNumber:11},void 0),b.jsxDEV(vt,{size:"small",onClick:()=>t(null),sx:{color:"#1d4ed8"},children:"Clear"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:158,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:136,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:127,columnNumber:7},void 0)},l=()=>e!=null&&e.error?b.jsxDEV(Aa,{severity:"warning",sx:{mb:2},onClose:()=>t(null),children:["Citation Link Error: ",e.error]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:175,columnNumber:7},void 0):null,c=()=>{if(!e||!e.fileId||i===e.fileId)return null;const u=s.find(m=>m.id===e.fileId);if(!u)return null;const p=s.find(m=>m.id===i);return b.jsxDEV(sn,{elevation:2,sx:{p:3,mb:2,textAlign:"center",backgroundColor:"#fef3c7",border:"1px solid #f59e0b"},children:[b.jsxDEV(ge,{variant:"h6",gutterBottom:!0,sx:{color:"#92400e"},children:"Switch to Referenced File?"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:207,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"body2",sx:{mb:2,color:"#78350f"},children:["Citation references ",b.jsxDEV("strong",{children:u.exhibit_id||u.name},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:212,columnNumber:31},void 0),e.targetPage&&` (Page ${e.targetPage})`,e.timestamp&&` (${e.timestamp})`]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:211,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"caption",sx:{display:"block",mb:3,color:"#78350f"},children:["Currently viewing: ",(p==null?void 0:p.exhibit_id)||(p==null?void 0:p.name)||"No file selected"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:217,columnNumber:9},void 0),b.jsxDEV(re,{sx:{display:"flex",gap:2,justifyContent:"center"},children:[b.jsxDEV(vt,{variant:"contained",startIcon:b.jsxDEV(L4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:224,columnNumber:24},void 0),onClick:()=>{r(e.fileId)},sx:{backgroundColor:"#f59e0b","&:hover":{backgroundColor:"#d97706"}},children:"Switch to File"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:222,columnNumber:11},void 0),b.jsxDEV(vt,{variant:"outlined",onClick:()=>t(null),sx:{color:"#92400e",borderColor:"#92400e","&:hover":{backgroundColor:"rgba(146, 64, 14, 0.1)",borderColor:"#92400e"}},children:"Cancel"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:236,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:221,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:197,columnNumber:7},void 0)};return b.jsxDEV(re,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[l(),c(),o(),b.jsxDEV(re,{sx:{flex:1,overflow:"hidden"},children:n},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:263,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/LinkActivationHandler.tsx",lineNumber:256,columnNumber:5},void 0)},_Z=({file:n,fileUrl:e,loading:t=!1,error:i=null})=>{const r=p=>{const m=p.file_type.toLowerCase(),g=p.content_type.toLowerCase();return m==="pdf"||g.includes("pdf")?"pdf":m==="image"||g.startsWith("image/")?"image":m==="audio"||g.startsWith("audio/")?"audio":m==="video"||g.startsWith("video/")?"video":m==="document"||g.includes("word")||g.includes("document")?"document":"unsupported"},s=p=>{switch(p){case"pdf":return b.jsxDEV(F0,{sx:{fontSize:48,color:"#dc2626"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:71,columnNumber:16},void 0);case"image":return b.jsxDEV(xg,{sx:{fontSize:48,color:"#059669"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:73,columnNumber:16},void 0);case"audio":return b.jsxDEV(oE,{sx:{fontSize:48,color:"#7c3aed"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:75,columnNumber:16},void 0);case"video":return b.jsxDEV(aE,{sx:{fontSize:48,color:"#ea580c"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:77,columnNumber:16},void 0);case"document":return b.jsxDEV(fp,{sx:{fontSize:48,color:"#2563eb"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:79,columnNumber:16},void 0);default:return b.jsxDEV(fp,{sx:{fontSize:48,color:"#6b7280"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:81,columnNumber:16},void 0)}},a=()=>b.jsxDEV(re,{sx:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#f8f9fa",p:4},children:[b.jsxDEV(Yr,{size:64,thickness:4,sx:{color:"#2563eb",mb:3}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:98,columnNumber:7},void 0),b.jsxDEV(ge,{variant:"h6",sx:{mb:1,color:"#1f2937"},children:"Loading Document"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:107,columnNumber:7},void 0),b.jsxDEV(ge,{variant:"body2",sx:{color:"#6b7280",textAlign:"center",maxWidth:300},children:["Preparing professional viewer for ",(n==null?void 0:n.name)||"document","..."]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:111,columnNumber:7},void 0),n&&b.jsxDEV(re,{sx:{mt:3,textAlign:"center"},children:[s(r(n)),b.jsxDEV(ge,{variant:"caption",sx:{display:"block",mt:1,color:"#9ca3af"},children:[n.exhibit_id&&`Exhibit ${n.exhibit_id} • `,n.file_type.toUpperCase()]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:118,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:116,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:87,columnNumber:5},void 0),o=()=>b.jsxDEV(re,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",p:4,backgroundColor:"#f8f9fa"},children:b.jsxDEV(sn,{elevation:0,sx:{p:4,maxWidth:500,textAlign:"center",backgroundColor:"white",border:"1px solid #fecaca"},children:[b.jsxDEV(Aa,{severity:"error",sx:{mb:3},children:"Document Loading Error"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:149,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"h6",gutterBottom:!0,sx:{color:"#dc2626"},children:"Unable to Load Document"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:153,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"body2",sx:{mb:3,color:"#6b7280"},children:i||"The document could not be loaded. Please check the file format and try again."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:157,columnNumber:9},void 0),n&&b.jsxDEV(re,{sx:{p:2,backgroundColor:"#f9fafb",borderRadius:1,mt:2},children:b.jsxDEV(ge,{variant:"caption",sx:{color:"#6b7280"},children:["File: ",n.name,b.jsxDEV("br",{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:164,columnNumber:32},void 0),"Type: ",n.file_type,b.jsxDEV("br",{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:165,columnNumber:37},void 0),"Size: ",(n.size/1024/1024).toFixed(2)," MB",n.exhibit_id&&b.jsxDEV(b.Fragment,{children:[b.jsxDEV("br",{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:167,columnNumber:37},void 0),"Exhibit: ",n.exhibit_id]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:167,columnNumber:35},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:163,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:139,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:129,columnNumber:5},void 0),l=()=>b.jsxDEV(re,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",p:4,backgroundColor:"#f8f9fa"},children:b.jsxDEV(sn,{elevation:0,sx:{p:6,maxWidth:400,textAlign:"center",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:2},children:[b.jsxDEV(re,{sx:{mb:3},children:b.jsxDEV(fp,{sx:{fontSize:72,color:"#d1d5db"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:199,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:198,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"h6",gutterBottom:!0,sx:{color:"#374151"},children:"No Document Selected"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:202,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"body2",sx:{color:"#6b7280",mb:3},children:"Select a document from the file browser to view it with professional precision controls."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:206,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"caption",sx:{color:"#9ca3af"},children:"Supports PDF, images, audio, video, and document files with citation linking"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:210,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:187,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:177,columnNumber:5},void 0),c=p=>b.jsxDEV(re,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",p:4,backgroundColor:"#f8f9fa"},children:b.jsxDEV(sn,{elevation:0,sx:{p:4,maxWidth:400,textAlign:"center",backgroundColor:"white",border:"1px solid #fbbf24"},children:[b.jsxDEV(re,{sx:{mb:3},children:s("unsupported")},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:239,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"h6",gutterBottom:!0,sx:{color:"#92400e"},children:"Unsupported File Type"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:243,columnNumber:9},void 0),b.jsxDEV(ge,{variant:"body2",sx:{mb:3,color:"#6b7280"},children:"This file type is not yet supported by the professional viewer."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:247,columnNumber:9},void 0),n&&b.jsxDEV(re,{sx:{p:2,backgroundColor:"#fef3c7",borderRadius:1},children:b.jsxDEV(ge,{variant:"caption",sx:{color:"#92400e"},children:["File: ",n.name,b.jsxDEV("br",{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:254,columnNumber:32},void 0),"Type: ",n.file_type,b.jsxDEV("br",{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:255,columnNumber:37},void 0),"Content Type: ",n.content_type]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:253,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:252,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:229,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:219,columnNumber:5},void 0),u=()=>{if(t)return a();if(i)return o();if(!n||!e)return l();switch(r(n)){case"pdf":return b.jsxDEV(iI,{url:e,fileName:n.name},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:287,columnNumber:11},void 0);case"image":return b.jsxDEV(a1,{url:e,fileType:"image",fileName:n.name},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:295,columnNumber:11},void 0);case"audio":return b.jsxDEV(a1,{url:e,fileType:"audio",fileName:n.name},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:304,columnNumber:11},void 0);case"video":return b.jsxDEV(a1,{url:e,fileType:"video",fileName:n.name},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:313,columnNumber:11},void 0);case"document":return b.jsxDEV(iI,{url:e,fileName:n.name},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:324,columnNumber:11},void 0);default:return c()}};return b.jsxDEV(re,{sx:{height:"100%",display:"flex",flexDirection:"column",backgroundColor:"#ffffff",overflow:"hidden"},children:b.jsxDEV(NZ,{children:u()},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:345,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/ProfessionalViewerContainer.tsx",lineNumber:336,columnNumber:5},void 0)},CZ=({fileName:n,fileType:e,onCopyLink:t})=>{const[i,r]=T.useState(1),[s,a]=T.useState(0),o=()=>{r(g=>Math.min(g+.25,3))},l=()=>{r(g=>Math.max(g-.25,.5))},c=()=>{a(g=>(g-90)%360)},u=()=>{a(g=>(g+90)%360)},p=()=>{switch(e){case"pdf":return b.jsxDEV(F0,{sx:{fontSize:64}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:53,columnNumber:16},void 0);case"image":return b.jsxDEV(xg,{sx:{fontSize:64}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:55,columnNumber:16},void 0);case"document":return b.jsxDEV(Gf,{sx:{fontSize:64}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:57,columnNumber:16},void 0);case"audio":return b.jsxDEV(vA,{sx:{fontSize:64}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:59,columnNumber:16},void 0);case"video":return b.jsxDEV(yA,{sx:{fontSize:64}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:61,columnNumber:16},void 0);case"code":return b.jsxDEV($m,{sx:{fontSize:64}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:63,columnNumber:16},void 0);default:return b.jsxDEV(Gf,{sx:{fontSize:64}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:65,columnNumber:16},void 0)}},m=()=>{switch(e){case"pdf":return b.jsxDEV(re,{sx:{p:4,bgcolor:"background.default",borderRadius:1,width:"80%",maxWidth:600},children:[b.jsxDEV(re,{sx:{mb:2,display:"flex",alignItems:"center",justifyContent:"center"},children:[b.jsxDEV(F0,{color:"primary",sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:76,columnNumber:15},void 0),b.jsxDEV(ge,{variant:"h6",color:"primary",children:"PDF Document"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:77,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:75,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"body1",paragraph:!0,children:"This is a preview of a PDF document. In a real application, you would see the actual PDF content rendered here."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:79,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"body1",paragraph:!0,children:"The document would contain text, images, and possibly other elements like tables or forms."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:82,columnNumber:13},void 0),b.jsxDEV(re,{sx:{mt:4,p:2,bgcolor:"background.paper",borderRadius:1},children:b.jsxDEV(ge,{variant:"body2",color:"text.secondary",children:["File: ",n]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:86,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:85,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:74,columnNumber:11},void 0);case"image":return b.jsxDEV(re,{sx:{width:400,height:300,bgcolor:"grey.200",display:"flex",alignItems:"center",justifyContent:"center",transform:`scale(${i}) rotate(${s}deg)`,transition:"transform 0.3s ease"},children:b.jsxDEV(xg,{sx:{fontSize:80,color:"text.secondary"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:106,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:94,columnNumber:11},void 0);case"audio":return b.jsxDEV(re,{sx:{p:3,width:"100%",maxWidth:500},children:b.jsxDEV(re,{sx:{border:1,borderColor:"divider",borderRadius:1,p:2,bgcolor:"background.paper"},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",mb:2},children:[b.jsxDEV(vA,{color:"primary",sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:114,columnNumber:17},void 0),b.jsxDEV(ge,{variant:"subtitle1",children:n},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:115,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:113,columnNumber:15},void 0),b.jsxDEV(re,{sx:{height:80,bgcolor:"action.hover",borderRadius:1,position:"relative",overflow:"hidden"},children:Array.from({length:40}).map((g,y)=>b.jsxDEV(re,{sx:{position:"absolute",bottom:"50%",left:`${y*2.5}%`,width:"2px",height:`${20+Math.random()*30}%`,bgcolor:"primary.main",opacity:.7}},y,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:128,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:117,columnNumber:15},void 0),b.jsxDEV(re,{sx:{display:"flex",justifyContent:"center",mt:2},children:b.jsxDEV(re,{sx:{width:"80%",height:5,bgcolor:"grey.300",borderRadius:5,position:"relative"},children:b.jsxDEV(re,{sx:{position:"absolute",left:0,top:0,width:"30%",height:"100%",bgcolor:"primary.main",borderRadius:5}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:150,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:143,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:112,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:111,columnNumber:11},void 0);case"video":return b.jsxDEV(re,{sx:{width:480,height:270,bgcolor:"black",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:1},children:b.jsxDEV(yA,{sx:{fontSize:80,color:"white"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:175,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:166,columnNumber:11},void 0);default:return b.jsxDEV(re,{sx:{p:3,bgcolor:"background.paper",border:1,borderColor:"divider",borderRadius:1,width:"100%",maxWidth:600,maxHeight:400,overflow:"auto"},children:b.jsxDEV(ge,{variant:"body1",fontFamily:"monospace",sx:{whiteSpace:"pre-wrap"},children:`This is a mock text representation of a ${e} file.
              
// ${n}
              
Lorem ipsum dolor sit amet, consectetur adipiscing elit.
Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.

${"-".repeat(40)}

The actual content would be displayed here in a format appropriate for the file type.
For documents, you would see formatted text.
For code files, you would see syntax-highlighted code.
For spreadsheets, you would see a grid of data.
              
${"-".repeat(40)}`},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:191,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:180,columnNumber:11},void 0)}};return b.jsxDEV(re,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[b.jsxDEV(sn,{elevation:0,sx:{p:1,borderBottom:1,borderColor:"divider",borderRadius:0},children:b.jsxDEV(pi,{direction:"row",spacing:1,divider:b.jsxDEV(Pr,{orientation:"vertical",flexItem:!0},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:235,columnNumber:20},void 0),sx:{alignItems:"center"},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center"},children:[p(),b.jsxDEV(ge,{variant:"subtitle2",sx:{ml:1},children:n},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:240,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:238,columnNumber:11},void 0),b.jsxDEV(re,{sx:{flexGrow:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:245,columnNumber:11},void 0),b.jsxDEV(pi,{direction:"row",spacing:.5,children:[b.jsxDEV(Nt,{title:"Zoom out",children:b.jsxDEV(ut,{onClick:l,disabled:i<=.5,children:b.jsxDEV(mE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:251,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:250,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:249,columnNumber:13},void 0),b.jsxDEV(ge,{sx:{alignSelf:"center"},children:[Math.round(i*100),"%"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:255,columnNumber:13},void 0),b.jsxDEV(Nt,{title:"Zoom in",children:b.jsxDEV(ut,{onClick:o,disabled:i>=3,children:b.jsxDEV(gE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:261,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:260,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:259,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:248,columnNumber:11},void 0),b.jsxDEV(pi,{direction:"row",spacing:.5,children:[b.jsxDEV(Nt,{title:"Rotate left",children:b.jsxDEV(ut,{onClick:c,children:b.jsxDEV(HR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:270,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:269,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:268,columnNumber:13},void 0),b.jsxDEV(Nt,{title:"Rotate right",children:b.jsxDEV(ut,{onClick:u,children:b.jsxDEV(qR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:276,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:275,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:274,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:267,columnNumber:11},void 0),b.jsxDEV(Nt,{title:"Copy link to this file",children:b.jsxDEV(ut,{onClick:t,children:b.jsxDEV(GR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:284,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:283,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:282,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:232,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:223,columnNumber:7},void 0),b.jsxDEV(re,{sx:{flexGrow:1,overflow:"auto",display:"flex",alignItems:"center",justifyContent:"center",p:2},children:m()},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:291,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/viewers/MockFileViewer.tsx",lineNumber:215,columnNumber:5},void 0)};class AZ extends Error{constructor(t,i,r,s,a){super(t);Me(this,"name","Assertion");Me(this,"code","ERR_ASSERTION");Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.actual=i,this.expected=r,this.generated=a,this.operator=s}}function te(n,e){jF(!!n,!1,!0,"ok","Expected value to be truthy",e)}function HS(n){jF(!1,!1,!0,"ok","Unreachable",n)}function jF(n,e,t,i,r,s){if(!n)throw s instanceof Error?s:new AZ(s||r,e,t,i,!s)}function PZ(n,e){const t={};return(n[n.length-1]===""?[...n,""]:n).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const TZ=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,IZ=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,RZ={};function pI(n,e){return(RZ.jsx?IZ:TZ).test(n)}const MZ=/[ \t\n\f\r]/g;function jZ(n){return typeof n=="object"?n.type==="text"?fI(n.value):!1:fI(n)}function fI(n){return n.replace(MZ,"")===""}class Ty{constructor(e,t,i){this.normal=t,this.property=e,i&&(this.space=i)}}Ty.prototype.normal={};Ty.prototype.property={};Ty.prototype.space=void 0;function OF(n,e){const t={},i={};for(const r of n)Object.assign(t,r.property),Object.assign(i,r.normal);return new Ty(t,i,e)}function qS(n){return n.toLowerCase()}class Kr{constructor(e,t){this.attribute=t,this.property=e}}Kr.prototype.attribute="";Kr.prototype.booleanish=!1;Kr.prototype.boolean=!1;Kr.prototype.commaOrSpaceSeparated=!1;Kr.prototype.commaSeparated=!1;Kr.prototype.defined=!1;Kr.prototype.mustUseProperty=!1;Kr.prototype.number=!1;Kr.prototype.overloadedBoolean=!1;Kr.prototype.property="";Kr.prototype.spaceSeparated=!1;Kr.prototype.space=void 0;let OZ=0;const jt=bh(),di=bh(),GS=bh(),Fe=bh(),Pn=bh(),wp=bh(),ss=bh();function bh(){return 2**++OZ}const YS=Object.freeze(Object.defineProperty({__proto__:null,boolean:jt,booleanish:di,commaOrSpaceSeparated:ss,commaSeparated:wp,number:Fe,overloadedBoolean:GS,spaceSeparated:Pn},Symbol.toStringTag,{value:"Module"})),o1=Object.keys(YS);class hN extends Kr{constructor(e,t,i,r){let s=-1;if(super(e,t),mI(this,"space",r),typeof i=="number")for(;++s<o1.length;){const a=o1[s];mI(this,o1[s],(i&YS[a])===YS[a])}}}hN.prototype.defined=!0;function mI(n,e,t){t&&(n[e]=t)}function im(n){const e={},t={};for(const[i,r]of Object.entries(n.properties)){const s=new hN(i,n.transform(n.attributes||{},i),r,n.space);n.mustUseProperty&&n.mustUseProperty.includes(i)&&(s.mustUseProperty=!0),e[i]=s,t[qS(i)]=i,t[qS(s.attribute)]=i}return new Ty(e,t,n.space)}const LF=im({properties:{ariaActiveDescendant:null,ariaAtomic:di,ariaAutoComplete:null,ariaBusy:di,ariaChecked:di,ariaColCount:Fe,ariaColIndex:Fe,ariaColSpan:Fe,ariaControls:Pn,ariaCurrent:null,ariaDescribedBy:Pn,ariaDetails:null,ariaDisabled:di,ariaDropEffect:Pn,ariaErrorMessage:null,ariaExpanded:di,ariaFlowTo:Pn,ariaGrabbed:di,ariaHasPopup:null,ariaHidden:di,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Pn,ariaLevel:Fe,ariaLive:null,ariaModal:di,ariaMultiLine:di,ariaMultiSelectable:di,ariaOrientation:null,ariaOwns:Pn,ariaPlaceholder:null,ariaPosInSet:Fe,ariaPressed:di,ariaReadOnly:di,ariaRelevant:null,ariaRequired:di,ariaRoleDescription:Pn,ariaRowCount:Fe,ariaRowIndex:Fe,ariaRowSpan:Fe,ariaSelected:di,ariaSetSize:Fe,ariaSort:null,ariaValueMax:Fe,ariaValueMin:Fe,ariaValueNow:Fe,ariaValueText:null,role:null},transform(n,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function FF(n,e){return e in n?n[e]:e}function VF(n,e){return FF(n,e.toLowerCase())}const LZ=im({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:wp,acceptCharset:Pn,accessKey:Pn,action:null,allow:null,allowFullScreen:jt,allowPaymentRequest:jt,allowUserMedia:jt,alt:null,as:null,async:jt,autoCapitalize:null,autoComplete:Pn,autoFocus:jt,autoPlay:jt,blocking:Pn,capture:null,charSet:null,checked:jt,cite:null,className:Pn,cols:Fe,colSpan:null,content:null,contentEditable:di,controls:jt,controlsList:Pn,coords:Fe|wp,crossOrigin:null,data:null,dateTime:null,decoding:null,default:jt,defer:jt,dir:null,dirName:null,disabled:jt,download:GS,draggable:di,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:jt,formTarget:null,headers:Pn,height:Fe,hidden:GS,high:Fe,href:null,hrefLang:null,htmlFor:Pn,httpEquiv:Pn,id:null,imageSizes:null,imageSrcSet:null,inert:jt,inputMode:null,integrity:null,is:null,isMap:jt,itemId:null,itemProp:Pn,itemRef:Pn,itemScope:jt,itemType:Pn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:jt,low:Fe,manifest:null,max:null,maxLength:Fe,media:null,method:null,min:null,minLength:Fe,multiple:jt,muted:jt,name:null,nonce:null,noModule:jt,noValidate:jt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:jt,optimum:Fe,pattern:null,ping:Pn,placeholder:null,playsInline:jt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:jt,referrerPolicy:null,rel:Pn,required:jt,reversed:jt,rows:Fe,rowSpan:Fe,sandbox:Pn,scope:null,scoped:jt,seamless:jt,selected:jt,shadowRootClonable:jt,shadowRootDelegatesFocus:jt,shadowRootMode:null,shape:null,size:Fe,sizes:null,slot:null,span:Fe,spellCheck:di,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Fe,step:null,style:null,tabIndex:Fe,target:null,title:null,translate:null,type:null,typeMustMatch:jt,useMap:null,value:di,width:Fe,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Pn,axis:null,background:null,bgColor:null,border:Fe,borderColor:null,bottomMargin:Fe,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:jt,declare:jt,event:null,face:null,frame:null,frameBorder:null,hSpace:Fe,leftMargin:Fe,link:null,longDesc:null,lowSrc:null,marginHeight:Fe,marginWidth:Fe,noResize:jt,noHref:jt,noShade:jt,noWrap:jt,object:null,profile:null,prompt:null,rev:null,rightMargin:Fe,rules:null,scheme:null,scrolling:di,standby:null,summary:null,text:null,topMargin:Fe,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Fe,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:jt,disableRemotePlayback:jt,prefix:null,property:null,results:Fe,security:null,unselectable:null},space:"html",transform:VF}),FZ=im({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:ss,accentHeight:Fe,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Fe,amplitude:Fe,arabicForm:null,ascent:Fe,attributeName:null,attributeType:null,azimuth:Fe,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Fe,by:null,calcMode:null,capHeight:Fe,className:Pn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Fe,diffuseConstant:Fe,direction:null,display:null,dur:null,divisor:Fe,dominantBaseline:null,download:jt,dx:null,dy:null,edgeMode:null,editable:null,elevation:Fe,enableBackground:null,end:null,event:null,exponent:Fe,externalResourcesRequired:null,fill:null,fillOpacity:Fe,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:wp,g2:wp,glyphName:wp,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Fe,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Fe,horizOriginX:Fe,horizOriginY:Fe,id:null,ideographic:Fe,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Fe,k:Fe,k1:Fe,k2:Fe,k3:Fe,k4:Fe,kernelMatrix:ss,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Fe,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Fe,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Fe,overlineThickness:Fe,paintOrder:null,panose1:null,path:null,pathLength:Fe,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Pn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Fe,pointsAtY:Fe,pointsAtZ:Fe,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:ss,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:ss,rev:ss,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:ss,requiredFeatures:ss,requiredFonts:ss,requiredFormats:ss,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Fe,specularExponent:Fe,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Fe,strikethroughThickness:Fe,string:null,stroke:null,strokeDashArray:ss,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Fe,strokeOpacity:Fe,strokeWidth:null,style:null,surfaceScale:Fe,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:ss,tabIndex:Fe,tableValues:null,target:null,targetX:Fe,targetY:Fe,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:ss,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Fe,underlineThickness:Fe,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Fe,values:null,vAlphabetic:Fe,vMathematical:Fe,vectorEffect:null,vHanging:Fe,vIdeographic:Fe,version:null,vertAdvY:Fe,vertOriginX:Fe,vertOriginY:Fe,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Fe,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:FF}),UF=im({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(n,e){return"xlink:"+e.slice(5).toLowerCase()}}),zF=im({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:VF}),BF=im({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(n,e){return"xml:"+e.slice(3).toLowerCase()}}),VZ={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},UZ=/[A-Z]/g,gI=/-[a-z]/g,zZ=/^data[-\w.:]+$/i;function BZ(n,e){const t=qS(e);let i=e,r=Kr;if(t in n.normal)return n.property[n.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&zZ.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(gI,WZ);i="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!gI.test(s)){let a=s.replace(UZ,$Z);a.charAt(0)!=="-"&&(a="-"+a),e="data"+a}}r=hN}return new r(i,e)}function $Z(n){return"-"+n.toLowerCase()}function WZ(n){return n.charAt(1).toUpperCase()}const HZ=OF([LF,LZ,UF,zF,BF],"html"),pN=OF([LF,FZ,UF,zF,BF],"svg");function qZ(n){return n.join(" ").trim()}var Xh={},l1,bI;function GZ(){if(bI)return l1;bI=1;var n=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,e=/\n/g,t=/^\s*/,i=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,r=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,a=/^[;\s]*/,o=/^\s+|\s+$/g,l=`
`,c="/",u="*",p="",m="comment",g="declaration";l1=function(v,w){if(typeof v!="string")throw new TypeError("First argument must be a string");if(!v)return[];w=w||{};var k=1,S=1;function E(X){var G=X.match(e);G&&(k+=G.length);var K=X.lastIndexOf(l);S=~K?X.length-K:S+X.length}function P(){var X={line:k,column:S};return function(G){return G.position=new A(X),V(),G}}function A(X){this.start=X,this.end={line:k,column:S},this.source=w.source}A.prototype.content=v;function N(X){var G=new Error(w.source+":"+k+":"+S+": "+X);if(G.reason=X,G.filename=w.source,G.line=k,G.column=S,G.source=v,!w.silent)throw G}function R(X){var G=X.exec(v);if(G){var K=G[0];return E(K),v=v.slice(K.length),G}}function V(){R(t)}function B(X){var G;for(X=X||[];G=L();)G!==!1&&X.push(G);return X}function L(){var X=P();if(!(c!=v.charAt(0)||u!=v.charAt(1))){for(var G=2;p!=v.charAt(G)&&(u!=v.charAt(G)||c!=v.charAt(G+1));)++G;if(G+=2,p===v.charAt(G-1))return N("End of comment missing");var K=v.slice(2,G-2);return S+=2,E(K),v=v.slice(G),S+=2,X({type:m,comment:K})}}function W(){var X=P(),G=R(i);if(G){if(L(),!R(r))return N("property missing ':'");var K=R(s),J=X({type:g,property:y(G[0].replace(n,p)),value:K?y(K[0].replace(n,p)):p});return R(a),J}}function q(){var X=[];B(X);for(var G;G=W();)G!==!1&&(X.push(G),B(X));return X}return V(),q()};function y(v){return v?v.replace(o,p):p}return l1}var yI;function YZ(){if(yI)return Xh;yI=1;var n=Xh&&Xh.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Xh,"__esModule",{value:!0}),Xh.default=t;var e=n(GZ());function t(i,r){var s=null;if(!i||typeof i!="string")return s;var a=(0,e.default)(i),o=typeof r=="function";return a.forEach(function(l){if(l.type==="declaration"){var c=l.property,u=l.value;o?r(c,u,l):u&&(s=s||{},s[c]=u)}}),s}return Xh}var Lm={},vI;function XZ(){if(vI)return Lm;vI=1,Object.defineProperty(Lm,"__esModule",{value:!0}),Lm.camelCase=void 0;var n=/^--[a-zA-Z0-9_-]+$/,e=/-([a-z])/g,t=/^[^-]+$/,i=/^-(webkit|moz|ms|o|khtml)-/,r=/^-(ms)-/,s=function(c){return!c||t.test(c)||n.test(c)},a=function(c,u){return u.toUpperCase()},o=function(c,u){return"".concat(u,"-")},l=function(c,u){return u===void 0&&(u={}),s(c)?c:(c=c.toLowerCase(),u.reactCompat?c=c.replace(r,o):c=c.replace(i,o),c.replace(e,a))};return Lm.camelCase=l,Lm}var Fm,xI;function KZ(){if(xI)return Fm;xI=1;var n=Fm&&Fm.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},e=n(YZ()),t=XZ();function i(r,s){var a={};return!r||typeof r!="string"||(0,e.default)(r,function(o,l){o&&l&&(a[(0,t.camelCase)(o,s)]=l)}),a}return i.default=i,Fm=i,Fm}var QZ=KZ();const JZ=Jf(QZ),$F=WF("end"),fN=WF("start");function WF(n){return e;function e(t){const i=t&&t.position&&t.position[n]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function ZZ(n){const e=fN(n),t=$F(n);if(e&&t)return{start:e,end:t}}function bg(n){return!n||typeof n!="object"?"":"position"in n||"type"in n?wI(n.position):"start"in n||"end"in n?wI(n):"line"in n||"column"in n?XS(n):""}function XS(n){return kI(n&&n.line)+":"+kI(n&&n.column)}function wI(n){return XS(n&&n.start)+"-"+XS(n&&n.end)}function kI(n){return n&&typeof n=="number"?n:1}class gr extends Error{constructor(e,t,i){super(),typeof t=="string"&&(i=t,t=void 0);let r="",s={},a=!1;if(t&&("line"in t&&"column"in t?s={place:t}:"start"in t&&"end"in t?s={place:t}:"type"in t?s={ancestors:[t],place:t.position}:s={...t}),typeof e=="string"?r=e:!s.cause&&e&&(a=!0,r=e.message,s.cause=e),!s.ruleId&&!s.source&&typeof i=="string"){const l=i.indexOf(":");l===-1?s.ruleId=i:(s.source=i.slice(0,l),s.ruleId=i.slice(l+1))}if(!s.place&&s.ancestors&&s.ancestors){const l=s.ancestors[s.ancestors.length-1];l&&(s.place=l.position)}const o=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file="",this.message=r,this.line=o?o.line:void 0,this.name=bg(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=a&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}gr.prototype.file="";gr.prototype.name="";gr.prototype.reason="";gr.prototype.message="";gr.prototype.stack="";gr.prototype.column=void 0;gr.prototype.line=void 0;gr.prototype.ancestors=void 0;gr.prototype.cause=void 0;gr.prototype.fatal=void 0;gr.prototype.place=void 0;gr.prototype.ruleId=void 0;gr.prototype.source=void 0;const mN={}.hasOwnProperty,eee=new Map,tee=/[A-Z]/g,nee=new Set(["table","tbody","thead","tfoot","tr"]),iee=new Set(["td","th"]),HF="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function ree(n,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=e.filePath||void 0;let i;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=hee(t,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");i=dee(t,e.jsx,e.jsxs)}const r={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:i,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?pN:HZ,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},s=qF(r,n,void 0);return s&&typeof s!="string"?s:r.create(n,r.Fragment,{children:s||void 0},void 0)}function qF(n,e,t){if(e.type==="element")return see(n,e,t);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return aee(n,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return lee(n,e,t);if(e.type==="mdxjsEsm")return oee(n,e);if(e.type==="root")return cee(n,e,t);if(e.type==="text")return uee(n,e)}function see(n,e,t){const i=n.schema;let r=i;e.tagName.toLowerCase()==="svg"&&i.space==="html"&&(r=pN,n.schema=r),n.ancestors.push(e);const s=YF(n,e.tagName,!1),a=pee(n,e);let o=bN(n,e);return nee.has(e.tagName)&&(o=o.filter(function(l){return typeof l=="string"?!jZ(l):!0})),GF(n,a,s,e),gN(a,o),n.ancestors.pop(),n.schema=i,n.create(e,s,a,t)}function aee(n,e){if(e.data&&e.data.estree&&n.evaluater){const i=e.data.estree.body[0];return te(i.type==="ExpressionStatement"),n.evaluater.evaluateExpression(i.expression)}Mg(n,e.position)}function oee(n,e){if(e.data&&e.data.estree&&n.evaluater)return n.evaluater.evaluateProgram(e.data.estree);Mg(n,e.position)}function lee(n,e,t){const i=n.schema;let r=i;e.name==="svg"&&i.space==="html"&&(r=pN,n.schema=r),n.ancestors.push(e);const s=e.name===null?n.Fragment:YF(n,e.name,!0),a=fee(n,e),o=bN(n,e);return GF(n,a,s,e),gN(a,o),n.ancestors.pop(),n.schema=i,n.create(e,s,a,t)}function cee(n,e,t){const i={};return gN(i,bN(n,e)),n.create(e,n.Fragment,i,t)}function uee(n,e){return e.value}function GF(n,e,t,i){typeof t!="string"&&t!==n.Fragment&&n.passNode&&(e.node=i)}function gN(n,e){if(e.length>0){const t=e.length>1?e:e[0];t&&(n.children=t)}}function dee(n,e,t){return i;function i(r,s,a,o){const c=Array.isArray(a.children)?t:e;return o?c(s,a,o):c(s,a)}}function hee(n,e){return t;function t(i,r,s,a){const o=Array.isArray(s.children),l=fN(i);return e(r,s,a,o,{columnNumber:l?l.column-1:void 0,fileName:n,lineNumber:l?l.line:void 0},void 0)}}function pee(n,e){const t={};let i,r;for(r in e.properties)if(r!=="children"&&mN.call(e.properties,r)){const s=mee(n,r,e.properties[r]);if(s){const[a,o]=s;n.tableCellAlignToStyle&&a==="align"&&typeof o=="string"&&iee.has(e.tagName)?i=o:t[a]=o}}if(i){const s=t.style||(t.style={});s[n.stylePropertyNameCase==="css"?"text-align":"textAlign"]=i}return t}function fee(n,e){const t={};for(const i of e.attributes)if(i.type==="mdxJsxExpressionAttribute")if(i.data&&i.data.estree&&n.evaluater){const s=i.data.estree.body[0];te(s.type==="ExpressionStatement");const a=s.expression;te(a.type==="ObjectExpression");const o=a.properties[0];te(o.type==="SpreadElement"),Object.assign(t,n.evaluater.evaluateExpression(o.argument))}else Mg(n,e.position);else{const r=i.name;let s;if(i.value&&typeof i.value=="object")if(i.value.data&&i.value.data.estree&&n.evaluater){const o=i.value.data.estree.body[0];te(o.type==="ExpressionStatement"),s=n.evaluater.evaluateExpression(o.expression)}else Mg(n,e.position);else s=i.value===null?!0:i.value;t[r]=s}return t}function bN(n,e){const t=[];let i=-1;const r=n.passKeys?new Map:eee;for(;++i<e.children.length;){const s=e.children[i];let a;if(n.passKeys){const l=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(l){const c=r.get(l)||0;a=l+"-"+c,r.set(l,c+1)}}const o=qF(n,s,a);o!==void 0&&t.push(o)}return t}function mee(n,e,t){const i=BZ(n.schema,e);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=i.commaSeparated?PZ(t):qZ(t)),i.property==="style"){let r=typeof t=="object"?t:gee(n,String(t));return n.stylePropertyNameCase==="css"&&(r=bee(r)),["style",r]}return[n.elementAttributeNameCase==="react"&&i.space?VZ[i.property]||i.property:i.attribute,t]}}function gee(n,e){try{return JZ(e,{reactCompat:!0})}catch(t){if(n.ignoreInvalidStyle)return{};const i=t,r=new gr("Cannot parse `style` attribute",{ancestors:n.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw r.file=n.filePath||void 0,r.url=HF+"#cannot-parse-style-attribute",r}}function YF(n,e,t){let i;if(!t)i={type:"Literal",value:e};else if(e.includes(".")){const r=e.split(".");let s=-1,a;for(;++s<r.length;){const o=pI(r[s])?{type:"Identifier",name:r[s]}:{type:"Literal",value:r[s]};a=a?{type:"MemberExpression",object:a,property:o,computed:!!(s&&o.type==="Literal"),optional:!1}:o}te(a,"always a result"),i=a}else i=pI(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(i.type==="Literal"){const r=i.value;return mN.call(n.components,r)?n.components[r]:r}if(n.evaluater)return n.evaluater.evaluateExpression(i);Mg(n)}function Mg(n,e){const t=new gr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:n.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=n.filePath||void 0,t.url=HF+"#cannot-handle-mdx-estrees-without-createevaluater",t}function bee(n){const e={};let t;for(t in n)mN.call(n,t)&&(e[yee(t)]=n[t]);return e}function yee(n){let e=n.replace(tee,vee);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function vee(n){return"-"+n.toLowerCase()}const c1={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},xee={};function yN(n,e){const t=xee,i=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,r=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return XF(n,i,r)}function XF(n,e,t){if(wee(n)){if("value"in n)return n.type==="html"&&!t?"":n.value;if(e&&"alt"in n&&n.alt)return n.alt;if("children"in n)return DI(n.children,e,t)}return Array.isArray(n)?DI(n,e,t):""}function DI(n,e,t){const i=[];let r=-1;for(;++r<n.length;)i[r]=XF(n[r],e,t);return i.join("")}function wee(n){return!!(n&&typeof n=="object")}const SI=document.createElement("i");function vN(n){const e="&"+n+";";SI.innerHTML=e;const t=SI.textContent;return t.charCodeAt(t.length-1)===59&&n!=="semi"||t===e?!1:t}const I={carriageReturn:-5,lineFeed:-4,carriageReturnLineFeed:-3,horizontalTab:-2,virtualSpace:-1,eof:null,nul:0,ht:9,lf:10,vt:11,cr:13,space:32,exclamationMark:33,quotationMark:34,numberSign:35,percentSign:37,ampersand:38,apostrophe:39,leftParenthesis:40,rightParenthesis:41,asterisk:42,plusSign:43,comma:44,dash:45,dot:46,slash:47,digit0:48,digit1:49,digit2:50,digit3:51,digit4:52,digit5:53,digit6:54,digit7:55,digit8:56,digit9:57,colon:58,semicolon:59,lessThan:60,equalsTo:61,greaterThan:62,questionMark:63,atSign:64,uppercaseA:65,uppercaseH:72,uppercaseW:87,uppercaseX:88,leftSquareBracket:91,backslash:92,rightSquareBracket:93,caret:94,underscore:95,graveAccent:96,lowercaseA:97,lowercaseH:104,lowercaseW:119,lowercaseX:120,leftCurlyBrace:123,verticalBar:124,tilde:126,del:127,byteOrderMarker:65279,replacementCharacter:65533},qe={attentionSideAfter:2,atxHeadingOpeningFenceSizeMax:6,autolinkDomainSizeMax:63,autolinkSchemeSizeMax:32,cdataOpeningString:"CDATA[",characterGroupPunctuation:2,characterGroupWhitespace:1,characterReferenceDecimalSizeMax:7,characterReferenceHexadecimalSizeMax:6,characterReferenceNamedSizeMax:31,codeFencedSequenceSizeMin:3,contentTypeContent:"content",contentTypeFlow:"flow",contentTypeString:"string",contentTypeText:"text",hardBreakPrefixSizeMin:2,htmlBasic:6,htmlCdata:5,htmlComment:2,htmlComplete:7,htmlDeclaration:4,htmlInstruction:3,htmlRawSizeMax:8,htmlRaw:1,linkResourceDestinationBalanceMax:32,linkReferenceSizeMax:999,listItemValueSizeMax:10,numericBaseDecimal:10,numericBaseHexadecimal:16,tabSize:4,thematicBreakMarkerCountMin:3,v8MaxSafeChunkSize:1e4},F={data:"data",whitespace:"whitespace",lineEnding:"lineEnding",lineEndingBlank:"lineEndingBlank",linePrefix:"linePrefix",lineSuffix:"lineSuffix",atxHeading:"atxHeading",atxHeadingSequence:"atxHeadingSequence",atxHeadingText:"atxHeadingText",autolink:"autolink",autolinkEmail:"autolinkEmail",autolinkMarker:"autolinkMarker",autolinkProtocol:"autolinkProtocol",characterEscape:"characterEscape",characterEscapeValue:"characterEscapeValue",characterReference:"characterReference",characterReferenceMarker:"characterReferenceMarker",characterReferenceMarkerNumeric:"characterReferenceMarkerNumeric",characterReferenceMarkerHexadecimal:"characterReferenceMarkerHexadecimal",characterReferenceValue:"characterReferenceValue",codeFenced:"codeFenced",codeFencedFence:"codeFencedFence",codeFencedFenceSequence:"codeFencedFenceSequence",codeFencedFenceInfo:"codeFencedFenceInfo",codeFencedFenceMeta:"codeFencedFenceMeta",codeFlowValue:"codeFlowValue",codeIndented:"codeIndented",codeText:"codeText",codeTextData:"codeTextData",codeTextPadding:"codeTextPadding",codeTextSequence:"codeTextSequence",content:"content",definition:"definition",definitionDestination:"definitionDestination",definitionDestinationLiteral:"definitionDestinationLiteral",definitionDestinationLiteralMarker:"definitionDestinationLiteralMarker",definitionDestinationRaw:"definitionDestinationRaw",definitionDestinationString:"definitionDestinationString",definitionLabel:"definitionLabel",definitionLabelMarker:"definitionLabelMarker",definitionLabelString:"definitionLabelString",definitionMarker:"definitionMarker",definitionTitle:"definitionTitle",definitionTitleMarker:"definitionTitleMarker",definitionTitleString:"definitionTitleString",emphasis:"emphasis",emphasisSequence:"emphasisSequence",emphasisText:"emphasisText",escapeMarker:"escapeMarker",hardBreakEscape:"hardBreakEscape",hardBreakTrailing:"hardBreakTrailing",htmlFlow:"htmlFlow",htmlFlowData:"htmlFlowData",htmlText:"htmlText",htmlTextData:"htmlTextData",image:"image",label:"label",labelText:"labelText",labelLink:"labelLink",labelImage:"labelImage",labelMarker:"labelMarker",labelImageMarker:"labelImageMarker",labelEnd:"labelEnd",link:"link",paragraph:"paragraph",reference:"reference",referenceMarker:"referenceMarker",referenceString:"referenceString",resource:"resource",resourceDestination:"resourceDestination",resourceDestinationLiteral:"resourceDestinationLiteral",resourceDestinationLiteralMarker:"resourceDestinationLiteralMarker",resourceDestinationRaw:"resourceDestinationRaw",resourceDestinationString:"resourceDestinationString",resourceMarker:"resourceMarker",resourceTitle:"resourceTitle",resourceTitleMarker:"resourceTitleMarker",resourceTitleString:"resourceTitleString",setextHeading:"setextHeading",setextHeadingText:"setextHeadingText",setextHeadingLine:"setextHeadingLine",setextHeadingLineSequence:"setextHeadingLineSequence",strong:"strong",strongSequence:"strongSequence",strongText:"strongText",thematicBreak:"thematicBreak",thematicBreakSequence:"thematicBreakSequence",blockQuote:"blockQuote",blockQuotePrefix:"blockQuotePrefix",blockQuoteMarker:"blockQuoteMarker",blockQuotePrefixWhitespace:"blockQuotePrefixWhitespace",listOrdered:"listOrdered",listUnordered:"listUnordered",listItemIndent:"listItemIndent",listItemMarker:"listItemMarker",listItemPrefix:"listItemPrefix",listItemPrefixWhitespace:"listItemPrefixWhitespace",listItemValue:"listItemValue",chunkContent:"chunkContent",chunkFlow:"chunkFlow",chunkText:"chunkText",chunkString:"chunkString"},Ba={ht:"	",lf:`
`,cr:"\r",space:" ",replacementCharacter:"�"};function Ns(n,e,t,i){const r=n.length;let s=0,a;if(e<0?e=-e>r?0:r+e:e=e>r?r:e,t=t>0?t:0,i.length<qe.v8MaxSafeChunkSize)a=Array.from(i),a.unshift(e,t),n.splice(...a);else for(t&&n.splice(e,t);s<i.length;)a=i.slice(s,s+qe.v8MaxSafeChunkSize),a.unshift(e,0),n.splice(...a),s+=qe.v8MaxSafeChunkSize,e+=qe.v8MaxSafeChunkSize}function Xs(n,e){return n.length>0?(Ns(n,n.length,0,e),n):e}const EI={}.hasOwnProperty;function KF(n){const e={};let t=-1;for(;++t<n.length;)kee(e,n[t]);return e}function kee(n,e){let t;for(t in e){const r=(EI.call(n,t)?n[t]:void 0)||(n[t]={}),s=e[t];let a;if(s)for(a in s){EI.call(r,a)||(r[a]=[]);const o=s[a];Dee(r[a],Array.isArray(o)?o:o?[o]:[])}}}function Dee(n,e){let t=-1;const i=[];for(;++t<e.length;)(e[t].add==="after"?n:i).push(e[t]);Ns(n,0,0,i)}function QF(n,e){const t=Number.parseInt(n,e);return t<I.ht||t===I.vt||t>I.cr&&t<I.space||t>I.tilde&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?Ba.replacementCharacter:String.fromCodePoint(t)}function Ca(n){return n.replace(/[\t\n\r ]+/g,Ba.space).replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Tr=lu(/[A-Za-z]/),mr=lu(/[\dA-Za-z]/),See=lu(/[#-'*+\--9=?A-Z^-~]/);function dx(n){return n!==null&&(n<I.space||n===I.del)}const KS=lu(/\d/),Eee=lu(/[\dA-Fa-f]/),Nee=lu(/[!-/:-@[-`{-~]/);function st(n){return n!==null&&n<I.horizontalTab}function Nn(n){return n!==null&&(n<I.nul||n===I.space)}function Ht(n){return n===I.horizontalTab||n===I.virtualSpace||n===I.space}const lw=lu(new RegExp("\\p{P}|\\p{S}","u")),ah=lu(/\s/);function lu(n){return e;function e(t){return t!==null&&t>-1&&n.test(String.fromCharCode(t))}}function rm(n){const e=[];let t=-1,i=0,r=0;for(;++t<n.length;){const s=n.charCodeAt(t);let a="";if(s===I.percentSign&&mr(n.charCodeAt(t+1))&&mr(n.charCodeAt(t+2)))r=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(a=String.fromCharCode(s));else if(s>55295&&s<57344){const o=n.charCodeAt(t+1);s<56320&&o>56319&&o<57344?(a=String.fromCharCode(s,o),r=1):a=Ba.replacementCharacter}else a=String.fromCharCode(s);a&&(e.push(n.slice(i,t),encodeURIComponent(a)),i=t+r+1,a=""),r&&(t+=r,r=0)}return e.join("")+n.slice(i)}function en(n,e,t,i){const r=i?i-1:Number.POSITIVE_INFINITY;let s=0;return a;function a(l){return Ht(l)?(n.enter(t),o(l)):e(l)}function o(l){return Ht(l)&&s++<r?(n.consume(l),o):(n.exit(t),e(l))}}const _ee={tokenize:Cee};function Cee(n){const e=n.attempt(this.parser.constructs.contentInitial,i,r);let t;return e;function i(o){if(te(o===I.eof||st(o),"expected eol or eof"),o===I.eof){n.consume(o);return}return n.enter(F.lineEnding),n.consume(o),n.exit(F.lineEnding),en(n,e,F.linePrefix)}function r(o){return te(o!==I.eof&&!st(o),"expected anything other than a line ending or EOF"),n.enter(F.paragraph),s(o)}function s(o){const l=n.enter(F.chunkText,{contentType:qe.contentTypeText,previous:t});return t&&(t.next=l),t=l,a(o)}function a(o){if(o===I.eof){n.exit(F.chunkText),n.exit(F.paragraph),n.consume(o);return}return st(o)?(n.consume(o),n.exit(F.chunkText),s):(n.consume(o),a)}}const Aee={tokenize:Pee},NI={tokenize:Tee};function Pee(n){const e=this,t=[];let i=0,r,s,a;return o;function o(E){if(i<t.length){const P=t[i];return e.containerState=P[1],te(P[0].continuation,"expected `continuation` to be defined on container construct"),n.attempt(P[0].continuation,l,c)(E)}return c(E)}function l(E){if(te(e.containerState,"expected `containerState` to be defined after continuation"),i++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,r&&S();const P=e.events.length;let A=P,N;for(;A--;)if(e.events[A][0]==="exit"&&e.events[A][1].type===F.chunkFlow){N=e.events[A][1].end;break}te(N,"could not find previous flow chunk"),k(i);let R=P;for(;R<e.events.length;)e.events[R][1].end={...N},R++;return Ns(e.events,A+1,0,e.events.slice(P)),e.events.length=R,c(E)}return o(E)}function c(E){if(i===t.length){if(!r)return m(E);if(r.currentConstruct&&r.currentConstruct.concrete)return y(E);e.interrupt=!!(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return e.containerState={},n.check(NI,u,p)(E)}function u(E){return r&&S(),k(i),m(E)}function p(E){return e.parser.lazy[e.now().line]=i!==t.length,a=e.now().offset,y(E)}function m(E){return e.containerState={},n.attempt(NI,g,y)(E)}function g(E){return te(e.currentConstruct,"expected `currentConstruct` to be defined on tokenizer"),te(e.containerState,"expected `containerState` to be defined on tokenizer"),i++,t.push([e.currentConstruct,e.containerState]),m(E)}function y(E){if(E===I.eof){r&&S(),k(0),n.consume(E);return}return r=r||e.parser.flow(e.now()),n.enter(F.chunkFlow,{_tokenizer:r,contentType:qe.contentTypeFlow,previous:s}),v(E)}function v(E){if(E===I.eof){w(n.exit(F.chunkFlow),!0),k(0),n.consume(E);return}return st(E)?(n.consume(E),w(n.exit(F.chunkFlow)),i=0,e.interrupt=void 0,o):(n.consume(E),v)}function w(E,P){te(r,"expected `childFlow` to be defined when continuing");const A=e.sliceStream(E);if(P&&A.push(null),E.previous=s,s&&(s.next=E),s=E,r.defineSkip(E.start),r.write(A),e.parser.lazy[E.start.line]){let N=r.events.length;for(;N--;)if(r.events[N][1].start.offset<a&&(!r.events[N][1].end||r.events[N][1].end.offset>a))return;const R=e.events.length;let V=R,B,L;for(;V--;)if(e.events[V][0]==="exit"&&e.events[V][1].type===F.chunkFlow){if(B){L=e.events[V][1].end;break}B=!0}for(te(L,"could not find previous flow chunk"),k(i),N=R;N<e.events.length;)e.events[N][1].end={...L},N++;Ns(e.events,V+1,0,e.events.slice(R)),e.events.length=N}}function k(E){let P=t.length;for(;P-- >E;){const A=t[P];e.containerState=A[1],te(A[0].exit,"expected `exit` to be defined on container construct"),A[0].exit.call(e,n)}t.length=E}function S(){te(e.containerState,"expected `containerState` to be defined when closing flow"),te(r,"expected `childFlow` to be defined when closing it"),r.write([I.eof]),s=void 0,r=void 0,e.containerState._closeFlow=void 0}}function Tee(n,e,t){return te(this.parser.constructs.disable.null,"expected `disable.null` to be populated"),en(n,n.attempt(this.parser.constructs.document,e,t),F.linePrefix,this.parser.constructs.disable.null.includes("codeIndented")?void 0:qe.tabSize)}function Qf(n){if(n===I.eof||Nn(n)||ah(n))return qe.characterGroupWhitespace;if(lw(n))return qe.characterGroupPunctuation}function cw(n,e,t){const i=[];let r=-1;for(;++r<n.length;){const s=n[r].resolveAll;s&&!i.includes(s)&&(e=s(e,t),i.push(s))}return e}const QS={name:"attention",resolveAll:Iee,tokenize:Ree};function Iee(n,e){let t=-1,i,r,s,a,o,l,c,u;for(;++t<n.length;)if(n[t][0]==="enter"&&n[t][1].type==="attentionSequence"&&n[t][1]._close){for(i=t;i--;)if(n[i][0]==="exit"&&n[i][1].type==="attentionSequence"&&n[i][1]._open&&e.sliceSerialize(n[i][1]).charCodeAt(0)===e.sliceSerialize(n[t][1]).charCodeAt(0)){if((n[i][1]._close||n[t][1]._open)&&(n[t][1].end.offset-n[t][1].start.offset)%3&&!((n[i][1].end.offset-n[i][1].start.offset+n[t][1].end.offset-n[t][1].start.offset)%3))continue;l=n[i][1].end.offset-n[i][1].start.offset>1&&n[t][1].end.offset-n[t][1].start.offset>1?2:1;const p={...n[i][1].end},m={...n[t][1].start};_I(p,-l),_I(m,l),a={type:l>1?F.strongSequence:F.emphasisSequence,start:p,end:{...n[i][1].end}},o={type:l>1?F.strongSequence:F.emphasisSequence,start:{...n[t][1].start},end:m},s={type:l>1?F.strongText:F.emphasisText,start:{...n[i][1].end},end:{...n[t][1].start}},r={type:l>1?F.strong:F.emphasis,start:{...a.start},end:{...o.end}},n[i][1].end={...a.start},n[t][1].start={...o.end},c=[],n[i][1].end.offset-n[i][1].start.offset&&(c=Xs(c,[["enter",n[i][1],e],["exit",n[i][1],e]])),c=Xs(c,[["enter",r,e],["enter",a,e],["exit",a,e],["enter",s,e]]),te(e.parser.constructs.insideSpan.null,"expected `insideSpan` to be populated"),c=Xs(c,cw(e.parser.constructs.insideSpan.null,n.slice(i+1,t),e)),c=Xs(c,[["exit",s,e],["enter",o,e],["exit",o,e],["exit",r,e]]),n[t][1].end.offset-n[t][1].start.offset?(u=2,c=Xs(c,[["enter",n[t][1],e],["exit",n[t][1],e]])):u=0,Ns(n,i-1,t-i+3,c),t=i+c.length-u-2;break}}for(t=-1;++t<n.length;)n[t][1].type==="attentionSequence"&&(n[t][1].type="data");return n}function Ree(n,e){const t=this.parser.constructs.attentionMarkers.null,i=this.previous,r=Qf(i);let s;return a;function a(l){return te(l===I.asterisk||l===I.underscore,"expected asterisk or underscore"),s=l,n.enter("attentionSequence"),o(l)}function o(l){if(l===s)return n.consume(l),o;const c=n.exit("attentionSequence"),u=Qf(l);te(t,"expected `attentionMarkers` to be populated");const p=!u||u===qe.characterGroupPunctuation&&r||t.includes(l),m=!r||r===qe.characterGroupPunctuation&&u||t.includes(i);return c._open=!!(s===I.asterisk?p:p&&(r||!m)),c._close=!!(s===I.asterisk?m:m&&(u||!p)),e(l)}}function _I(n,e){n.column+=e,n.offset+=e,n._bufferIndex+=e}const Mee={name:"autolink",tokenize:jee};function jee(n,e,t){let i=0;return r;function r(g){return te(g===I.lessThan,"expected `<`"),n.enter(F.autolink),n.enter(F.autolinkMarker),n.consume(g),n.exit(F.autolinkMarker),n.enter(F.autolinkProtocol),s}function s(g){return Tr(g)?(n.consume(g),a):g===I.atSign?t(g):c(g)}function a(g){return g===I.plusSign||g===I.dash||g===I.dot||mr(g)?(i=1,o(g)):c(g)}function o(g){return g===I.colon?(n.consume(g),i=0,l):(g===I.plusSign||g===I.dash||g===I.dot||mr(g))&&i++<qe.autolinkSchemeSizeMax?(n.consume(g),o):(i=0,c(g))}function l(g){return g===I.greaterThan?(n.exit(F.autolinkProtocol),n.enter(F.autolinkMarker),n.consume(g),n.exit(F.autolinkMarker),n.exit(F.autolink),e):g===I.eof||g===I.space||g===I.lessThan||dx(g)?t(g):(n.consume(g),l)}function c(g){return g===I.atSign?(n.consume(g),u):See(g)?(n.consume(g),c):t(g)}function u(g){return mr(g)?p(g):t(g)}function p(g){return g===I.dot?(n.consume(g),i=0,u):g===I.greaterThan?(n.exit(F.autolinkProtocol).type=F.autolinkEmail,n.enter(F.autolinkMarker),n.consume(g),n.exit(F.autolinkMarker),n.exit(F.autolink),e):m(g)}function m(g){if((g===I.dash||mr(g))&&i++<qe.autolinkDomainSizeMax){const y=g===I.dash?m:p;return n.consume(g),y}return t(g)}}const Iy={partial:!0,tokenize:Oee};function Oee(n,e,t){return i;function i(s){return Ht(s)?en(n,r,F.linePrefix)(s):r(s)}function r(s){return s===I.eof||st(s)?e(s):t(s)}}const JF={continuation:{tokenize:Fee},exit:Vee,name:"blockQuote",tokenize:Lee};function Lee(n,e,t){const i=this;return r;function r(a){if(a===I.greaterThan){const o=i.containerState;return te(o,"expected `containerState` to be defined in container"),o.open||(n.enter(F.blockQuote,{_container:!0}),o.open=!0),n.enter(F.blockQuotePrefix),n.enter(F.blockQuoteMarker),n.consume(a),n.exit(F.blockQuoteMarker),s}return t(a)}function s(a){return Ht(a)?(n.enter(F.blockQuotePrefixWhitespace),n.consume(a),n.exit(F.blockQuotePrefixWhitespace),n.exit(F.blockQuotePrefix),e):(n.exit(F.blockQuotePrefix),e(a))}}function Fee(n,e,t){const i=this;return r;function r(a){return Ht(a)?(te(i.parser.constructs.disable.null,"expected `disable.null` to be populated"),en(n,s,F.linePrefix,i.parser.constructs.disable.null.includes("codeIndented")?void 0:qe.tabSize)(a)):s(a)}function s(a){return n.attempt(JF,e,t)(a)}}function Vee(n){n.exit(F.blockQuote)}const ZF={name:"characterEscape",tokenize:Uee};function Uee(n,e,t){return i;function i(s){return te(s===I.backslash,"expected `\\`"),n.enter(F.characterEscape),n.enter(F.escapeMarker),n.consume(s),n.exit(F.escapeMarker),r}function r(s){return Nee(s)?(n.enter(F.characterEscapeValue),n.consume(s),n.exit(F.characterEscapeValue),n.exit(F.characterEscape),e):t(s)}}const e2={name:"characterReference",tokenize:zee};function zee(n,e,t){const i=this;let r=0,s,a;return o;function o(p){return te(p===I.ampersand,"expected `&`"),n.enter(F.characterReference),n.enter(F.characterReferenceMarker),n.consume(p),n.exit(F.characterReferenceMarker),l}function l(p){return p===I.numberSign?(n.enter(F.characterReferenceMarkerNumeric),n.consume(p),n.exit(F.characterReferenceMarkerNumeric),c):(n.enter(F.characterReferenceValue),s=qe.characterReferenceNamedSizeMax,a=mr,u(p))}function c(p){return p===I.uppercaseX||p===I.lowercaseX?(n.enter(F.characterReferenceMarkerHexadecimal),n.consume(p),n.exit(F.characterReferenceMarkerHexadecimal),n.enter(F.characterReferenceValue),s=qe.characterReferenceHexadecimalSizeMax,a=Eee,u):(n.enter(F.characterReferenceValue),s=qe.characterReferenceDecimalSizeMax,a=KS,u(p))}function u(p){if(p===I.semicolon&&r){const m=n.exit(F.characterReferenceValue);return a===mr&&!vN(i.sliceSerialize(m))?t(p):(n.enter(F.characterReferenceMarker),n.consume(p),n.exit(F.characterReferenceMarker),n.exit(F.characterReference),e)}return a(p)&&r++<s?(n.consume(p),u):t(p)}}const CI={partial:!0,tokenize:$ee},AI={concrete:!0,name:"codeFenced",tokenize:Bee};function Bee(n,e,t){const i=this,r={partial:!0,tokenize:A};let s=0,a=0,o;return l;function l(N){return c(N)}function c(N){te(N===I.graveAccent||N===I.tilde,"expected `` ` `` or `~`");const R=i.events[i.events.length-1];return s=R&&R[1].type===F.linePrefix?R[2].sliceSerialize(R[1],!0).length:0,o=N,n.enter(F.codeFenced),n.enter(F.codeFencedFence),n.enter(F.codeFencedFenceSequence),u(N)}function u(N){return N===o?(a++,n.consume(N),u):a<qe.codeFencedSequenceSizeMin?t(N):(n.exit(F.codeFencedFenceSequence),Ht(N)?en(n,p,F.whitespace)(N):p(N))}function p(N){return N===I.eof||st(N)?(n.exit(F.codeFencedFence),i.interrupt?e(N):n.check(CI,v,P)(N)):(n.enter(F.codeFencedFenceInfo),n.enter(F.chunkString,{contentType:qe.contentTypeString}),m(N))}function m(N){return N===I.eof||st(N)?(n.exit(F.chunkString),n.exit(F.codeFencedFenceInfo),p(N)):Ht(N)?(n.exit(F.chunkString),n.exit(F.codeFencedFenceInfo),en(n,g,F.whitespace)(N)):N===I.graveAccent&&N===o?t(N):(n.consume(N),m)}function g(N){return N===I.eof||st(N)?p(N):(n.enter(F.codeFencedFenceMeta),n.enter(F.chunkString,{contentType:qe.contentTypeString}),y(N))}function y(N){return N===I.eof||st(N)?(n.exit(F.chunkString),n.exit(F.codeFencedFenceMeta),p(N)):N===I.graveAccent&&N===o?t(N):(n.consume(N),y)}function v(N){return te(st(N),"expected eol"),n.attempt(r,P,w)(N)}function w(N){return te(st(N),"expected eol"),n.enter(F.lineEnding),n.consume(N),n.exit(F.lineEnding),k}function k(N){return s>0&&Ht(N)?en(n,S,F.linePrefix,s+1)(N):S(N)}function S(N){return N===I.eof||st(N)?n.check(CI,v,P)(N):(n.enter(F.codeFlowValue),E(N))}function E(N){return N===I.eof||st(N)?(n.exit(F.codeFlowValue),S(N)):(n.consume(N),E)}function P(N){return n.exit(F.codeFenced),e(N)}function A(N,R,V){let B=0;return L;function L(K){return te(st(K),"expected eol"),N.enter(F.lineEnding),N.consume(K),N.exit(F.lineEnding),W}function W(K){return te(i.parser.constructs.disable.null,"expected `disable.null` to be populated"),N.enter(F.codeFencedFence),Ht(K)?en(N,q,F.linePrefix,i.parser.constructs.disable.null.includes("codeIndented")?void 0:qe.tabSize)(K):q(K)}function q(K){return K===o?(N.enter(F.codeFencedFenceSequence),X(K)):V(K)}function X(K){return K===o?(B++,N.consume(K),X):B>=a?(N.exit(F.codeFencedFenceSequence),Ht(K)?en(N,G,F.whitespace)(K):G(K)):V(K)}function G(K){return K===I.eof||st(K)?(N.exit(F.codeFencedFence),R(K)):V(K)}}}function $ee(n,e,t){const i=this;return r;function r(a){return a===I.eof?t(a):(te(st(a),"expected eol"),n.enter(F.lineEnding),n.consume(a),n.exit(F.lineEnding),s)}function s(a){return i.parser.lazy[i.now().line]?t(a):e(a)}}const u1={name:"codeIndented",tokenize:Hee},Wee={partial:!0,tokenize:qee};function Hee(n,e,t){const i=this;return r;function r(c){return te(Ht(c)),n.enter(F.codeIndented),en(n,s,F.linePrefix,qe.tabSize+1)(c)}function s(c){const u=i.events[i.events.length-1];return u&&u[1].type===F.linePrefix&&u[2].sliceSerialize(u[1],!0).length>=qe.tabSize?a(c):t(c)}function a(c){return c===I.eof?l(c):st(c)?n.attempt(Wee,a,l)(c):(n.enter(F.codeFlowValue),o(c))}function o(c){return c===I.eof||st(c)?(n.exit(F.codeFlowValue),a(c)):(n.consume(c),o)}function l(c){return n.exit(F.codeIndented),e(c)}}function qee(n,e,t){const i=this;return r;function r(a){return i.parser.lazy[i.now().line]?t(a):st(a)?(n.enter(F.lineEnding),n.consume(a),n.exit(F.lineEnding),r):en(n,s,F.linePrefix,qe.tabSize+1)(a)}function s(a){const o=i.events[i.events.length-1];return o&&o[1].type===F.linePrefix&&o[2].sliceSerialize(o[1],!0).length>=qe.tabSize?e(a):st(a)?r(a):t(a)}}const Gee={name:"codeText",previous:t2,resolve:Yee,tokenize:Xee};function Yee(n){let e=n.length-4,t=3,i,r;if((n[t][1].type===F.lineEnding||n[t][1].type==="space")&&(n[e][1].type===F.lineEnding||n[e][1].type==="space")){for(i=t;++i<e;)if(n[i][1].type===F.codeTextData){n[t][1].type=F.codeTextPadding,n[e][1].type=F.codeTextPadding,t+=2,e-=2;break}}for(i=t-1,e++;++i<=e;)r===void 0?i!==e&&n[i][1].type!==F.lineEnding&&(r=i):(i===e||n[i][1].type===F.lineEnding)&&(n[r][1].type=F.codeTextData,i!==r+2&&(n[r][1].end=n[i-1][1].end,n.splice(r+2,i-r-2),e-=i-r-2,i=r+2),r=void 0);return n}function t2(n){return n!==I.graveAccent||this.events[this.events.length-1][1].type===F.characterEscape}function Xee(n,e,t){const i=this;let r=0,s,a;return o;function o(m){return te(m===I.graveAccent,"expected `` ` ``"),te(t2.call(i,i.previous),"expected correct previous"),n.enter(F.codeText),n.enter(F.codeTextSequence),l(m)}function l(m){return m===I.graveAccent?(n.consume(m),r++,l):(n.exit(F.codeTextSequence),c(m))}function c(m){return m===I.eof?t(m):m===I.space?(n.enter("space"),n.consume(m),n.exit("space"),c):m===I.graveAccent?(a=n.enter(F.codeTextSequence),s=0,p(m)):st(m)?(n.enter(F.lineEnding),n.consume(m),n.exit(F.lineEnding),c):(n.enter(F.codeTextData),u(m))}function u(m){return m===I.eof||m===I.space||m===I.graveAccent||st(m)?(n.exit(F.codeTextData),c(m)):(n.consume(m),u)}function p(m){return m===I.graveAccent?(n.consume(m),s++,p):s===r?(n.exit(F.codeTextSequence),n.exit(F.codeText),e(m)):(a.type=F.codeTextData,u(m))}}class Kee{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){const i=t??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(e,i):e>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(e,t,i){const r=t||0;this.setCursor(Math.trunc(e));const s=this.right.splice(this.right.length-r,Number.POSITIVE_INFINITY);return i&&Vm(this.left,i),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),Vm(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),Vm(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const t=this.left.splice(e,Number.POSITIVE_INFINITY);Vm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);Vm(this.left,t.reverse())}}}function Vm(n,e){let t=0;if(e.length<qe.v8MaxSafeChunkSize)n.push(...e);else for(;t<e.length;)n.push(...e.slice(t,t+qe.v8MaxSafeChunkSize)),t+=qe.v8MaxSafeChunkSize}function n2(n){const e={};let t=-1,i,r,s,a,o,l,c;const u=new Kee(n);for(;++t<u.length;){for(;t in e;)t=e[t];if(i=u.get(t),t&&i[1].type===F.chunkFlow&&u.get(t-1)[1].type===F.listItemPrefix&&(te(i[1]._tokenizer,"expected `_tokenizer` on subtokens"),l=i[1]._tokenizer.events,s=0,s<l.length&&l[s][1].type===F.lineEndingBlank&&(s+=2),s<l.length&&l[s][1].type===F.content))for(;++s<l.length&&l[s][1].type!==F.content;)l[s][1].type===F.chunkText&&(l[s][1]._isInFirstContentOfListItem=!0,s++);if(i[0]==="enter")i[1].contentType&&(Object.assign(e,Qee(u,t)),t=e[t],c=!0);else if(i[1]._container){for(s=t,r=void 0;s--;)if(a=u.get(s),a[1].type===F.lineEnding||a[1].type===F.lineEndingBlank)a[0]==="enter"&&(r&&(u.get(r)[1].type=F.lineEndingBlank),a[1].type=F.lineEnding,r=s);else if(!(a[1].type===F.linePrefix||a[1].type===F.listItemIndent))break;r&&(i[1].end={...u.get(r)[1].start},o=u.slice(r,t),o.unshift(i),u.splice(r,t-r+1,o))}}return Ns(n,0,Number.POSITIVE_INFINITY,u.slice(0)),!c}function Qee(n,e){const t=n.get(e)[1],i=n.get(e)[2];let r=e-1;const s=[];te(t.contentType,"expected `contentType` on subtokens");let a=t._tokenizer;a||(a=i.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const o=a.events,l=[],c={};let u,p,m=-1,g=t,y=0,v=0;const w=[v];for(;g;){for(;n.get(++r)[1]!==g;);te(!p||g.previous===p,"expected previous to match"),te(!p||p.next===g,"expected next to match"),s.push(r),g._tokenizer||(u=i.sliceStream(g),g.next||u.push(I.eof),p&&a.defineSkip(g.start),g._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(u),g._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),p=g,g=g.next}for(g=t;++m<o.length;)o[m][0]==="exit"&&o[m-1][0]==="enter"&&o[m][1].type===o[m-1][1].type&&o[m][1].start.line!==o[m][1].end.line&&(te(g,"expected a current token"),v=m+1,w.push(v),g._tokenizer=void 0,g.previous=void 0,g=g.next);for(a.events=[],g?(g._tokenizer=void 0,g.previous=void 0,te(!g.next,"expected no next token")):w.pop(),m=w.length;m--;){const k=o.slice(w[m],w[m+1]),S=s.pop();te(S!==void 0,"expected a start position when splicing"),l.push([S,S+k.length-1]),n.splice(S,2,k)}for(l.reverse(),m=-1;++m<l.length;)c[y+l[m][0]]=y+l[m][1],y+=l[m][1]-l[m][0]-1;return c}const Jee={resolve:ete,tokenize:tte},Zee={partial:!0,tokenize:nte};function ete(n){return n2(n),n}function tte(n,e){let t;return i;function i(o){return te(o!==I.eof&&!st(o),"expected no eof or eol"),n.enter(F.content),t=n.enter(F.chunkContent,{contentType:qe.contentTypeContent}),r(o)}function r(o){return o===I.eof?s(o):st(o)?n.check(Zee,a,s)(o):(n.consume(o),r)}function s(o){return n.exit(F.chunkContent),n.exit(F.content),e(o)}function a(o){return te(st(o),"expected eol"),n.consume(o),n.exit(F.chunkContent),te(t,"expected previous token"),t.next=n.enter(F.chunkContent,{contentType:qe.contentTypeContent,previous:t}),t=t.next,r}}function nte(n,e,t){const i=this;return r;function r(a){return te(st(a),"expected a line ending"),n.exit(F.chunkContent),n.enter(F.lineEnding),n.consume(a),n.exit(F.lineEnding),en(n,s,F.linePrefix)}function s(a){if(a===I.eof||st(a))return t(a);te(i.parser.constructs.disable.null,"expected `disable.null` to be populated");const o=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type===F.linePrefix&&o[2].sliceSerialize(o[1],!0).length>=qe.tabSize?e(a):n.interrupt(i.parser.constructs.flow,t,e)(a)}}function i2(n,e,t,i,r,s,a,o,l){const c=l||Number.POSITIVE_INFINITY;let u=0;return p;function p(k){return k===I.lessThan?(n.enter(i),n.enter(r),n.enter(s),n.consume(k),n.exit(s),m):k===I.eof||k===I.space||k===I.rightParenthesis||dx(k)?t(k):(n.enter(i),n.enter(a),n.enter(o),n.enter(F.chunkString,{contentType:qe.contentTypeString}),v(k))}function m(k){return k===I.greaterThan?(n.enter(s),n.consume(k),n.exit(s),n.exit(r),n.exit(i),e):(n.enter(o),n.enter(F.chunkString,{contentType:qe.contentTypeString}),g(k))}function g(k){return k===I.greaterThan?(n.exit(F.chunkString),n.exit(o),m(k)):k===I.eof||k===I.lessThan||st(k)?t(k):(n.consume(k),k===I.backslash?y:g)}function y(k){return k===I.lessThan||k===I.greaterThan||k===I.backslash?(n.consume(k),g):g(k)}function v(k){return!u&&(k===I.eof||k===I.rightParenthesis||Nn(k))?(n.exit(F.chunkString),n.exit(o),n.exit(a),n.exit(i),e(k)):u<c&&k===I.leftParenthesis?(n.consume(k),u++,v):k===I.rightParenthesis?(n.consume(k),u--,v):k===I.eof||k===I.space||k===I.leftParenthesis||dx(k)?t(k):(n.consume(k),k===I.backslash?w:v)}function w(k){return k===I.leftParenthesis||k===I.rightParenthesis||k===I.backslash?(n.consume(k),v):v(k)}}function r2(n,e,t,i,r,s){const a=this;let o=0,l;return c;function c(g){return te(g===I.leftSquareBracket,"expected `[`"),n.enter(i),n.enter(r),n.consume(g),n.exit(r),n.enter(s),u}function u(g){return o>qe.linkReferenceSizeMax||g===I.eof||g===I.leftSquareBracket||g===I.rightSquareBracket&&!l||g===I.caret&&!o&&"_hiddenFootnoteSupport"in a.parser.constructs?t(g):g===I.rightSquareBracket?(n.exit(s),n.enter(r),n.consume(g),n.exit(r),n.exit(i),e):st(g)?(n.enter(F.lineEnding),n.consume(g),n.exit(F.lineEnding),u):(n.enter(F.chunkString,{contentType:qe.contentTypeString}),p(g))}function p(g){return g===I.eof||g===I.leftSquareBracket||g===I.rightSquareBracket||st(g)||o++>qe.linkReferenceSizeMax?(n.exit(F.chunkString),u(g)):(n.consume(g),l||(l=!Ht(g)),g===I.backslash?m:p)}function m(g){return g===I.leftSquareBracket||g===I.backslash||g===I.rightSquareBracket?(n.consume(g),o++,p):p(g)}}function s2(n,e,t,i,r,s){let a;return o;function o(m){return m===I.quotationMark||m===I.apostrophe||m===I.leftParenthesis?(n.enter(i),n.enter(r),n.consume(m),n.exit(r),a=m===I.leftParenthesis?I.rightParenthesis:m,l):t(m)}function l(m){return m===a?(n.enter(r),n.consume(m),n.exit(r),n.exit(i),e):(n.enter(s),c(m))}function c(m){return m===a?(n.exit(s),l(a)):m===I.eof?t(m):st(m)?(n.enter(F.lineEnding),n.consume(m),n.exit(F.lineEnding),en(n,c,F.linePrefix)):(n.enter(F.chunkString,{contentType:qe.contentTypeString}),u(m))}function u(m){return m===a||m===I.eof||st(m)?(n.exit(F.chunkString),c(m)):(n.consume(m),m===I.backslash?p:u)}function p(m){return m===a||m===I.backslash?(n.consume(m),u):u(m)}}function yg(n,e){let t;return i;function i(r){return st(r)?(n.enter(F.lineEnding),n.consume(r),n.exit(F.lineEnding),t=!0,i):Ht(r)?en(n,i,t?F.linePrefix:F.lineSuffix)(r):e(r)}}const ite={name:"definition",tokenize:ste},rte={partial:!0,tokenize:ate};function ste(n,e,t){const i=this;let r;return s;function s(g){return n.enter(F.definition),a(g)}function a(g){return te(g===I.leftSquareBracket,"expected `[`"),r2.call(i,n,o,t,F.definitionLabel,F.definitionLabelMarker,F.definitionLabelString)(g)}function o(g){return r=Ca(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),g===I.colon?(n.enter(F.definitionMarker),n.consume(g),n.exit(F.definitionMarker),l):t(g)}function l(g){return Nn(g)?yg(n,c)(g):c(g)}function c(g){return i2(n,u,t,F.definitionDestination,F.definitionDestinationLiteral,F.definitionDestinationLiteralMarker,F.definitionDestinationRaw,F.definitionDestinationString)(g)}function u(g){return n.attempt(rte,p,p)(g)}function p(g){return Ht(g)?en(n,m,F.whitespace)(g):m(g)}function m(g){return g===I.eof||st(g)?(n.exit(F.definition),i.parser.defined.push(r),e(g)):t(g)}}function ate(n,e,t){return i;function i(o){return Nn(o)?yg(n,r)(o):t(o)}function r(o){return s2(n,s,t,F.definitionTitle,F.definitionTitleMarker,F.definitionTitleString)(o)}function s(o){return Ht(o)?en(n,a,F.whitespace)(o):a(o)}function a(o){return o===I.eof||st(o)?e(o):t(o)}}const ote={name:"hardBreakEscape",tokenize:lte};function lte(n,e,t){return i;function i(s){return te(s===I.backslash,"expected `\\`"),n.enter(F.hardBreakEscape),n.consume(s),r}function r(s){return st(s)?(n.exit(F.hardBreakEscape),e(s)):t(s)}}const cte={name:"headingAtx",resolve:ute,tokenize:dte};function ute(n,e){let t=n.length-2,i=3,r,s;return n[i][1].type===F.whitespace&&(i+=2),t-2>i&&n[t][1].type===F.whitespace&&(t-=2),n[t][1].type===F.atxHeadingSequence&&(i===t-1||t-4>i&&n[t-2][1].type===F.whitespace)&&(t-=i+1===t?2:4),t>i&&(r={type:F.atxHeadingText,start:n[i][1].start,end:n[t][1].end},s={type:F.chunkText,start:n[i][1].start,end:n[t][1].end,contentType:qe.contentTypeText},Ns(n,i,t-i+1,[["enter",r,e],["enter",s,e],["exit",s,e],["exit",r,e]])),n}function dte(n,e,t){let i=0;return r;function r(u){return n.enter(F.atxHeading),s(u)}function s(u){return te(u===I.numberSign,"expected `#`"),n.enter(F.atxHeadingSequence),a(u)}function a(u){return u===I.numberSign&&i++<qe.atxHeadingOpeningFenceSizeMax?(n.consume(u),a):u===I.eof||Nn(u)?(n.exit(F.atxHeadingSequence),o(u)):t(u)}function o(u){return u===I.numberSign?(n.enter(F.atxHeadingSequence),l(u)):u===I.eof||st(u)?(n.exit(F.atxHeading),e(u)):Ht(u)?en(n,o,F.whitespace)(u):(n.enter(F.atxHeadingText),c(u))}function l(u){return u===I.numberSign?(n.consume(u),l):(n.exit(F.atxHeadingSequence),o(u))}function c(u){return u===I.eof||u===I.numberSign||Nn(u)?(n.exit(F.atxHeadingText),o(u)):(n.consume(u),c)}}const hte=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],PI=["pre","script","style","textarea"],pte={concrete:!0,name:"htmlFlow",resolveTo:gte,tokenize:bte},fte={partial:!0,tokenize:vte},mte={partial:!0,tokenize:yte};function gte(n){let e=n.length;for(;e--&&!(n[e][0]==="enter"&&n[e][1].type===F.htmlFlow););return e>1&&n[e-2][1].type===F.linePrefix&&(n[e][1].start=n[e-2][1].start,n[e+1][1].start=n[e-2][1].start,n.splice(e-2,2)),n}function bte(n,e,t){const i=this;let r,s,a,o,l;return c;function c($){return u($)}function u($){return te($===I.lessThan,"expected `<`"),n.enter(F.htmlFlow),n.enter(F.htmlFlowData),n.consume($),p}function p($){return $===I.exclamationMark?(n.consume($),m):$===I.slash?(n.consume($),s=!0,v):$===I.questionMark?(n.consume($),r=qe.htmlInstruction,i.interrupt?e:U):Tr($)?(te($!==null),n.consume($),a=String.fromCharCode($),w):t($)}function m($){return $===I.dash?(n.consume($),r=qe.htmlComment,g):$===I.leftSquareBracket?(n.consume($),r=qe.htmlCdata,o=0,y):Tr($)?(n.consume($),r=qe.htmlDeclaration,i.interrupt?e:U):t($)}function g($){return $===I.dash?(n.consume($),i.interrupt?e:U):t($)}function y($){const Y=qe.cdataOpeningString;return $===Y.charCodeAt(o++)?(n.consume($),o===Y.length?i.interrupt?e:q:y):t($)}function v($){return Tr($)?(te($!==null),n.consume($),a=String.fromCharCode($),w):t($)}function w($){if($===I.eof||$===I.slash||$===I.greaterThan||Nn($)){const Y=$===I.slash,oe=a.toLowerCase();return!Y&&!s&&PI.includes(oe)?(r=qe.htmlRaw,i.interrupt?e($):q($)):hte.includes(a.toLowerCase())?(r=qe.htmlBasic,Y?(n.consume($),k):i.interrupt?e($):q($)):(r=qe.htmlComplete,i.interrupt&&!i.parser.lazy[i.now().line]?t($):s?S($):E($))}return $===I.dash||mr($)?(n.consume($),a+=String.fromCharCode($),w):t($)}function k($){return $===I.greaterThan?(n.consume($),i.interrupt?e:q):t($)}function S($){return Ht($)?(n.consume($),S):L($)}function E($){return $===I.slash?(n.consume($),L):$===I.colon||$===I.underscore||Tr($)?(n.consume($),P):Ht($)?(n.consume($),E):L($)}function P($){return $===I.dash||$===I.dot||$===I.colon||$===I.underscore||mr($)?(n.consume($),P):A($)}function A($){return $===I.equalsTo?(n.consume($),N):Ht($)?(n.consume($),A):E($)}function N($){return $===I.eof||$===I.lessThan||$===I.equalsTo||$===I.greaterThan||$===I.graveAccent?t($):$===I.quotationMark||$===I.apostrophe?(n.consume($),l=$,R):Ht($)?(n.consume($),N):V($)}function R($){return $===l?(n.consume($),l=null,B):$===I.eof||st($)?t($):(n.consume($),R)}function V($){return $===I.eof||$===I.quotationMark||$===I.apostrophe||$===I.slash||$===I.lessThan||$===I.equalsTo||$===I.greaterThan||$===I.graveAccent||Nn($)?A($):(n.consume($),V)}function B($){return $===I.slash||$===I.greaterThan||Ht($)?E($):t($)}function L($){return $===I.greaterThan?(n.consume($),W):t($)}function W($){return $===I.eof||st($)?q($):Ht($)?(n.consume($),W):t($)}function q($){return $===I.dash&&r===qe.htmlComment?(n.consume($),J):$===I.lessThan&&r===qe.htmlRaw?(n.consume($),ee):$===I.greaterThan&&r===qe.htmlDeclaration?(n.consume($),he):$===I.questionMark&&r===qe.htmlInstruction?(n.consume($),U):$===I.rightSquareBracket&&r===qe.htmlCdata?(n.consume($),ae):st($)&&(r===qe.htmlBasic||r===qe.htmlComplete)?(n.exit(F.htmlFlowData),n.check(fte,ie,X)($)):$===I.eof||st($)?(n.exit(F.htmlFlowData),X($)):(n.consume($),q)}function X($){return n.check(mte,G,ie)($)}function G($){return te(st($)),n.enter(F.lineEnding),n.consume($),n.exit(F.lineEnding),K}function K($){return $===I.eof||st($)?X($):(n.enter(F.htmlFlowData),q($))}function J($){return $===I.dash?(n.consume($),U):q($)}function ee($){return $===I.slash?(n.consume($),a="",fe):q($)}function fe($){if($===I.greaterThan){const Y=a.toLowerCase();return PI.includes(Y)?(n.consume($),he):q($)}return Tr($)&&a.length<qe.htmlRawSizeMax?(te($!==null),n.consume($),a+=String.fromCharCode($),fe):q($)}function ae($){return $===I.rightSquareBracket?(n.consume($),U):q($)}function U($){return $===I.greaterThan?(n.consume($),he):$===I.dash&&r===qe.htmlComment?(n.consume($),U):q($)}function he($){return $===I.eof||st($)?(n.exit(F.htmlFlowData),ie($)):(n.consume($),he)}function ie($){return n.exit(F.htmlFlow),e($)}}function yte(n,e,t){const i=this;return r;function r(a){return st(a)?(n.enter(F.lineEnding),n.consume(a),n.exit(F.lineEnding),s):t(a)}function s(a){return i.parser.lazy[i.now().line]?t(a):e(a)}}function vte(n,e,t){return i;function i(r){return te(st(r),"expected a line ending"),n.enter(F.lineEnding),n.consume(r),n.exit(F.lineEnding),n.attempt(Iy,e,t)}}const xte={name:"htmlText",tokenize:wte};function wte(n,e,t){const i=this;let r,s,a;return o;function o(U){return te(U===I.lessThan,"expected `<`"),n.enter(F.htmlText),n.enter(F.htmlTextData),n.consume(U),l}function l(U){return U===I.exclamationMark?(n.consume(U),c):U===I.slash?(n.consume(U),A):U===I.questionMark?(n.consume(U),E):Tr(U)?(n.consume(U),V):t(U)}function c(U){return U===I.dash?(n.consume(U),u):U===I.leftSquareBracket?(n.consume(U),s=0,y):Tr(U)?(n.consume(U),S):t(U)}function u(U){return U===I.dash?(n.consume(U),g):t(U)}function p(U){return U===I.eof?t(U):U===I.dash?(n.consume(U),m):st(U)?(a=p,ee(U)):(n.consume(U),p)}function m(U){return U===I.dash?(n.consume(U),g):p(U)}function g(U){return U===I.greaterThan?J(U):U===I.dash?m(U):p(U)}function y(U){const he=qe.cdataOpeningString;return U===he.charCodeAt(s++)?(n.consume(U),s===he.length?v:y):t(U)}function v(U){return U===I.eof?t(U):U===I.rightSquareBracket?(n.consume(U),w):st(U)?(a=v,ee(U)):(n.consume(U),v)}function w(U){return U===I.rightSquareBracket?(n.consume(U),k):v(U)}function k(U){return U===I.greaterThan?J(U):U===I.rightSquareBracket?(n.consume(U),k):v(U)}function S(U){return U===I.eof||U===I.greaterThan?J(U):st(U)?(a=S,ee(U)):(n.consume(U),S)}function E(U){return U===I.eof?t(U):U===I.questionMark?(n.consume(U),P):st(U)?(a=E,ee(U)):(n.consume(U),E)}function P(U){return U===I.greaterThan?J(U):E(U)}function A(U){return Tr(U)?(n.consume(U),N):t(U)}function N(U){return U===I.dash||mr(U)?(n.consume(U),N):R(U)}function R(U){return st(U)?(a=R,ee(U)):Ht(U)?(n.consume(U),R):J(U)}function V(U){return U===I.dash||mr(U)?(n.consume(U),V):U===I.slash||U===I.greaterThan||Nn(U)?B(U):t(U)}function B(U){return U===I.slash?(n.consume(U),J):U===I.colon||U===I.underscore||Tr(U)?(n.consume(U),L):st(U)?(a=B,ee(U)):Ht(U)?(n.consume(U),B):J(U)}function L(U){return U===I.dash||U===I.dot||U===I.colon||U===I.underscore||mr(U)?(n.consume(U),L):W(U)}function W(U){return U===I.equalsTo?(n.consume(U),q):st(U)?(a=W,ee(U)):Ht(U)?(n.consume(U),W):B(U)}function q(U){return U===I.eof||U===I.lessThan||U===I.equalsTo||U===I.greaterThan||U===I.graveAccent?t(U):U===I.quotationMark||U===I.apostrophe?(n.consume(U),r=U,X):st(U)?(a=q,ee(U)):Ht(U)?(n.consume(U),q):(n.consume(U),G)}function X(U){return U===r?(n.consume(U),r=void 0,K):U===I.eof?t(U):st(U)?(a=X,ee(U)):(n.consume(U),X)}function G(U){return U===I.eof||U===I.quotationMark||U===I.apostrophe||U===I.lessThan||U===I.equalsTo||U===I.graveAccent?t(U):U===I.slash||U===I.greaterThan||Nn(U)?B(U):(n.consume(U),G)}function K(U){return U===I.slash||U===I.greaterThan||Nn(U)?B(U):t(U)}function J(U){return U===I.greaterThan?(n.consume(U),n.exit(F.htmlTextData),n.exit(F.htmlText),e):t(U)}function ee(U){return te(a,"expected return state"),te(st(U),"expected eol"),n.exit(F.htmlTextData),n.enter(F.lineEnding),n.consume(U),n.exit(F.lineEnding),fe}function fe(U){return te(i.parser.constructs.disable.null,"expected `disable.null` to be populated"),Ht(U)?en(n,ae,F.linePrefix,i.parser.constructs.disable.null.includes("codeIndented")?void 0:qe.tabSize)(U):ae(U)}function ae(U){return n.enter(F.htmlTextData),a(U)}}const xN={name:"labelEnd",resolveAll:Ete,resolveTo:Nte,tokenize:_te},kte={tokenize:Cte},Dte={tokenize:Ate},Ste={tokenize:Pte};function Ete(n){let e=-1;const t=[];for(;++e<n.length;){const i=n[e][1];if(t.push(n[e]),i.type===F.labelImage||i.type===F.labelLink||i.type===F.labelEnd){const r=i.type===F.labelImage?4:2;i.type=F.data,e+=r}}return n.length!==t.length&&Ns(n,0,n.length,t),n}function Nte(n,e){let t=n.length,i=0,r,s,a,o;for(;t--;)if(r=n[t][1],s){if(r.type===F.link||r.type===F.labelLink&&r._inactive)break;n[t][0]==="enter"&&r.type===F.labelLink&&(r._inactive=!0)}else if(a){if(n[t][0]==="enter"&&(r.type===F.labelImage||r.type===F.labelLink)&&!r._balanced&&(s=t,r.type!==F.labelLink)){i=2;break}}else r.type===F.labelEnd&&(a=t);te(s!==void 0,"`open` is supposed to be found"),te(a!==void 0,"`close` is supposed to be found");const l={type:n[s][1].type===F.labelLink?F.link:F.image,start:{...n[s][1].start},end:{...n[n.length-1][1].end}},c={type:F.label,start:{...n[s][1].start},end:{...n[a][1].end}},u={type:F.labelText,start:{...n[s+i+2][1].end},end:{...n[a-2][1].start}};return o=[["enter",l,e],["enter",c,e]],o=Xs(o,n.slice(s+1,s+i+3)),o=Xs(o,[["enter",u,e]]),te(e.parser.constructs.insideSpan.null,"expected `insideSpan.null` to be populated"),o=Xs(o,cw(e.parser.constructs.insideSpan.null,n.slice(s+i+4,a-3),e)),o=Xs(o,[["exit",u,e],n[a-2],n[a-1],["exit",c,e]]),o=Xs(o,n.slice(a+1)),o=Xs(o,[["exit",l,e]]),Ns(n,s,n.length,o),n}function _te(n,e,t){const i=this;let r=i.events.length,s,a;for(;r--;)if((i.events[r][1].type===F.labelImage||i.events[r][1].type===F.labelLink)&&!i.events[r][1]._balanced){s=i.events[r][1];break}return o;function o(m){return te(m===I.rightSquareBracket,"expected `]`"),s?s._inactive?p(m):(a=i.parser.defined.includes(Ca(i.sliceSerialize({start:s.end,end:i.now()}))),n.enter(F.labelEnd),n.enter(F.labelMarker),n.consume(m),n.exit(F.labelMarker),n.exit(F.labelEnd),l):t(m)}function l(m){return m===I.leftParenthesis?n.attempt(kte,u,a?u:p)(m):m===I.leftSquareBracket?n.attempt(Dte,u,a?c:p)(m):a?u(m):p(m)}function c(m){return n.attempt(Ste,u,p)(m)}function u(m){return e(m)}function p(m){return s._balanced=!0,t(m)}}function Cte(n,e,t){return i;function i(p){return te(p===I.leftParenthesis,"expected left paren"),n.enter(F.resource),n.enter(F.resourceMarker),n.consume(p),n.exit(F.resourceMarker),r}function r(p){return Nn(p)?yg(n,s)(p):s(p)}function s(p){return p===I.rightParenthesis?u(p):i2(n,a,o,F.resourceDestination,F.resourceDestinationLiteral,F.resourceDestinationLiteralMarker,F.resourceDestinationRaw,F.resourceDestinationString,qe.linkResourceDestinationBalanceMax)(p)}function a(p){return Nn(p)?yg(n,l)(p):u(p)}function o(p){return t(p)}function l(p){return p===I.quotationMark||p===I.apostrophe||p===I.leftParenthesis?s2(n,c,t,F.resourceTitle,F.resourceTitleMarker,F.resourceTitleString)(p):u(p)}function c(p){return Nn(p)?yg(n,u)(p):u(p)}function u(p){return p===I.rightParenthesis?(n.enter(F.resourceMarker),n.consume(p),n.exit(F.resourceMarker),n.exit(F.resource),e):t(p)}}function Ate(n,e,t){const i=this;return r;function r(o){return te(o===I.leftSquareBracket,"expected left bracket"),r2.call(i,n,s,a,F.reference,F.referenceMarker,F.referenceString)(o)}function s(o){return i.parser.defined.includes(Ca(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?e(o):t(o)}function a(o){return t(o)}}function Pte(n,e,t){return i;function i(s){return te(s===I.leftSquareBracket,"expected left bracket"),n.enter(F.reference),n.enter(F.referenceMarker),n.consume(s),n.exit(F.referenceMarker),r}function r(s){return s===I.rightSquareBracket?(n.enter(F.referenceMarker),n.consume(s),n.exit(F.referenceMarker),n.exit(F.reference),e):t(s)}}const Tte={name:"labelStartImage",resolveAll:xN.resolveAll,tokenize:Ite};function Ite(n,e,t){const i=this;return r;function r(o){return te(o===I.exclamationMark,"expected `!`"),n.enter(F.labelImage),n.enter(F.labelImageMarker),n.consume(o),n.exit(F.labelImageMarker),s}function s(o){return o===I.leftSquareBracket?(n.enter(F.labelMarker),n.consume(o),n.exit(F.labelMarker),n.exit(F.labelImage),a):t(o)}function a(o){return o===I.caret&&"_hiddenFootnoteSupport"in i.parser.constructs?t(o):e(o)}}const Rte={name:"labelStartLink",resolveAll:xN.resolveAll,tokenize:Mte};function Mte(n,e,t){const i=this;return r;function r(a){return te(a===I.leftSquareBracket,"expected `[`"),n.enter(F.labelLink),n.enter(F.labelMarker),n.consume(a),n.exit(F.labelMarker),n.exit(F.labelLink),s}function s(a){return a===I.caret&&"_hiddenFootnoteSupport"in i.parser.constructs?t(a):e(a)}}const d1={name:"lineEnding",tokenize:jte};function jte(n,e){return t;function t(i){return te(st(i),"expected eol"),n.enter(F.lineEnding),n.consume(i),n.exit(F.lineEnding),en(n,e,F.linePrefix)}}const j0={name:"thematicBreak",tokenize:Ote};function Ote(n,e,t){let i=0,r;return s;function s(c){return n.enter(F.thematicBreak),a(c)}function a(c){return te(c===I.asterisk||c===I.dash||c===I.underscore,"expected `*`, `-`, or `_`"),r=c,o(c)}function o(c){return c===r?(n.enter(F.thematicBreakSequence),l(c)):i>=qe.thematicBreakMarkerCountMin&&(c===I.eof||st(c))?(n.exit(F.thematicBreak),e(c)):t(c)}function l(c){return c===r?(n.consume(c),i++,l):(n.exit(F.thematicBreakSequence),Ht(c)?en(n,o,F.whitespace)(c):o(c))}}const Vr={continuation:{tokenize:Ute},exit:Bte,name:"list",tokenize:Vte},Lte={partial:!0,tokenize:$te},Fte={partial:!0,tokenize:zte};function Vte(n,e,t){const i=this,r=i.events[i.events.length-1];let s=r&&r[1].type===F.linePrefix?r[2].sliceSerialize(r[1],!0).length:0,a=0;return o;function o(g){te(i.containerState,"expected state");const y=i.containerState.type||(g===I.asterisk||g===I.plusSign||g===I.dash?F.listUnordered:F.listOrdered);if(y===F.listUnordered?!i.containerState.marker||g===i.containerState.marker:KS(g)){if(i.containerState.type||(i.containerState.type=y,n.enter(y,{_container:!0})),y===F.listUnordered)return n.enter(F.listItemPrefix),g===I.asterisk||g===I.dash?n.check(j0,t,c)(g):c(g);if(!i.interrupt||g===I.digit1)return n.enter(F.listItemPrefix),n.enter(F.listItemValue),l(g)}return t(g)}function l(g){return te(i.containerState,"expected state"),KS(g)&&++a<qe.listItemValueSizeMax?(n.consume(g),l):(!i.interrupt||a<2)&&(i.containerState.marker?g===i.containerState.marker:g===I.rightParenthesis||g===I.dot)?(n.exit(F.listItemValue),c(g)):t(g)}function c(g){return te(i.containerState,"expected state"),te(g!==I.eof,"eof (`null`) is not a marker"),n.enter(F.listItemMarker),n.consume(g),n.exit(F.listItemMarker),i.containerState.marker=i.containerState.marker||g,n.check(Iy,i.interrupt?t:u,n.attempt(Lte,m,p))}function u(g){return te(i.containerState,"expected state"),i.containerState.initialBlankLine=!0,s++,m(g)}function p(g){return Ht(g)?(n.enter(F.listItemPrefixWhitespace),n.consume(g),n.exit(F.listItemPrefixWhitespace),m):t(g)}function m(g){return te(i.containerState,"expected state"),i.containerState.size=s+i.sliceSerialize(n.exit(F.listItemPrefix),!0).length,e(g)}}function Ute(n,e,t){const i=this;return te(i.containerState,"expected state"),i.containerState._closeFlow=void 0,n.check(Iy,r,s);function r(o){return te(i.containerState,"expected state"),te(typeof i.containerState.size=="number","expected size"),i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,en(n,e,F.listItemIndent,i.containerState.size+1)(o)}function s(o){return te(i.containerState,"expected state"),i.containerState.furtherBlankLines||!Ht(o)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,a(o)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,n.attempt(Fte,e,a)(o))}function a(o){return te(i.containerState,"expected state"),i.containerState._closeFlow=!0,i.interrupt=void 0,te(i.parser.constructs.disable.null,"expected `disable.null` to be populated"),en(n,n.attempt(Vr,e,t),F.linePrefix,i.parser.constructs.disable.null.includes("codeIndented")?void 0:qe.tabSize)(o)}}function zte(n,e,t){const i=this;return te(i.containerState,"expected state"),te(typeof i.containerState.size=="number","expected size"),en(n,r,F.listItemIndent,i.containerState.size+1);function r(s){te(i.containerState,"expected state");const a=i.events[i.events.length-1];return a&&a[1].type===F.listItemIndent&&a[2].sliceSerialize(a[1],!0).length===i.containerState.size?e(s):t(s)}}function Bte(n){te(this.containerState,"expected state"),te(typeof this.containerState.type=="string","expected type"),n.exit(this.containerState.type)}function $te(n,e,t){const i=this;return te(i.parser.constructs.disable.null,"expected `disable.null` to be populated"),en(n,r,F.listItemPrefixWhitespace,i.parser.constructs.disable.null.includes("codeIndented")?void 0:qe.tabSize+1);function r(s){const a=i.events[i.events.length-1];return!Ht(s)&&a&&a[1].type===F.listItemPrefixWhitespace?e(s):t(s)}}const TI={name:"setextUnderline",resolveTo:Wte,tokenize:Hte};function Wte(n,e){let t=n.length,i,r,s;for(;t--;)if(n[t][0]==="enter"){if(n[t][1].type===F.content){i=t;break}n[t][1].type===F.paragraph&&(r=t)}else n[t][1].type===F.content&&n.splice(t,1),!s&&n[t][1].type===F.definition&&(s=t);te(r!==void 0,"expected a `text` index to be found"),te(i!==void 0,"expected a `text` index to be found"),te(n[i][2]===e,"enter context should be same"),te(n[n.length-1][2]===e,"enter context should be same");const a={type:F.setextHeading,start:{...n[i][1].start},end:{...n[n.length-1][1].end}};return n[r][1].type=F.setextHeadingText,s?(n.splice(r,0,["enter",a,e]),n.splice(s+1,0,["exit",n[i][1],e]),n[i][1].end={...n[s][1].end}):n[i][1]=a,n.push(["exit",a,e]),n}function Hte(n,e,t){const i=this;let r;return s;function s(c){let u=i.events.length,p;for(te(c===I.dash||c===I.equalsTo,"expected `=` or `-`");u--;)if(i.events[u][1].type!==F.lineEnding&&i.events[u][1].type!==F.linePrefix&&i.events[u][1].type!==F.content){p=i.events[u][1].type===F.paragraph;break}return!i.parser.lazy[i.now().line]&&(i.interrupt||p)?(n.enter(F.setextHeadingLine),r=c,a(c)):t(c)}function a(c){return n.enter(F.setextHeadingLineSequence),o(c)}function o(c){return c===r?(n.consume(c),o):(n.exit(F.setextHeadingLineSequence),Ht(c)?en(n,l,F.lineSuffix)(c):l(c))}function l(c){return c===I.eof||st(c)?(n.exit(F.setextHeadingLine),e(c)):t(c)}}const qte={tokenize:Gte};function Gte(n){const e=this,t=n.attempt(Iy,i,n.attempt(this.parser.constructs.flowInitial,r,en(n,n.attempt(this.parser.constructs.flow,r,n.attempt(Jee,r)),F.linePrefix)));return t;function i(s){if(te(s===I.eof||st(s),"expected eol or eof"),s===I.eof){n.consume(s);return}return n.enter(F.lineEndingBlank),n.consume(s),n.exit(F.lineEndingBlank),e.currentConstruct=void 0,t}function r(s){if(te(s===I.eof||st(s),"expected eol or eof"),s===I.eof){n.consume(s);return}return n.enter(F.lineEnding),n.consume(s),n.exit(F.lineEnding),e.currentConstruct=void 0,t}}const Yte={resolveAll:o2()},Xte=a2("string"),Kte=a2("text");function a2(n){return{resolveAll:o2(n==="text"?Qte:void 0),tokenize:e};function e(t){const i=this,r=this.parser.constructs[n],s=t.attempt(r,a,o);return a;function a(u){return c(u)?s(u):o(u)}function o(u){if(u===I.eof){t.consume(u);return}return t.enter(F.data),t.consume(u),l}function l(u){return c(u)?(t.exit(F.data),s(u)):(t.consume(u),l)}function c(u){if(u===I.eof)return!0;const p=r[u];let m=-1;if(p)for(te(Array.isArray(p),"expected `disable.null` to be populated");++m<p.length;){const g=p[m];if(!g.previous||g.previous.call(i,i.previous))return!0}return!1}}}function o2(n){return e;function e(t,i){let r=-1,s;for(;++r<=t.length;)s===void 0?t[r]&&t[r][1].type===F.data&&(s=r,r++):(!t[r]||t[r][1].type!==F.data)&&(r!==s+2&&(t[s][1].end=t[r-1][1].end,t.splice(s+2,r-s-2),r=s+2),s=void 0);return n?n(t,i):t}}function Qte(n,e){let t=0;for(;++t<=n.length;)if((t===n.length||n[t][1].type===F.lineEnding)&&n[t-1][1].type===F.data){const i=n[t-1][1],r=e.sliceStream(i);let s=r.length,a=-1,o=0,l;for(;s--;){const c=r[s];if(typeof c=="string"){for(a=c.length;c.charCodeAt(a-1)===I.space;)o++,a--;if(a)break;a=-1}else if(c===I.horizontalTab)l=!0,o++;else if(c!==I.virtualSpace){s++;break}}if(e._contentTypeTextTrailing&&t===n.length&&(o=0),o){const c={type:t===n.length||l||o<qe.hardBreakPrefixSizeMin?F.lineSuffix:F.hardBreakTrailing,start:{_bufferIndex:s?a:i.start._bufferIndex+a,_index:i.start._index+s,line:i.end.line,column:i.end.column-o,offset:i.end.offset-o},end:{...i.end}};i.end={...c.start},i.start.offset===i.end.offset?Object.assign(i,c):(n.splice(t,0,["enter",c,e],["exit",c,e]),t+=2)}t++}return n}const Jte={[I.asterisk]:Vr,[I.plusSign]:Vr,[I.dash]:Vr,[I.digit0]:Vr,[I.digit1]:Vr,[I.digit2]:Vr,[I.digit3]:Vr,[I.digit4]:Vr,[I.digit5]:Vr,[I.digit6]:Vr,[I.digit7]:Vr,[I.digit8]:Vr,[I.digit9]:Vr,[I.greaterThan]:JF},Zte={[I.leftSquareBracket]:ite},ene={[I.horizontalTab]:u1,[I.virtualSpace]:u1,[I.space]:u1},tne={[I.numberSign]:cte,[I.asterisk]:j0,[I.dash]:[TI,j0],[I.lessThan]:pte,[I.equalsTo]:TI,[I.underscore]:j0,[I.graveAccent]:AI,[I.tilde]:AI},nne={[I.ampersand]:e2,[I.backslash]:ZF},ine={[I.carriageReturn]:d1,[I.lineFeed]:d1,[I.carriageReturnLineFeed]:d1,[I.exclamationMark]:Tte,[I.ampersand]:e2,[I.asterisk]:QS,[I.lessThan]:[Mee,xte],[I.leftSquareBracket]:Rte,[I.backslash]:[ote,ZF],[I.rightSquareBracket]:xN,[I.underscore]:QS,[I.graveAccent]:Gee},rne={null:[QS,Yte]},sne={null:[I.asterisk,I.underscore]},ane={null:[]},one=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:sne,contentInitial:Zte,disable:ane,document:Jte,flow:tne,flowInitial:ene,insideSpan:rne,string:nne,text:ine},Symbol.toStringTag,{value:"Module"}));var Yv={exports:{}},h1,II;function lne(){if(II)return h1;II=1;var n=1e3,e=n*60,t=e*60,i=t*24,r=i*7,s=i*365.25;h1=function(u,p){p=p||{};var m=typeof u;if(m==="string"&&u.length>0)return a(u);if(m==="number"&&isFinite(u))return p.long?l(u):o(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function a(u){if(u=String(u),!(u.length>100)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(p){var m=parseFloat(p[1]),g=(p[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return m*s;case"weeks":case"week":case"w":return m*r;case"days":case"day":case"d":return m*i;case"hours":case"hour":case"hrs":case"hr":case"h":return m*t;case"minutes":case"minute":case"mins":case"min":case"m":return m*e;case"seconds":case"second":case"secs":case"sec":case"s":return m*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return m;default:return}}}}function o(u){var p=Math.abs(u);return p>=i?Math.round(u/i)+"d":p>=t?Math.round(u/t)+"h":p>=e?Math.round(u/e)+"m":p>=n?Math.round(u/n)+"s":u+"ms"}function l(u){var p=Math.abs(u);return p>=i?c(u,p,i,"day"):p>=t?c(u,p,t,"hour"):p>=e?c(u,p,e,"minute"):p>=n?c(u,p,n,"second"):u+" ms"}function c(u,p,m,g){var y=p>=m*1.5;return Math.round(u/m)+" "+g+(y?"s":"")}return h1}var p1,RI;function cne(){if(RI)return p1;RI=1;function n(e){i.debug=i,i.default=i,i.coerce=c,i.disable=o,i.enable=s,i.enabled=l,i.humanize=lne(),i.destroy=u,Object.keys(e).forEach(p=>{i[p]=e[p]}),i.names=[],i.skips=[],i.formatters={};function t(p){let m=0;for(let g=0;g<p.length;g++)m=(m<<5)-m+p.charCodeAt(g),m|=0;return i.colors[Math.abs(m)%i.colors.length]}i.selectColor=t;function i(p){let m,g=null,y,v;function w(...k){if(!w.enabled)return;const S=w,E=Number(new Date),P=E-(m||E);S.diff=P,S.prev=m,S.curr=E,m=E,k[0]=i.coerce(k[0]),typeof k[0]!="string"&&k.unshift("%O");let A=0;k[0]=k[0].replace(/%([a-zA-Z%])/g,(R,V)=>{if(R==="%%")return"%";A++;const B=i.formatters[V];if(typeof B=="function"){const L=k[A];R=B.call(S,L),k.splice(A,1),A--}return R}),i.formatArgs.call(S,k),(S.log||i.log).apply(S,k)}return w.namespace=p,w.useColors=i.useColors(),w.color=i.selectColor(p),w.extend=r,w.destroy=i.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>g!==null?g:(y!==i.namespaces&&(y=i.namespaces,v=i.enabled(p)),v),set:k=>{g=k}}),typeof i.init=="function"&&i.init(w),w}function r(p,m){const g=i(this.namespace+(typeof m>"u"?":":m)+p);return g.log=this.log,g}function s(p){i.save(p),i.namespaces=p,i.names=[],i.skips=[];const m=(typeof p=="string"?p:"").trim().replace(" ",",").split(",").filter(Boolean);for(const g of m)g[0]==="-"?i.skips.push(g.slice(1)):i.names.push(g)}function a(p,m){let g=0,y=0,v=-1,w=0;for(;g<p.length;)if(y<m.length&&(m[y]===p[g]||m[y]==="*"))m[y]==="*"?(v=y,w=g,y++):(g++,y++);else if(v!==-1)y=v+1,w++,g=w;else return!1;for(;y<m.length&&m[y]==="*";)y++;return y===m.length}function o(){const p=[...i.names,...i.skips.map(m=>"-"+m)].join(",");return i.enable(""),p}function l(p){for(const m of i.skips)if(a(p,m))return!1;for(const m of i.names)if(a(p,m))return!0;return!1}function c(p){return p instanceof Error?p.stack||p.message:p}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return i.enable(i.load()),i}return p1=n,p1}var MI;function une(){return MI||(MI=1,function(n,e){var t={};e.formatArgs=r,e.save=s,e.load=a,e.useColors=i,e.storage=o(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function i(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let c;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(c=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(c[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let p=0,m=0;c[0].replace(/%[a-zA-Z%]/g,g=>{g!=="%%"&&(p++,g==="%c"&&(m=p))}),c.splice(m,0,u)}e.log=console.debug||console.log||(()=>{});function s(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function a(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c=t.DEBUG),c}function o(){try{return localStorage}catch{}}n.exports=cne()(e);const{formatters:l}=n.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}(Yv,Yv.exports)),Yv.exports}var dne=une();const hne=Jf(dne),Eu=hne("micromark");function pne(n,e,t){let i={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const r={},s=[];let a=[],o=[],l=!0;const c={attempt:B(R),check:B(V),consume:P,enter:A,exit:N,interrupt:B(V,{interrupt:!0})},u={code:I.eof,containerState:{},defineSkip:k,events:[],now:w,parser:n,previous:I.eof,sliceSerialize:y,sliceStream:v,write:g};let p=e.tokenize.call(u,c),m;return e.resolveAll&&s.push(e),u;function g(X){return a=Xs(a,X),S(),a[a.length-1]!==I.eof?[]:(L(e,0),u.events=cw(s,u.events,u),u.events)}function y(X,G){return mne(v(X),G)}function v(X){return fne(a,X)}function w(){const{_bufferIndex:X,_index:G,line:K,column:J,offset:ee}=i;return{_bufferIndex:X,_index:G,line:K,column:J,offset:ee}}function k(X){r[X.line]=X.column,q(),Eu("position: define skip: `%j`",i)}function S(){let X;for(;i._index<a.length;){const G=a[i._index];if(typeof G=="string")for(X=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===X&&i._bufferIndex<G.length;)E(G.charCodeAt(i._bufferIndex));else E(G)}}function E(X){te(l===!0,"expected character to be consumed"),l=void 0,Eu("main: passing `%s` to %s",X,p&&p.name),m=X,te(typeof p=="function","expected state"),p=p(X)}function P(X){te(X===m,"expected given code to equal expected code"),Eu("consume: `%s`",X),te(l===void 0,"expected code to not have been consumed: this might be because `return x(code)` instead of `return x` was used"),te(X===null?u.events.length===0||u.events[u.events.length-1][0]==="exit":u.events[u.events.length-1][0]==="enter","expected last token to be open"),st(X)?(i.line++,i.column=1,i.offset+=X===I.carriageReturnLineFeed?2:1,q(),Eu("position: after eol: `%j`",i)):X!==I.virtualSpace&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===a[i._index].length&&(i._bufferIndex=-1,i._index++)),u.previous=X,l=!0}function A(X,G){const K=G||{};return K.type=X,K.start=w(),te(typeof X=="string","expected string type"),te(X.length>0,"expected non-empty string"),Eu("enter: `%s`",X),u.events.push(["enter",K,u]),o.push(K),K}function N(X){te(typeof X=="string","expected string type"),te(X.length>0,"expected non-empty string");const G=o.pop();return te(G,"cannot close w/o open tokens"),G.end=w(),te(X===G.type,"expected exit token to match current token"),te(!(G.start._index===G.end._index&&G.start._bufferIndex===G.end._bufferIndex),"expected non-empty token (`"+X+"`)"),Eu("exit: `%s`",G.type),u.events.push(["exit",G,u]),G}function R(X,G){L(X,G.from)}function V(X,G){G.restore()}function B(X,G){return K;function K(J,ee,fe){let ae,U,he,ie;return Array.isArray(J)?Y(J):"tokenize"in J?Y([J]):$(J);function $(je){return ze;function ze(Ve){const we=Ve!==null&&je[Ve],Ae=Ve!==null&&je.null,_e=[...Array.isArray(we)?we:we?[we]:[],...Array.isArray(Ae)?Ae:Ae?[Ae]:[]];return Y(_e)(Ve)}}function Y(je){return ae=je,U=0,je.length===0?(te(fe,"expected `bogusState` to be given"),fe):oe(je[U])}function oe(je){return ze;function ze(Ve){return ie=W(),he=je,je.partial||(u.currentConstruct=je),te(u.parser.constructs.disable.null,"expected `disable.null` to be populated"),je.name&&u.parser.constructs.disable.null.includes(je.name)?xe(Ve):je.tokenize.call(G?Object.assign(Object.create(u),G):u,c,be,xe)(Ve)}}function be(je){return te(je===m,"expected code"),l=!0,X(he,ie),ee}function xe(je){return te(je===m,"expected code"),l=!0,ie.restore(),++U<ae.length?oe(ae[U]):fe}}}function L(X,G){X.resolveAll&&!s.includes(X)&&s.push(X),X.resolve&&Ns(u.events,G,u.events.length-G,X.resolve(u.events.slice(G),u)),X.resolveTo&&(u.events=X.resolveTo(u.events,u)),te(X.partial||u.events.length===0||u.events[u.events.length-1][0]==="exit","expected last token to end")}function W(){const X=w(),G=u.previous,K=u.currentConstruct,J=u.events.length,ee=Array.from(o);return{from:J,restore:fe};function fe(){i=X,u.previous=G,u.currentConstruct=K,u.events.length=J,o=ee,q(),Eu("position: restore: `%j`",i)}}function q(){i.line in r&&i.column<2&&(i.column=r[i.line],i.offset+=r[i.line]-1)}}function fne(n,e){const t=e.start._index,i=e.start._bufferIndex,r=e.end._index,s=e.end._bufferIndex;let a;if(t===r)te(s>-1,"expected non-negative end buffer index"),te(i>-1,"expected non-negative start buffer index"),a=[n[t].slice(i,s)];else{if(a=n.slice(t,r),i>-1){const o=a[0];typeof o=="string"?a[0]=o.slice(i):(te(i===0,"expected `startBufferIndex` to be `0`"),a.shift())}s>0&&a.push(n[r].slice(0,s))}return a}function mne(n,e){let t=-1;const i=[];let r;for(;++t<n.length;){const s=n[t];let a;if(typeof s=="string")a=s;else switch(s){case I.carriageReturn:{a=Ba.cr;break}case I.lineFeed:{a=Ba.lf;break}case I.carriageReturnLineFeed:{a=Ba.cr+Ba.lf;break}case I.horizontalTab:{a=e?Ba.space:Ba.ht;break}case I.virtualSpace:{if(!e&&r)continue;a=Ba.space;break}default:te(typeof s=="number","expected number"),a=String.fromCharCode(s)}r=s===I.horizontalTab,i.push(a)}return i.join("")}function gne(n){const i={constructs:KF([one,...(n||{}).extensions||[]]),content:r(_ee),defined:[],document:r(Aee),flow:r(qte),lazy:{},string:r(Xte),text:r(Kte)};return i;function r(s){return a;function a(o){return pne(i,s,o)}}}function bne(n){for(;!n2(n););return n}const jI=/[\0\t\n\r]/g;function yne(){let n=1,e="",t=!0,i;return r;function r(s,a,o){const l=[];let c,u,p,m,g;for(s=e+(typeof s=="string"?s.toString():new TextDecoder(a||void 0).decode(s)),p=0,e="",t&&(s.charCodeAt(0)===I.byteOrderMarker&&p++,t=void 0);p<s.length;){if(jI.lastIndex=p,c=jI.exec(s),m=c&&c.index!==void 0?c.index:s.length,g=s.charCodeAt(m),!c){e=s.slice(p);break}if(g===I.lf&&p===m&&i)l.push(I.carriageReturnLineFeed),i=void 0;else switch(i&&(l.push(I.carriageReturn),i=void 0),p<m&&(l.push(s.slice(p,m)),n+=m-p),g){case I.nul:{l.push(I.replacementCharacter),n++;break}case I.ht:{for(u=Math.ceil(n/qe.tabSize)*qe.tabSize,l.push(I.horizontalTab);n++<u;)l.push(I.virtualSpace);break}case I.lf:{l.push(I.lineFeed),n=1;break}default:i=!0,n=1}p=m+1}return o&&(i&&l.push(I.carriageReturn),e&&l.push(e),l.push(I.eof)),l}}const vne=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function xne(n){return n.replace(vne,wne)}function wne(n,e,t){if(e)return e;if(t.charCodeAt(0)===I.numberSign){const r=t.charCodeAt(1),s=r===I.lowercaseX||r===I.uppercaseX;return QF(t.slice(s?2:1),s?qe.numericBaseHexadecimal:qe.numericBaseDecimal)}return vN(t)||n}const l2={}.hasOwnProperty;function kne(n,e,t){return typeof e!="string"&&(t=e,e=void 0),Dne(t)(bne(gne(t).document().write(yne()(n,e,!0))))}function Dne(n){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(mt),autolinkProtocol:B,autolinkEmail:B,atxHeading:s(He),blockQuote:s(Ve),characterEscape:B,characterReference:B,codeFenced:s(we),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:s(we,a),codeText:s(Ae,a),codeTextData:B,data:B,codeFlowValue:B,definition:s(_e),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:s(ye),hardBreakEscape:s(Re),hardBreakTrailing:s(Re),htmlFlow:s(et,a),htmlFlowData:B,htmlText:s(et,a),htmlTextData:B,image:s(Be),label:a,link:s(mt),listItem:s(ct),listItemValue:m,listOrdered:s(Xe,p),listUnordered:s(Xe),paragraph:s(tn),reference:$,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:s(He),strong:s(on),thematicBreak:s(Ge)},exit:{atxHeading:l(),atxHeadingSequence:A,autolink:l(),autolinkEmail:ze,autolinkProtocol:je,blockQuote:l(),characterEscapeValue:L,characterReferenceMarkerHexadecimal:oe,characterReferenceMarkerNumeric:oe,characterReferenceValue:be,characterReference:xe,codeFenced:l(w),codeFencedFence:v,codeFencedFenceInfo:g,codeFencedFenceMeta:y,codeFlowValue:L,codeIndented:l(k),codeText:l(K),codeTextData:L,data:L,definition:l(),definitionDestinationString:P,definitionLabelString:S,definitionTitleString:E,emphasis:l(),hardBreakEscape:l(q),hardBreakTrailing:l(q),htmlFlow:l(X),htmlFlowData:L,htmlText:l(G),htmlTextData:L,image:l(ee),label:ae,labelText:fe,lineEnding:W,link:l(J),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:Y,resourceDestinationString:U,resourceTitleString:he,resource:ie,setextHeading:l(V),setextHeadingLineSequence:R,setextHeadingText:N,strong:l(),thematicBreak:l()}};c2(e,(n||{}).mdastExtensions||[]);const t={};return i;function i(ue){let de={type:"root",children:[]};const Pe={stack:[de],tokenStack:[],config:e,enter:o,exit:c,buffer:a,resume:u,data:t},Le=[];let $e=-1;for(;++$e<ue.length;)if(ue[$e][1].type===F.listOrdered||ue[$e][1].type===F.listUnordered)if(ue[$e][0]==="enter")Le.push($e);else{const ht=Le.pop();te(typeof ht=="number","expected list ot be open"),$e=r(ue,ht,$e)}for($e=-1;++$e<ue.length;){const ht=e[ue[$e][0]];l2.call(ht,ue[$e][1].type)&&ht[ue[$e][1].type].call(Object.assign({sliceSerialize:ue[$e][2].sliceSerialize},Pe),ue[$e][1])}if(Pe.tokenStack.length>0){const ht=Pe.tokenStack[Pe.tokenStack.length-1];(ht[1]||OI).call(Pe,void 0,ht[0])}for(de.position={start:Vl(ue.length>0?ue[0][1].start:{line:1,column:1,offset:0}),end:Vl(ue.length>0?ue[ue.length-2][1].end:{line:1,column:1,offset:0})},$e=-1;++$e<e.transforms.length;)de=e.transforms[$e](de)||de;return de}function r(ue,de,Pe){let Le=de-1,$e=-1,ht=!1,Et,Ut,zt,Te;for(;++Le<=Pe;){const Ue=ue[Le];switch(Ue[1].type){case F.listUnordered:case F.listOrdered:case F.blockQuote:{Ue[0]==="enter"?$e++:$e--,Te=void 0;break}case F.lineEndingBlank:{Ue[0]==="enter"&&(Et&&!Te&&!$e&&!zt&&(zt=Le),Te=void 0);break}case F.linePrefix:case F.listItemValue:case F.listItemMarker:case F.listItemPrefix:case F.listItemPrefixWhitespace:break;default:Te=void 0}if(!$e&&Ue[0]==="enter"&&Ue[1].type===F.listItemPrefix||$e===-1&&Ue[0]==="exit"&&(Ue[1].type===F.listUnordered||Ue[1].type===F.listOrdered)){if(Et){let ke=Le;for(Ut=void 0;ke--;){const ot=ue[ke];if(ot[1].type===F.lineEnding||ot[1].type===F.lineEndingBlank){if(ot[0]==="exit")continue;Ut&&(ue[Ut][1].type=F.lineEndingBlank,ht=!0),ot[1].type=F.lineEnding,Ut=ke}else if(!(ot[1].type===F.linePrefix||ot[1].type===F.blockQuotePrefix||ot[1].type===F.blockQuotePrefixWhitespace||ot[1].type===F.blockQuoteMarker||ot[1].type===F.listItemIndent))break}zt&&(!Ut||zt<Ut)&&(Et._spread=!0),Et.end=Object.assign({},Ut?ue[Ut][1].start:Ue[1].end),ue.splice(Ut||Le,0,["exit",Et,Ue[2]]),Le++,Pe++}if(Ue[1].type===F.listItemPrefix){const ke={type:"listItem",_spread:!1,start:Object.assign({},Ue[1].start),end:void 0};Et=ke,ue.splice(Le,0,["enter",ke,Ue[2]]),Le++,Pe++,zt=void 0,Te=!0}}}return ue[de][1]._spread=ht,Pe}function s(ue,de){return Pe;function Pe(Le){o.call(this,ue(Le),Le),de&&de.call(this,Le)}}function a(){this.stack.push({type:"fragment",children:[]})}function o(ue,de,Pe){const Le=this.stack[this.stack.length-1];te(Le,"expected `parent`"),te("children"in Le,"expected `parent`"),Le.children.push(ue),this.stack.push(ue),this.tokenStack.push([de,Pe||void 0]),ue.position={start:Vl(de.start),end:void 0}}function l(ue){return de;function de(Pe){ue&&ue.call(this,Pe),c.call(this,Pe)}}function c(ue,de){const Pe=this.stack.pop();te(Pe,"expected `node`");const Le=this.tokenStack.pop();if(Le)Le[0].type!==ue.type&&(de?de.call(this,ue,Le[0]):(Le[1]||OI).call(this,ue,Le[0]));else throw new Error("Cannot close `"+ue.type+"` ("+bg({start:ue.start,end:ue.end})+"): it’s not open");te(Pe.type!=="fragment","unexpected fragment `exit`ed"),te(Pe.position,"expected `position` to be defined"),Pe.position.end=Vl(ue.end)}function u(){return yN(this.stack.pop())}function p(){this.data.expectingFirstListItemValue=!0}function m(ue){if(this.data.expectingFirstListItemValue){const de=this.stack[this.stack.length-2];te(de,"expected nodes on stack"),te(de.type==="list","expected list on stack"),de.start=Number.parseInt(this.sliceSerialize(ue),qe.numericBaseDecimal),this.data.expectingFirstListItemValue=void 0}}function g(){const ue=this.resume(),de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="code","expected code on stack"),de.lang=ue}function y(){const ue=this.resume(),de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="code","expected code on stack"),de.meta=ue}function v(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function w(){const ue=this.resume(),de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="code","expected code on stack"),de.value=ue.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function k(){const ue=this.resume(),de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="code","expected code on stack"),de.value=ue.replace(/(\r?\n|\r)$/g,"")}function S(ue){const de=this.resume(),Pe=this.stack[this.stack.length-1];te(Pe,"expected node on stack"),te(Pe.type==="definition","expected definition on stack"),Pe.label=de,Pe.identifier=Ca(this.sliceSerialize(ue)).toLowerCase()}function E(){const ue=this.resume(),de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="definition","expected definition on stack"),de.title=ue}function P(){const ue=this.resume(),de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="definition","expected definition on stack"),de.url=ue}function A(ue){const de=this.stack[this.stack.length-1];if(te(de,"expected node on stack"),te(de.type==="heading","expected heading on stack"),!de.depth){const Pe=this.sliceSerialize(ue).length;te(Pe===1||Pe===2||Pe===3||Pe===4||Pe===5||Pe===6,"expected `depth` between `1` and `6`"),de.depth=Pe}}function N(){this.data.setextHeadingSlurpLineEnding=!0}function R(ue){const de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="heading","expected heading on stack"),de.depth=this.sliceSerialize(ue).codePointAt(0)===I.equalsTo?1:2}function V(){this.data.setextHeadingSlurpLineEnding=void 0}function B(ue){const de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te("children"in de,"expected parent on stack");const Pe=de.children;let Le=Pe[Pe.length-1];(!Le||Le.type!=="text")&&(Le=Oe(),Le.position={start:Vl(ue.start),end:void 0},Pe.push(Le)),this.stack.push(Le)}function L(ue){const de=this.stack.pop();te(de,"expected a `node` to be on the stack"),te("value"in de,"expected a `literal` to be on the stack"),te(de.position,"expected `node` to have an open position"),de.value+=this.sliceSerialize(ue),de.position.end=Vl(ue.end)}function W(ue){const de=this.stack[this.stack.length-1];if(te(de,"expected `node`"),this.data.atHardBreak){te("children"in de,"expected `parent`");const Pe=de.children[de.children.length-1];te(Pe.position,"expected tail to have a starting position"),Pe.position.end=Vl(ue.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(de.type)&&(B.call(this,ue),L.call(this,ue))}function q(){this.data.atHardBreak=!0}function X(){const ue=this.resume(),de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="html","expected html on stack"),de.value=ue}function G(){const ue=this.resume(),de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="html","expected html on stack"),de.value=ue}function K(){const ue=this.resume(),de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="inlineCode","expected inline code on stack"),de.value=ue}function J(){const ue=this.stack[this.stack.length-1];if(te(ue,"expected node on stack"),te(ue.type==="link","expected link on stack"),this.data.inReference){const de=this.data.referenceType||"shortcut";ue.type+="Reference",ue.referenceType=de,delete ue.url,delete ue.title}else delete ue.identifier,delete ue.label;this.data.referenceType=void 0}function ee(){const ue=this.stack[this.stack.length-1];if(te(ue,"expected node on stack"),te(ue.type==="image","expected image on stack"),this.data.inReference){const de=this.data.referenceType||"shortcut";ue.type+="Reference",ue.referenceType=de,delete ue.url,delete ue.title}else delete ue.identifier,delete ue.label;this.data.referenceType=void 0}function fe(ue){const de=this.sliceSerialize(ue),Pe=this.stack[this.stack.length-2];te(Pe,"expected ancestor on stack"),te(Pe.type==="image"||Pe.type==="link","expected image or link on stack"),Pe.label=xne(de),Pe.identifier=Ca(de).toLowerCase()}function ae(){const ue=this.stack[this.stack.length-1];te(ue,"expected node on stack"),te(ue.type==="fragment","expected fragment on stack");const de=this.resume(),Pe=this.stack[this.stack.length-1];if(te(Pe,"expected node on stack"),te(Pe.type==="image"||Pe.type==="link","expected image or link on stack"),this.data.inReference=!0,Pe.type==="link"){const Le=ue.children;Pe.children=Le}else Pe.alt=de}function U(){const ue=this.resume(),de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="image"||de.type==="link","expected image or link on stack"),de.url=ue}function he(){const ue=this.resume(),de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="image"||de.type==="link","expected image or link on stack"),de.title=ue}function ie(){this.data.inReference=void 0}function $(){this.data.referenceType="collapsed"}function Y(ue){const de=this.resume(),Pe=this.stack[this.stack.length-1];te(Pe,"expected node on stack"),te(Pe.type==="image"||Pe.type==="link","expected image reference or link reference on stack"),Pe.label=de,Pe.identifier=Ca(this.sliceSerialize(ue)).toLowerCase(),this.data.referenceType="full"}function oe(ue){te(ue.type==="characterReferenceMarkerNumeric"||ue.type==="characterReferenceMarkerHexadecimal"),this.data.characterReferenceType=ue.type}function be(ue){const de=this.sliceSerialize(ue),Pe=this.data.characterReferenceType;let Le;if(Pe)Le=QF(de,Pe===F.characterReferenceMarkerNumeric?qe.numericBaseDecimal:qe.numericBaseHexadecimal),this.data.characterReferenceType=void 0;else{const ht=vN(de);te(ht!==!1,"expected reference to decode"),Le=ht}const $e=this.stack[this.stack.length-1];te($e,"expected `node`"),te("value"in $e,"expected `node.value`"),$e.value+=Le}function xe(ue){const de=this.stack.pop();te(de,"expected `node`"),te(de.position,"expected `node.position`"),de.position.end=Vl(ue.end)}function je(ue){L.call(this,ue);const de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="link","expected link on stack"),de.url=this.sliceSerialize(ue)}function ze(ue){L.call(this,ue);const de=this.stack[this.stack.length-1];te(de,"expected node on stack"),te(de.type==="link","expected link on stack"),de.url="mailto:"+this.sliceSerialize(ue)}function Ve(){return{type:"blockquote",children:[]}}function we(){return{type:"code",lang:null,meta:null,value:""}}function Ae(){return{type:"inlineCode",value:""}}function _e(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function ye(){return{type:"emphasis",children:[]}}function He(){return{type:"heading",depth:0,children:[]}}function Re(){return{type:"break"}}function et(){return{type:"html",value:""}}function Be(){return{type:"image",title:null,url:"",alt:null}}function mt(){return{type:"link",title:null,url:"",children:[]}}function Xe(ue){return{type:"list",ordered:ue.type==="listOrdered",start:null,spread:ue._spread,children:[]}}function ct(ue){return{type:"listItem",spread:ue._spread,checked:null,children:[]}}function tn(){return{type:"paragraph",children:[]}}function on(){return{type:"strong",children:[]}}function Oe(){return{type:"text",value:""}}function Ge(){return{type:"thematicBreak"}}}function Vl(n){return{line:n.line,column:n.column,offset:n.offset}}function c2(n,e){let t=-1;for(;++t<e.length;){const i=e[t];Array.isArray(i)?c2(n,i):Sne(n,i)}}function Sne(n,e){let t;for(t in e)if(l2.call(e,t))switch(t){case"canContainEols":{const i=e[t];i&&n[t].push(...i);break}case"transforms":{const i=e[t];i&&n[t].push(...i);break}case"enter":case"exit":{const i=e[t];i&&Object.assign(n[t],i);break}}}function OI(n,e){throw n?new Error("Cannot close `"+n.type+"` ("+bg({start:n.start,end:n.end})+"): a different token (`"+e.type+"`, "+bg({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+bg({start:e.start,end:e.end})+") is still open")}function Ene(n){const e=this;e.parser=t;function t(i){return kne(i,{...e.data("settings"),...n,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function Nne(n,e){const t={type:"element",tagName:"blockquote",properties:{},children:n.wrap(n.all(e),!0)};return n.patch(e,t),n.applyData(e,t)}function _ne(n,e){const t={type:"element",tagName:"br",properties:{},children:[]};return n.patch(e,t),[n.applyData(e,t),{type:"text",value:`
`}]}function Cne(n,e){const t=e.value?e.value+`
`:"",i={};e.lang&&(i.className=["language-"+e.lang]);let r={type:"element",tagName:"code",properties:i,children:[{type:"text",value:t}]};return e.meta&&(r.data={meta:e.meta}),n.patch(e,r),r=n.applyData(e,r),r={type:"element",tagName:"pre",properties:{},children:[r]},n.patch(e,r),r}function Ane(n,e){const t={type:"element",tagName:"del",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function Pne(n,e){const t={type:"element",tagName:"em",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function Tne(n,e){const t=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",i=String(e.identifier).toUpperCase(),r=rm(i.toLowerCase()),s=n.footnoteOrder.indexOf(i);let a,o=n.footnoteCounts.get(i);o===void 0?(o=0,n.footnoteOrder.push(i),a=n.footnoteOrder.length):a=s+1,o+=1,n.footnoteCounts.set(i,o);const l={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+r,id:t+"fnref-"+r+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};n.patch(e,l);const c={type:"element",tagName:"sup",properties:{},children:[l]};return n.patch(e,c),n.applyData(e,c)}function Ine(n,e){const t={type:"element",tagName:"h"+e.depth,properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function Rne(n,e){if(n.options.allowDangerousHtml){const t={type:"raw",value:e.value};return n.patch(e,t),n.applyData(e,t)}}function u2(n,e){const t=e.referenceType;let i="]";if(t==="collapsed"?i+="[]":t==="full"&&(i+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+i}];const r=n.all(e),s=r[0];s&&s.type==="text"?s.value="["+s.value:r.unshift({type:"text",value:"["});const a=r[r.length-1];return a&&a.type==="text"?a.value+=i:r.push({type:"text",value:i}),r}function Mne(n,e){const t=String(e.identifier).toUpperCase(),i=n.definitionById.get(t);if(!i)return u2(n,e);const r={src:rm(i.url||""),alt:e.alt};i.title!==null&&i.title!==void 0&&(r.title=i.title);const s={type:"element",tagName:"img",properties:r,children:[]};return n.patch(e,s),n.applyData(e,s)}function jne(n,e){const t={src:rm(e.url)};e.alt!==null&&e.alt!==void 0&&(t.alt=e.alt),e.title!==null&&e.title!==void 0&&(t.title=e.title);const i={type:"element",tagName:"img",properties:t,children:[]};return n.patch(e,i),n.applyData(e,i)}function One(n,e){const t={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};n.patch(e,t);const i={type:"element",tagName:"code",properties:{},children:[t]};return n.patch(e,i),n.applyData(e,i)}function Lne(n,e){const t=String(e.identifier).toUpperCase(),i=n.definitionById.get(t);if(!i)return u2(n,e);const r={href:rm(i.url||"")};i.title!==null&&i.title!==void 0&&(r.title=i.title);const s={type:"element",tagName:"a",properties:r,children:n.all(e)};return n.patch(e,s),n.applyData(e,s)}function Fne(n,e){const t={href:rm(e.url)};e.title!==null&&e.title!==void 0&&(t.title=e.title);const i={type:"element",tagName:"a",properties:t,children:n.all(e)};return n.patch(e,i),n.applyData(e,i)}function Vne(n,e,t){const i=n.all(e),r=t?Une(t):d2(e),s={},a=[];if(typeof e.checked=="boolean"){const u=i[0];let p;u&&u.type==="element"&&u.tagName==="p"?p=u:(p={type:"element",tagName:"p",properties:{},children:[]},i.unshift(p)),p.children.length>0&&p.children.unshift({type:"text",value:" "}),p.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let o=-1;for(;++o<i.length;){const u=i[o];(r||o!==0||u.type!=="element"||u.tagName!=="p")&&a.push({type:"text",value:`
`}),u.type==="element"&&u.tagName==="p"&&!r?a.push(...u.children):a.push(u)}const l=i[i.length-1];l&&(r||l.type!=="element"||l.tagName!=="p")&&a.push({type:"text",value:`
`});const c={type:"element",tagName:"li",properties:s,children:a};return n.patch(e,c),n.applyData(e,c)}function Une(n){let e=!1;if(n.type==="list"){e=n.spread||!1;const t=n.children;let i=-1;for(;!e&&++i<t.length;)e=d2(t[i])}return e}function d2(n){const e=n.spread;return e??n.children.length>1}function zne(n,e){const t={},i=n.all(e);let r=-1;for(typeof e.start=="number"&&e.start!==1&&(t.start=e.start);++r<i.length;){const a=i[r];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const s={type:"element",tagName:e.ordered?"ol":"ul",properties:t,children:n.wrap(i,!0)};return n.patch(e,s),n.applyData(e,s)}function Bne(n,e){const t={type:"element",tagName:"p",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function $ne(n,e){const t={type:"root",children:n.wrap(n.all(e))};return n.patch(e,t),n.applyData(e,t)}function Wne(n,e){const t={type:"element",tagName:"strong",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function Hne(n,e){const t=n.all(e),i=t.shift(),r=[];if(i){const a={type:"element",tagName:"thead",properties:{},children:n.wrap([i],!0)};n.patch(e.children[0],a),r.push(a)}if(t.length>0){const a={type:"element",tagName:"tbody",properties:{},children:n.wrap(t,!0)},o=fN(e.children[1]),l=$F(e.children[e.children.length-1]);o&&l&&(a.position={start:o,end:l}),r.push(a)}const s={type:"element",tagName:"table",properties:{},children:n.wrap(r,!0)};return n.patch(e,s),n.applyData(e,s)}function qne(n,e,t){const i=t?t.children:void 0,s=(i?i.indexOf(e):1)===0?"th":"td",a=t&&t.type==="table"?t.align:void 0,o=a?a.length:e.children.length;let l=-1;const c=[];for(;++l<o;){const p=e.children[l],m={},g=a?a[l]:void 0;g&&(m.align=g);let y={type:"element",tagName:s,properties:m,children:[]};p&&(y.children=n.all(p),n.patch(p,y),y=n.applyData(p,y)),c.push(y)}const u={type:"element",tagName:"tr",properties:{},children:n.wrap(c,!0)};return n.patch(e,u),n.applyData(e,u)}function Gne(n,e){const t={type:"element",tagName:"td",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}const LI=9,FI=32;function Yne(n){const e=String(n),t=/\r?\n|\r/g;let i=t.exec(e),r=0;const s=[];for(;i;)s.push(VI(e.slice(r,i.index),r>0,!0),i[0]),r=i.index+i[0].length,i=t.exec(e);return s.push(VI(e.slice(r),r>0,!1)),s.join("")}function VI(n,e,t){let i=0,r=n.length;if(e){let s=n.codePointAt(i);for(;s===LI||s===FI;)i++,s=n.codePointAt(i)}if(t){let s=n.codePointAt(r-1);for(;s===LI||s===FI;)r--,s=n.codePointAt(r-1)}return r>i?n.slice(i,r):""}function Xne(n,e){const t={type:"text",value:Yne(String(e.value))};return n.patch(e,t),n.applyData(e,t)}function Kne(n,e){const t={type:"element",tagName:"hr",properties:{},children:[]};return n.patch(e,t),n.applyData(e,t)}const Qne={blockquote:Nne,break:_ne,code:Cne,delete:Ane,emphasis:Pne,footnoteReference:Tne,heading:Ine,html:Rne,imageReference:Mne,image:jne,inlineCode:One,linkReference:Lne,link:Fne,listItem:Vne,list:zne,paragraph:Bne,root:$ne,strong:Wne,table:Hne,tableCell:Gne,tableRow:qne,text:Xne,thematicBreak:Kne,toml:Xv,yaml:Xv,definition:Xv,footnoteDefinition:Xv};function Xv(){}const h2=-1,uw=0,vg=1,hx=2,wN=3,kN=4,DN=5,SN=6,p2=7,f2=8,UI=typeof self=="object"?self:globalThis,Jne=(n,e)=>{const t=(r,s)=>(n.set(s,r),r),i=r=>{if(n.has(r))return n.get(r);const[s,a]=e[r];switch(s){case uw:case h2:return t(a,r);case vg:{const o=t([],r);for(const l of a)o.push(i(l));return o}case hx:{const o=t({},r);for(const[l,c]of a)o[i(l)]=i(c);return o}case wN:return t(new Date(a),r);case kN:{const{source:o,flags:l}=a;return t(new RegExp(o,l),r)}case DN:{const o=t(new Map,r);for(const[l,c]of a)o.set(i(l),i(c));return o}case SN:{const o=t(new Set,r);for(const l of a)o.add(i(l));return o}case p2:{const{name:o,message:l}=a;return t(new UI[o](l),r)}case f2:return t(BigInt(a),r);case"BigInt":return t(Object(BigInt(a)),r);case"ArrayBuffer":return t(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:o}=new Uint8Array(a);return t(new DataView(o),a)}}return t(new UI[s](a),r)};return i},zI=n=>Jne(new Map,n)(0),Kh="",{toString:Zne}={},{keys:eie}=Object,Um=n=>{const e=typeof n;if(e!=="object"||!n)return[uw,e];const t=Zne.call(n).slice(8,-1);switch(t){case"Array":return[vg,Kh];case"Object":return[hx,Kh];case"Date":return[wN,Kh];case"RegExp":return[kN,Kh];case"Map":return[DN,Kh];case"Set":return[SN,Kh];case"DataView":return[vg,t]}return t.includes("Array")?[vg,t]:t.includes("Error")?[p2,t]:[hx,t]},Kv=([n,e])=>n===uw&&(e==="function"||e==="symbol"),tie=(n,e,t,i)=>{const r=(a,o)=>{const l=i.push(a)-1;return t.set(o,l),l},s=a=>{if(t.has(a))return t.get(a);let[o,l]=Um(a);switch(o){case uw:{let u=a;switch(l){case"bigint":o=f2,u=a.toString();break;case"function":case"symbol":if(n)throw new TypeError("unable to serialize "+l);u=null;break;case"undefined":return r([h2],a)}return r([o,u],a)}case vg:{if(l){let m=a;return l==="DataView"?m=new Uint8Array(a.buffer):l==="ArrayBuffer"&&(m=new Uint8Array(a)),r([l,[...m]],a)}const u=[],p=r([o,u],a);for(const m of a)u.push(s(m));return p}case hx:{if(l)switch(l){case"BigInt":return r([l,a.toString()],a);case"Boolean":case"Number":case"String":return r([l,a.valueOf()],a)}if(e&&"toJSON"in a)return s(a.toJSON());const u=[],p=r([o,u],a);for(const m of eie(a))(n||!Kv(Um(a[m])))&&u.push([s(m),s(a[m])]);return p}case wN:return r([o,a.toISOString()],a);case kN:{const{source:u,flags:p}=a;return r([o,{source:u,flags:p}],a)}case DN:{const u=[],p=r([o,u],a);for(const[m,g]of a)(n||!(Kv(Um(m))||Kv(Um(g))))&&u.push([s(m),s(g)]);return p}case SN:{const u=[],p=r([o,u],a);for(const m of a)(n||!Kv(Um(m)))&&u.push(s(m));return p}}const{message:c}=a;return r([o,{name:l,message:c}],a)};return s},BI=(n,{json:e,lossy:t}={})=>{const i=[];return tie(!(e||t),!!e,new Map,i)(n),i},px=typeof structuredClone=="function"?(n,e)=>e&&("json"in e||"lossy"in e)?zI(BI(n,e)):structuredClone(n):(n,e)=>zI(BI(n,e));function nie(n,e){const t=[{type:"text",value:"↩"}];return e>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),t}function iie(n,e){return"Back to reference "+(n+1)+(e>1?"-"+e:"")}function rie(n){const e=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",t=n.options.footnoteBackContent||nie,i=n.options.footnoteBackLabel||iie,r=n.options.footnoteLabel||"Footnotes",s=n.options.footnoteLabelTagName||"h2",a=n.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let l=-1;for(;++l<n.footnoteOrder.length;){const c=n.footnoteById.get(n.footnoteOrder[l]);if(!c)continue;const u=n.all(c),p=String(c.identifier).toUpperCase(),m=rm(p.toLowerCase());let g=0;const y=[],v=n.footnoteCounts.get(p);for(;v!==void 0&&++g<=v;){y.length>0&&y.push({type:"text",value:" "});let S=typeof t=="string"?t:t(l,g);typeof S=="string"&&(S={type:"text",value:S}),y.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+m+(g>1?"-"+g:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(l,g),className:["data-footnote-backref"]},children:Array.isArray(S)?S:[S]})}const w=u[u.length-1];if(w&&w.type==="element"&&w.tagName==="p"){const S=w.children[w.children.length-1];S&&S.type==="text"?S.value+=" ":w.children.push({type:"text",value:" "}),w.children.push(...y)}else u.push(...y);const k={type:"element",tagName:"li",properties:{id:e+"fn-"+m},children:n.wrap(u,!0)};n.patch(c,k),o.push(k)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...px(a),id:"footnote-label"},children:[{type:"text",value:r}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:n.wrap(o,!0)},{type:"text",value:`
`}]}}const dw=function(n){if(n==null)return lie;if(typeof n=="function")return hw(n);if(typeof n=="object")return Array.isArray(n)?sie(n):aie(n);if(typeof n=="string")return oie(n);throw new Error("Expected function, string, or object as test")};function sie(n){const e=[];let t=-1;for(;++t<n.length;)e[t]=dw(n[t]);return hw(i);function i(...r){let s=-1;for(;++s<e.length;)if(e[s].apply(this,r))return!0;return!1}}function aie(n){const e=n;return hw(t);function t(i){const r=i;let s;for(s in n)if(r[s]!==e[s])return!1;return!0}}function oie(n){return hw(e);function e(t){return t&&t.type===n}}function hw(n){return e;function e(t,i,r){return!!(cie(t)&&n.call(this,t,typeof i=="number"?i:void 0,r||void 0))}}function lie(){return!0}function cie(n){return n!==null&&typeof n=="object"&&"type"in n}const m2=[],uie=!0,JS=!1,die="skip";function g2(n,e,t,i){let r;typeof e=="function"&&typeof t!="function"?(i=t,t=e):r=e;const s=dw(r),a=i?-1:1;o(n,void 0,[])();function o(l,c,u){const p=l&&typeof l=="object"?l:{};if(typeof p.type=="string"){const g=typeof p.tagName=="string"?p.tagName:typeof p.name=="string"?p.name:void 0;Object.defineProperty(m,"name",{value:"node ("+(l.type+(g?"<"+g+">":""))+")"})}return m;function m(){let g=m2,y,v,w;if((!e||s(l,c,u[u.length-1]||void 0))&&(g=hie(t(l,u)),g[0]===JS))return g;if("children"in l&&l.children){const k=l;if(k.children&&g[0]!==die)for(v=(i?k.children.length:-1)+a,w=u.concat(k);v>-1&&v<k.children.length;){const S=k.children[v];if(y=o(S,v,w)(),y[0]===JS)return y;v=typeof y[1]=="number"?y[1]:v+a}}return g}}}function hie(n){return Array.isArray(n)?n:typeof n=="number"?[uie,n]:n==null?m2:[n]}function EN(n,e,t,i){let r,s,a;typeof e=="function"?(s=void 0,a=e,r=t):(s=e,a=t,r=i),g2(n,s,o,r);function o(l,c){const u=c[c.length-1],p=u?u.children.indexOf(l):void 0;return a(l,p,u)}}const ZS={}.hasOwnProperty,pie={};function fie(n,e){const t=e||pie,i=new Map,r=new Map,s=new Map,a={...Qne,...t.handlers},o={all:c,applyData:gie,definitionById:i,footnoteById:r,footnoteCounts:s,footnoteOrder:[],handlers:a,one:l,options:t,patch:mie,wrap:yie};return EN(n,function(u){if(u.type==="definition"||u.type==="footnoteDefinition"){const p=u.type==="definition"?i:r,m=String(u.identifier).toUpperCase();p.has(m)||p.set(m,u)}}),o;function l(u,p){const m=u.type,g=o.handlers[m];if(ZS.call(o.handlers,m)&&g)return g(o,u,p);if(o.options.passThrough&&o.options.passThrough.includes(m)){if("children"in u){const{children:v,...w}=u,k=px(w);return k.children=o.all(u),k}return px(u)}return(o.options.unknownHandler||bie)(o,u,p)}function c(u){const p=[];if("children"in u){const m=u.children;let g=-1;for(;++g<m.length;){const y=o.one(m[g],u);if(y){if(g&&m[g-1].type==="break"&&(!Array.isArray(y)&&y.type==="text"&&(y.value=$I(y.value)),!Array.isArray(y)&&y.type==="element")){const v=y.children[0];v&&v.type==="text"&&(v.value=$I(v.value))}Array.isArray(y)?p.push(...y):p.push(y)}}}return p}}function mie(n,e){n.position&&(e.position=ZZ(n))}function gie(n,e){let t=e;if(n&&n.data){const i=n.data.hName,r=n.data.hChildren,s=n.data.hProperties;if(typeof i=="string")if(t.type==="element")t.tagName=i;else{const a="children"in t?t.children:[t];t={type:"element",tagName:i,properties:{},children:a}}t.type==="element"&&s&&Object.assign(t.properties,px(s)),"children"in t&&t.children&&r!==null&&r!==void 0&&(t.children=r)}return t}function bie(n,e){const t=e.data||{},i="value"in e&&!(ZS.call(t,"hProperties")||ZS.call(t,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:n.all(e)};return n.patch(e,i),n.applyData(e,i)}function yie(n,e){const t=[];let i=-1;for(e&&t.push({type:"text",value:`
`});++i<n.length;)i&&t.push({type:"text",value:`
`}),t.push(n[i]);return e&&n.length>0&&t.push({type:"text",value:`
`}),t}function $I(n){let e=0,t=n.charCodeAt(e);for(;t===9||t===32;)e++,t=n.charCodeAt(e);return n.slice(e)}function WI(n,e){const t=fie(n,e),i=t.one(n,void 0),r=rie(t),s=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return r&&(te("children"in s),s.children.push({type:"text",value:`
`},r)),s}function vie(n,e){return n&&"run"in n?async function(t,i){const r=WI(t,{file:i,...e});await n.run(r,i)}:function(t,i){return WI(t,{file:i,...n||e})}}function HI(n){if(n)throw n}var f1,qI;function xie(){if(qI)return f1;qI=1;var n=Object.prototype.hasOwnProperty,e=Object.prototype.toString,t=Object.defineProperty,i=Object.getOwnPropertyDescriptor,r=function(c){return typeof Array.isArray=="function"?Array.isArray(c):e.call(c)==="[object Array]"},s=function(c){if(!c||e.call(c)!=="[object Object]")return!1;var u=n.call(c,"constructor"),p=c.constructor&&c.constructor.prototype&&n.call(c.constructor.prototype,"isPrototypeOf");if(c.constructor&&!u&&!p)return!1;var m;for(m in c);return typeof m>"u"||n.call(c,m)},a=function(c,u){t&&u.name==="__proto__"?t(c,u.name,{enumerable:!0,configurable:!0,value:u.newValue,writable:!0}):c[u.name]=u.newValue},o=function(c,u){if(u==="__proto__")if(n.call(c,u)){if(i)return i(c,u).value}else return;return c[u]};return f1=function l(){var c,u,p,m,g,y,v=arguments[0],w=1,k=arguments.length,S=!1;for(typeof v=="boolean"&&(S=v,v=arguments[1]||{},w=2),(v==null||typeof v!="object"&&typeof v!="function")&&(v={});w<k;++w)if(c=arguments[w],c!=null)for(u in c)p=o(v,u),m=o(c,u),v!==m&&(S&&m&&(s(m)||(g=r(m)))?(g?(g=!1,y=p&&r(p)?p:[]):y=p&&s(p)?p:{},a(v,{name:u,newValue:l(S,y,m)})):typeof m<"u"&&a(v,{name:u,newValue:m}));return v},f1}var wie=xie();const m1=Jf(wie);function eE(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}function kie(){const n=[],e={run:t,use:i};return e;function t(...r){let s=-1;const a=r.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);o(null,...r);function o(l,...c){const u=n[++s];let p=-1;if(l){a(l);return}for(;++p<r.length;)(c[p]===null||c[p]===void 0)&&(c[p]=r[p]);r=c,u?Die(u,o)(...c):a(null,...c)}}function i(r){if(typeof r!="function")throw new TypeError("Expected `middelware` to be a function, not "+r);return n.push(r),e}}function Die(n,e){let t;return i;function i(...a){const o=n.length>a.length;let l;o&&a.push(r);try{l=n.apply(this,a)}catch(c){const u=c;if(o&&t)throw u;return r(u)}o||(l&&l.then&&typeof l.then=="function"?l.then(s,r):l instanceof Error?r(l):s(l))}function r(a,...o){t||(t=!0,e(a,...o))}function s(a){r(null,a)}}const za={basename:Sie,dirname:Eie,extname:Nie,join:_ie,sep:"/"};function Sie(n,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');Ry(n);let t=0,i=-1,r=n.length,s;if(e===void 0||e.length===0||e.length>n.length){for(;r--;)if(n.codePointAt(r)===47){if(s){t=r+1;break}}else i<0&&(s=!0,i=r+1);return i<0?"":n.slice(t,i)}if(e===n)return"";let a=-1,o=e.length-1;for(;r--;)if(n.codePointAt(r)===47){if(s){t=r+1;break}}else a<0&&(s=!0,a=r+1),o>-1&&(n.codePointAt(r)===e.codePointAt(o--)?o<0&&(i=r):(o=-1,i=a));return t===i?i=a:i<0&&(i=n.length),n.slice(t,i)}function Eie(n){if(Ry(n),n.length===0)return".";let e=-1,t=n.length,i;for(;--t;)if(n.codePointAt(t)===47){if(i){e=t;break}}else i||(i=!0);return e<0?n.codePointAt(0)===47?"/":".":e===1&&n.codePointAt(0)===47?"//":n.slice(0,e)}function Nie(n){Ry(n);let e=n.length,t=-1,i=0,r=-1,s=0,a;for(;e--;){const o=n.codePointAt(e);if(o===47){if(a){i=e+1;break}continue}t<0&&(a=!0,t=e+1),o===46?r<0?r=e:s!==1&&(s=1):r>-1&&(s=-1)}return r<0||t<0||s===0||s===1&&r===t-1&&r===i+1?"":n.slice(r,t)}function _ie(...n){let e=-1,t;for(;++e<n.length;)Ry(n[e]),n[e]&&(t=t===void 0?n[e]:t+"/"+n[e]);return t===void 0?".":Cie(t)}function Cie(n){Ry(n);const e=n.codePointAt(0)===47;let t=Aie(n,!e);return t.length===0&&!e&&(t="."),t.length>0&&n.codePointAt(n.length-1)===47&&(t+="/"),e?"/"+t:t}function Aie(n,e){let t="",i=0,r=-1,s=0,a=-1,o,l;for(;++a<=n.length;){if(a<n.length)o=n.codePointAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||s===1))if(r!==a-1&&s===2){if(t.length<2||i!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(l=t.lastIndexOf("/"),l!==t.length-1){l<0?(t="",i=0):(t=t.slice(0,l),i=t.length-1-t.lastIndexOf("/")),r=a,s=0;continue}}else if(t.length>0){t="",i=0,r=a,s=0;continue}}e&&(t=t.length>0?t+"/..":"..",i=2)}else t.length>0?t+="/"+n.slice(r+1,a):t=n.slice(r+1,a),i=a-r-1;r=a,s=0}else o===46&&s>-1?s++:s=-1}return t}function Ry(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}const Pie={cwd:Tie};function Tie(){return"/"}function tE(n){return!!(n!==null&&typeof n=="object"&&"href"in n&&n.href&&"protocol"in n&&n.protocol&&n.auth===void 0)}function Iie(n){if(typeof n=="string")n=new URL(n);else if(!tE(n)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+n+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(n.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return Rie(n)}function Rie(n){if(n.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const e=n.pathname;let t=-1;for(;++t<e.length;)if(e.codePointAt(t)===37&&e.codePointAt(t+1)===50){const i=e.codePointAt(t+2);if(i===70||i===102){const r=new TypeError("File URL path must not include encoded / characters");throw r.code="ERR_INVALID_FILE_URL_PATH",r}}return decodeURIComponent(e)}const g1=["history","path","basename","stem","extname","dirname"];class b2{constructor(e){let t;e?tE(e)?t={path:e}:typeof e=="string"||Mie(e)?t={value:e}:t=e:t={},this.cwd="cwd"in t?"":Pie.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<g1.length;){const s=g1[i];s in t&&t[s]!==void 0&&t[s]!==null&&(this[s]=s==="history"?[...t[s]]:t[s])}let r;for(r in t)g1.includes(r)||(this[r]=t[r])}get basename(){return typeof this.path=="string"?za.basename(this.path):void 0}set basename(e){y1(e,"basename"),b1(e,"basename"),this.path=za.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?za.dirname(this.path):void 0}set dirname(e){GI(this.basename,"dirname"),this.path=za.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?za.extname(this.path):void 0}set extname(e){if(b1(e,"extname"),GI(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=za.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){tE(e)&&(e=Iie(e)),y1(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?za.basename(this.path,this.extname):void 0}set stem(e){y1(e,"stem"),b1(e,"stem"),this.path=za.join(this.dirname||"",e+(this.extname||""))}fail(e,t,i){const r=this.message(e,t,i);throw r.fatal=!0,r}info(e,t,i){const r=this.message(e,t,i);return r.fatal=void 0,r}message(e,t,i){const r=new gr(e,t,i);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function b1(n,e){if(n&&n.includes(za.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+za.sep+"`")}function y1(n,e){if(!n)throw new Error("`"+e+"` cannot be empty")}function GI(n,e){if(!n)throw new Error("Setting `"+e+"` requires `path` to be set too")}function Mie(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const jie=function(n){const i=this.constructor.prototype,r=i[n],s=function(){return r.apply(s,arguments)};return Object.setPrototypeOf(s,i),s},Oie={}.hasOwnProperty;class NN extends jie{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=kie()}copy(){const e=new NN;let t=-1;for(;++t<this.attachers.length;){const i=this.attachers[t];e.use(...i)}return e.data(m1(!0,{},this.namespace)),e}data(e,t){return typeof e=="string"?arguments.length===2?(w1("data",this.frozen),this.namespace[e]=t,this):Oie.call(this.namespace,e)&&this.namespace[e]||void 0:e?(w1("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const r=t.call(e,...i);typeof r=="function"&&this.transformers.use(r)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=Qv(e),i=this.parser||this.Parser;return v1("parse",i),i(String(t),t)}process(e,t){const i=this;return this.freeze(),v1("process",this.parser||this.Parser),x1("process",this.compiler||this.Compiler),t?r(void 0,t):new Promise(r);function r(s,a){const o=Qv(e),l=i.parse(o);i.run(l,o,function(u,p,m){if(u||!p||!m)return c(u);const g=p,y=i.stringify(g,m);Vie(y)?m.value=y:m.result=y,c(u,m)});function c(u,p){u||!p?a(u):s?s(p):(te(t,"`done` is defined if `resolve` is not"),t(void 0,p))}}}processSync(e){let t=!1,i;return this.freeze(),v1("processSync",this.parser||this.Parser),x1("processSync",this.compiler||this.Compiler),this.process(e,r),XI("processSync","process",t),te(i,"we either bailed on an error or have a tree"),i;function r(s,a){t=!0,HI(s),i=a}}run(e,t,i){YI(e),this.freeze();const r=this.transformers;return!i&&typeof t=="function"&&(i=t,t=void 0),i?s(void 0,i):new Promise(s);function s(a,o){te(typeof t!="function","`file` can’t be a `done` anymore, we checked");const l=Qv(t);r.run(e,l,c);function c(u,p,m){const g=p||e;u?o(u):a?a(g):(te(i,"`done` is defined if `resolve` is not"),i(void 0,g,m))}}}runSync(e,t){let i=!1,r;return this.run(e,t,s),XI("runSync","run",i),te(r,"we either bailed on an error or have a tree"),r;function s(a,o){HI(a),r=o,i=!0}}stringify(e,t){this.freeze();const i=Qv(t),r=this.compiler||this.Compiler;return x1("stringify",r),YI(e),r(e,i)}use(e,...t){const i=this.attachers,r=this.namespace;if(w1("use",this.frozen),e!=null)if(typeof e=="function")l(e,t);else if(typeof e=="object")Array.isArray(e)?o(e):a(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function s(c){if(typeof c=="function")l(c,[]);else if(typeof c=="object")if(Array.isArray(c)){const[u,...p]=c;l(u,p)}else a(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function a(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(c.plugins),c.settings&&(r.settings=m1(!0,r.settings,c.settings))}function o(c){let u=-1;if(c!=null)if(Array.isArray(c))for(;++u<c.length;){const p=c[u];s(p)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function l(c,u){let p=-1,m=-1;for(;++p<i.length;)if(i[p][0]===c){m=p;break}if(m===-1)i.push([c,...u]);else if(u.length>0){let[g,...y]=u;const v=i[m][1];eE(v)&&eE(g)&&(g=m1(!0,v,g)),i[m]=[c,g,...y]}}}}const Lie=new NN().freeze();function v1(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `parser`")}function x1(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `compiler`")}function w1(n,e){if(e)throw new Error("Cannot call `"+n+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function YI(n){if(!eE(n)||typeof n.type!="string")throw new TypeError("Expected node, got `"+n+"`")}function XI(n,e,t){if(!t)throw new Error("`"+n+"` finished async. Use `"+e+"` instead")}function Qv(n){return Fie(n)?n:new b2(n)}function Fie(n){return!!(n&&typeof n=="object"&&"message"in n&&"messages"in n)}function Vie(n){return typeof n=="string"||Uie(n)}function Uie(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const zie="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",KI=[],QI={allowDangerousHtml:!0},Bie=/^(https?|ircs?|mailto|xmpp)$/i,$ie=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Wie(n){const e=Hie(n),t=qie(n);return Gie(e.runSync(e.parse(t),t),n)}function Hie(n){const e=n.rehypePlugins||KI,t=n.remarkPlugins||KI,i=n.remarkRehypeOptions?{...n.remarkRehypeOptions,...QI}:QI;return Lie().use(Ene).use(t).use(vie,i).use(e)}function qie(n){const e=n.children||"",t=new b2;return typeof e=="string"?t.value=e:HS("Unexpected value `"+e+"` for `children` prop, expected `string`"),t}function Gie(n,e){const t=e.allowedElements,i=e.allowElement,r=e.components,s=e.disallowedElements,a=e.skipHtml,o=e.unwrapDisallowed,l=e.urlTransform||Yie;for(const u of $ie)Object.hasOwn(e,u.from)&&HS("Unexpected `"+u.from+"` prop, "+(u.to?"use `"+u.to+"` instead":"remove it")+" (see <"+zie+"#"+u.id+"> for more info)");return t&&s&&HS("Unexpected combined `allowedElements` and `disallowedElements`, expected one or the other"),EN(n,c),ree(n,{Fragment:pe.Fragment,components:r,ignoreInvalidStyle:!0,jsx:pe.jsx,jsxs:pe.jsxs,passKeys:!0,passNode:!0});function c(u,p,m){if(u.type==="raw"&&m&&typeof p=="number")return a?m.children.splice(p,1):m.children[p]={type:"text",value:u.value},p;if(u.type==="element"){let g;for(g in c1)if(Object.hasOwn(c1,g)&&Object.hasOwn(u.properties,g)){const y=u.properties[g],v=c1[g];(v===null||v.includes(u.tagName))&&(u.properties[g]=l(String(y||""),g,u))}}if(u.type==="element"){let g=t?!t.includes(u.tagName):s?s.includes(u.tagName):!1;if(!g&&i&&typeof p=="number"&&(g=!i(u,p,m)),g&&m&&typeof p=="number")return o&&u.children?m.children.splice(p,1,...u.children):m.children.splice(p,1),p}}}function Yie(n){const e=n.indexOf(":"),t=n.indexOf("?"),i=n.indexOf("#"),r=n.indexOf("/");return e===-1||r!==-1&&e>r||t!==-1&&e>t||i!==-1&&e>i||Bie.test(n.slice(0,e))?n:""}function JI(n,e){const t=String(n);if(typeof e!="string")throw new TypeError("Expected character");let i=0,r=t.indexOf(e);for(;r!==-1;)i++,r=t.indexOf(e,r+e.length);return i}function Xie(n){if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function Kie(n,e,t){const r=dw((t||{}).ignore||[]),s=Qie(e);let a=-1;for(;++a<s.length;)g2(n,"text",o);function o(c,u){let p=-1,m;for(;++p<u.length;){const g=u[p],y=m?m.children:void 0;if(r(g,y?y.indexOf(g):void 0,m))return;m=g}if(m)return l(c,u)}function l(c,u){const p=u[u.length-1],m=s[a][0],g=s[a][1];let y=0;const w=p.children.indexOf(c);let k=!1,S=[];m.lastIndex=0;let E=m.exec(c.value);for(;E;){const P=E.index,A={index:E.index,input:E.input,stack:[...u,c]};let N=g(...E,A);if(typeof N=="string"&&(N=N.length>0?{type:"text",value:N}:void 0),N===!1?m.lastIndex=P+1:(y!==P&&S.push({type:"text",value:c.value.slice(y,P)}),Array.isArray(N)?S.push(...N):N&&S.push(N),y=P+E[0].length,k=!0),!m.global)break;E=m.exec(c.value)}return k?(y<c.value.length&&S.push({type:"text",value:c.value.slice(y)}),p.children.splice(w,1,...S)):S=[c],w+S.length}}function Qie(n){const e=[];if(!Array.isArray(n))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!n[0]||Array.isArray(n[0])?n:[n];let i=-1;for(;++i<t.length;){const r=t[i];e.push([Jie(r[0]),Zie(r[1])])}return e}function Jie(n){return typeof n=="string"?new RegExp(Xie(n),"g"):n}function Zie(n){return typeof n=="function"?n:function(){return n}}const k1="phrasing",D1=["autolink","link","image","label"];function ere(){return{transforms:[ore],enter:{literalAutolink:nre,literalAutolinkEmail:S1,literalAutolinkHttp:S1,literalAutolinkWww:S1},exit:{literalAutolink:are,literalAutolinkEmail:sre,literalAutolinkHttp:ire,literalAutolinkWww:rre}}}function tre(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:k1,notInConstruct:D1},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:k1,notInConstruct:D1},{character:":",before:"[ps]",after:"\\/",inConstruct:k1,notInConstruct:D1}]}}function nre(n){this.enter({type:"link",title:null,url:"",children:[]},n)}function S1(n){this.config.enter.autolinkProtocol.call(this,n)}function ire(n){this.config.exit.autolinkProtocol.call(this,n)}function rre(n){this.config.exit.data.call(this,n);const e=this.stack[this.stack.length-1];te(e.type==="link"),e.url="http://"+this.sliceSerialize(n)}function sre(n){this.config.exit.autolinkEmail.call(this,n)}function are(n){this.exit(n)}function ore(n){Kie(n,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,lre],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),cre]],{ignore:["link","linkReference"]})}function lre(n,e,t,i,r){let s="";if(!y2(r)||(/^w/i.test(e)&&(t=e+t,e="",s="http://"),!ure(t)))return!1;const a=dre(t+i);if(!a[0])return!1;const o={type:"link",title:null,url:s+e+a[0],children:[{type:"text",value:e+a[0]}]};return a[1]?[o,{type:"text",value:a[1]}]:o}function cre(n,e,t,i){return!y2(i,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+t,children:[{type:"text",value:e+"@"+t}]}}function ure(n){const e=n.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function dre(n){const e=/[!"&'),.:;<>?\]}]+$/.exec(n);if(!e)return[n,void 0];n=n.slice(0,e.index);let t=e[0],i=t.indexOf(")");const r=JI(n,"(");let s=JI(n,")");for(;i!==-1&&r>s;)n+=t.slice(0,i+1),t=t.slice(i+1),i=t.indexOf(")"),s++;return[n,t]}function y2(n,e){const t=n.input.charCodeAt(n.index-1);return(n.index===0||ah(t)||lw(t))&&(!e||t!==47)}v2.peek=xre;function hre(){this.buffer()}function pre(n){this.enter({type:"footnoteReference",identifier:"",label:""},n)}function fre(){this.buffer()}function mre(n){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},n)}function gre(n){const e=this.resume(),t=this.stack[this.stack.length-1];te(t.type==="footnoteReference"),t.identifier=Ca(this.sliceSerialize(n)).toLowerCase(),t.label=e}function bre(n){this.exit(n)}function yre(n){const e=this.resume(),t=this.stack[this.stack.length-1];te(t.type==="footnoteDefinition"),t.identifier=Ca(this.sliceSerialize(n)).toLowerCase(),t.label=e}function vre(n){this.exit(n)}function xre(){return"["}function v2(n,e,t,i){const r=t.createTracker(i);let s=r.move("[^");const a=t.enter("footnoteReference"),o=t.enter("reference");return s+=r.move(t.safe(t.associationId(n),{after:"]",before:s})),o(),a(),s+=r.move("]"),s}function wre(){return{enter:{gfmFootnoteCallString:hre,gfmFootnoteCall:pre,gfmFootnoteDefinitionLabelString:fre,gfmFootnoteDefinition:mre},exit:{gfmFootnoteCallString:gre,gfmFootnoteCall:bre,gfmFootnoteDefinitionLabelString:yre,gfmFootnoteDefinition:vre}}}function kre(n){let e=!1;return n&&n.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:t,footnoteReference:v2},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(i,r,s,a){const o=s.createTracker(a);let l=o.move("[^");const c=s.enter("footnoteDefinition"),u=s.enter("label");return l+=o.move(s.safe(s.associationId(i),{before:l,after:"]"})),u(),l+=o.move("]:"),i.children&&i.children.length>0&&(o.shift(4),l+=o.move((e?`
`:" ")+s.indentLines(s.containerFlow(i,o.current()),e?x2:Dre))),c(),l}}function Dre(n,e,t){return e===0?n:x2(n,e,t)}function x2(n,e,t){return(t?"":"    ")+n}const Sre=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];w2.peek=Are;function Ere(){return{canContainEols:["delete"],enter:{strikethrough:_re},exit:{strikethrough:Cre}}}function Nre(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:Sre}],handlers:{delete:w2}}}function _re(n){this.enter({type:"delete",children:[]},n)}function Cre(n){this.exit(n)}function w2(n,e,t,i){const r=t.createTracker(i),s=t.enter("strikethrough");let a=r.move("~~");return a+=t.containerPhrasing(n,{...r.current(),before:a,after:"~"}),a+=r.move("~~"),s(),a}function Are(){return"~"}function Pre(n){return n.length}function Tre(n,e){const t=e||{},i=(t.align||[]).concat(),r=t.stringLength||Pre,s=[],a=[],o=[],l=[];let c=0,u=-1;for(;++u<n.length;){const v=[],w=[];let k=-1;for(n[u].length>c&&(c=n[u].length);++k<n[u].length;){const S=Ire(n[u][k]);if(t.alignDelimiters!==!1){const E=r(S);w[k]=E,(l[k]===void 0||E>l[k])&&(l[k]=E)}v.push(S)}a[u]=v,o[u]=w}let p=-1;if(typeof i=="object"&&"length"in i)for(;++p<c;)s[p]=ZI(i[p]);else{const v=ZI(i);for(;++p<c;)s[p]=v}p=-1;const m=[],g=[];for(;++p<c;){const v=s[p];let w="",k="";v===99?(w=":",k=":"):v===108?w=":":v===114&&(k=":");let S=t.alignDelimiters===!1?1:Math.max(1,l[p]-w.length-k.length);const E=w+"-".repeat(S)+k;t.alignDelimiters!==!1&&(S=w.length+S+k.length,S>l[p]&&(l[p]=S),g[p]=S),m[p]=E}a.splice(1,0,m),o.splice(1,0,g),u=-1;const y=[];for(;++u<a.length;){const v=a[u],w=o[u];p=-1;const k=[];for(;++p<c;){const S=v[p]||"";let E="",P="";if(t.alignDelimiters!==!1){const A=l[p]-(w[p]||0),N=s[p];N===114?E=" ".repeat(A):N===99?A%2?(E=" ".repeat(A/2+.5),P=" ".repeat(A/2-.5)):(E=" ".repeat(A/2),P=E):P=" ".repeat(A)}t.delimiterStart!==!1&&!p&&k.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&S==="")&&(t.delimiterStart!==!1||p)&&k.push(" "),t.alignDelimiters!==!1&&k.push(E),k.push(S),t.alignDelimiters!==!1&&k.push(P),t.padding!==!1&&k.push(" "),(t.delimiterEnd!==!1||p!==c-1)&&k.push("|")}y.push(t.delimiterEnd===!1?k.join("").replace(/ +$/,""):k.join(""))}return y.join(`
`)}function Ire(n){return n==null?"":String(n)}function ZI(n){const e=typeof n=="string"?n.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function Rre(n,e,t,i){const r=t.enter("blockquote"),s=t.createTracker(i);s.move("> "),s.shift(2);const a=t.indentLines(t.containerFlow(n,s.current()),Mre);return r(),a}function Mre(n,e,t){return">"+(t?"":" ")+n}function jre(n,e){return eR(n,e.inConstruct,!0)&&!eR(n,e.notInConstruct,!1)}function eR(n,e,t){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return t;let i=-1;for(;++i<e.length;)if(n.includes(e[i]))return!0;return!1}function tR(n,e,t,i){let r=-1;for(;++r<t.unsafe.length;)if(t.unsafe[r].character===`
`&&jre(t.stack,t.unsafe[r]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function Ore(n,e){const t=String(n);let i=t.indexOf(e),r=i,s=0,a=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===r?++s>a&&(a=s):s=1,r=i+e.length,i=t.indexOf(e,r);return a}function Lre(n,e){return!!(e.options.fences===!1&&n.value&&!n.lang&&/[^ \r\n]/.test(n.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(n.value))}function Fre(n){const e=n.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function Vre(n,e,t,i){const r=Fre(t),s=n.value||"",a=r==="`"?"GraveAccent":"Tilde";if(Lre(n,t)){const p=t.enter("codeIndented"),m=t.indentLines(s,Ure);return p(),m}const o=t.createTracker(i),l=r.repeat(Math.max(Ore(s,r)+1,3)),c=t.enter("codeFenced");let u=o.move(l);if(n.lang){const p=t.enter(`codeFencedLang${a}`);u+=o.move(t.safe(n.lang,{before:u,after:" ",encode:["`"],...o.current()})),p()}if(n.lang&&n.meta){const p=t.enter(`codeFencedMeta${a}`);u+=o.move(" "),u+=o.move(t.safe(n.meta,{before:u,after:`
`,encode:["`"],...o.current()})),p()}return u+=o.move(`
`),s&&(u+=o.move(s+`
`)),u+=o.move(l),c(),u}function Ure(n,e,t){return(t?"":"    ")+n}function _N(n){const e=n.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function zre(n,e,t,i){const r=_N(t),s=r==='"'?"Quote":"Apostrophe",a=t.enter("definition");let o=t.enter("label");const l=t.createTracker(i);let c=l.move("[");return c+=l.move(t.safe(t.associationId(n),{before:c,after:"]",...l.current()})),c+=l.move("]: "),o(),!n.url||/[\0- \u007F]/.test(n.url)?(o=t.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(t.safe(n.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(o=t.enter("destinationRaw"),c+=l.move(t.safe(n.url,{before:c,after:n.title?" ":`
`,...l.current()}))),o(),n.title&&(o=t.enter(`title${s}`),c+=l.move(" "+r),c+=l.move(t.safe(n.title,{before:c,after:r,...l.current()})),c+=l.move(r),o()),a(),c}function Bre(n){const e=n.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}function jg(n){return"&#x"+n.toString(16).toUpperCase()+";"}function fx(n,e,t){const i=Qf(n),r=Qf(e);return i===void 0?r===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}k2.peek=$re;function k2(n,e,t,i){const r=Bre(t),s=t.enter("emphasis"),a=t.createTracker(i),o=a.move(r);let l=a.move(t.containerPhrasing(n,{after:r,before:o,...a.current()}));const c=l.charCodeAt(0),u=fx(i.before.charCodeAt(i.before.length-1),c,r);u.inside&&(l=jg(c)+l.slice(1));const p=l.charCodeAt(l.length-1),m=fx(i.after.charCodeAt(0),p,r);m.inside&&(l=l.slice(0,-1)+jg(p));const g=a.move(r);return s(),t.attentionEncodeSurroundingInfo={after:m.outside,before:u.outside},o+l+g}function $re(n,e,t){return t.options.emphasis||"*"}function Wre(n,e){let t=!1;return EN(n,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return t=!0,JS}),!!((!n.depth||n.depth<3)&&yN(n)&&(e.options.setext||t))}function Hre(n,e,t,i){const r=Math.max(Math.min(6,n.depth||1),1),s=t.createTracker(i);if(Wre(n,t)){const u=t.enter("headingSetext"),p=t.enter("phrasing"),m=t.containerPhrasing(n,{...s.current(),before:`
`,after:`
`});return p(),u(),m+`
`+(r===1?"=":"-").repeat(m.length-(Math.max(m.lastIndexOf("\r"),m.lastIndexOf(`
`))+1))}const a="#".repeat(r),o=t.enter("headingAtx"),l=t.enter("phrasing");s.move(a+" ");let c=t.containerPhrasing(n,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(c)&&(c=jg(c.charCodeAt(0))+c.slice(1)),c=c?a+" "+c:a,t.options.closeAtx&&(c+=" "+a),l(),o(),c}D2.peek=qre;function D2(n){return n.value||""}function qre(){return"<"}S2.peek=Gre;function S2(n,e,t,i){const r=_N(t),s=r==='"'?"Quote":"Apostrophe",a=t.enter("image");let o=t.enter("label");const l=t.createTracker(i);let c=l.move("![");return c+=l.move(t.safe(n.alt,{before:c,after:"]",...l.current()})),c+=l.move("]("),o(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(o=t.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(t.safe(n.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(o=t.enter("destinationRaw"),c+=l.move(t.safe(n.url,{before:c,after:n.title?" ":")",...l.current()}))),o(),n.title&&(o=t.enter(`title${s}`),c+=l.move(" "+r),c+=l.move(t.safe(n.title,{before:c,after:r,...l.current()})),c+=l.move(r),o()),c+=l.move(")"),a(),c}function Gre(){return"!"}E2.peek=Yre;function E2(n,e,t,i){const r=n.referenceType,s=t.enter("imageReference");let a=t.enter("label");const o=t.createTracker(i);let l=o.move("![");const c=t.safe(n.alt,{before:l,after:"]",...o.current()});l+=o.move(c+"]["),a();const u=t.stack;t.stack=[],a=t.enter("reference");const p=t.safe(t.associationId(n),{before:l,after:"]",...o.current()});return a(),t.stack=u,s(),r==="full"||!c||c!==p?l+=o.move(p+"]"):r==="shortcut"?l=l.slice(0,-1):l+=o.move("]"),l}function Yre(){return"!"}N2.peek=Xre;function N2(n,e,t){let i=n.value||"",r="`",s=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(i);)r+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++s<t.unsafe.length;){const a=t.unsafe[s],o=t.compilePattern(a);let l;if(a.atBreak)for(;l=o.exec(i);){let c=l.index;i.charCodeAt(c)===10&&i.charCodeAt(c-1)===13&&c--,i=i.slice(0,c)+" "+i.slice(l.index+1)}}return r+i+r}function Xre(){return"`"}function _2(n,e){const t=yN(n);return!!(!e.options.resourceLink&&n.url&&!n.title&&n.children&&n.children.length===1&&n.children[0].type==="text"&&(t===n.url||"mailto:"+t===n.url)&&/^[a-z][a-z+.-]+:/i.test(n.url)&&!/[\0- <>\u007F]/.test(n.url))}C2.peek=Kre;function C2(n,e,t,i){const r=_N(t),s=r==='"'?"Quote":"Apostrophe",a=t.createTracker(i);let o,l;if(_2(n,t)){const u=t.stack;t.stack=[],o=t.enter("autolink");let p=a.move("<");return p+=a.move(t.containerPhrasing(n,{before:p,after:">",...a.current()})),p+=a.move(">"),o(),t.stack=u,p}o=t.enter("link"),l=t.enter("label");let c=a.move("[");return c+=a.move(t.containerPhrasing(n,{before:c,after:"](",...a.current()})),c+=a.move("]("),l(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(l=t.enter("destinationLiteral"),c+=a.move("<"),c+=a.move(t.safe(n.url,{before:c,after:">",...a.current()})),c+=a.move(">")):(l=t.enter("destinationRaw"),c+=a.move(t.safe(n.url,{before:c,after:n.title?" ":")",...a.current()}))),l(),n.title&&(l=t.enter(`title${s}`),c+=a.move(" "+r),c+=a.move(t.safe(n.title,{before:c,after:r,...a.current()})),c+=a.move(r),l()),c+=a.move(")"),o(),c}function Kre(n,e,t){return _2(n,t)?"<":"["}A2.peek=Qre;function A2(n,e,t,i){const r=n.referenceType,s=t.enter("linkReference");let a=t.enter("label");const o=t.createTracker(i);let l=o.move("[");const c=t.containerPhrasing(n,{before:l,after:"]",...o.current()});l+=o.move(c+"]["),a();const u=t.stack;t.stack=[],a=t.enter("reference");const p=t.safe(t.associationId(n),{before:l,after:"]",...o.current()});return a(),t.stack=u,s(),r==="full"||!c||c!==p?l+=o.move(p+"]"):r==="shortcut"?l=l.slice(0,-1):l+=o.move("]"),l}function Qre(){return"["}function CN(n){const e=n.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function Jre(n){const e=CN(n),t=n.options.bulletOther;if(!t)return e==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+t+"`) to be different");return t}function Zre(n){const e=n.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function P2(n){const e=n.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function ese(n,e,t,i){const r=t.enter("list"),s=t.bulletCurrent;let a=n.ordered?Zre(t):CN(t);const o=n.ordered?a==="."?")":".":Jre(t);let l=e&&t.bulletLastUsed?a===t.bulletLastUsed:!1;if(!n.ordered){const u=n.children?n.children[0]:void 0;if((a==="*"||a==="-")&&u&&(!u.children||!u.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(l=!0),P2(t)===a&&u){let p=-1;for(;++p<n.children.length;){const m=n.children[p];if(m&&m.type==="listItem"&&m.children&&m.children[0]&&m.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(a=o),t.bulletCurrent=a;const c=t.containerFlow(n,i);return t.bulletLastUsed=a,t.bulletCurrent=s,r(),c}function tse(n){const e=n.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function nse(n,e,t,i){const r=tse(t);let s=t.bulletCurrent||CN(t);e&&e.type==="list"&&e.ordered&&(s=(typeof e.start=="number"&&e.start>-1?e.start:1)+(t.options.incrementListMarker===!1?0:e.children.indexOf(n))+s);let a=s.length+1;(r==="tab"||r==="mixed"&&(e&&e.type==="list"&&e.spread||n.spread))&&(a=Math.ceil(a/4)*4);const o=t.createTracker(i);o.move(s+" ".repeat(a-s.length)),o.shift(a);const l=t.enter("listItem"),c=t.indentLines(t.containerFlow(n,o.current()),u);return l(),c;function u(p,m,g){return m?(g?"":" ".repeat(a))+p:(g?s:s+" ".repeat(a-s.length))+p}}function ise(n,e,t,i){const r=t.enter("paragraph"),s=t.enter("phrasing"),a=t.containerPhrasing(n,i);return s(),r(),a}const rse=dw(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function sse(n,e,t,i){return(n.children.some(function(a){return rse(a)})?t.containerPhrasing:t.containerFlow).call(t,n,i)}function ase(n){const e=n.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}T2.peek=ose;function T2(n,e,t,i){const r=ase(t),s=t.enter("strong"),a=t.createTracker(i),o=a.move(r+r);let l=a.move(t.containerPhrasing(n,{after:r,before:o,...a.current()}));const c=l.charCodeAt(0),u=fx(i.before.charCodeAt(i.before.length-1),c,r);u.inside&&(l=jg(c)+l.slice(1));const p=l.charCodeAt(l.length-1),m=fx(i.after.charCodeAt(0),p,r);m.inside&&(l=l.slice(0,-1)+jg(p));const g=a.move(r+r);return s(),t.attentionEncodeSurroundingInfo={after:m.outside,before:u.outside},o+l+g}function ose(n,e,t){return t.options.strong||"*"}function lse(n,e,t,i){return t.safe(n.value,i)}function cse(n){const e=n.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function use(n,e,t){const i=(P2(t)+(t.options.ruleSpaces?" ":"")).repeat(cse(t));return t.options.ruleSpaces?i.slice(0,-1):i}const I2={blockquote:Rre,break:tR,code:Vre,definition:zre,emphasis:k2,hardBreak:tR,heading:Hre,html:D2,image:S2,imageReference:E2,inlineCode:N2,link:C2,linkReference:A2,list:ese,listItem:nse,paragraph:ise,root:sse,strong:T2,text:lse,thematicBreak:use};function dse(){return{enter:{table:hse,tableData:nR,tableHeader:nR,tableRow:fse},exit:{codeText:mse,table:pse,tableData:E1,tableHeader:E1,tableRow:E1}}}function hse(n){const e=n._align;te(e,"expected `_align` on table"),this.enter({type:"table",align:e.map(function(t){return t==="none"?null:t}),children:[]},n),this.data.inTable=!0}function pse(n){this.exit(n),this.data.inTable=void 0}function fse(n){this.enter({type:"tableRow",children:[]},n)}function E1(n){this.exit(n)}function nR(n){this.enter({type:"tableCell",children:[]},n)}function mse(n){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,gse));const t=this.stack[this.stack.length-1];te(t.type==="inlineCode"),t.value=e,this.exit(n)}function gse(n,e){return e==="|"?e:n}function bse(n){const e=n||{},t=e.tableCellPadding,i=e.tablePipeAlign,r=e.stringLength,s=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:m,table:a,tableCell:l,tableRow:o}};function a(g,y,v,w){return c(u(g,v,w),g.align)}function o(g,y,v,w){const k=p(g,v,w),S=c([k]);return S.slice(0,S.indexOf(`
`))}function l(g,y,v,w){const k=v.enter("tableCell"),S=v.enter("phrasing"),E=v.containerPhrasing(g,{...w,before:s,after:s});return S(),k(),E}function c(g,y){return Tre(g,{align:y,alignDelimiters:i,padding:t,stringLength:r})}function u(g,y,v){const w=g.children;let k=-1;const S=[],E=y.enter("table");for(;++k<w.length;)S[k]=p(w[k],y,v);return E(),S}function p(g,y,v){const w=g.children;let k=-1;const S=[],E=y.enter("tableRow");for(;++k<w.length;)S[k]=l(w[k],g,y,v);return E(),S}function m(g,y,v){let w=I2.inlineCode(g,y,v);return v.stack.includes("tableCell")&&(w=w.replace(/\|/g,"\\$&")),w}}function yse(){return{exit:{taskListCheckValueChecked:iR,taskListCheckValueUnchecked:iR,paragraph:xse}}}function vse(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:wse}}}function iR(n){const e=this.stack[this.stack.length-2];te(e.type==="listItem"),e.checked=n.type==="taskListCheckValueChecked"}function xse(n){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const t=this.stack[this.stack.length-1];te(t.type==="paragraph");const i=t.children[0];if(i&&i.type==="text"){const r=e.children;let s=-1,a;for(;++s<r.length;){const o=r[s];if(o.type==="paragraph"){a=o;break}}a===t&&(i.value=i.value.slice(1),i.value.length===0?t.children.shift():t.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,t.position.start=Object.assign({},i.position.start)))}}this.exit(n)}function wse(n,e,t,i){const r=n.children[0],s=typeof n.checked=="boolean"&&r&&r.type==="paragraph",a="["+(n.checked?"x":" ")+"] ",o=t.createTracker(i);s&&o.move(a);let l=I2.listItem(n,e,t,{...i,...o.current()});return s&&(l=l.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),l;function c(u){return u+a}}function kse(){return[ere(),wre(),Ere(),dse(),yse()]}function Dse(n){return{extensions:[tre(),kre(n),Nre(),bse(n),vse()]}}const Sse={tokenize:Pse,partial:!0},R2={tokenize:Tse,partial:!0},M2={tokenize:Ise,partial:!0},j2={tokenize:Rse,partial:!0},Ese={tokenize:Mse,partial:!0},O2={name:"wwwAutolink",tokenize:Cse,previous:F2},L2={name:"protocolAutolink",tokenize:Ase,previous:V2},_l={name:"emailAutolink",tokenize:_se,previous:U2},yo={};function Nse(){return{text:yo}}let Nu=I.digit0;for(;Nu<I.leftCurlyBrace;)yo[Nu]=_l,Nu++,Nu===I.colon?Nu=I.uppercaseA:Nu===I.leftSquareBracket&&(Nu=I.lowercaseA);yo[I.plusSign]=_l;yo[I.dash]=_l;yo[I.dot]=_l;yo[I.underscore]=_l;yo[I.uppercaseH]=[_l,L2];yo[I.lowercaseH]=[_l,L2];yo[I.uppercaseW]=[_l,O2];yo[I.lowercaseW]=[_l,O2];function _se(n,e,t){const i=this;let r,s;return a;function a(p){return!nE(p)||!U2.call(i,i.previous)||AN(i.events)?t(p):(n.enter("literalAutolink"),n.enter("literalAutolinkEmail"),o(p))}function o(p){return nE(p)?(n.consume(p),o):p===I.atSign?(n.consume(p),l):t(p)}function l(p){return p===I.dot?n.check(Ese,u,c)(p):p===I.dash||p===I.underscore||mr(p)?(s=!0,n.consume(p),l):u(p)}function c(p){return n.consume(p),r=!0,l}function u(p){return s&&r&&Tr(i.previous)?(n.exit("literalAutolinkEmail"),n.exit("literalAutolink"),e(p)):t(p)}}function Cse(n,e,t){const i=this;return r;function r(a){return a!==I.uppercaseW&&a!==I.lowercaseW||!F2.call(i,i.previous)||AN(i.events)?t(a):(n.enter("literalAutolink"),n.enter("literalAutolinkWww"),n.check(Sse,n.attempt(R2,n.attempt(M2,s),t),t)(a))}function s(a){return n.exit("literalAutolinkWww"),n.exit("literalAutolink"),e(a)}}function Ase(n,e,t){const i=this;let r="",s=!1;return a;function a(p){return(p===I.uppercaseH||p===I.lowercaseH)&&V2.call(i,i.previous)&&!AN(i.events)?(n.enter("literalAutolink"),n.enter("literalAutolinkHttp"),r+=String.fromCodePoint(p),n.consume(p),o):t(p)}function o(p){if(Tr(p)&&r.length<5)return r+=String.fromCodePoint(p),n.consume(p),o;if(p===I.colon){const m=r.toLowerCase();if(m==="http"||m==="https")return n.consume(p),l}return t(p)}function l(p){return p===I.slash?(n.consume(p),s?c:(s=!0,l)):t(p)}function c(p){return p===I.eof||dx(p)||Nn(p)||ah(p)||lw(p)?t(p):n.attempt(R2,n.attempt(M2,u),t)(p)}function u(p){return n.exit("literalAutolinkHttp"),n.exit("literalAutolink"),e(p)}}function Pse(n,e,t){let i=0;return r;function r(a){return(a===I.uppercaseW||a===I.lowercaseW)&&i<3?(i++,n.consume(a),r):a===I.dot&&i===3?(n.consume(a),s):t(a)}function s(a){return a===I.eof?t(a):e(a)}}function Tse(n,e,t){let i,r,s;return a;function a(c){return c===I.dot||c===I.underscore?n.check(j2,l,o)(c):c===I.eof||Nn(c)||ah(c)||c!==I.dash&&lw(c)?l(c):(s=!0,n.consume(c),a)}function o(c){return c===I.underscore?i=!0:(r=i,i=void 0),n.consume(c),a}function l(c){return r||i||!s?t(c):e(c)}}function Ise(n,e){let t=0,i=0;return r;function r(a){return a===I.leftParenthesis?(t++,n.consume(a),r):a===I.rightParenthesis&&i<t?s(a):a===I.exclamationMark||a===I.quotationMark||a===I.ampersand||a===I.apostrophe||a===I.rightParenthesis||a===I.asterisk||a===I.comma||a===I.dot||a===I.colon||a===I.semicolon||a===I.lessThan||a===I.questionMark||a===I.rightSquareBracket||a===I.underscore||a===I.tilde?n.check(j2,e,s)(a):a===I.eof||Nn(a)||ah(a)?e(a):(n.consume(a),r)}function s(a){return a===I.rightParenthesis&&i++,n.consume(a),r}}function Rse(n,e,t){return i;function i(o){return o===I.exclamationMark||o===I.quotationMark||o===I.apostrophe||o===I.rightParenthesis||o===I.asterisk||o===I.comma||o===I.dot||o===I.colon||o===I.semicolon||o===I.questionMark||o===I.underscore||o===I.tilde?(n.consume(o),i):o===I.ampersand?(n.consume(o),s):o===I.rightSquareBracket?(n.consume(o),r):o===I.lessThan||o===I.eof||Nn(o)||ah(o)?e(o):t(o)}function r(o){return o===I.eof||o===I.leftParenthesis||o===I.leftSquareBracket||Nn(o)||ah(o)?e(o):i(o)}function s(o){return Tr(o)?a(o):t(o)}function a(o){return o===I.semicolon?(n.consume(o),i):Tr(o)?(n.consume(o),a):t(o)}}function Mse(n,e,t){return i;function i(s){return n.consume(s),r}function r(s){return mr(s)?t(s):e(s)}}function F2(n){return n===I.eof||n===I.leftParenthesis||n===I.asterisk||n===I.underscore||n===I.leftSquareBracket||n===I.rightSquareBracket||n===I.tilde||Nn(n)}function V2(n){return!Tr(n)}function U2(n){return!(n===I.slash||nE(n))}function nE(n){return n===I.plusSign||n===I.dash||n===I.dot||n===I.underscore||mr(n)}function AN(n){let e=n.length,t=!1;for(;e--;){const i=n[e][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){t=!0;break}if(i._gfmAutolinkLiteralWalkedInto){t=!1;break}}return n.length>0&&!t&&(n[n.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const jse={tokenize:$se,partial:!0};function Ose(){return{document:{[I.leftSquareBracket]:{name:"gfmFootnoteDefinition",tokenize:Use,continuation:{tokenize:zse},exit:Bse}},text:{[I.leftSquareBracket]:{name:"gfmFootnoteCall",tokenize:Vse},[I.rightSquareBracket]:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:Lse,resolveTo:Fse}}}}function Lse(n,e,t){const i=this;let r=i.events.length;const s=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a;for(;r--;){const l=i.events[r][1];if(l.type===F.labelImage){a=l;break}if(l.type==="gfmFootnoteCall"||l.type===F.labelLink||l.type===F.label||l.type===F.image||l.type===F.link)break}return o;function o(l){if(te(l===I.rightSquareBracket,"expected `]`"),!a||!a._balanced)return t(l);const c=Ca(i.sliceSerialize({start:a.end,end:i.now()}));return c.codePointAt(0)!==I.caret||!s.includes(c.slice(1))?t(l):(n.enter("gfmFootnoteCallLabelMarker"),n.consume(l),n.exit("gfmFootnoteCallLabelMarker"),e(l))}}function Fse(n,e){let t=n.length,i;for(;t--;)if(n[t][1].type===F.labelImage&&n[t][0]==="enter"){i=n[t][1];break}te(i,"expected `labelStart` to resolve"),n[t+1][1].type=F.data,n[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},n[t+3][1].start),end:Object.assign({},n[n.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},n[t+3][1].end),end:Object.assign({},n[t+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const a={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},n[n.length-1][1].start)},o={type:F.chunkString,contentType:"string",start:Object.assign({},a.start),end:Object.assign({},a.end)},l=[n[t+1],n[t+2],["enter",r,e],n[t+3],n[t+4],["enter",s,e],["exit",s,e],["enter",a,e],["enter",o,e],["exit",o,e],["exit",a,e],n[n.length-2],n[n.length-1],["exit",r,e]];return n.splice(t,n.length-t+1,...l),n}function Vse(n,e,t){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s=0,a;return o;function o(p){return te(p===I.leftSquareBracket,"expected `[`"),n.enter("gfmFootnoteCall"),n.enter("gfmFootnoteCallLabelMarker"),n.consume(p),n.exit("gfmFootnoteCallLabelMarker"),l}function l(p){return p!==I.caret?t(p):(n.enter("gfmFootnoteCallMarker"),n.consume(p),n.exit("gfmFootnoteCallMarker"),n.enter("gfmFootnoteCallString"),n.enter("chunkString").contentType="string",c)}function c(p){if(s>qe.linkReferenceSizeMax||p===I.rightSquareBracket&&!a||p===I.eof||p===I.leftSquareBracket||Nn(p))return t(p);if(p===I.rightSquareBracket){n.exit("chunkString");const m=n.exit("gfmFootnoteCallString");return r.includes(Ca(i.sliceSerialize(m)))?(n.enter("gfmFootnoteCallLabelMarker"),n.consume(p),n.exit("gfmFootnoteCallLabelMarker"),n.exit("gfmFootnoteCall"),e):t(p)}return Nn(p)||(a=!0),s++,n.consume(p),p===I.backslash?u:c}function u(p){return p===I.leftSquareBracket||p===I.backslash||p===I.rightSquareBracket?(n.consume(p),s++,c):c(p)}}function Use(n,e,t){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s,a=0,o;return l;function l(y){return te(y===I.leftSquareBracket,"expected `[`"),n.enter("gfmFootnoteDefinition")._container=!0,n.enter("gfmFootnoteDefinitionLabel"),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(y),n.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(y){return y===I.caret?(n.enter("gfmFootnoteDefinitionMarker"),n.consume(y),n.exit("gfmFootnoteDefinitionMarker"),n.enter("gfmFootnoteDefinitionLabelString"),n.enter("chunkString").contentType="string",u):t(y)}function u(y){if(a>qe.linkReferenceSizeMax||y===I.rightSquareBracket&&!o||y===I.eof||y===I.leftSquareBracket||Nn(y))return t(y);if(y===I.rightSquareBracket){n.exit("chunkString");const v=n.exit("gfmFootnoteDefinitionLabelString");return s=Ca(i.sliceSerialize(v)),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(y),n.exit("gfmFootnoteDefinitionLabelMarker"),n.exit("gfmFootnoteDefinitionLabel"),m}return Nn(y)||(o=!0),a++,n.consume(y),y===I.backslash?p:u}function p(y){return y===I.leftSquareBracket||y===I.backslash||y===I.rightSquareBracket?(n.consume(y),a++,u):u(y)}function m(y){return y===I.colon?(n.enter("definitionMarker"),n.consume(y),n.exit("definitionMarker"),r.includes(s)||r.push(s),en(n,g,"gfmFootnoteDefinitionWhitespace")):t(y)}function g(y){return e(y)}}function zse(n,e,t){return n.check(Iy,e,n.attempt(jse,e,t))}function Bse(n){n.exit("gfmFootnoteDefinition")}function $se(n,e,t){const i=this;return en(n,r,"gfmFootnoteDefinitionIndent",qe.tabSize+1);function r(s){const a=i.events[i.events.length-1];return a&&a[1].type==="gfmFootnoteDefinitionIndent"&&a[2].sliceSerialize(a[1],!0).length===qe.tabSize?e(s):t(s)}}function Wse(n){let t=(n||{}).singleTilde;const i={name:"strikethrough",tokenize:s,resolveAll:r};return t==null&&(t=!0),{text:{[I.tilde]:i},insideSpan:{null:[i]},attentionMarkers:{null:[I.tilde]}};function r(a,o){let l=-1;for(;++l<a.length;)if(a[l][0]==="enter"&&a[l][1].type==="strikethroughSequenceTemporary"&&a[l][1]._close){let c=l;for(;c--;)if(a[c][0]==="exit"&&a[c][1].type==="strikethroughSequenceTemporary"&&a[c][1]._open&&a[l][1].end.offset-a[l][1].start.offset===a[c][1].end.offset-a[c][1].start.offset){a[l][1].type="strikethroughSequence",a[c][1].type="strikethroughSequence";const u={type:"strikethrough",start:Object.assign({},a[c][1].start),end:Object.assign({},a[l][1].end)},p={type:"strikethroughText",start:Object.assign({},a[c][1].end),end:Object.assign({},a[l][1].start)},m=[["enter",u,o],["enter",a[c][1],o],["exit",a[c][1],o],["enter",p,o]],g=o.parser.constructs.insideSpan.null;g&&Ns(m,m.length,0,cw(g,a.slice(c+1,l),o)),Ns(m,m.length,0,[["exit",p,o],["enter",a[l][1],o],["exit",a[l][1],o],["exit",u,o]]),Ns(a,c-1,l-c+3,m),l=c+m.length-2;break}}for(l=-1;++l<a.length;)a[l][1].type==="strikethroughSequenceTemporary"&&(a[l][1].type=F.data);return a}function s(a,o,l){const c=this.previous,u=this.events;let p=0;return m;function m(y){return te(y===I.tilde,"expected `~`"),c===I.tilde&&u[u.length-1][1].type!==F.characterEscape?l(y):(a.enter("strikethroughSequenceTemporary"),g(y))}function g(y){const v=Qf(c);if(y===I.tilde)return p>1?l(y):(a.consume(y),p++,g);if(p<2&&!t)return l(y);const w=a.exit("strikethroughSequenceTemporary"),k=Qf(y);return w._open=!k||k===qe.attentionSideAfter&&!!v,w._close=!v||v===qe.attentionSideAfter&&!!k,o(y)}}}class Hse{constructor(){this.map=[]}add(e,t,i){qse(this,e,t,i)}consume(e){if(this.map.sort(function(s,a){return s[0]-a[0]}),this.map.length===0)return;let t=this.map.length;const i=[];for(;t>0;)t-=1,i.push(e.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),e.length=this.map[t][0];i.push(e.slice()),e.length=0;let r=i.pop();for(;r;){for(const s of r)e.push(s);r=i.pop()}this.map.length=0}}function qse(n,e,t,i){let r=0;if(!(t===0&&i.length===0)){for(;r<n.map.length;){if(n.map[r][0]===e){n.map[r][1]+=t,n.map[r][2].push(...i);return}r+=1}n.map.push([e,t,i])}}function Gse(n,e){te(n[e][1].type==="table","expected table");let t=!1;const i=[];for(;e<n.length;){const r=n[e];if(t){if(r[0]==="enter")r[1].type==="tableContent"&&i.push(n[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(r[1].type==="tableContent"){if(n[e-1][1].type==="tableDelimiterMarker"){const s=i.length-1;i[s]=i[s]==="left"?"center":"right"}}else if(r[1].type==="tableDelimiterRow")break}else r[0]==="enter"&&r[1].type==="tableDelimiterRow"&&(t=!0);e+=1}return i}function Yse(){return{flow:{null:{name:"table",tokenize:Xse,resolveAll:Kse}}}}function Xse(n,e,t){const i=this;let r=0,s=0,a;return o;function o(L){let W=i.events.length-1;for(;W>-1;){const G=i.events[W][1].type;if(G===F.lineEnding||G===F.linePrefix)W--;else break}const q=W>-1?i.events[W][1].type:null,X=q==="tableHead"||q==="tableRow"?N:l;return X===N&&i.parser.lazy[i.now().line]?t(L):X(L)}function l(L){return n.enter("tableHead"),n.enter("tableRow"),c(L)}function c(L){return L===I.verticalBar||(a=!0,s+=1),u(L)}function u(L){return L===I.eof?t(L):st(L)?s>1?(s=0,i.interrupt=!0,n.exit("tableRow"),n.enter(F.lineEnding),n.consume(L),n.exit(F.lineEnding),g):t(L):Ht(L)?en(n,u,F.whitespace)(L):(s+=1,a&&(a=!1,r+=1),L===I.verticalBar?(n.enter("tableCellDivider"),n.consume(L),n.exit("tableCellDivider"),a=!0,u):(n.enter(F.data),p(L)))}function p(L){return L===I.eof||L===I.verticalBar||Nn(L)?(n.exit(F.data),u(L)):(n.consume(L),L===I.backslash?m:p)}function m(L){return L===I.backslash||L===I.verticalBar?(n.consume(L),p):p(L)}function g(L){return i.interrupt=!1,i.parser.lazy[i.now().line]?t(L):(n.enter("tableDelimiterRow"),a=!1,Ht(L)?(te(i.parser.constructs.disable.null,"expected `disabled.null`"),en(n,y,F.linePrefix,i.parser.constructs.disable.null.includes("codeIndented")?void 0:qe.tabSize)(L)):y(L))}function y(L){return L===I.dash||L===I.colon?w(L):L===I.verticalBar?(a=!0,n.enter("tableCellDivider"),n.consume(L),n.exit("tableCellDivider"),v):A(L)}function v(L){return Ht(L)?en(n,w,F.whitespace)(L):w(L)}function w(L){return L===I.colon?(s+=1,a=!0,n.enter("tableDelimiterMarker"),n.consume(L),n.exit("tableDelimiterMarker"),k):L===I.dash?(s+=1,k(L)):L===I.eof||st(L)?P(L):A(L)}function k(L){return L===I.dash?(n.enter("tableDelimiterFiller"),S(L)):A(L)}function S(L){return L===I.dash?(n.consume(L),S):L===I.colon?(a=!0,n.exit("tableDelimiterFiller"),n.enter("tableDelimiterMarker"),n.consume(L),n.exit("tableDelimiterMarker"),E):(n.exit("tableDelimiterFiller"),E(L))}function E(L){return Ht(L)?en(n,P,F.whitespace)(L):P(L)}function P(L){return L===I.verticalBar?y(L):L===I.eof||st(L)?!a||r!==s?A(L):(n.exit("tableDelimiterRow"),n.exit("tableHead"),e(L)):A(L)}function A(L){return t(L)}function N(L){return n.enter("tableRow"),R(L)}function R(L){return L===I.verticalBar?(n.enter("tableCellDivider"),n.consume(L),n.exit("tableCellDivider"),R):L===I.eof||st(L)?(n.exit("tableRow"),e(L)):Ht(L)?en(n,R,F.whitespace)(L):(n.enter(F.data),V(L))}function V(L){return L===I.eof||L===I.verticalBar||Nn(L)?(n.exit(F.data),R(L)):(n.consume(L),L===I.backslash?B:V)}function B(L){return L===I.backslash||L===I.verticalBar?(n.consume(L),V):V(L)}}function Kse(n,e){let t=-1,i=!0,r=0,s=[0,0,0,0],a=[0,0,0,0],o=!1,l=0,c,u,p;const m=new Hse;for(;++t<n.length;){const g=n[t],y=g[1];g[0]==="enter"?y.type==="tableHead"?(o=!1,l!==0&&(te(c,"there should be a table opening"),rR(m,e,l,c,u),u=void 0,l=0),c={type:"table",start:Object.assign({},y.start),end:Object.assign({},y.end)},m.add(t,0,[["enter",c,e]])):y.type==="tableRow"||y.type==="tableDelimiterRow"?(i=!0,p=void 0,s=[0,0,0,0],a=[0,t+1,0,0],o&&(o=!1,u={type:"tableBody",start:Object.assign({},y.start),end:Object.assign({},y.end)},m.add(t,0,[["enter",u,e]])),r=y.type==="tableDelimiterRow"?2:u?3:1):r&&(y.type===F.data||y.type==="tableDelimiterMarker"||y.type==="tableDelimiterFiller")?(i=!1,a[2]===0&&(s[1]!==0&&(a[0]=a[1],p=Jv(m,e,s,r,void 0,p),s=[0,0,0,0]),a[2]=t)):y.type==="tableCellDivider"&&(i?i=!1:(s[1]!==0&&(a[0]=a[1],p=Jv(m,e,s,r,void 0,p)),s=a,a=[s[1],t,0,0])):y.type==="tableHead"?(o=!0,l=t):y.type==="tableRow"||y.type==="tableDelimiterRow"?(l=t,s[1]!==0?(a[0]=a[1],p=Jv(m,e,s,r,t,p)):a[1]!==0&&(p=Jv(m,e,a,r,t,p)),r=0):r&&(y.type===F.data||y.type==="tableDelimiterMarker"||y.type==="tableDelimiterFiller")&&(a[3]=t)}for(l!==0&&(te(c,"expected table opening"),rR(m,e,l,c,u)),m.consume(e.events),t=-1;++t<e.events.length;){const g=e.events[t];g[0]==="enter"&&g[1].type==="table"&&(g[1]._align=Gse(e.events,t))}return n}function Jv(n,e,t,i,r,s){const a=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",o="tableContent";t[0]!==0&&(te(s,"expected previous cell enter"),s.end=Object.assign({},op(e.events,t[0])),n.add(t[0],0,[["exit",s,e]]));const l=op(e.events,t[1]);if(s={type:a,start:Object.assign({},l),end:Object.assign({},l)},n.add(t[1],0,[["enter",s,e]]),t[2]!==0){const c=op(e.events,t[2]),u=op(e.events,t[3]),p={type:o,start:Object.assign({},c),end:Object.assign({},u)};if(n.add(t[2],0,[["enter",p,e]]),te(t[3]!==0),i!==2){const m=e.events[t[2]],g=e.events[t[3]];if(m[1].end=Object.assign({},g[1].end),m[1].type=F.chunkText,m[1].contentType=qe.contentTypeText,t[3]>t[2]+1){const y=t[2]+1,v=t[3]-t[2]-1;n.add(y,v,[])}}n.add(t[3]+1,0,[["exit",p,e]])}return r!==void 0&&(s.end=Object.assign({},op(e.events,r)),n.add(r,0,[["exit",s,e]]),s=void 0),s}function rR(n,e,t,i,r){const s=[],a=op(e.events,t);r&&(r.end=Object.assign({},a),s.push(["exit",r,e])),i.end=Object.assign({},a),s.push(["exit",i,e]),n.add(t+1,0,s)}function op(n,e){const t=n[e],i=t[0]==="enter"?"start":"end";return t[1][i]}const Qse={name:"tasklistCheck",tokenize:Zse};function Jse(){return{text:{[I.leftSquareBracket]:Qse}}}function Zse(n,e,t){const i=this;return r;function r(l){return te(l===I.leftSquareBracket,"expected `[`"),i.previous!==I.eof||!i._gfmTasklistFirstContentOfListItem?t(l):(n.enter("taskListCheck"),n.enter("taskListCheckMarker"),n.consume(l),n.exit("taskListCheckMarker"),s)}function s(l){return Nn(l)?(n.enter("taskListCheckValueUnchecked"),n.consume(l),n.exit("taskListCheckValueUnchecked"),a):l===I.uppercaseX||l===I.lowercaseX?(n.enter("taskListCheckValueChecked"),n.consume(l),n.exit("taskListCheckValueChecked"),a):t(l)}function a(l){return l===I.rightSquareBracket?(n.enter("taskListCheckMarker"),n.consume(l),n.exit("taskListCheckMarker"),n.exit("taskListCheck"),o):t(l)}function o(l){return st(l)?e(l):Ht(l)?n.check({tokenize:eae},e,t)(l):t(l)}}function eae(n,e,t){return en(n,i,F.whitespace);function i(r){return r===I.eof?t(r):e(r)}}function tae(n){return KF([Nse(),Ose(),Wse(n),Yse(),Jse()])}const nae={};function iae(n){const e=this,t=n||nae,i=e.data(),r=i.micromarkExtensions||(i.micromarkExtensions=[]),s=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),a=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);r.push(tae(t)),s.push(kse()),a.push(Dse(t))}const Foe=6048e5,Voe=864e5,Uoe=6e4,zoe=36e5,Zv=43200,sR=1440,aR=Symbol.for("constructDateFrom");function PN(n,e){return typeof n=="function"?n(e):n&&typeof n=="object"&&aR in n?n[aR](e):n instanceof Date?new n.constructor(e):new Date(e)}function Jc(n,e){return PN(e||n,n)}let rae={};function sae(){return rae}function oR(n){const e=Jc(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function TN(n,...e){const t=PN.bind(null,n||e.find(i=>typeof i=="object"));return e.map(t)}function O0(n,e){const t=+Jc(n)-+Jc(e);return t<0?-1:t>0?1:t}function aae(n){return PN(n,Date.now())}function oae(n,e,t){const[i,r]=TN(t==null?void 0:t.in,n,e),s=i.getFullYear()-r.getFullYear(),a=i.getMonth()-r.getMonth();return s*12+a}function lae(n){return e=>{const i=(n?Math[n]:Math.trunc)(e);return i===0?0:i}}function cae(n,e){return+Jc(n)-+Jc(e)}function uae(n,e){const t=Jc(n,e==null?void 0:e.in);return t.setHours(23,59,59,999),t}function dae(n,e){const t=Jc(n,e==null?void 0:e.in),i=t.getMonth();return t.setFullYear(t.getFullYear(),i+1,0),t.setHours(23,59,59,999),t}function hae(n,e){const t=Jc(n,e==null?void 0:e.in);return+uae(t,e)==+dae(t,e)}function pae(n,e,t){const[i,r,s]=TN(t==null?void 0:t.in,n,n,e),a=O0(r,s),o=Math.abs(oae(r,s));if(o<1)return 0;r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*o);let l=O0(r,s)===-a;hae(i)&&o===1&&O0(i,s)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function fae(n,e,t){const i=cae(n,e)/1e3;return lae(t==null?void 0:t.roundingMethod)(i)}const mae={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},gae=(n,e,t)=>{let i;const r=mae[n];return typeof r=="string"?i=r:e===1?i=r.one:i=r.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+i:i+" ago":i};function N1(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const bae={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},yae={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},vae={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},xae={date:N1({formats:bae,defaultWidth:"full"}),time:N1({formats:yae,defaultWidth:"full"}),dateTime:N1({formats:vae,defaultWidth:"full"})},wae={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},kae=(n,e,t,i)=>wae[n];function zm(n){return(e,t)=>{const i=t!=null&&t.context?String(t.context):"standalone";let r;if(i==="formatting"&&n.formattingValues){const a=n.defaultFormattingWidth||n.defaultWidth,o=t!=null&&t.width?String(t.width):a;r=n.formattingValues[o]||n.formattingValues[a]}else{const a=n.defaultWidth,o=t!=null&&t.width?String(t.width):n.defaultWidth;r=n.values[o]||n.values[a]}const s=n.argumentCallback?n.argumentCallback(e):e;return r[s]}}const Dae={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Sae={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Eae={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Nae={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},_ae={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Cae={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Aae=(n,e)=>{const t=Number(n),i=t%100;if(i>20||i<10)switch(i%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},Pae={ordinalNumber:Aae,era:zm({values:Dae,defaultWidth:"wide"}),quarter:zm({values:Sae,defaultWidth:"wide",argumentCallback:n=>n-1}),month:zm({values:Eae,defaultWidth:"wide"}),day:zm({values:Nae,defaultWidth:"wide"}),dayPeriod:zm({values:_ae,defaultWidth:"wide",formattingValues:Cae,defaultFormattingWidth:"wide"})};function Bm(n){return(e,t={})=>{const i=t.width,r=i&&n.matchPatterns[i]||n.matchPatterns[n.defaultMatchWidth],s=e.match(r);if(!s)return null;const a=s[0],o=i&&n.parsePatterns[i]||n.parsePatterns[n.defaultParseWidth],l=Array.isArray(o)?Iae(o,p=>p.test(a)):Tae(o,p=>p.test(a));let c;c=n.valueCallback?n.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;const u=e.slice(a.length);return{value:c,rest:u}}}function Tae(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function Iae(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function Rae(n){return(e,t={})=>{const i=e.match(n.matchPattern);if(!i)return null;const r=i[0],s=e.match(n.parsePattern);if(!s)return null;let a=n.valueCallback?n.valueCallback(s[0]):s[0];a=t.valueCallback?t.valueCallback(a):a;const o=e.slice(r.length);return{value:a,rest:o}}}const Mae=/^(\d+)(th|st|nd|rd)?/i,jae=/\d+/i,Oae={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Lae={any:[/^b/i,/^(a|c)/i]},Fae={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Vae={any:[/1/i,/2/i,/3/i,/4/i]},Uae={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},zae={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Bae={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},$ae={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Wae={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Hae={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},qae={ordinalNumber:Rae({matchPattern:Mae,parsePattern:jae,valueCallback:n=>parseInt(n,10)}),era:Bm({matchPatterns:Oae,defaultMatchWidth:"wide",parsePatterns:Lae,defaultParseWidth:"any"}),quarter:Bm({matchPatterns:Fae,defaultMatchWidth:"wide",parsePatterns:Vae,defaultParseWidth:"any",valueCallback:n=>n+1}),month:Bm({matchPatterns:Uae,defaultMatchWidth:"wide",parsePatterns:zae,defaultParseWidth:"any"}),day:Bm({matchPatterns:Bae,defaultMatchWidth:"wide",parsePatterns:$ae,defaultParseWidth:"any"}),dayPeriod:Bm({matchPatterns:Wae,defaultMatchWidth:"any",parsePatterns:Hae,defaultParseWidth:"any"})},Gae={code:"en-US",formatDistance:gae,formatLong:xae,formatRelative:kae,localize:Pae,match:qae,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Yae(n,e,t){const i=sae(),r=(t==null?void 0:t.locale)??i.locale??Gae,s=2520,a=O0(n,e);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:a}),[l,c]=TN(t==null?void 0:t.in,...a>0?[e,n]:[n,e]),u=fae(c,l),p=(oR(c)-oR(l))/1e3,m=Math.round((u-p)/60);let g;if(m<2)return t!=null&&t.includeSeconds?u<5?r.formatDistance("lessThanXSeconds",5,o):u<10?r.formatDistance("lessThanXSeconds",10,o):u<20?r.formatDistance("lessThanXSeconds",20,o):u<40?r.formatDistance("halfAMinute",0,o):u<60?r.formatDistance("lessThanXMinutes",1,o):r.formatDistance("xMinutes",1,o):m===0?r.formatDistance("lessThanXMinutes",1,o):r.formatDistance("xMinutes",m,o);if(m<45)return r.formatDistance("xMinutes",m,o);if(m<90)return r.formatDistance("aboutXHours",1,o);if(m<sR){const y=Math.round(m/60);return r.formatDistance("aboutXHours",y,o)}else{if(m<s)return r.formatDistance("xDays",1,o);if(m<Zv){const y=Math.round(m/sR);return r.formatDistance("xDays",y,o)}else if(m<Zv*2)return g=Math.round(m/Zv),r.formatDistance("aboutXMonths",g,o)}if(g=pae(c,l),g<12){const y=Math.round(m/Zv);return r.formatDistance("xMonths",y,o)}else{const y=g%12,v=Math.trunc(g/12);return y<3?r.formatDistance("aboutXYears",v,o):y<9?r.formatDistance("overXYears",v,o):r.formatDistance("almostXYears",v+1,o)}}function mx(n,e){return Yae(n,aae(n),e)}class Xae{constructor(){this.userProfiles=new Map,this.gemini=new aO("AIzaSyBoHxMRLlqSzCzvVpeuw06SUqmkj4eNzm8")}async getUserAIProfile(e){if(this.userProfiles.has(e))return this.userProfiles.get(e);const{data:t,error:i}=await rt.from("user_ai_profiles").select("*").eq("user_id",e).single();if(i||!t){const{data:r}=await rt.from("user_ai_profiles").insert({user_id:e,legal_specialties:[],writing_style_analysis:{},case_patterns:{},interaction_preferences:{response_length:"medium",detail_level:"standard",citation_style:"bluebook"},knowledge_domains:{},ai_learning_metadata:{}}).select().single();return this.userProfiles.set(e,r),r}return this.userProfiles.set(e,t),t}async processFileForUser(e,t){var i;console.log(`Starting AI processing for file ${e} for user ${t}`);try{const r=await this.getUserAIProfile(t),{data:s}=await rt.from("files").select("*").eq("id",e).single();if(!s)throw new Error("File not found");await this.updateProcessingStage(e,"extract",25);const a=await this.downloadAndExtractContent(s);await this.updateProcessingStage(e,"analyze",50);const o=await this.analyzeWithUserContext(a,r),l=await this.generateExhibitData(s,o);await rt.from("files").update({exhibit_id:l.exhibitId,exhibit_title:l.exhibitTitle,exhibit_auto_generated:!0,description:((i=o.extractedText)==null?void 0:i.substring(0,500))||null}).eq("id",e),await this.updateProcessingStage(e,"embed",75),await this.generateUserSpecificEmbeddings(s,a,o,t),await this.updateProcessingStage(e,"personalize",90);const c=await this.generatePersonalizedInsights(o,r,s);await this.updateProcessingStage(e,"completed",100,{analysis:o,insights:c,exhibit:l}),await this.updateUserAILearning(t,s,o,c),console.log(`AI processing completed for file ${e} with exhibit ${l.exhibitId}`)}catch(r){console.error(`AI processing failed for file ${e}:`,r),await this.updateProcessingStage(e,"error",0,null,r.message)}}async generateExhibitData(e,t){try{const{data:i}=await rt.rpc("generate_exhibit_id",{project_id_param:e.project_id,file_name:e.name,file_type:e.content_type||e.file_type}),r=await this.generateSmartExhibitTitle(e.name,t);return{exhibitId:i||"X1",exhibitTitle:r}}catch(i){return console.error("Error generating exhibit data:",i),{exhibitId:"X1",exhibitTitle:e.name.replace(/\.[^/.]+$/,"")}}}async generateSmartExhibitTitle(e,t){const i=this.gemini.getGenerativeModel({model:"gemini-2.5-pro"}),r=`
    Based on this file analysis, generate a clear, professional exhibit title for a legal case.
    
    Original filename: ${e}
    Content analysis: ${JSON.stringify(t)}
    
    Generate a title that:
    1. Is clear and descriptive for legal professionals
    2. Indicates the document type or content
    3. Is 2-8 words long
    4. Uses professional legal terminology
    5. Avoids technical jargon
    
    Examples:
    - "Employment Contract - John Smith"
    - "Medical Records Summary"
    - "Email Correspondence Chain"
    - "Witness Statement Video"
    
    Return only the title, nothing else.
    `;try{let a=(await i.generateContent(r)).response.text().trim();return a=a.replace(/['"]/g,""),a=a.substring(0,100),(a.length<3||a.length>100)&&(a=e.replace(/\.[^/.]+$/,"").replace(/[_-]/g," "),a=a.charAt(0).toUpperCase()+a.slice(1)),a}catch(s){console.error("Error generating smart title:",s);let a=e.replace(/\.[^/.]+$/,"").replace(/[_-]/g," ");return a.charAt(0).toUpperCase()+a.slice(1)}}async downloadAndExtractContent(e){const{data:t}=await rt.storage.from("project-files").createSignedUrl(e.storage_path,3600);if(!(t!=null&&t.signedUrl))throw new Error("Could not generate signed URL for file");const r=await(await fetch(t.signedUrl)).blob(),s=new File([r],e.name,{type:e.content_type});return await this.extractContentWithGemini(s,e.content_type)}async extractContentWithGemini(e,t){const i=this.gemini.getGenerativeModel({model:"gemini-2.5-pro"}),r=await e.arrayBuffer(),s=btoa(String.fromCharCode(...new Uint8Array(r))),l=(await i.generateContent([`
    Analyze this legal document and extract:
    1. All text content (OCR if needed)
    2. Key legal entities (parties, dates, amounts, etc.)
    3. Important legal concepts and clauses
    4. Document structure and sections
    5. Any tables, charts, or structured data
    
    Return structured JSON with extracted content.
    `,{inlineData:{data:s,mimeType:t}}])).response.text();try{return JSON.parse(l)}catch{return{extractedText:l,keyEntities:[],legalConcepts:[],structure:{}}}}async analyzeWithUserContext(e,t){const i=await this.getUserRelevantContext(t.user_id,e.extractedText),r=this.gemini.getGenerativeModel({model:"gemini-2.5-pro",generationConfig:{temperature:.1,topP:.8,maxOutputTokens:4096}}),s=`
    You are analyzing a legal document for a ${t.legal_specialties.join(", ")} attorney.
    
    User's Legal Specialties: ${t.legal_specialties.join(", ")}
    User's Case History Context:
    ${i.map(l=>`- ${l.content.substring(0,200)}...`).join(`
`)}
    
    User's Known Patterns:
    ${JSON.stringify(t.case_patterns)}
    
    Current Document Analysis:
    ${JSON.stringify(e)}
    
    Provide analysis that:
    1. Connects to their existing cases and patterns
    2. Matches their expertise level
    3. Identifies opportunities based on their successful strategies
    4. Flags potential issues they've encountered before
    5. Suggests specific actions in their workflow
    
    Return structured JSON with:
    - extractedText: string
    - insights: array of personalized insights
    - keyEntities: array of important entities
    - legalConcepts: array of relevant legal concepts
    - suggestedActions: array of recommended next steps
    - confidenceScore: number (0-1)
    `,o=(await r.generateContent(s)).response.text();try{return JSON.parse(o)}catch{return{extractedText:e.extractedText||o,insights:[],keyEntities:[],legalConcepts:[],suggestedActions:[],confidenceScore:.5}}}async generateUserSpecificEmbeddings(e,t,i,r){const s=this.chunkContentIntelligently(i.extractedText,i.legalConcepts);for(const a of s){const o=await this.generateEmbedding(a.text);await rt.from("user_embeddings").insert({user_id:r,project_id:e.project_id,source_type:"file",source_id:e.id,content_chunk:a.text,embedding:o,user_context:{legal_concepts:a.concepts,relevance_score:a.relevance,chunk_index:a.index,file_section:a.section},relevance_score:a.relevance})}}async generateEmbedding(e){return(await this.gemini.getGenerativeModel({model:"text-embedding-004"}).embedContent(e)).embedding.values}chunkContentIntelligently(e,t){const i=[];for(let a=0;a<e.length;a+=900){const o=e.substring(a,a+1e3),l=t.filter(c=>o.toLowerCase().includes(c.toLowerCase())).length/t.length;i.push({text:o,concepts:t.filter(c=>o.toLowerCase().includes(c.toLowerCase())),relevance:Math.max(.3,l),index:i.length,section:this.detectSection(o)})}return i}detectSection(e){const t=e.toLowerCase();return t.includes("whereas")||t.includes("preamble")?"preamble":t.includes("section")||t.includes("article")?"body":t.includes("signature")||t.includes("executed")?"signature":"body"}async generatePersonalizedInsights(e,t,i){const r=this.gemini.getGenerativeModel({model:"gemini-2.5-pro"}),s=`
    Based on this analysis and user profile, generate personalized insights:
    
    User Specialties: ${t.legal_specialties.join(", ")}
    Document Analysis: ${JSON.stringify(e)}
    
    Generate 3-5 specific, actionable insights that would be valuable for this user's practice.
    Focus on their specialties and provide concrete next steps.
    
    Return JSON array of insights with: title, description, priority, suggested_action.
    `,a=await r.generateContent(s);try{const o=JSON.parse(a.response.text());for(const l of o)await rt.from("ai_insights").insert({project_id:i.project_id,user_id:t.user_id,insight_type:"pattern",title:l.title,description:l.description,confidence_score:l.confidence||.8,source_files:[i.id],evidence:{analysis_data:e}});return o}catch{return[]}}async getUserRelevantContext(e,t){const i=await this.generateEmbedding(t),{data:r}=await rt.rpc("match_user_content",{user_id_param:e,query_embedding:i,match_threshold:.7,match_count:5});return r||[]}async updateProcessingStage(e,t,i,r,s){await rt.from("file_processing_queue").update({current_stage:t,progress_percentage:i,ai_analysis_result:r||null,error_message:s||null,completed_at:t==="completed"||t==="error"?new Date().toISOString():null}).eq("file_id",e)}async updateUserAILearning(e,t,i,r){const s=await this.getUserAIProfile(e),a={...s.knowledge_domains};for(const c of i.legalConcepts)a[c]=(a[c]||0)+1;const o={...s.case_patterns},l=this.detectCaseType(i.extractedText);o[l]=(o[l]||0)+1,await rt.from("user_ai_profiles").update({knowledge_domains:a,case_patterns:o,updated_at:new Date().toISOString()}).eq("user_id",e),this.userProfiles.delete(e)}detectCaseType(e){const t=e.toLowerCase();return t.includes("contract")||t.includes("agreement")?"contract":t.includes("litigation")||t.includes("complaint")?"litigation":t.includes("employment")||t.includes("employee")?"employment":t.includes("intellectual property")||t.includes("patent")?"ip":"general"}async generatePersonalizedResponse(e){const t=this.gemini.getGenerativeModel({model:"gemini-2.5-pro"}),i=e.userContext.map(a=>a.content.substring(0,300)).join(`
`),r=`
    You are a personalized legal AI assistant for a ${e.userProfile.legal_specialties.join(", ")} attorney.
    
    User Profile:
    - Specialties: ${e.userProfile.legal_specialties.join(", ")}
    - Preferred Response Length: ${e.userProfile.interaction_preferences.response_length}
    - Detail Level: ${e.userProfile.interaction_preferences.detail_level}
    
    Relevant Context from User's Files:
    ${i}
    
    Recent Conversation:
    ${e.conversationHistory.slice(-3).map(a=>`${a.role}: ${a.content}`).join(`
`)}
    
    User Question: ${e.userMessage}
    
    Provide a helpful, personalized response that:
    1. References their specific case context when relevant
    2. Matches their expertise level and specialties
    3. Suggests specific actions they can take
    4. Uses their preferred communication style
    
    Return JSON with: content, personalizedInsights, citations, learningSignals, profileUpdates
    `,s=await t.generateContent(r);try{return JSON.parse(s.response.text())}catch{return{content:s.response.text(),personalizedInsights:[],citations:[],learningSignals:{},profileUpdates:{}}}}}const Kae=()=>{const n=We(ie=>ie.user),e=We(ie=>ie.selectedProjectId),[t,i]=T.useState([]),[r,s]=T.useState(""),[a,o]=T.useState(!1),[l,c]=T.useState(null),[u,p]=T.useState(null),[m]=T.useState(()=>new Xae),[g,y]=T.useState([]),[v,w]=T.useState(new Set),[k,S]=T.useState(null),E=T.useRef(null),P=T.useRef(null);T.useEffect(()=>{n&&n.id&&e&&A()},[n,e]),T.useEffect(()=>{var ie;(ie=E.current)==null||ie.scrollIntoView({behavior:"smooth"})},[t]);const A=async()=>{const ie=n.id==="00000000-0000-0000-0000-000000000000";try{ie?await N():await R()}catch($){console.error("Failed to initialize chat:",$)}},N=async()=>{const ie={id:"demo-profile",user_id:n.id,legal_specialties:["Corporate Law","Contract Disputes","Commercial Litigation"],writing_style_analysis:{tone:"professional",formality:"high",preferred_structures:["IRAC","chronological"],citation_style:"bluebook"},case_patterns:{common_case_types:["contract_breach","corporate_governance"],typical_outcomes:["settlement","motion_granted"],jurisdiction_focus:["federal","delaware"]},interaction_preferences:{communication_style:"detailed",response_length:"comprehensive",expertise_level:"senior_partner"},knowledge_domains:{primary_domains:["contract_law","corporate_law","litigation"],specialization_depth:"expert"},ai_learning_metadata:{total_interactions:25,learning_progress:{contract_analysis:.85,brief_writing:.92}},created_at:new Date().toISOString(),updated_at:new Date().toISOString()};c(ie);const $=await vl.getConversations(e);if($.length>0){const Y=$[0];p({id:Y.id,project_id:Y.project_id,user_id:n.id,title:Y.title,created_at:Y.created_at,updated_at:Y.updated_at,last_message_at:Y.updated_at});const oe=Y.messages.map(be=>({id:be.id,role:be.role,content:be.content,citations:be.citations||[],insights:be.insights||[],timestamp:new Date(be.timestamp),tokens_used:be.tokens_used||0}));i(oe)}else{const Y={id:Wl(),project_id:e,title:"AI Legal Assistant - Demo",messages:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};await vl.saveConversation(Y),p({id:Y.id,project_id:Y.project_id,user_id:n.id,title:Y.title,created_at:Y.created_at,updated_at:Y.updated_at,last_message_at:Y.updated_at}),await L(ie)}},R=async()=>{const ie=await m.getUserAIProfile(n.id);c(ie);const{data:$}=await rt.from("ai_conversations").select("*").eq("user_id",n.id).eq("project_id",e).order("last_message_at",{ascending:!1}).limit(1).single();if($)p($),await V($.id);else{const{data:Y}=await rt.from("ai_conversations").insert({project_id:e,user_id:n.id,title:"New Legal Discussion"}).select().single();Y&&(p(Y),await B(ie))}},V=async ie=>{const{data:$}=await rt.from("ai_messages").select("*").eq("conversation_id",ie).order("created_at",{ascending:!0});if($){const Y=$.map(oe=>({id:oe.id,role:oe.role,content:oe.content,citations:oe.citations||[],insights:oe.insights||[],timestamp:new Date(oe.created_at),tokens_used:oe.tokens_used}));i(Y)}},B=async ie=>{const $={id:Wl(),role:"assistant",content:`Hello! I'm your personalized legal AI assistant. I've learned about your practice in ${ie.legal_specialties.join(", ")} and I'm ready to help with your case analysis, document review, and legal research.

I can analyze any files you upload, help draft documents, find relevant precedents from your case history, and provide insights tailored to your legal practice. 

What would you like to work on today?`,personalizedInsights:[{title:"Personalized for You",description:`Customized for ${ie.legal_specialties.join(", ")} practice`,type:"info"}],timestamp:new Date};i([$]),u&&await X($,u.id)},L=async ie=>{const $={id:Wl(),role:"assistant",content:`Welcome to Clarity Hub's AI Legal Assistant! 🎯

I'm your personalized AI assistant, trained in ${ie.legal_specialties.join(", ")}. I'm here to help you with:

• **Document Analysis**: Upload files and get intelligent insights
• **Case Strategy**: Develop arguments and identify key legal issues  
• **Research Assistance**: Find relevant precedents and authorities
• **Brief Writing**: Help draft motions, briefs, and legal documents
• **Evidence Review**: Organize and analyze exhibits

**Demo Features Available:**
✅ Real file upload with persistent storage
✅ AI-powered document analysis
✅ Exhibit management with smart numbering
✅ Conversation history that persists across sessions
✅ Professional legal document editing

Try asking me about your case, uploading a document, or requesting help with legal research. Everything you do here will be saved and persist across browser sessions!

What would you like to work on first?`,personalizedInsights:[{title:"Demo Mode Active",description:"Full-featured demo with persistent data storage",type:"info"},{title:"Legal Expertise",description:`Specialized in ${ie.legal_specialties.join(", ")}`,type:"success"}],timestamp:new Date};i([$]);const Y=await vl.getConversations(e);if(Y.length>0){const oe={...Y[0],messages:[$],updated_at:new Date().toISOString()};await vl.saveConversation(oe)}},W=async()=>{var $;if(!r.trim()&&g.length===0||!u||!l)return;const ie={id:Wl(),role:"user",content:r,attachments:[...g],timestamp:new Date};i(Y=>[...Y,ie]),s(""),y([]),o(!0);try{await X(ie,u.id);const Y=await q(r),oe=await m.generatePersonalizedResponse({userMessage:r,userProfile:l,userContext:Y,conversationHistory:t.slice(-10),attachments:g}),be={id:Wl(),role:"assistant",content:oe.content,insights:oe.personalizedInsights||[],citations:oe.citations||[],timestamp:new Date,tokens_used:($=oe.learningSignals)==null?void 0:$.tokens_used};i(xe=>[...xe,be]),await X(be,u.id),await G(ie,be,Y)}catch(Y){console.error("Failed to generate AI response:",Y);const oe={id:Wl(),role:"assistant",content:"I apologize, but I encountered an error processing your request. Please try again.",timestamp:new Date};i(be=>[...be,oe])}finally{o(!1)}},q=async ie=>{if(!n||!ie)return[];try{const $=await m.generateEmbedding(ie),{data:Y}=await rt.rpc("match_user_content",{user_id_param:n.id,query_embedding:$,match_threshold:.7,match_count:5,project_filter:e});return Y||[]}catch($){return console.error("Failed to get user context:",$),[]}},X=async(ie,$)=>{var Y;await rt.from("ai_messages").insert({id:ie.id,conversation_id:$,role:ie.role,content:ie.content,attachments:((Y=ie.attachments)==null?void 0:Y.map(oe=>({name:oe.name,type:oe.type,size:oe.size})))||[],citations:ie.citations||[],insights:ie.insights||[],tokens_used:ie.tokens_used})},G=async(ie,$,Y)=>{await rt.from("user_ai_interactions").insert({user_id:n.id,interaction_type:"query",query_text:ie.content,ai_response:$.content,context_used:{context_items:Y.map(oe=>oe.id)},learning_signal:{tokens_used:$.tokens_used,response_quality:"pending_feedback",context_relevance:Y.length>0?"high":"low"}})},K=async(ie,$)=>{i(Y=>Y.map(oe=>oe.id===ie?{...oe,feedback:$}:oe)),await rt.from("user_ai_interactions").insert({user_id:n.id,interaction_type:"feedback",user_feedback:{type:$,message_id:ie},learning_signal:{feedback_type:$,improvement_areas:$==="negative"?["accuracy","relevance"]:[]}}),S(null)},J=()=>{var ie;(ie=P.current)==null||ie.click()},ee=ie=>{const $=ie.target.files;$&&y(Y=>[...Y,...Array.from($)])},fe=ie=>{y($=>$.filter((Y,oe)=>oe!==ie))},ae=ie=>{w($=>{const Y=new Set($);return Y.has(ie)?Y.delete(ie):Y.add(ie),Y})},U=ie=>{navigator.clipboard.writeText(ie)},he=ie=>{ie.key==="Enter"&&!ie.shiftKey&&(ie.preventDefault(),W())};return b.jsxDEV(re,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[b.jsxDEV(sn,{elevation:1,sx:{p:2,borderRadius:0},children:b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:2},children:[b.jsxDEV(Jd,{sx:{bgcolor:"primary.main"},children:b.jsxDEV(A1,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:524,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:523,columnNumber:11},void 0),b.jsxDEV(re,{children:[b.jsxDEV(ge,{variant:"h6",children:"Legal AI Assistant"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:527,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:l!=null&&l.legal_specialties.length?`Specialized in ${l.legal_specialties.join(", ")}`:"Learning your practice areas"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:530,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:526,columnNumber:11},void 0),b.jsxDEV(re,{sx:{ml:"auto"},children:b.jsxDEV(It,{icon:b.jsxDEV(dE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:539,columnNumber:21},void 0),label:"Personalized",color:"primary",variant:"outlined",size:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:538,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:537,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:522,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:521,columnNumber:7},void 0),b.jsxDEV(re,{sx:{flex:1,overflow:"auto",p:2},children:[b.jsxDEV(nu,{children:[t.map(ie=>b.jsxDEV(Js,{sx:{flexDirection:"column",alignItems:"flex-start",px:0},children:b.jsxDEV(re,{sx:{display:"flex",flexDirection:ie.role==="user"?"row-reverse":"row",width:"100%",gap:1},children:[b.jsxDEV(Jd,{sx:{bgcolor:ie.role==="user"?"grey.300":"primary.main",width:32,height:32},children:ie.role==="user"?b.jsxDEV(F4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:569,columnNumber:46},void 0):b.jsxDEV(A1,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:569,columnNumber:61},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:562,columnNumber:17},void 0),b.jsxDEV(sn,{elevation:1,sx:{maxWidth:"80%",p:2,bgcolor:ie.role==="user"?"primary.main":"background.paper",color:ie.role==="user"?"white":"text.primary",borderRadius:2,mb:1},children:[b.jsxDEV(re,{sx:{"& p":{margin:"0.5em 0"},"& ul, & ol":{paddingLeft:"1.5em"},"& li":{marginBottom:"0.25em"},"& strong":{fontWeight:600},"& code":{backgroundColor:"action.hover",padding:"0.2em 0.4em",borderRadius:"3px",fontSize:"0.9em"},"& pre":{backgroundColor:"action.hover",padding:"1em",borderRadius:"4px",overflow:"auto"}},children:b.jsxDEV(Wie,{remarkPlugins:[iae],children:ie.content},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:603,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:583,columnNumber:19},void 0),ie.citations&&ie.citations.length>0&&b.jsxDEV(re,{sx:{mt:2},children:[b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:"Citations:"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:611,columnNumber:23},void 0),b.jsxDEV(re,{sx:{display:"flex",gap:1,flexWrap:"wrap",mt:1},children:ie.citations.map(($,Y)=>b.jsxDEV(It,{icon:b.jsxDEV(OR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:618,columnNumber:35},void 0),label:$.title||`Citation ${Y+1}`,size:"small",variant:"outlined"},Y,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:616,columnNumber:27},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:614,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:610,columnNumber:21},void 0),ie.insights&&ie.insights.length>0&&b.jsxDEV(re,{sx:{mt:2},children:[b.jsxDEV(vt,{startIcon:b.jsxDEV(bE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:632,columnNumber:36},void 0),endIcon:b.jsxDEV(MR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:633,columnNumber:34},void 0),size:"small",onClick:()=>ae(ie.id),children:[ie.insights.length," Personalized Insights"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:631,columnNumber:23},void 0),b.jsxDEV(FR,{in:v.has(ie.id),children:b.jsxDEV(re,{sx:{mt:1},children:ie.insights.map(($,Y)=>b.jsxDEV(Aa,{severity:"info",sx:{mb:1},children:b.jsxDEV(ge,{variant:"body2",children:[b.jsxDEV("strong",{children:$.title},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:645,columnNumber:33},void 0),": ",$.description]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:644,columnNumber:31},void 0)},Y,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:643,columnNumber:29},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:641,columnNumber:25},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:640,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:630,columnNumber:21},void 0),ie.role==="assistant"&&b.jsxDEV(re,{sx:{display:"flex",gap:1,mt:2,alignItems:"center"},children:[b.jsxDEV(Nt,{title:"Copy response",children:b.jsxDEV(ut,{size:"small",onClick:()=>U(ie.content),children:b.jsxDEV(GR,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:659,columnNumber:27},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:658,columnNumber:25},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:657,columnNumber:23},void 0),b.jsxDEV(Nt,{title:"Helpful",children:b.jsxDEV(ut,{size:"small",color:ie.feedback==="positive"?"success":"default",onClick:()=>K(ie.id,"positive"),children:b.jsxDEV(V4,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:669,columnNumber:27},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:664,columnNumber:25},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:663,columnNumber:23},void 0),b.jsxDEV(Nt,{title:"Not helpful",children:b.jsxDEV(ut,{size:"small",color:ie.feedback==="negative"?"error":"default",onClick:()=>K(ie.id,"negative"),children:b.jsxDEV(U4,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:679,columnNumber:27},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:674,columnNumber:25},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:673,columnNumber:23},void 0),b.jsxDEV(ge,{variant:"caption",color:"text.secondary",sx:{ml:"auto"},children:mx(ie.timestamp,{addSuffix:!0})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:683,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:656,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:572,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:554,columnNumber:15},void 0)},ie.id,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:553,columnNumber:13},void 0)),a&&b.jsxDEV(Js,{sx:{justifyContent:"center"},children:[b.jsxDEV(Yr,{size:24},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:695,columnNumber:15},void 0),b.jsxDEV(ge,{variant:"body2",sx:{ml:1},children:"Analyzing with your case context..."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:696,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:694,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:551,columnNumber:9},void 0),b.jsxDEV("div",{ref:E},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:702,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:550,columnNumber:7},void 0),g.length>0&&b.jsxDEV(re,{sx:{p:2,bgcolor:"background.default"},children:[b.jsxDEV(ge,{variant:"caption",color:"text.secondary",gutterBottom:!0,children:"Attachments:"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:708,columnNumber:11},void 0),b.jsxDEV(re,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:g.map((ie,$)=>b.jsxDEV(It,{label:ie.name,onDelete:()=>fe($),size:"small"},$,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:713,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:711,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:707,columnNumber:9},void 0),b.jsxDEV(sn,{elevation:2,sx:{p:2,borderRadius:0},children:b.jsxDEV(re,{sx:{display:"flex",gap:1,alignItems:"flex-end"},children:[b.jsxDEV("input",{ref:P,type:"file",multiple:!0,accept:"image/*,application/pdf,.doc,.docx,.txt",style:{display:"none"},onChange:ee},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:727,columnNumber:11},void 0),b.jsxDEV(ut,{onClick:J,disabled:a,children:b.jsxDEV(z4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:737,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:736,columnNumber:11},void 0),b.jsxDEV(Ni,{fullWidth:!0,multiline:!0,maxRows:4,placeholder:"Ask about your cases, upload documents, or request legal analysis...",value:r,onChange:ie=>s(ie.target.value),onKeyPress:he,disabled:a,variant:"outlined",size:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:740,columnNumber:11},void 0),b.jsxDEV(ut,{onClick:W,disabled:a||!r.trim()&&g.length===0,color:"primary",children:b.jsxDEV(B4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:758,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:753,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:726,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:725,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ai/AdaptiveLegalAIChat.tsx",lineNumber:519,columnNumber:5},void 0)},Qae=(n,e)=>{const t="https://swtkpfpyjjkkemmvkhmz.supabase.co".replace(/\/+$/,"");let i,r;if(n.includes("/")){const o=n.split("/");r=o[0],i=o.slice(1).join("/")}else r="files",i=n;r=r.replace(/^\/+|\/+$/g,""),i=i.replace(/^\/+|\/+$/g,"");const s=i.split("/").map(o=>encodeURIComponent(o)).join("/"),a=`${t}/storage/v1/object/public/${r}/${s}`;return console.log(`[publicUrl] Generated URL: ${a}`),a};function lR(n){const{children:e,value:t,index:i,...r}=n;return b.jsxDEV("div",{role:"tabpanel",hidden:t!==i,id:`right-panel-tabpanel-${i}`,"aria-labelledby":`right-panel-tab-${i}`,style:{height:"100%"},...r,children:t===i&&b.jsxDEV(re,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:e},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:32,columnNumber:9},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:23,columnNumber:5},this)}const z2=()=>{const n=We(y=>y.selectedFileId),e=We(y=>y.files),t=We(y=>y.user),[i,r]=T.useState(0),[s,a]=T.useState(!1),[o,l]=T.useState(null),[c,u]=T.useState(null),p=n?e.find(y=>y.id===n):null,m=(t==null?void 0:t.id)==="00000000-0000-0000-0000-000000000000";T.useEffect(()=>((async()=>{if(!p||m){u(null),a(!1);return}try{a(!0),l(null);const v=Qae(`files/${p.storage_path}`);if(console.log(`[RightPanelWrapper] Generated public URL: ${v}`),["pdf","document"].includes(p.file_type)){console.log(`[RightPanelWrapper] Using blob approach for ${p.file_type}`);try{const w=await fetch(v);if(!w.ok)throw new Error(`Failed to fetch file: ${w.status}`);const k=await w.blob(),S=URL.createObjectURL(k);console.log(`[RightPanelWrapper] Created blob URL from ${k.size} bytes`),u(S)}catch(w){console.error("[RightPanelWrapper] Blob fetch failed, using direct URL:",w),u(v)}}else u(v)}catch(v){console.error("Error loading file URL:",v),l("Error loading file. Please try again later."),u(null)}finally{a(!1)}})(),()=>{c&&c.startsWith("blob:")&&URL.revokeObjectURL(c)}),[p,m]);const g=(y,v)=>{r(v)};return b.jsxDEV(re,{sx:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",backgroundColor:"#ffffff",color:"#1a1a1a"},"data-test":"right-panel",children:[b.jsxDEV(sn,{elevation:1,sx:{borderRadius:0},children:b.jsxDEV(hE,{value:i,onChange:g,variant:"fullWidth",sx:{minHeight:48},children:[b.jsxDEV(mp,{icon:b.jsxDEV(Gf,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:144,columnNumber:19},void 0),label:"Viewer",id:"right-panel-tab-0","aria-controls":"right-panel-tabpanel-0",sx:{minHeight:48}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:143,columnNumber:11},void 0),b.jsxDEV(mp,{icon:b.jsxDEV(A1,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:151,columnNumber:19},void 0),label:"AI Assistant",id:"right-panel-tab-1","aria-controls":"right-panel-tabpanel-1",sx:{minHeight:48}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:150,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:137,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:136,columnNumber:7},void 0),b.jsxDEV(lR,{value:i,index:0,children:m&&p?b.jsxDEV(re,{sx:{flex:1,overflow:"hidden"},children:b.jsxDEV(CZ,{fileName:p.name,fileType:p.file_type,onCopyLink:()=>{console.log("Demo: copied link for file:",p.name)}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:168,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:164,columnNumber:11},void 0):b.jsxDEV(_Z,{file:p,fileUrl:c,loading:s,error:o},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:179,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:161,columnNumber:7},void 0),b.jsxDEV(lR,{value:i,index:1,children:b.jsxDEV(Kae,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:190,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:189,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/panels/RightPanelWrapper.tsx",lineNumber:124,columnNumber:5},void 0)},Jae=({leftPanel:n,centerPanel:e,rightPanel:t,leftPanelOpen:i=!0,rightPanelOpen:r=!0,onLeftPanelToggle:s,onRightPanelToggle:a,onWidthChange:o})=>{const[l,c]=T.useState(i),[u,p]=T.useState(r);T.useEffect(()=>{c(i)},[i]),T.useEffect(()=>{p(r)},[r]);const[m,g]=T.useState({left:20,center:55,right:25}),[y,v]=T.useState(!1),w={left:15,center:30,right:15},k=T.useRef(null),S=T.useRef(null),E=T.useRef(null),P=T.useRef(null),A=T.useRef({isResizing:!1,startX:0,startWidths:{left:20,center:55,right:25},panelType:null,containerWidth:0}),N=T.useCallback((V,B)=>!V&&!B?{left:20,center:100,right:25}:V&&!B?{left:20,center:80,right:25}:!V&&B?{left:20,center:75,right:25}:{left:20,center:55,right:25},[]);T.useEffect(()=>{const V=N(l,u);g(V),o==null||o(V)},[l,u,N,o]),T.useEffect(()=>()=>{document.body.style.cursor="",document.body.style.userSelect="",document.body.classList.remove("resizing-panel"),v(!1)},[]);const R=T.useCallback(V=>B=>{B.preventDefault(),B.stopPropagation();const L=k.current;if(!L)return;const W=L.offsetWidth,q=B.clientX;A.current={isResizing:!0,startX:q,startWidths:{...m},panelType:V,containerWidth:W},S.current&&(S.current.style.transition="none"),E.current&&(E.current.style.transition="none"),P.current&&(P.current.style.transition="none"),v(!0),document.body.style.cursor="col-resize",document.body.style.userSelect="none",document.body.classList.add("resizing-panel");const X=K=>{A.current.isResizing&&requestAnimationFrame(()=>{const J=K.clientX-A.current.startX,ee=A.current.containerWidth,fe=J/ee*100,ae=A.current.startWidths;let U={...ae};if(V==="left")U.left=Math.max(w.left,Math.min(50,ae.left+fe)),U.center=ae.center-(U.left-ae.left);else if(V==="right"){U.right=Math.max(w.right,Math.min(50,ae.right-fe));const he=ae.right-U.right;U.center=ae.center+he}if(U.center<w.center){const he=w.center-U.center;U.center=w.center,V==="left"?U.left=Math.max(w.left,U.left-he):U.right=Math.max(w.right,U.right-he)}S.current&&l&&(S.current.style.width=`${U.left}%`),E.current&&(E.current.style.width=`${U.center}%`),P.current&&u&&(P.current.style.width=`${U.right}%`)})},G=()=>{A.current.isResizing=!1,document.body.style.cursor="",document.body.style.userSelect="",document.body.classList.remove("resizing-panel"),S.current&&(S.current.style.transition="width 300ms cubic-bezier(0.4, 0, 0.2, 1)"),E.current&&(E.current.style.transition="width 300ms cubic-bezier(0.4, 0, 0.2, 1)"),P.current&&(P.current.style.transition="width 300ms cubic-bezier(0.4, 0, 0.2, 1)");const K={left:S.current?parseFloat(S.current.style.width):m.left,center:E.current?parseFloat(E.current.style.width):m.center,right:P.current?parseFloat(P.current.style.width):m.right};g(K),o==null||o(K),v(!1),document.removeEventListener("mousemove",X),document.removeEventListener("mouseup",G)};document.addEventListener("mousemove",X),document.addEventListener("mouseup",G)},[m,l,u,o]);return b.jsxDEV(re,{ref:k,sx:{display:"flex",height:"100%",width:"100%",overflow:"hidden",position:"relative"},children:[l&&b.jsxDEV(b.Fragment,{children:[b.jsxDEV(re,{ref:S,sx:{width:`${m.left}%`,height:"100%",overflow:"hidden",bgcolor:"background.paper",borderRight:"1px solid",borderColor:"divider",transition:y?"none":"width 300ms cubic-bezier(0.4, 0, 0.2, 1)",position:"relative"},children:n},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ProfessionalPanelLayout.tsx",lineNumber:239,columnNumber:11},void 0),b.jsxDEV(re,{className:"panel-resize-handle",onMouseDown:R("left"),sx:{width:"8px",height:"100%",background:V=>`linear-gradient(90deg, ${V.palette.primary.main}30 0%, ${V.palette.primary.light}30 100%)`,cursor:"col-resize",position:"relative",zIndex:50,transition:"background-color 0.2s ease",borderRadius:"0 4px 4px 0",boxShadow:"2px 0 8px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{background:V=>`linear-gradient(90deg, ${V.palette.primary.main}50 0%, ${V.palette.primary.light}50 100%)`,"& .grip-icon":{opacity:1}},"&:active":{background:V=>`linear-gradient(90deg, ${V.palette.primary.main}80 0%, ${V.palette.primary.light}80 100%)`}},children:b.jsxDEV(xA,{className:"grip-icon",sx:{color:"white",opacity:.6,transition:"opacity 0.2s",pointerEvents:"none",fontSize:20}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ProfessionalPanelLayout.tsx",lineNumber:286,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ProfessionalPanelLayout.tsx",lineNumber:256,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ProfessionalPanelLayout.tsx",lineNumber:238,columnNumber:9},void 0),b.jsxDEV(re,{ref:E,sx:{width:l?u?`${m.center}%`:`${m.center+m.right}%`:u?`${m.left+m.center}%`:"100%",height:"100%",overflow:"hidden",bgcolor:"background.default",transition:y?"none":"width 300ms cubic-bezier(0.4, 0, 0.2, 1)",position:"relative"},children:e},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ProfessionalPanelLayout.tsx",lineNumber:301,columnNumber:7},void 0),u&&b.jsxDEV(b.Fragment,{children:[b.jsxDEV(re,{className:"panel-resize-handle",onMouseDown:R("right"),sx:{width:"8px",height:"100%",background:V=>`linear-gradient(90deg, ${V.palette.primary.main}30 0%, ${V.palette.primary.light}30 100%)`,cursor:"col-resize",position:"relative",zIndex:50,transition:"background-color 0.2s ease",borderRadius:"4px 0 0 4px",boxShadow:"-2px 0 8px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{background:V=>`linear-gradient(90deg, ${V.palette.primary.main}50 0%, ${V.palette.primary.light}50 100%)`,"& .grip-icon":{opacity:1}},"&:active":{background:V=>`linear-gradient(90deg, ${V.palette.primary.main}80 0%, ${V.palette.primary.light}80 100%)`}},children:b.jsxDEV(xA,{className:"grip-icon",sx:{color:"white",opacity:.6,transition:"opacity 0.2s",pointerEvents:"none",fontSize:20}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ProfessionalPanelLayout.tsx",lineNumber:351,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ProfessionalPanelLayout.tsx",lineNumber:321,columnNumber:11},void 0),b.jsxDEV(re,{ref:P,sx:{width:`${m.right}%`,height:"100%",overflow:"hidden",bgcolor:"background.paper",borderLeft:"1px solid",borderColor:"divider",transition:y?"none":"width 300ms cubic-bezier(0.4, 0, 0.2, 1)",position:"relative"},children:t},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ProfessionalPanelLayout.tsx",lineNumber:363,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ProfessionalPanelLayout.tsx",lineNumber:319,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ProfessionalPanelLayout.tsx",lineNumber:226,columnNumber:5},void 0)},Zae=()=>{const n=oh(),e=jx(),{projectId:t}=DR(),{signOut:i,user:r}=AE(),{showNotification:s}=PE(),[a,o]=T.useState(null),[l,c]=T.useState(!1),u=!!a,p=We(W=>W.projects),m=We(W=>W.selectedProjectId),g=We(W=>W.setSelectedProject),y=We(W=>W.toggleTheme),v=We(W=>W.themeMode),w=We(W=>W.setSelectedFile),k=We(W=>W.isLeftPanelOpen),S=We(W=>W.isRightPanelOpen),E=We(W=>W.toggleLeftPanel),P=We(W=>W.toggleRightPanel);T.useEffect(()=>{t&&g(t)},[t,g]),T.useEffect(()=>{const W=q=>{(q.metaKey||q.ctrlKey)&&(q.key==="["?(q.preventDefault(),E()):q.key==="]"&&(q.preventDefault(),P()))};return window.addEventListener("keydown",W),()=>window.removeEventListener("keydown",W)},[E,P]),T.useEffect(()=>{w(null)},[m,w]);const A=W=>{var q;g(W),e(`/project/${W}`),s(`Switched to project: ${(q=p.find(X=>X.id===W))==null?void 0:q.name}`,"info")},N=()=>{const W=prompt("Enter project name:",`Case ${p.length+1}`);if(!W)return;const q=`demo-project-${Date.now()}`,X={id:q,name:W,description:prompt("Enter project description (optional):","")||void 0,created_at:new Date().toISOString(),owner_id:(r==null?void 0:r.id)||"00000000-0000-0000-0000-000000000000"};We.setState(G=>({projects:[...G.projects,X],selectedProjectId:q})),e(`/project/${q}`),s(`Created new project: ${W}`,"success")},R=[{icon:b.jsxDEV(QR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:146,columnNumber:13},void 0),label:"Home",path:"/"},{icon:b.jsxDEV(Y4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:147,columnNumber:13},void 0),label:"Dashboard",path:"/dashboard"},{icon:b.jsxDEV(X4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:148,columnNumber:13},void 0),label:"Messages",path:"/messages"},{icon:b.jsxDEV(P1,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:149,columnNumber:13},void 0),label:"Settings",path:"/settings"},{icon:b.jsxDEV(K4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:150,columnNumber:13},void 0),label:"Help & Support",path:"/help"}],V=W=>{o(W.currentTarget)},B=()=>{o(null)},L=async()=>{try{await i(),B(),e("/auth/login"),s("Successfully logged out","success")}catch(W){console.error("Error signing out:",W),s("Failed to log out. Please try again.","error")}};return b.jsxDEV(re,{component:"main",sx:{display:"flex",flexDirection:"column",height:"100vh",width:"100vw",overflow:"hidden",bgcolor:n.palette.background.default},children:[b.jsxDEV(yE,{position:"fixed",elevation:0,sx:{zIndex:W=>W.zIndex.drawer+1,backdropFilter:"blur(20px)",background:n.palette.mode==="dark"?Qe(n.palette.background.paper,.9):"rgba(255, 255, 255, 0.95)",borderBottom:`1px solid ${n.palette.divider}`,boxShadow:n.palette.mode==="dark"?"0 1px 3px rgba(0, 0, 0, 0.3)":"0 1px 3px rgba(0, 0, 0, 0.05)"},children:b.jsxDEV(gy,{sx:{minHeight:{xs:56,sm:64},px:{xs:2,sm:3}},children:[b.jsxDEV(Nt,{title:"Menu",children:b.jsxDEV(ut,{edge:"start",color:"inherit",onClick:()=>c(!l),sx:{mr:2,color:n.palette.text.primary,"&:hover":{bgcolor:Qe(n.palette.primary.main,.08)}},children:b.jsxDEV($4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:218,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:206,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:205,columnNumber:11},void 0),b.jsxDEV(ge,{variant:"h6",noWrap:!0,sx:{fontWeight:700,fontSize:"1.1rem",color:n.palette.primary.main,letterSpacing:"-0.5px",mr:3,display:{xs:"none",sm:"block"}},children:"CLARITY HUB"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:223,columnNumber:11},void 0),b.jsxDEV(AR,{size:"small",sx:{minWidth:200,mr:2,"& .MuiOutlinedInput-root":{bgcolor:"white","&:hover":{bgcolor:Qe("#1e3a8a",.02)}}},children:b.jsxDEV(W4,{value:m||"",onChange:W=>A(W.target.value),displayEmpty:!0,renderValue:W=>{if(!W)return b.jsxDEV("em",{style:{color:"#9ca3af"},children:"Select a project"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:257,columnNumber:36},void 0);const q=p.find(X=>X.id===W);return b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1},children:[b.jsxDEV(V0,{sx:{fontSize:18,color:n.palette.primary.main}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:261,columnNumber:21},void 0),b.jsxDEV("span",{children:q==null?void 0:q.name},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:262,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:260,columnNumber:19},void 0)},children:[b.jsxDEV(Dn,{value:"",disabled:!0,children:b.jsxDEV("em",{children:"Select a project"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:268,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:267,columnNumber:15},void 0),b.jsxDEV(Pr,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:270,columnNumber:15},void 0),p.map(W=>b.jsxDEV(Dn,{value:W.id,children:[b.jsxDEV(Ui,{children:b.jsxDEV(V0,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:274,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:273,columnNumber:19},void 0),b.jsxDEV(si,{primary:W.name,secondary:W.description},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:276,columnNumber:19},void 0)]},W.id,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:272,columnNumber:17},void 0)),b.jsxDEV(Pr,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:282,columnNumber:15},void 0),b.jsxDEV(Dn,{onClick:W=>{W.stopPropagation(),N()},children:[b.jsxDEV(Ui,{children:b.jsxDEV(Qd,{fontSize:"small",color:"primary"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:288,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:287,columnNumber:17},void 0),b.jsxDEV(si,{primary:"Create New Project"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:290,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:283,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:252,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:239,columnNumber:11},void 0),b.jsxDEV(re,{sx:{flexGrow:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:296,columnNumber:11},void 0),b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1},children:[b.jsxDEV(Nt,{title:"Toggle Left Panel (⌘[)",children:b.jsxDEV(ut,{onClick:()=>E(),sx:{color:n.palette.text.primary,bgcolor:k?Qe(n.palette.primary.main,.1):"transparent","&:hover":{bgcolor:Qe(n.palette.primary.main,.15)}},children:b.jsxDEV(wA,{sx:{transform:"scaleX(-1)"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:312,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:302,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:301,columnNumber:13},void 0),b.jsxDEV(Nt,{title:"Toggle Right Panel (⌘])",children:b.jsxDEV(ut,{onClick:()=>P(),sx:{color:n.palette.text.primary,bgcolor:S?Qe(n.palette.primary.main,.1):"transparent","&:hover":{bgcolor:Qe(n.palette.primary.main,.15)}},children:b.jsxDEV(wA,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:327,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:317,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:316,columnNumber:13},void 0),b.jsxDEV(Pr,{orientation:"vertical",flexItem:!0,sx:{mx:.5}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:331,columnNumber:13},void 0),b.jsxDEV(Hq,{variant:"icon",showCount:!0},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:334,columnNumber:13},void 0),b.jsxDEV(Nt,{title:"Notifications",children:b.jsxDEV(ut,{sx:{color:n.palette.text.primary,"&:hover":{bgcolor:Qe(n.palette.primary.main,.08)}},onClick:()=>s("No new notifications","info"),children:b.jsxDEV(Yc,{badgeContent:0,color:"error",children:b.jsxDEV(H4,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:348,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:347,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:338,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:337,columnNumber:13},void 0),b.jsxDEV(Nt,{title:`Switch to ${v==="dark"?"light":"dark"} mode`,children:b.jsxDEV(ut,{onClick:y,sx:{color:n.palette.text.primary,"&:hover":{bgcolor:Qe(n.palette.primary.main,.08)}},children:v==="dark"?b.jsxDEV(YR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:364,columnNumber:41},void 0):b.jsxDEV(XR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:364,columnNumber:57},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:355,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:354,columnNumber:13},void 0),r?b.jsxDEV(b.Fragment,{children:[b.jsxDEV(ut,{onClick:V,size:"small",sx:{ml:1},children:b.jsxDEV(Jd,{sx:{width:32,height:32,bgcolor:n.palette.primary.main,fontSize:"0.9rem"},src:r.avatar_url||void 0,children:(r.full_name||r.email||"U")[0].toUpperCase()},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:376,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:371,columnNumber:17},void 0),b.jsxDEV(ru,{anchorEl:a,open:u,onClose:B,PaperProps:{elevation:3,sx:{mt:1.5,minWidth:200,"& .MuiMenuItem-root":{px:2,py:1}}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[b.jsxDEV(re,{sx:{px:2,py:1},children:[b.jsxDEV(ge,{variant:"subtitle1",sx:{fontWeight:500},children:r.full_name||"User"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:407,columnNumber:21},void 0),b.jsxDEV(ge,{variant:"body2",color:"text.secondary",children:r.email},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:410,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:406,columnNumber:19},void 0),b.jsxDEV(Pr,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:414,columnNumber:19},void 0),b.jsxDEV(Dn,{onClick:()=>{B(),e("/profile")},children:[b.jsxDEV(Ui,{children:b.jsxDEV(q4,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:420,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:419,columnNumber:21},void 0),"Profile"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:415,columnNumber:19},void 0),b.jsxDEV(Dn,{onClick:()=>{B(),e("/settings")},children:[b.jsxDEV(Ui,{children:b.jsxDEV(P1,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:429,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:428,columnNumber:21},void 0),"Settings"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:424,columnNumber:19},void 0),b.jsxDEV(Pr,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:433,columnNumber:19},void 0),b.jsxDEV(Dn,{onClick:L,children:[b.jsxDEV(Ui,{children:b.jsxDEV(G4,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:436,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:435,columnNumber:21},void 0),"Logout"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:434,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:388,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:370,columnNumber:15},void 0):b.jsxDEV(vt,{component:SR,to:"/auth/login",variant:"contained",size:"small",sx:{ml:2,bgcolor:n.palette.primary.main,"&:hover":{bgcolor:n.palette.primary.dark}},children:"Sign In"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:443,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:299,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:188,columnNumber:7},void 0),b.jsxDEV(T1,{anchor:"left",open:l,onClose:()=>c(!1),sx:{"& .MuiDrawer-paper":{width:280,boxSizing:"border-box",bgcolor:"background.paper",borderRight:`1px solid ${Qe("#000",.1)}`}},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderBottom:`1px solid ${Qe("#000",.1)}`},children:[b.jsxDEV(ge,{variant:"h6",sx:{fontWeight:600,color:n.palette.primary.main},children:"Navigation"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:484,columnNumber:11},void 0),b.jsxDEV(ut,{onClick:()=>c(!1),size:"small",children:b.jsxDEV(KR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:488,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:487,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:477,columnNumber:9},void 0),b.jsxDEV(nu,{children:R.map(W=>b.jsxDEV(Js,{disablePadding:!0,children:b.jsxDEV(qf,{onClick:()=>{e(W.path),c(!1)},sx:{"&:hover":{bgcolor:Qe(n.palette.primary.main,.08)}},children:[b.jsxDEV(Ui,{sx:{color:n.palette.primary.main},children:W.icon},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:505,columnNumber:17},void 0),b.jsxDEV(si,{primary:W.label},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:508,columnNumber:17},void 0),b.jsxDEV(U0,{sx:{color:"text.secondary"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:509,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:494,columnNumber:15},void 0)},W.path,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:493,columnNumber:13},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:491,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:464,columnNumber:7},void 0),b.jsxDEV(re,{sx:{flexGrow:1,display:"flex",width:"100vw",height:"calc(100vh - 64px)",mt:"64px",overflow:"hidden",position:"relative"},children:b.jsxDEV(Jae,{leftPanel:b.jsxDEV(re,{className:"panel-content panel-left",children:b.jsxDEV(oO,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:529,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:528,columnNumber:13},void 0),centerPanel:b.jsxDEV(re,{className:"panel-content",children:b.jsxDEV(uO,{children:b.jsxDEV(ER,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:535,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:534,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:533,columnNumber:13},void 0),rightPanel:b.jsxDEV(re,{className:"panel-content panel-right",children:b.jsxDEV(z2,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:541,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:540,columnNumber:13},void 0),leftPanelOpen:k,rightPanelOpen:S,onLeftPanelToggle:E,onRightPanelToggle:P,onWidthChange:W=>{console.log("Panel widths changed:",W)}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:526,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:517,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/MainLayout.tsx",lineNumber:176,columnNumber:5},void 0)},eoe=n=>b.jsxDEV(noe,{...n,navigate:e=>{console.log("Navigation attempted:",e),typeof e=="string"&&(window.location.href=e)},location:{pathname:window.location.pathname}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:49,columnNumber:5},void 0),toe=n=>{const t=n.toString().match(/\[(.*?)\]/);return t?t[1]:"UNKNOWN"};lt(Q4)(({theme:n})=>({fontSize:64,color:n.palette.error.main,animation:"pulse 2s infinite","@keyframes pulse":{"0%":{opacity:.6,transform:"scale(0.95)"},"50%":{opacity:1,transform:"scale(1.05)"},"100%":{opacity:.6,transform:"scale(0.95)"}}}));class noe extends T.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null,errorInfo:null,showDetails:!1,isRetrying:!1,retryCount:0},this.toggleDetails=()=>{this.setState(e=>({showDetails:!e.showDetails}))},this.handleReset=async()=>{this.setState({isRetrying:!0,retryCount:this.state.retryCount+1}),await new Promise(e=>setTimeout(e,1e3)),this.props.routeOnReset&&this.props.navigate(this.props.routeOnReset),this.setState({hasError:!1,error:null,errorInfo:null,isRetrying:!1})},this.handleNavigateHome=()=>{this.props.navigate("/"),this.setState({hasError:!1,error:null,errorInfo:null})},this.handleNavigateBack=()=>{this.props.navigate(-1),this.setState({hasError:!1,error:null,errorInfo:null})},this.getContextualAction=()=>{const{error:e}=this.state,{location:t}=this.props;if(!e)return null;const i=e.toString().toLowerCase();return i.includes("not found")||i.includes("404")?{text:"Go to Dashboard",action:this.handleNavigateHome}:i.includes("unauthorized")||i.includes("authentication")||i.includes("permission")||i.includes("access denied")||i.includes("token")?{text:"Go to Login",action:()=>this.props.navigate("/login")}:i.includes("network")||i.includes("connection")||i.includes("offline")?{text:"Check Connection & Retry",action:this.handleReset}:t.pathname.includes("/projects/")?{text:"Go to Projects List",action:()=>this.props.navigate("/")}:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Error caught by ErrorBoundary:",e,t),this.setState({errorInfo:t}),this.props.onError&&this.props.onError(e,t)}componentDidUpdate(e){this.props.resetOnPropsChange&&this.state.hasError&&e.children!==this.props.children&&this.handleReset()}render(){const{hasError:e,error:t,errorInfo:i,showDetails:r,isRetrying:s}=this.state;return e?this.props.fallback?this.props.fallback:(this.getContextualAction(),t&&toe(t),b.jsxDEV(J4,{maxWidth:"md",sx:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:b.jsxDEV(sn,{elevation:3,sx:{p:5,display:"flex",flexDirection:"column",alignItems:"center",maxWidth:"600px",mx:"auto"},children:[b.jsxDEV(Z4,{color:"error",sx:{fontSize:60,mb:2,opacity:.8}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:264,columnNumber:13},this),b.jsxDEV(ge,{variant:"h4",component:"h1",gutterBottom:!0,color:"error.main",children:"Something went wrong"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:265,columnNumber:13},this),b.jsxDEV(ge,{variant:"body1",align:"center",sx:{mb:3},children:"An error occurred in the application. Please try refreshing the page or contact support if the problem persists."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:268,columnNumber:13},this),t&&b.jsxDEV(re,{sx:{mt:2,p:2,bgcolor:"grey.900",color:"grey.100",width:"100%",borderRadius:1,fontFamily:"monospace",fontSize:"0.875rem",overflowX:"auto"},children:[b.jsxDEV(ge,{variant:"subtitle2",color:"error.light",sx:{mb:1},children:["Error: ",t.toString()]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:284,columnNumber:17},this),i&&b.jsxDEV("pre",{style:{whiteSpace:"pre-wrap"},children:i.componentStack},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:288,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:273,columnNumber:15},this),b.jsxDEV(re,{sx:{mt:4,display:"flex",gap:2},children:[b.jsxDEV(vt,{variant:"outlined",color:"primary",onClick:this.handleReset,startIcon:b.jsxDEV(sE,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:300,columnNumber:28},this),children:"Try Again"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:296,columnNumber:15},this),b.jsxDEV(vt,{variant:"contained",color:"primary",onClick:()=>window.location.reload(),children:"Reload Page"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:304,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:295,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:253,columnNumber:11},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ErrorBoundary.tsx",lineNumber:247,columnNumber:9},this)):this.props.children}}const ioe=()=>{const n=T.useRef(!1),[e,t]=T.useState(!1),i=We(c=>c.setSelectedProject),r=We(c=>c.setProjects),s=We(c=>c.setFiles),a=We(c=>c.setUser),o=We(c=>c.user),l=()=>{const c={id:"00000000-0000-0000-0000-000000000000",email:"demo@example.com",avatar_url:"https://ui-avatars.com/api/?name=Demo+User&background=0D8ABC&color=fff",full_name:"Demo User"},u="11111111-1111-1111-1111-111111111111",m=[{id:u,name:"Acme Corp. v. Widget Industries",owner_id:c.id,created_at:new Date().toISOString(),description:"Contract dispute regarding manufacturing components",status:"active"},{id:"22222222-2222-2222-2222-222222222222",name:"Smith Estate Planning",owner_id:c.id,created_at:new Date(Date.now()-7*24*60*60*1e3).toISOString(),description:"Trust and estate planning documents",status:"active"}],g=[{id:"22222222-2222-2222-2222-222222222222",name:"Client Contract.pdf",project_id:u,owner_id:c.id,storage_path:`projects/${u}/contract.pdf`,content_type:"application/pdf",size:12345,file_type:"pdf",exhibit_id:"1-A",metadata:{tags:["contract","client","agreement"],processingStatus:"completed",pageCount:12},added_at:new Date().toISOString()},{id:"33333333-3333-3333-3333-333333333333",name:"Photo Evidence.jpg",project_id:u,owner_id:c.id,storage_path:`projects/${u}/evidence.jpg`,content_type:"image/jpeg",size:45678,file_type:"image",exhibit_id:"1-B",metadata:{tags:["evidence","photo","scene"],processingStatus:"completed",dimensions:"1920x1080"},added_at:new Date(Date.now()-864e5).toISOString()},{id:"44444444-4444-4444-4444-444444444444",name:"Witness Statement.docx",project_id:u,owner_id:c.id,storage_path:`projects/${u}/statement.docx`,content_type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",size:23456,file_type:"document",exhibit_id:"1-C",metadata:{tags:["witness","statement","testimony"],processingStatus:"completed",wordCount:1243},added_at:new Date(Date.now()-1728e5).toISOString()},{id:"55555555-5555-5555-5555-555555555555",name:"Interview Recording.mp3",project_id:u,owner_id:c.id,storage_path:`projects/${u}/interview.mp3`,content_type:"audio/mpeg",size:98765,file_type:"audio",exhibit_id:"1-D",metadata:{tags:["interview","audio","recording"],processingStatus:"completed",duration:"34:21"},added_at:new Date(Date.now()-2592e5).toISOString()}];a(c),r(m),i(u),s(g),n.current=!0,t(!0),document.documentElement.setAttribute("data-demo-initialized","true"),console.log("✅ Demo data initialized successfully")};return T.useEffect(()=>{if(!n.current){if(window.FORCE_DEMO_MODE===!0){console.log("🔄 FORCE_DEMO_MODE enabled - initializing demo data immediately"),l();return}console.log("Initializing demo data immediately..."),l()}},[]),T.useEffect(()=>{if(window.FORCE_DEMO_MODE===!0&&!e){console.log("Force demo mode detected, ensuring demo data is initialized..."),l();return}!e&&!o&&(console.log("No user detected, ensuring demo data is initialized..."),l())},[o,e]),T.useEffect(()=>{const c=m=>{var y,v;const{user:g}=m.detail;g&&(console.log("Setting demo user from event:",g),a({id:g.id,email:g.email,avatar_url:(y=g.user_metadata)==null?void 0:y.avatar_url,full_name:(v=g.user_metadata)==null?void 0:v.full_name}))},u=m=>{const{projectId:g,projects:y,files:v}=m.detail;if(g){if(console.log("Loading demo project from event:",g),Array.isArray(y)&&y.length>0)r(y);else{const w=[{id:g,name:"Acme Corp. v. Widget Industries",owner_id:"00000000-0000-0000-0000-000000000000",created_at:new Date().toISOString(),description:"Contract dispute regarding manufacturing components",status:"active"}];r(w)}i(g),Array.isArray(v)&&v.length>0&&s(v),n.current=!0}},p=m=>{const{forceInit:g}=m.detail||{};if(console.log("Initialize demo event received:",g),g===!0){try{localStorage.removeItem("clarity-hub-storage"),localStorage.removeItem("clarity-hub-panel-state")}catch(y){console.warn("Failed to clear localStorage:",y)}l(),document.documentElement.setAttribute("data-demo-initialized","true"),console.log("🎉 Demo initialized via event with forced initialization")}};return window.addEventListener("clarity-hub:demo-login",c),window.addEventListener("clarity-hub:load-demo",u),window.addEventListener("clarity-hub:initialize-demo",p),()=>{window.removeEventListener("clarity-hub:demo-login",c),window.removeEventListener("clarity-hub:load-demo",u),window.removeEventListener("clarity-hub:initialize-demo",p)}},[i,r,s,a]),null},roe={activeUsers:[],comments:[],activities:[],chatMessages:[],currentDocument:void 0,currentProject:void 0,isConnected:!1,channels:new Map};function soe(n,e){switch(e.type){case"SET_ACTIVE_USERS":return{...n,activeUsers:e.payload};case"ADD_USER":return{...n,activeUsers:[...n.activeUsers.filter(s=>s.user_id!==e.payload.user_id),e.payload]};case"UPDATE_USER":return{...n,activeUsers:n.activeUsers.map(s=>s.user_id===e.payload.user_id?{...s,...e.payload}:s)};case"REMOVE_USER":return{...n,activeUsers:n.activeUsers.filter(s=>s.user_id!==e.payload)};case"SET_COMMENTS":return{...n,comments:e.payload};case"ADD_COMMENT":return{...n,comments:[e.payload,...n.comments]};case"UPDATE_COMMENT":return{...n,comments:n.comments.map(s=>s.id===e.payload.id?{...s,...e.payload}:s)};case"DELETE_COMMENT":return{...n,comments:n.comments.filter(s=>s.id!==e.payload)};case"SET_ACTIVITIES":return{...n,activities:e.payload};case"ADD_ACTIVITY":return{...n,activities:[e.payload,...n.activities]};case"SET_CHAT_MESSAGES":return{...n,chatMessages:e.payload};case"ADD_CHAT_MESSAGE":return{...n,chatMessages:[...n.chatMessages,e.payload]};case"UPDATE_CHAT_MESSAGE":return{...n,chatMessages:n.chatMessages.map(s=>s.id===e.payload.id?{...s,...e.payload}:s)};case"SET_CURRENT_DOCUMENT":return{...n,currentDocument:e.payload};case"SET_CURRENT_PROJECT":return{...n,currentProject:e.payload};case"SET_CONNECTED":return{...n,isConnected:e.payload};case"SET_CHANNEL":const t=new Map(n.channels);return t.set(e.payload.key,e.payload.channel),{...n,channels:t};case"REMOVE_CHANNEL":const i=new Map(n.channels),r=i.get(e.payload);return r&&r.unsubscribe(),i.delete(e.payload),{...n,channels:i};default:return n}}const B2=T.createContext(void 0);function aoe({children:n}){const[e,t]=T.useReducer(soe,roe),{user:i}=AE(),r=T.useCallback(async(N,R,V)=>{if(i)try{await rt.rpc("update_user_presence",{p_project_id:N,p_document_id:R,p_status:"online",p_cursor_position:V})}catch(B){console.error("Error updating presence:",B)}},[i]),s=T.useCallback(async()=>{if(!(!i||!e.currentProject))try{await rt.rpc("update_user_presence",{p_project_id:e.currentProject,p_status:"offline"})}catch(N){console.error("Error setting user offline:",N)}},[i,e.currentProject]),a=T.useCallback(async N=>{if(i)try{const{data:R,error:V}=await rt.from("document_comments").insert({...N,author_id:i.id}).select("*, author:profiles(first_name, last_name, avatar_url)").single();if(V)throw V;t({type:"ADD_COMMENT",payload:R})}catch(R){console.error("Error adding comment:",R)}},[i]),o=T.useCallback(async(N,R)=>{try{const{data:V,error:B}=await rt.from("document_comments").update(R).eq("id",N).select("*, author:profiles(first_name, last_name, avatar_url)").single();if(B)throw B;t({type:"UPDATE_COMMENT",payload:V})}catch(V){console.error("Error updating comment:",V)}},[]),l=T.useCallback(async N=>{try{const{error:R}=await rt.from("document_comments").delete().eq("id",N);if(R)throw R;t({type:"DELETE_COMMENT",payload:N})}catch(R){console.error("Error deleting comment:",R)}},[]),c=T.useCallback(async N=>{if(i)try{const{data:R,error:V}=await rt.from("document_comments").update({resolved:!0,resolved_by:i.id,resolved_at:new Date().toISOString()}).eq("id",N).select("*, author:profiles(first_name, last_name, avatar_url)").single();if(V)throw V;t({type:"UPDATE_COMMENT",payload:R})}catch(R){console.error("Error resolving comment:",R)}},[i]),u=T.useCallback(async N=>{if(i)try{const{data:R,error:V}=await rt.from("project_activities").insert({...N,user_id:i.id}).select("*, user:profiles(first_name, last_name, avatar_url)").single();if(V)throw V;t({type:"ADD_ACTIVITY",payload:R})}catch(R){console.error("Error adding activity:",R)}},[i]),p=T.useCallback(async N=>{if(i)try{const{data:R,error:V}=await rt.from("chat_messages").insert({...N,author_id:i.id}).select("*, author:profiles(first_name, last_name, avatar_url)").single();if(V)throw V;t({type:"ADD_CHAT_MESSAGE",payload:R})}catch(R){console.error("Error sending message:",R)}},[i]),m=T.useCallback(async(N,R)=>{try{const{data:V,error:B}=await rt.from("chat_messages").update({content:R,edited:!0,edited_at:new Date().toISOString()}).eq("id",N).select("*, author:profiles(first_name, last_name, avatar_url)").single();if(B)throw B;t({type:"UPDATE_CHAT_MESSAGE",payload:V})}catch(V){console.error("Error editing message:",V)}},[]),g=T.useCallback(async N=>{if(i)try{e.currentProject&&await y(e.currentProject),t({type:"SET_CURRENT_PROJECT",payload:N});const R=rt.channel(`project_presence:${N}`).on("postgres_changes",{event:"*",schema:"public",table:"user_presence",filter:`project_id=eq.${N}`},L=>{console.log("Presence change:",L),L.eventType==="INSERT"||L.eventType==="UPDATE"?t({type:"UPDATE_USER",payload:L.new}):L.eventType==="DELETE"&&t({type:"REMOVE_USER",payload:L.old.user_id})}).subscribe();t({type:"SET_CHANNEL",payload:{key:`presence:${N}`,channel:R}});const V=rt.channel(`project_activities:${N}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"project_activities",filter:`project_id=eq.${N}`},L=>{t({type:"ADD_ACTIVITY",payload:L.new})}).subscribe();t({type:"SET_CHANNEL",payload:{key:`activities:${N}`,channel:V}});const B=rt.channel(`project_chat:${N}`).on("postgres_changes",{event:"*",schema:"public",table:"chat_messages",filter:`project_id=eq.${N}`},L=>{L.eventType==="INSERT"?t({type:"ADD_CHAT_MESSAGE",payload:L.new}):L.eventType==="UPDATE"&&t({type:"UPDATE_CHAT_MESSAGE",payload:L.new})}).subscribe();t({type:"SET_CHANNEL",payload:{key:`chat:${N}`,channel:B}}),await Promise.all([k(N),E(N),P(N)]),await r(N),t({type:"SET_CONNECTED",payload:!0})}catch(R){console.error("Error joining project:",R)}},[i,e.currentProject,r]),y=T.useCallback(async N=>{try{await s(),[`presence:${N}`,`activities:${N}`,`chat:${N}`].forEach(V=>{t({type:"REMOVE_CHANNEL",payload:V})}),t({type:"SET_CURRENT_PROJECT",payload:void 0}),t({type:"SET_CONNECTED",payload:!1})}catch(R){console.error("Error leaving project:",R)}},[s]),v=T.useCallback(async N=>{if(!(!i||!e.currentProject))try{t({type:"SET_CURRENT_DOCUMENT",payload:N});const R=rt.channel(`document_comments:${N}`).on("postgres_changes",{event:"*",schema:"public",table:"document_comments",filter:`document_id=eq.${N}`},V=>{V.eventType==="INSERT"?t({type:"ADD_COMMENT",payload:V.new}):V.eventType==="UPDATE"?t({type:"UPDATE_COMMENT",payload:V.new}):V.eventType==="DELETE"&&t({type:"DELETE_COMMENT",payload:V.old.id})}).subscribe();t({type:"SET_CHANNEL",payload:{key:`comments:${N}`,channel:R}}),await S(N),await r(e.currentProject,N)}catch(R){console.error("Error joining document:",R)}},[i,e.currentProject,r]),w=T.useCallback(async N=>{try{t({type:"REMOVE_CHANNEL",payload:`comments:${N}`}),t({type:"SET_CURRENT_DOCUMENT",payload:void 0}),e.currentProject&&await r(e.currentProject)}catch(R){console.error("Error leaving document:",R)}},[e.currentProject,r]),k=async N=>{try{const{data:R,error:V}=await rt.from("user_presence").select("*, profile:profiles(first_name, last_name, avatar_url)").eq("project_id",N).eq("status","online");if(V)throw V;t({type:"SET_ACTIVE_USERS",payload:R||[]})}catch(R){console.error("Error loading presence:",R)}},S=async N=>{try{const{data:R,error:V}=await rt.from("document_comments").select("*, author:profiles(first_name, last_name, avatar_url)").eq("document_id",N).order("created_at",{ascending:!1});if(V)throw V;t({type:"SET_COMMENTS",payload:R||[]})}catch(R){console.error("Error loading comments:",R)}},E=async N=>{try{const{data:R,error:V}=await rt.from("project_activities").select("*, user:profiles(first_name, last_name, avatar_url)").eq("project_id",N).order("created_at",{ascending:!1}).limit(50);if(V)throw V;t({type:"SET_ACTIVITIES",payload:R||[]})}catch(R){console.error("Error loading activities:",R)}},P=async N=>{try{const{data:R,error:V}=await rt.from("chat_messages").select("*, author:profiles(first_name, last_name, avatar_url)").eq("project_id",N).order("created_at",{ascending:!0}).limit(100);if(V)throw V;t({type:"SET_CHAT_MESSAGES",payload:R||[]})}catch(R){console.error("Error loading chat messages:",R)}};T.useEffect(()=>()=>{e.channels.forEach(N=>{N.unsubscribe()}),i&&e.currentProject&&s()},[i,e.currentProject,e.channels,s]);const A={state:e,updatePresence:r,setUserOffline:s,addComment:a,updateComment:o,deleteComment:l,resolveComment:c,addActivity:u,sendMessage:p,editMessage:m,joinProject:g,leaveProject:y,joinDocument:v,leaveDocument:w};return b.jsxDEV(B2.Provider,{value:A,children:n},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/contexts/CollaborationContext.tsx",lineNumber:678,columnNumber:5},this)}function pw(){const n=T.useContext(B2);if(n===void 0)throw new Error("useCollaboration must be used within a CollaborationProvider");return n}const ooe=({children:n})=>{oh();const e=T.useRef(null),[t,i]=T.useState(null),[r,s]=T.useState(0),[a,o]=T.useState(0),{isLeftPanelOpen:l,isRightPanelOpen:c,toggleLeftPanel:u,toggleRightPanel:p,leftPanelWidth:m,centerPanelWidth:g,rightPanelWidth:y,leftPanelPercentage:v,centerPanelPercentage:w,rightPanelPercentage:k,minLeftPanelWidth:S,minCenterPanelWidth:E,minRightPanelWidth:P,setPanelSizes:A,setPanelPercentages:N}=kq(W=>({isLeftPanelOpen:W.isLeftPanelOpen,isRightPanelOpen:W.isRightPanelOpen,toggleLeftPanel:W.toggleLeftPanel,toggleRightPanel:W.toggleRightPanel,leftPanelWidth:W.leftPanelWidth,centerPanelWidth:W.centerPanelWidth,rightPanelWidth:W.rightPanelWidth,leftPanelPercentage:W.leftPanelPercentage,centerPanelPercentage:W.centerPanelPercentage,rightPanelPercentage:W.rightPanelPercentage,minLeftPanelWidth:W.minLeftPanelWidth,minCenterPanelWidth:W.minCenterPanelWidth,minRightPanelWidth:W.minRightPanelWidth,setPanelSizes:W.setPanelSizes,setPanelPercentages:W.setPanelPercentages})),R=Xr.Children.toArray(n);R.length!==3&&console.warn("ResizablePanels expects exactly 3 children"),T.useEffect(()=>{const W=()=>{if(e.current){const q=e.current.offsetWidth;o(q)}};return W(),window.addEventListener("resize",W),()=>{window.removeEventListener("resize",W)}},[]);const V=(W,q)=>{q.preventDefault(),i(W),s(q.clientX)},B=T.useCallback(W=>{if(t===null||!e.current)return;const q=e.current.offsetWidth,X=W.clientX-r;if(!(Math.abs(X)<1)){if(t===0&&l){let G=Math.max(m+X,S),K=Math.max(g-X,E);const J=G+K+y;if(J>q){const U=J-q;G-=U*(G/(G+K)),K-=U*(K/(G+K))}const ee=G/q*100,fe=K/q*100,ae=100-ee-fe;A(G,K,y),N(ee,fe,ae),s(W.clientX)}if(t===1&&c){let G=Math.max(g+X,E),K=Math.max(y-X,P);const J=m+G+K;if(J>q){const U=J-q;G-=U*(G/(G+K)),K-=U*(K/(G+K))}const ee=l?m/q*100:0,fe=G/q*100,ae=K/q*100;A(m,G,K),N(ee,fe,ae),s(W.clientX)}}},[t,r,e,m,g,y,S,E,P,l,c,A,N,v,k]),L=()=>{i(null)};return T.useEffect(()=>(t!==null&&(document.addEventListener("mousemove",B),document.addEventListener("mouseup",L)),()=>{document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",L)}),[t,B]),b.jsxDEV(re,{ref:e,sx:{display:"flex",width:"100%",height:"100%",overflow:"hidden",position:"relative",backgroundColor:"background.default",borderRadius:W=>W.shape.borderRadius},children:[b.jsxDEV(re,{sx:{display:l?"flex":"none",width:l?`${v}%`:"0",minWidth:l?S:0,overflowX:"hidden",overflowY:"auto",flexDirection:"column",transition:l?"width 0.2s ease":"none",borderRight:1,borderColor:"divider",flexShrink:0,bgcolor:"background.paper"},children:R[0]},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:202,columnNumber:7},void 0),b.jsxDEV(re,{sx:{position:"absolute",left:l?`${v}%`:0,top:"50%",transform:"translateY(-50%)",zIndex:W=>W.zIndex.drawer+1,transition:l?"left 0.2s ease":"none"},children:b.jsxDEV(ut,{onClick:u,size:"small",sx:{backgroundColor:"background.paper",border:1,borderColor:"divider",borderRadius:"50%",boxShadow:1,"&:hover":{backgroundColor:"primary.light",color:"primary.contrastText"}},children:l?b.jsxDEV(kA,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:246,columnNumber:30},void 0):b.jsxDEV(U0,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:246,columnNumber:48},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:231,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:221,columnNumber:7},void 0),l&&b.jsxDEV(re,{sx:{position:"absolute",left:`${v}%`,top:0,bottom:0,width:"3px",backgroundColor:"transparent",cursor:"col-resize",zIndex:W=>W.zIndex.drawer,"&:hover":{backgroundColor:"primary.main",opacity:.3},"&:active":{backgroundColor:"primary.main",opacity:.5}},onMouseDown:W=>V(0,W)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:252,columnNumber:9},void 0),b.jsxDEV(re,{sx:{flexGrow:1,width:`${w}%`,minWidth:E,display:"flex",flexDirection:"column",overflow:"hidden",transition:"width 0.2s ease",backgroundColor:"background.paper",borderRadius:W=>W.shape.borderRadius,borderLeft:l?0:1,borderRight:c?0:1,borderColor:"divider"},children:R[1]},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:276,columnNumber:7},void 0),c&&b.jsxDEV(re,{sx:{position:"absolute",right:`${k}%`,top:0,bottom:0,width:"3px",backgroundColor:"transparent",cursor:"col-resize",zIndex:W=>W.zIndex.drawer,"&:hover":{backgroundColor:"primary.main",opacity:.3},"&:active":{backgroundColor:"primary.main",opacity:.5}},onMouseDown:W=>V(1,W)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:297,columnNumber:9},void 0),b.jsxDEV(re,{sx:{position:"absolute",right:c?`${k}%`:0,top:"50%",transform:"translateY(-50%)",zIndex:W=>W.zIndex.drawer+1,transition:c?"right 0.2s ease":"none"},children:b.jsxDEV(ut,{onClick:p,size:"small",sx:{backgroundColor:"background.paper",border:1,borderColor:"divider",borderRadius:"50%",boxShadow:1,"&:hover":{backgroundColor:"primary.light",color:"primary.contrastText"}},children:c?b.jsxDEV(U0,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:346,columnNumber:31},void 0):b.jsxDEV(kA,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:346,columnNumber:50},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:331,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:321,columnNumber:7},void 0),b.jsxDEV(re,{sx:{display:c?"flex":"none",width:c?`${k}%`:"0",minWidth:c?P:0,overflowX:"hidden",overflowY:"auto",flexDirection:"column",transition:c?"width 0.2s ease":"none",borderLeft:1,borderColor:"divider",flexShrink:0,bgcolor:"background.paper"},children:R[2]},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:351,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/ResizablePanels.tsx",lineNumber:189,columnNumber:5},void 0)},iE=({status:n,size:e="medium"})=>{const t=r=>{switch(r){case"online":return"#4caf50";case"away":return"#ff9800";case"offline":return"#9e9e9e";default:return"#9e9e9e"}},i=r=>{switch(r){case"small":return 8;case"large":return 16;default:return 12}};return b.jsxDEV(eW,{sx:{fontSize:i(e),color:t(n)}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:58,columnNumber:5},void 0)},_1=({user:n,size:e="medium",showCursor:t=!1})=>{var a;const i=o=>{switch(o){case"small":return{width:24,height:24};case"large":return{width:48,height:48};default:return{width:32,height:32}}},r=o=>{var u,p;const l=((u=o.profile)==null?void 0:u.first_name)||"",c=((p=o.profile)==null?void 0:p.last_name)||"";return`${l} ${c}`.trim()||"Anonymous"},s=o=>{var u,p;const l=((u=o.profile)==null?void 0:u.first_name)||"",c=((p=o.profile)==null?void 0:p.last_name)||"";return`${l.charAt(0)}${c.charAt(0)}`.toUpperCase()||"A"};return b.jsxDEV(Nt,{title:b.jsxDEV(re,{children:[b.jsxDEV(ge,{variant:"body2",fontWeight:"bold",children:r(n)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:110,columnNumber:11},void 0),b.jsxDEV(ge,{variant:"caption",color:"inherit",children:n.status==="online"?"Active now":`Last seen ${new Date(n.last_seen).toLocaleTimeString()}`},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:113,columnNumber:11},void 0),n.current_page&&b.jsxDEV(ge,{variant:"caption",display:"block",color:"inherit",children:["Viewing: ",n.current_page]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:117,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:109,columnNumber:9},void 0),arrow:!0,children:b.jsxDEV(Yc,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:e==="small"?12:16,height:e==="small"?12:16,backgroundColor:"white",borderRadius:"50%",border:"1px solid #e0e0e0"},children:b.jsxDEV(iE,{status:n.status,size:e},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:141,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:129,columnNumber:11},void 0),children:b.jsxDEV(Jd,{src:(a=n.profile)==null?void 0:a.avatar_url,alt:r(n),sx:{...i(e),border:n.status==="online"?"2px solid #4caf50":"2px solid transparent",cursor:"pointer",transition:"all 0.2s ease-in-out","&:hover":{transform:"scale(1.1)"}},children:s(n)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:145,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:125,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:107,columnNumber:5},void 0)},loe=({maxUsers:n=5,showDetails:e=!1,size:t="medium",variant:i="compact"})=>{const{state:r}=pw(),s=r.activeUsers.filter(c=>c.status==="online");if(s.length===0)return null;const a=()=>b.jsxDEV(DA,{max:n,sx:{"& .MuiAvatar-root":{border:"2px solid white",cursor:"pointer"}},children:s.map(c=>b.jsxDEV(_1,{user:c,size:t},c.user_id,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:189,columnNumber:9},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:179,columnNumber:5},void 0),o=()=>b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1},children:[b.jsxDEV(DA,{max:3,children:s.slice(0,3).map(c=>b.jsxDEV(_1,{user:c,size:t,showCursor:!0},c.user_id,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:198,columnNumber:11},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:196,columnNumber:7},void 0),s.length>0&&b.jsxDEV(re,{sx:{ml:1},children:[b.jsxDEV(ge,{variant:"body2",color:"text.secondary",children:[s.length," ",s.length===1?"person":"people"," online"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:203,columnNumber:11},void 0),e&&b.jsxDEV(pi,{direction:"row",spacing:.5,sx:{mt:.5},children:s.slice(0,3).map(c=>{var u;return b.jsxDEV(It,{label:((u=c.profile)==null?void 0:u.first_name)||"User",size:"small",variant:"outlined",avatar:b.jsxDEV(iE,{status:c.status,size:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:214,columnNumber:27},void 0)},c.user_id,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:209,columnNumber:17},void 0)})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:207,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:202,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:195,columnNumber:5},void 0),l=()=>b.jsxDEV(pi,{spacing:1,children:[b.jsxDEV(ge,{variant:"subtitle2",color:"text.secondary",children:["Active Users (",s.length,")"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:226,columnNumber:7},void 0),s.map(c=>{var u,p;return b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1,p:1,borderRadius:1,backgroundColor:Qe("#000",.02),"&:hover":{backgroundColor:Qe("#000",.04)}},children:[b.jsxDEV(_1,{user:c,size:t,showCursor:!0},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:244,columnNumber:11},void 0),b.jsxDEV(re,{sx:{flex:1},children:[b.jsxDEV(ge,{variant:"body2",fontWeight:"medium",children:[(u=c.profile)==null?void 0:u.first_name," ",(p=c.profile)==null?void 0:p.last_name]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:246,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:c.current_page?`Viewing: ${c.current_page}`:"Active"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:249,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:245,columnNumber:11},void 0),b.jsxDEV(iE,{status:c.status},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:253,columnNumber:11},void 0)]},c.user_id,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:230,columnNumber:9},void 0)})]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/UserPresenceIndicator.tsx",lineNumber:225,columnNumber:5},void 0);switch(i){case"detailed":return o();case"list":return l();default:return a()}},coe=({position:n,showName:e=!0})=>{const t=s=>{const a=["#ff4757","#5352ed","#00d2d3","#ff6348","#7bed9f","#70a1ff","#ff9ff3","#ffb8b8","#c44569","#f8b500"],o=s.charCodeAt(0)%a.length;return a[o]},i=s=>{var l,c;const a=((l=s.profile)==null?void 0:l.first_name)||"",o=((c=s.profile)==null?void 0:c.last_name)||"";return`${a} ${o}`.trim()||"Anonymous"},r=t(n.user.user_id);return b.jsxDEV(re,{sx:{position:"absolute",left:n.x,top:n.y,pointerEvents:"none",zIndex:1e3,transition:"all 0.1s ease-out"},children:[b.jsxDEV(re,{sx:{width:0,height:0,borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderTop:`12px solid ${r}`,position:"relative"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/CursorTracker.tsx",lineNumber:54,columnNumber:7},void 0),b.jsxDEV(re,{sx:{width:"2px",height:"20px",backgroundColor:r,position:"absolute",left:"6px",top:"-2px"}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/CursorTracker.tsx",lineNumber:66,columnNumber:7},void 0),e&&b.jsxDEV(It,{label:i(n.user),size:"small",sx:{position:"absolute",left:"16px",top:"-8px",backgroundColor:r,color:"white",fontSize:"0.7rem",height:"20px","& .MuiChip-label":{px:1},animation:"fadeInOut 3s ease-in-out","@keyframes fadeInOut":{"0%":{opacity:0,transform:"translateX(-10px)"},"10%":{opacity:1,transform:"translateX(0)"},"90%":{opacity:1,transform:"translateX(0)"},"100%":{opacity:0,transform:"translateX(10px)"}}}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/CursorTracker.tsx",lineNumber:79,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/CursorTracker.tsx",lineNumber:43,columnNumber:5},void 0)},uoe=({user:n,selection:e,containerRef:t})=>{const[i,r]=T.useState([]);T.useEffect(()=>{var o;if(!(!t.current||!e))try{const l=t.current,c=[],u=document.createTreeWalker(l,NodeFilter.SHOW_TEXT,null,!1);let p;for(;p=u.nextNode();)c.push(p);let m=0;const g=document.createRange();let y=!1;for(const S of c){const E=((o=S.textContent)==null?void 0:o.length)||0;if(!y&&m+E>e.start&&(g.setStart(S,e.start-m),y=!0),m+E>=e.end){g.setEnd(S,e.end-m);break}m+=E}const v=Array.from(g.getClientRects()),w=l.getBoundingClientRect(),k=v.map(S=>({...S,x:S.x-w.x,y:S.y-w.y}));r(k)}catch(l){console.error("Error calculating selection highlight:",l)}},[e,t]);const a=(o=>{const l=["#ff4757","#5352ed","#00d2d3","#ff6348","#7bed9f","#70a1ff","#ff9ff3","#ffb8b8","#c44569","#f8b500"],c=o.charCodeAt(0)%l.length;return l[c]})(n.user_id);return b.jsxDEV(b.Fragment,{children:i.map((o,l)=>b.jsxDEV(re,{sx:{position:"absolute",left:o.x,top:o.y,width:o.width,height:o.height,backgroundColor:Qe(a,.2),border:`1px solid ${Qe(a,.4)}`,pointerEvents:"none",zIndex:999}},l,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/CursorTracker.tsx",lineNumber:187,columnNumber:9},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/CursorTracker.tsx",lineNumber:185,columnNumber:5},void 0)},doe=({documentId:n,containerRef:e,trackSelection:t=!0,showCursorNames:i=!0})=>{const{state:r,updatePresence:s}=pw(),[a,o]=T.useState([]),[l,c]=T.useState(!1),u=T.useRef(0),p=100,m=r.activeUsers.filter(v=>v.status==="online"&&v.cursor_position&&(!n||v.document_id===n));T.useEffect(()=>{const v=m.map(w=>{var k,S;return{x:((k=w.cursor_position)==null?void 0:k.x)||0,y:((S=w.cursor_position)==null?void 0:S.y)||0,user:w}});o(v)},[m]);const g=T.useCallback(v=>{if(!l||!(e!=null&&e.current)||!r.currentProject)return;const w=Date.now();if(w-u.current<p)return;const k=e.current.getBoundingClientRect(),S=v.clientX-k.left,E=v.clientY-k.top;s(r.currentProject,n,{x:S,y:E,timestamp:w}),u.current=w},[l,e,r.currentProject,n,s]),y=T.useCallback(()=>{if(!t||!(e!=null&&e.current)||!r.currentProject)return;const v=window.getSelection();if(!v||v.rangeCount===0)return;const w=v.getRangeAt(0),k=e.current.getBoundingClientRect(),S=w.getBoundingClientRect();if(S.width===0&&S.height===0)return;const E={start:w.startOffset,end:w.endOffset,x:S.x-k.x,y:S.y-k.y,timestamp:Date.now()};s(r.currentProject,n,E)},[t,e,r.currentProject,n,s]);return T.useEffect(()=>{if(!(e!=null&&e.current))return;const v=e.current,w=()=>c(!0),k=()=>c(!1);return v.addEventListener("mouseenter",w),v.addEventListener("mouseleave",k),v.addEventListener("mousemove",g),t&&document.addEventListener("selectionchange",y),()=>{v.removeEventListener("mouseenter",w),v.removeEventListener("mouseleave",k),v.removeEventListener("mousemove",g),t&&document.removeEventListener("selectionchange",y)}},[g,y,t,e]),e!=null&&e.current?b.jsxDEV(re,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:1e3},children:[a.map(v=>b.jsxDEV(coe,{position:v,showName:i},v.user.user_id,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/CursorTracker.tsx",lineNumber:326,columnNumber:9},void 0)),t&&m.map(v=>{var w;return(w=v.cursor_position)!=null&&w.selection?b.jsxDEV(uoe,{user:v,selection:v.cursor_position.selection,containerRef:e},`selection-${v.user_id}`,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/CursorTracker.tsx",lineNumber:338,columnNumber:11},void 0):null})]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/presence/CursorTracker.tsx",lineNumber:313,columnNumber:5},void 0):null},$2=({type:n})=>{switch(n){case"highlight":return b.jsxDEV(JR,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:62,columnNumber:14},void 0);case"sticky_note":return b.jsxDEV(ZR,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:64,columnNumber:14},void 0);case"suggestion":return b.jsxDEV(bE,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:66,columnNumber:14},void 0);default:return b.jsxDEV(wg,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:68,columnNumber:14},void 0)}},W2=({onSubmit:n,onCancel:e,placeholder:t="Add a comment...",autoFocus:i=!1})=>{const[r,s]=T.useState(""),[a,o]=T.useState("comment"),[l,c]=T.useState(null),u=m=>{m.preventDefault(),r.trim()&&(n(r.trim(),a),s(""),o("comment"))},p=m=>{o(m),c(null)};return b.jsxDEV(Ux,{variant:"outlined",sx:{mb:2},children:b.jsxDEV(zx,{children:b.jsxDEV("form",{onSubmit:u,children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"flex-start",gap:1,mb:2},children:[b.jsxDEV(vt,{variant:"outlined",size:"small",onClick:m=>c(m.currentTarget),startIcon:b.jsxDEV($2,{type:a},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:105,columnNumber:26},void 0),children:a},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:101,columnNumber:13},void 0),b.jsxDEV(ru,{anchorEl:l,open:!!l,onClose:()=>c(null),children:[b.jsxDEV(Dn,{onClick:()=>p("comment"),children:[b.jsxDEV(wg,{fontSize:"small",sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:115,columnNumber:17},void 0),"Comment"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:114,columnNumber:15},void 0),b.jsxDEV(Dn,{onClick:()=>p("highlight"),children:[b.jsxDEV(JR,{fontSize:"small",sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:119,columnNumber:17},void 0),"Highlight"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:118,columnNumber:15},void 0),b.jsxDEV(Dn,{onClick:()=>p("sticky_note"),children:[b.jsxDEV(ZR,{fontSize:"small",sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:123,columnNumber:17},void 0),"Sticky Note"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:122,columnNumber:15},void 0),b.jsxDEV(Dn,{onClick:()=>p("suggestion"),children:[b.jsxDEV(bE,{fontSize:"small",sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:127,columnNumber:17},void 0),"Suggestion"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:126,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:109,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:100,columnNumber:11},void 0),b.jsxDEV(Ni,{fullWidth:!0,multiline:!0,rows:3,value:r,onChange:m=>s(m.target.value),placeholder:t,autoFocus:i,variant:"outlined",sx:{mb:2}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:133,columnNumber:11},void 0),b.jsxDEV(re,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[b.jsxDEV(vt,{onClick:e,children:"Cancel"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:146,columnNumber:13},void 0),b.jsxDEV(vt,{type:"submit",variant:"contained",disabled:!r.trim(),children:"Submit"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:147,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:145,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:99,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:98,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:97,columnNumber:5},void 0)},hoe=({comment:n,replies:e,onReply:t,onResolve:i,onEdit:r,onDelete:s,currentUserId:a})=>{var P;const[o,l]=T.useState(!1),[c,u]=T.useState(!1),[p,m]=T.useState(n.content),[g,y]=T.useState(null),v=A=>{var V,B;const N=((V=A.author)==null?void 0:V.first_name)||"",R=((B=A.author)==null?void 0:B.last_name)||"";return`${N} ${R}`.trim()||"Anonymous"},w=A=>{var V,B;const N=((V=A.author)==null?void 0:V.first_name)||"",R=((B=A.author)==null?void 0:B.last_name)||"";return`${N.charAt(0)}${R.charAt(0)}`.toUpperCase()||"A"},k=A=>{t(A),l(!1)},S=()=>{p.trim()&&p!==n.content&&r(n.id,p.trim()),u(!1),m(n.content)},E=a===n.author_id;return b.jsxDEV(Ux,{variant:"outlined",sx:{mb:2,opacity:n.resolved?.7:1,backgroundColor:n.resolved?"action.hover":"background.paper"},children:b.jsxDEV(zx,{children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"flex-start",gap:2},children:[b.jsxDEV(Jd,{src:(P=n.author)==null?void 0:P.avatar_url,sx:{width:32,height:32},children:w(n)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:213,columnNumber:11},void 0),b.jsxDEV(re,{sx:{flex:1},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[b.jsxDEV(ge,{variant:"subtitle2",fontWeight:"bold",children:v(n)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:222,columnNumber:15},void 0),b.jsxDEV(It,{icon:b.jsxDEV($2,{type:n.comment_type},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:226,columnNumber:23},void 0),label:n.comment_type,size:"small",variant:"outlined"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:225,columnNumber:15},void 0),n.resolved&&b.jsxDEV(It,{icon:b.jsxDEV(SA,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:233,columnNumber:25},void 0),label:"Resolved",size:"small",color:"success",variant:"outlined"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:232,columnNumber:17},void 0),b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:mx(new Date(n.created_at),{addSuffix:!0})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:240,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:221,columnNumber:13},void 0),c?b.jsxDEV(re,{sx:{mb:2},children:[b.jsxDEV(Ni,{fullWidth:!0,multiline:!0,value:p,onChange:A=>m(A.target.value),variant:"outlined",size:"small",sx:{mb:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:247,columnNumber:17},void 0),b.jsxDEV(re,{sx:{display:"flex",gap:1},children:[b.jsxDEV(vt,{size:"small",variant:"contained",onClick:S,children:"Save"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:257,columnNumber:19},void 0),b.jsxDEV(vt,{size:"small",onClick:()=>{u(!1),m(n.content)},children:"Cancel"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:264,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:256,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:246,columnNumber:15},void 0):b.jsxDEV(ge,{variant:"body2",sx:{mb:2,whiteSpace:"pre-wrap"},children:n.content},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:276,columnNumber:15},void 0),b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1},children:[!n.resolved&&b.jsxDEV(vt,{size:"small",startIcon:b.jsxDEV(tW,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:285,columnNumber:30},void 0),onClick:()=>l(!0),children:"Reply"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:283,columnNumber:17},void 0),!n.resolved&&b.jsxDEV(vt,{size:"small",startIcon:b.jsxDEV(SA,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:295,columnNumber:30},void 0),onClick:i,color:"success",children:"Resolve"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:293,columnNumber:17},void 0),E&&b.jsxDEV(ut,{size:"small",onClick:A=>y(A.currentTarget),children:b.jsxDEV(my,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:308,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:304,columnNumber:17},void 0),b.jsxDEV(ru,{anchorEl:g,open:!!g,onClose:()=>y(null),children:[b.jsxDEV(Dn,{onClick:()=>{u(!0),y(null)},children:[b.jsxDEV(cE,{fontSize:"small",sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:318,columnNumber:19},void 0),"Edit"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:317,columnNumber:17},void 0),b.jsxDEV(Dn,{onClick:()=>{s(n.id),y(null)},sx:{color:"error.main"},children:[b.jsxDEV(uE,{fontSize:"small",sx:{mr:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:325,columnNumber:19},void 0),"Delete"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:321,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:312,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:281,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:220,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:212,columnNumber:9},void 0),e.length>0&&b.jsxDEV(re,{sx:{ml:5,mt:2},children:[b.jsxDEV(Pr,{sx:{mb:2}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:336,columnNumber:13},void 0),e.map(A=>{var N;return b.jsxDEV(re,{sx:{display:"flex",gap:2,mb:2},children:[b.jsxDEV(Jd,{src:(N=A.author)==null?void 0:N.avatar_url,sx:{width:24,height:24},children:w(A)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:339,columnNumber:17},void 0),b.jsxDEV(re,{sx:{flex:1},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[b.jsxDEV(ge,{variant:"caption",fontWeight:"bold",children:v(A)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:347,columnNumber:21},void 0),b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:mx(new Date(A.created_at),{addSuffix:!0})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:350,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:346,columnNumber:19},void 0),b.jsxDEV(ge,{variant:"body2",sx:{whiteSpace:"pre-wrap"},children:A.content},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:354,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:345,columnNumber:17},void 0)]},A.id,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:338,columnNumber:15},void 0)})]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:335,columnNumber:11},void 0),o&&b.jsxDEV(re,{sx:{ml:5,mt:2},children:b.jsxDEV(W2,{onSubmit:k,onCancel:()=>l(!1),placeholder:"Add a reply...",autoFocus:!0},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:366,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:365,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:211,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:203,columnNumber:5},void 0)},poe=({documentId:n,containerRef:e,showResolved:t=!1})=>{const{state:i,addComment:r,updateComment:s,deleteComment:a,resolveComment:o}=pw(),[l,c]=T.useState(!1),[u,p]=T.useState(null),m=i.comments.filter(P=>P.document_id===n&&(t||!P.resolved)&&!P.parent_id),g=m.map(P=>({comment:P,replies:i.comments.filter(A=>A.parent_id===P.id)})),y=T.useCallback((P,A)=>{r({document_id:n,project_id:i.currentProject,content:P,comment_type:A,position:u?{page:1,x:u.x,y:u.y}:void 0,metadata:{},resolved:!1}),c(!1),p(null)},[r,n,i.currentProject,u]),v=T.useCallback(P=>A=>{r({document_id:n,project_id:i.currentProject,parent_id:P,content:A,comment_type:"comment",metadata:{},resolved:!1})},[r,n,i.currentProject]),w=T.useCallback((P,A)=>{s(P,{content:A})},[s]),k=T.useCallback(P=>{a(P)},[a]),S=T.useCallback(P=>{o(P)},[o]);T.useEffect(()=>{if(!(e!=null&&e.current))return;const P=()=>{const N=window.getSelection();if(!N||N.rangeCount===0||N.isCollapsed)return;const R=N.getRangeAt(0),V=e.current.getBoundingClientRect(),B=R.getBoundingClientRect();p({x:B.x-V.x,y:B.y-V.y})},A=e.current;return A.addEventListener("mouseup",P),()=>{A.removeEventListener("mouseup",P)}},[e]);const E=m.filter(P=>!P.resolved).length;return b.jsxDEV(re,{sx:{p:2},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:2},children:[b.jsxDEV(ge,{variant:"h6",children:"Comments"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:476,columnNumber:11},void 0),E>0&&b.jsxDEV(Yc,{badgeContent:E,color:"primary",children:b.jsxDEV(wg,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:481,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:480,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:475,columnNumber:9},void 0),b.jsxDEV(vt,{variant:"contained",startIcon:b.jsxDEV(Qd,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:488,columnNumber:22},void 0),onClick:()=>c(!0),size:"small",children:"Add Comment"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:486,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:474,columnNumber:7},void 0),u&&b.jsxDEV(sn,{sx:{p:2,mb:2,border:"2px dashed",borderColor:"primary.main",backgroundColor:"primary.50"},children:b.jsxDEV(ge,{variant:"body2",color:"primary",children:'Text selected! Click "Add Comment" to comment on the selection.'},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:506,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:497,columnNumber:9},void 0),l&&b.jsxDEV(W2,{onSubmit:y,onCancel:()=>{c(!1),p(null)},autoFocus:!0},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:513,columnNumber:9},void 0),b.jsxDEV(pi,{spacing:2,children:g.length===0?b.jsxDEV(sn,{sx:{p:3,textAlign:"center",color:"text.secondary"},children:[b.jsxDEV(wg,{sx:{fontSize:48,opacity:.3,mb:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:526,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"body1",children:"No comments yet. Be the first to add one!"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:527,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:525,columnNumber:11},void 0):g.map(({comment:P,replies:A})=>{var N;return b.jsxDEV(hoe,{comment:P,replies:A,onReply:v(P.id),onResolve:()=>S(P.id),onEdit:w,onDelete:k,currentUserId:(N=i.activeUsers.find(R=>R.user_id===P.author_id))==null?void 0:N.user_id},P.id,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:533,columnNumber:13},void 0)})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:523,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/comments/CommentSystem.tsx",lineNumber:473,columnNumber:5},void 0)},foe=({version1:n,version2:e,open:t,onClose:i})=>{const[r,s]=T.useState("side-by-side"),a=()=>{if(!e.content_diff)return b.jsxDEV(sn,{sx:{p:2},children:b.jsxDEV(ge,{variant:"body2",color:"text.secondary",children:"No diff data available for this version."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:100,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:99,columnNumber:9},void 0);const{changes:o}=e.content_diff;return r==="unified"?b.jsxDEV(sn,{sx:{p:2,backgroundColor:"#f5f5f5",fontFamily:"monospace",fontSize:"0.875rem"},children:o.map((l,c)=>b.jsxDEV(re,{sx:{py:.5,px:1,backgroundColor:l.type==="add"?"#e8f5e8":l.type==="remove"?"#ffe8e8":"transparent",borderLeft:`3px solid ${l.type==="add"?"#4caf50":l.type==="remove"?"#f44336":"#2196f3"}`,mb:.5},children:[b.jsxDEV(ge,{component:"span",sx:{color:l.type==="add"?"#2e7d32":l.type==="remove"?"#d32f2f":"#1976d2",fontFamily:"inherit",fontSize:"inherit"},children:[l.type==="add"?"+ ":l.type==="remove"?"- ":"  ","Line ",l.line,": ",l.content]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:130,columnNumber:15},void 0),l.type==="modify"&&l.previous&&b.jsxDEV(ge,{component:"div",sx:{color:"#d32f2f",fontFamily:"inherit",fontSize:"inherit",opacity:.7},children:["- ",l.previous]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:145,columnNumber:17},void 0)]},c,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:113,columnNumber:13},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:111,columnNumber:9},void 0):b.jsxDEV(re,{sx:{display:"flex",gap:2},children:[b.jsxDEV(sn,{sx:{flex:1,p:2},children:[b.jsxDEV(ge,{variant:"subtitle2",gutterBottom:!0,children:["Version ",n.version_number]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:167,columnNumber:11},void 0),b.jsxDEV(re,{sx:{fontFamily:"monospace",fontSize:"0.875rem",whiteSpace:"pre-wrap"},children:n.content},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:170,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:166,columnNumber:9},void 0),b.jsxDEV(sn,{sx:{flex:1,p:2},children:[b.jsxDEV(ge,{variant:"subtitle2",gutterBottom:!0,children:["Version ",e.version_number]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:176,columnNumber:11},void 0),b.jsxDEV(re,{sx:{fontFamily:"monospace",fontSize:"0.875rem",whiteSpace:"pre-wrap"},children:e.content},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:179,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:175,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:165,columnNumber:7},void 0)};return b.jsxDEV(uh,{open:t,onClose:i,maxWidth:"lg",fullWidth:!0,children:[b.jsxDEV(Zf,{children:b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[b.jsxDEV(ge,{variant:"h6",children:["Compare Versions ",n.version_number," → ",e.version_number]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:191,columnNumber:11},void 0),b.jsxDEV(pi,{direction:"row",spacing:1,children:[b.jsxDEV(vt,{size:"small",variant:r==="unified"?"contained":"outlined",onClick:()=>s("unified"),children:"Unified"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:195,columnNumber:13},void 0),b.jsxDEV(vt,{size:"small",variant:r==="side-by-side"?"contained":"outlined",onClick:()=>s("side-by-side"),children:"Side by Side"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:202,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:194,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:190,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:189,columnNumber:7},void 0),b.jsxDEV(dh,{children:[b.jsxDEV(re,{sx:{mb:2},children:b.jsxDEV(pi,{direction:"row",spacing:2,children:e.content_diff&&b.jsxDEV(b.Fragment,{children:[b.jsxDEV(It,{label:`+${e.content_diff.additions} additions`,size:"small",color:"success",variant:"outlined"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:218,columnNumber:17},void 0),b.jsxDEV(It,{label:`-${e.content_diff.deletions} deletions`,size:"small",color:"error",variant:"outlined"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:224,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:217,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:215,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:214,columnNumber:9},void 0),b.jsxDEV(Pr,{sx:{mb:2}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:235,columnNumber:9},void 0),a()]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:213,columnNumber:7},void 0),b.jsxDEV(ch,{children:[b.jsxDEV(vt,{onClick:i,children:"Close"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:241,columnNumber:9},void 0),b.jsxDEV(vt,{variant:"outlined",startIcon:b.jsxDEV(zR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:242,columnNumber:47},void 0),children:"Export Diff"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:242,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:240,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:188,columnNumber:5},void 0)},moe=({open:n,onClose:e,onSubmit:t,currentContent:i,lastVersion:r})=>{const[s,a]=T.useState(""),[o,l]=T.useState("");T.useEffect(()=>{if(r&&i){const u=i.length,p=r.content.length,m=u-p;m>0?l(`Added ${m} characters`):m<0?l(`Removed ${Math.abs(m)} characters`):l("Minor edits")}},[i,r]);const c=()=>{const u=s.trim()||o||"Version update";t(u),a(""),e()};return b.jsxDEV(uh,{open:n,onClose:e,maxWidth:"sm",fullWidth:!0,children:[b.jsxDEV(Zf,{children:"Create New Version"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:286,columnNumber:7},void 0),b.jsxDEV(dh,{children:[b.jsxDEV(Ni,{fullWidth:!0,multiline:!0,rows:3,label:"Commit Message",value:s,onChange:u=>a(u.target.value),placeholder:o||"Describe your changes...",margin:"normal",helperText:"Describe what changed in this version"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:288,columnNumber:9},void 0),r&&b.jsxDEV(sn,{sx:{mt:2,p:2,backgroundColor:"action.hover"},children:[b.jsxDEV(ge,{variant:"subtitle2",gutterBottom:!0,children:["Changes since v",r.version_number,":"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:302,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"body2",color:"text.secondary",children:[i.length-r.content.length>0?"+ ":"",i.length-r.content.length," characters"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:305,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:301,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:287,columnNumber:7},void 0),b.jsxDEV(ch,{children:[b.jsxDEV(vt,{onClick:e,children:"Cancel"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:313,columnNumber:9},void 0),b.jsxDEV(vt,{onClick:c,variant:"contained",children:"Create Version"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:314,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:312,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:285,columnNumber:5},void 0)},goe=({documentId:n,currentContent:e="",onRestoreVersion:t,onCreateVersion:i})=>{const[r,s]=T.useState([]),[a,o]=T.useState(!0),[l,c]=T.useState({open:!1}),[u,p]=T.useState(!1),[m,g]=T.useState([]);T.useEffect(()=>{y()},[n]);const y=async()=>{try{o(!0);const N=[{id:"v3",document_id:n,version_number:3,content:"Latest content with more changes...",content_diff:{additions:5,deletions:2,changes:[{type:"add",line:1,content:"New introduction paragraph"},{type:"modify",line:5,content:"Updated methodology section",previous:"Old methodology section"},{type:"remove",line:10,content:"Removed outdated information"}]},author_id:"user1",commit_message:"Added new introduction and updated methodology",file_size:2048,checksum:"abc123",created_at:new Date(Date.now()-2*60*60*1e3).toISOString(),author:{first_name:"John",last_name:"Doe",avatar_url:void 0}},{id:"v2",document_id:n,version_number:2,content:"Updated content with some changes...",content_diff:{additions:3,deletions:1,changes:[{type:"add",line:3,content:"Added new section"},{type:"remove",line:8,content:"Removed old paragraph"}]},author_id:"user2",commit_message:"Minor content updates",file_size:1536,checksum:"def456",created_at:new Date(Date.now()-24*60*60*1e3).toISOString(),author:{first_name:"Jane",last_name:"Smith",avatar_url:void 0}},{id:"v1",document_id:n,version_number:1,content:"Initial content...",author_id:"user1",commit_message:"Initial version",file_size:1024,checksum:"ghi789",created_at:new Date(Date.now()-3*24*60*60*1e3).toISOString(),author:{first_name:"John",last_name:"Doe",avatar_url:void 0}}];s(N)}catch(N){console.error("Failed to load versions:",N)}finally{o(!1)}},v=N=>{g(R=>R.includes(N)?R.filter(V=>V!==N):R.length>=2?[R[1],N]:[...R,N])},w=()=>{if(m.length===2){const N=r.find(V=>V.id===m[0]),R=r.find(V=>V.id===m[1]);N&&R&&c({open:!0,version1:N.version_number<R.version_number?N:R,version2:N.version_number>R.version_number?N:R})}},k=N=>{i&&i(N),y()},S=N=>{t&&t(N)},E=N=>N?`${N.first_name} ${N.last_name}`.trim():"Unknown",P=N=>N?`${N.first_name.charAt(0)}${N.last_name.charAt(0)}`.toUpperCase():"U",A=N=>{if(N===0)return"0 B";const R=1024,V=["B","KB","MB","GB"],B=Math.floor(Math.log(N)/Math.log(R));return parseFloat((N/Math.pow(R,B)).toFixed(1))+" "+V[B]};return a?b.jsxDEV(ge,{children:"Loading versions..."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:482,columnNumber:12},void 0):b.jsxDEV(Ux,{children:[b.jsxDEV(zx,{children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1},children:[b.jsxDEV(I1,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:490,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"h6",children:"Version History"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:491,columnNumber:13},void 0),b.jsxDEV(Yc,{badgeContent:r.length,color:"primary",children:b.jsxDEV(re,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:495,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:489,columnNumber:11},void 0),b.jsxDEV(pi,{direction:"row",spacing:1,children:[m.length===2&&b.jsxDEV(vt,{variant:"outlined",startIcon:b.jsxDEV(nW,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:503,columnNumber:28},void 0),onClick:w,size:"small",children:"Compare"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:501,columnNumber:15},void 0),b.jsxDEV(vt,{variant:"contained",startIcon:b.jsxDEV(Qd,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:512,columnNumber:26},void 0),onClick:()=>p(!0),size:"small",children:"Save Version"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:510,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:499,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:488,columnNumber:9},void 0),m.length>0&&b.jsxDEV(sn,{sx:{p:2,mb:2,backgroundColor:"action.hover"},children:b.jsxDEV(ge,{variant:"body2",color:"text.secondary",children:m.length===1?"Select another version to compare":`Selected versions: ${m.map(N=>{var R;return(R=r.find(V=>V.id===N))==null?void 0:R.version_number}).join(" & ")}`},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:523,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:522,columnNumber:11},void 0),b.jsxDEV(nu,{children:r.map((N,R)=>{var V;return b.jsxDEV(Js,{sx:{border:1,borderColor:m.includes(N.id)?"primary.main":"divider",borderRadius:1,mb:1,cursor:"pointer","&:hover":{backgroundColor:"action.hover"}},onClick:()=>v(N.id),children:[b.jsxDEV(iW,{children:b.jsxDEV(Jd,{src:(V=N.author)==null?void 0:V.avatar_url,children:P(N.author)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:551,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:550,columnNumber:15},void 0),b.jsxDEV(si,{primary:b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:1},children:[b.jsxDEV(ge,{variant:"subtitle2",children:["Version ",N.version_number]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:559,columnNumber:21},void 0),N.content_diff&&b.jsxDEV(pi,{direction:"row",spacing:.5,children:[b.jsxDEV(It,{label:`+${N.content_diff.additions}`,size:"small",color:"success",variant:"outlined"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:564,columnNumber:25},void 0),b.jsxDEV(It,{label:`-${N.content_diff.deletions}`,size:"small",color:"error",variant:"outlined"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:570,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:563,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:558,columnNumber:19},void 0),secondary:b.jsxDEV(re,{children:[b.jsxDEV(ge,{variant:"body2",sx:{fontWeight:500},children:N.commit_message||"No commit message"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:582,columnNumber:21},void 0),b.jsxDEV(ge,{variant:"caption",color:"text.secondary",children:[E(N.author)," • ",mx(new Date(N.created_at),{addSuffix:!0})," • ",A(N.file_size)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:585,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:581,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:556,columnNumber:15},void 0),b.jsxDEV(RR,{children:b.jsxDEV(pi,{direction:"row",spacing:.5,children:[b.jsxDEV(Nt,{title:"View content",children:b.jsxDEV(ut,{size:"small",children:b.jsxDEV(rW,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:596,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:595,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:594,columnNumber:19},void 0),b.jsxDEV(Nt,{title:"Restore this version",children:b.jsxDEV(ut,{size:"small",onClick:B=>{B.stopPropagation(),S(N)},children:b.jsxDEV(sW,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:608,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:601,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:600,columnNumber:19},void 0),b.jsxDEV(Nt,{title:"Download",children:b.jsxDEV(ut,{size:"small",children:b.jsxDEV(Vx,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:614,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:613,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:612,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:593,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:592,columnNumber:15},void 0)]},N.id,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:536,columnNumber:13},void 0)})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:534,columnNumber:9},void 0),r.length===0&&b.jsxDEV(sn,{sx:{p:3,textAlign:"center",color:"text.secondary"},children:[b.jsxDEV(I1,{sx:{fontSize:48,opacity:.3,mb:1}},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:625,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"body1",children:"No versions saved yet"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:626,columnNumber:13},void 0),b.jsxDEV(ge,{variant:"body2",children:"Create your first version to start tracking changes"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:629,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:624,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:487,columnNumber:7},void 0),l.version1&&l.version2&&b.jsxDEV(foe,{version1:l.version1,version2:l.version2,open:l.open,onClose:()=>c({open:!1})},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:637,columnNumber:9},void 0),b.jsxDEV(moe,{open:u,onClose:()=>p(!1),onSubmit:k,currentContent:e,lastVersion:r[0]},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:645,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/versions/VersionControl.tsx",lineNumber:486,columnNumber:5},void 0)};function boe(n){const{children:e,value:t,index:i,...r}=n;return b.jsxDEV("div",{role:"tabpanel",hidden:t!==i,id:`collaboration-tabpanel-${i}`,"aria-labelledby":`collaboration-tab-${i}`,...r,children:t===i&&b.jsxDEV(re,{sx:{height:"100%"},children:e},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:61,columnNumber:9},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:53,columnNumber:5},this)}function yoe(n){return{id:`collaboration-tab-${n}`,"aria-controls":`collaboration-tabpanel-${n}`}}const voe=({projectId:n,documentId:e,documentContent:t="",containerRef:i,onDocumentChange:r,compact:s=!1})=>{const a=oh(),o=Lx(a.breakpoints.down("md")),{state:l,joinProject:c,joinDocument:u,leaveDocument:p}=pw(),[m,g]=T.useState(0),[y,v]=T.useState(!o),[w,k]=T.useState({comments:0,activity:0,chat:0});T.useEffect(()=>(n&&c(n),()=>{e&&p(e)}),[n,e,c,p]),T.useEffect(()=>(e&&u(e),()=>{e&&p(e)}),[e,u,p]),T.useEffect(()=>{const V=Date.now()-5*60*1e3,B=l.comments.filter(L=>new Date(L.created_at).getTime()>V).length;k({comments:B,activity:0,chat:0})},[l.comments]);const S=(R,V)=>{g(V)},E=R=>{console.log("Creating version:",R)},P=R=>{r&&R.content&&r(R.content)},A=[{label:"Comments",icon:b.jsxDEV(wg,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:156,columnNumber:13},void 0),badge:w.comments,component:e?b.jsxDEV(poe,{documentId:e,containerRef:i,showResolved:!1},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:159,columnNumber:9},void 0):b.jsxDEV(re,{sx:{p:2},children:b.jsxDEV(ge,{color:"text.secondary",children:"Select a document to view and add comments"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:166,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:165,columnNumber:9},void 0)},{label:"Versions",icon:b.jsxDEV(I1,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:174,columnNumber:13},void 0),badge:0,component:e?b.jsxDEV(goe,{documentId:e,currentContent:t,onCreateVersion:E,onRestoreVersion:P},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:177,columnNumber:9},void 0):b.jsxDEV(re,{sx:{p:2},children:b.jsxDEV(ge,{color:"text.secondary",children:"Select a document to view version history"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:185,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:184,columnNumber:9},void 0)}],N=b.jsxDEV(re,{sx:{width:400,height:"100%",display:"flex",flexDirection:"column"},children:[b.jsxDEV(yE,{position:"static",color:"default",elevation:1,children:b.jsxDEV(gy,{variant:"dense",children:[b.jsxDEV(ge,{variant:"h6",sx:{flex:1},children:"Legal Document Collaboration"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:197,columnNumber:11},void 0),b.jsxDEV(loe,{maxUsers:3,size:"small",variant:"compact"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:200,columnNumber:11},void 0),b.jsxDEV(ut,{edge:"end",onClick:()=>v(!1),sx:{ml:1},children:b.jsxDEV(KR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:210,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:205,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:196,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:195,columnNumber:7},void 0),b.jsxDEV(re,{sx:{borderBottom:1,borderColor:"divider"},children:b.jsxDEV(hE,{value:m,onChange:S,variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,children:A.map((R,V)=>b.jsxDEV(mp,{label:b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",gap:.5},children:[R.badge>0?b.jsxDEV(Yc,{badgeContent:R.badge,color:"primary",children:R.icon},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:229,columnNumber:21},void 0):R.icon,!s&&R.label]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:227,columnNumber:17},void 0),...yoe(V)},V,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:224,columnNumber:13},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:216,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:215,columnNumber:7},void 0),b.jsxDEV(re,{sx:{flex:1,overflow:"hidden"},children:A.map((R,V)=>b.jsxDEV(boe,{value:m,index:V,children:R.component},V,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:246,columnNumber:11},void 0))},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:244,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:194,columnNumber:5},void 0);return b.jsxDEV(re,{children:[i&&e&&b.jsxDEV(doe,{documentId:e,containerRef:i,trackSelection:!0,showCursorNames:!0},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:258,columnNumber:9},void 0),o?b.jsxDEV(T1,{anchor:"right",open:y,onClose:()=>v(!1),ModalProps:{keepMounted:!0},children:N},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:268,columnNumber:9},void 0):b.jsxDEV(T1,{anchor:"right",variant:"persistent",open:y,sx:{"& .MuiDrawer-paper":{position:"relative",width:400,height:"100vh",boxSizing:"border-box"}},children:N},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:279,columnNumber:9},void 0),!y&&b.jsxDEV(aW,{color:"primary",sx:{position:"fixed",bottom:16,right:16,zIndex:1e3},onClick:()=>v(!0),children:b.jsxDEV(Yc,{badgeContent:w.comments,color:"error",invisible:w.comments===0,children:b.jsxDEV(oW,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:313,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:308,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:298,columnNumber:9},void 0),!l.isConnected&&b.jsxDEV(Ux,{sx:{position:"fixed",bottom:16,left:16,zIndex:1e3,backgroundColor:"warning.main",color:"warning.contrastText"},children:b.jsxDEV(zx,{sx:{py:1,"&:last-child":{pb:1}},children:b.jsxDEV(ge,{variant:"body2",children:"Reconnecting to collaboration server..."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:331,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:330,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:320,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/components/collaboration/CollaborationDashboard.tsx",lineNumber:255,columnNumber:5},void 0)};function xoe(){const n=oh(),e=jx(),{projectId:t}=DR(),i=Lx(n.breakpoints.down("md")),[r,s]=T.useState(!0),[a,o]=T.useState(null),l=We(g=>g.themeMode),c=We(g=>g.toggleTheme),u=We(g=>g.projects.find(y=>y.id===t)||null),p=We(g=>g.setSelectedProject);T.useEffect(()=>{t&&(p(t),u?s(!1):m())},[t]);const m=async()=>{try{s(!0),o(null);const{data:g,error:y}=await Zn.from("projects").select("*").eq("id",t).single();if(y)throw y;g&&We.setState(v=>({projects:[...v.projects.filter(w=>w.id!==g.id),g]}))}catch(g){console.error("Error fetching project:",g),o("Error loading project. Please try again.")}finally{s(!1)}};return b.jsxDEV(re,{sx:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden",bgcolor:"background.default"},children:[b.jsxDEV(yE,{position:"sticky",color:"default",elevation:0,sx:{zIndex:g=>g.zIndex.drawer+1,borderBottom:"1px solid",borderColor:"divider",background:n.palette.mode==="dark"?"rgba(15, 23, 42, 0.8)":"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(8px)"},children:b.jsxDEV(gy,{sx:{minHeight:{xs:56,sm:64}},children:[i&&b.jsxDEV(ut,{edge:"start",color:"inherit","aria-label":"back",onClick:()=>e(-1),sx:{mr:1},children:b.jsxDEV(lW,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:105,columnNumber:15},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:98,columnNumber:13},this),b.jsxDEV(cW,{separator:b.jsxDEV(U0,{fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:110,columnNumber:35},this),"aria-label":"breadcrumb",sx:{flexGrow:1},children:[b.jsxDEV(uW,{component:SR,to:"/",underline:"hover",color:"inherit",sx:{display:"flex",alignItems:"center"},children:[b.jsxDEV(QR,{sx:{mr:.5},fontSize:"small"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:118,columnNumber:15},this),"Dashboard"]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:111,columnNumber:13},this),b.jsxDEV(ge,{color:"text.primary",sx:{fontWeight:500},children:r?b.jsxDEV(Na,{width:120},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:124,columnNumber:17},this):u?u.name:"Project"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:122,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:110,columnNumber:11},this),b.jsxDEV(ut,{color:"inherit",onClick:c,sx:{ml:1},children:l==="dark"?b.jsxDEV(YR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:135,columnNumber:37},this):b.jsxDEV(XR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:135,columnNumber:53},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:134,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:95,columnNumber:9},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:81,columnNumber:7},this),b.jsxDEV(re,{sx:{display:"flex",flexGrow:1,overflow:"hidden",p:{xs:1,sm:2}},children:r?b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:b.jsxDEV(Yr,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:154,columnNumber:13},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:148,columnNumber:11},this):a?b.jsxDEV(re,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",color:"error.main"},children:a},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:157,columnNumber:11},this):b.jsxDEV(b.Fragment,{children:[b.jsxDEV(ooe,{children:[b.jsxDEV(oO,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:169,columnNumber:15},this),b.jsxDEV(uO,{children:b.jsxDEV(ER,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:171,columnNumber:17},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:170,columnNumber:15},this),b.jsxDEV(z2,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:173,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:168,columnNumber:13},this),b.jsxDEV(voe,{projectId:t,compact:i},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:175,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:167,columnNumber:11},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:141,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/layouts/ProjectLayout.tsx",lineNumber:73,columnNumber:5},this)}const cR=T.lazy(()=>ta(()=>import("./Dashboard-CvQjZp2T.js"),__vite__mapDeps([0,1,2,3]))),woe=T.lazy(()=>ta(()=>import("./Auth-DzDFn8mY.js"),__vite__mapDeps([4,3,1,2]))),uR=T.lazy(()=>ta(()=>import("./ProjectView-CdmghoDd.js"),__vite__mapDeps([5,1,2,3]))),dR=T.lazy(()=>ta(()=>import("./Settings-CLG7HV_e.js"),__vite__mapDeps([6,1,2,3]))),koe=T.lazy(()=>ta(()=>import("./Messages-CxWmo1ZW.js"),__vite__mapDeps([7,1,2,3]))),Doe=T.lazy(()=>ta(()=>import("./Help-DJea_o2y.js"),__vite__mapDeps([8,1,2,3]))),Soe=T.lazy(()=>ta(()=>import("./NotFound-BF-2T1wZ.js"),__vite__mapDeps([9,2,1,3]))),Eoe=new RW({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}});function Noe(){const[n,e]=T.useState(!0),t=We(a=>a.themeMode),i=We(a=>a.toggleTheme);T.useEffect(()=>{console.log("App initialized in demo mode"),(async()=>{await vl.initializeDemoData();const o={id:"00000000-0000-0000-0000-000000000000",email:"demo@example.com",avatar_url:"https://ui-avatars.com/api/?name=Demo+User&background=0D8ABC&color=fff",full_name:"Demo User"};We.setState({user:o});try{const[l,c]=await Promise.all([vl.getProjects(),vl.getFiles("11111111-1111-1111-1111-111111111111")]),u=c.map(p=>({id:p.id,name:p.name,project_id:p.project_id,owner_id:"00000000-0000-0000-0000-000000000000",file_type:p.type.split("/")[0],content_type:p.type,size:p.size,storage_path:`demo/${p.id}`,added_at:p.uploaded_at,exhibit_id:p.exhibit_id,exhibit_title:p.exhibit_title}));We.setState({projects:l,files:u,selectedProjectId:"11111111-1111-1111-1111-111111111111"}),console.log("Demo data loaded:",{projects:l.length,files:u.length})}catch(l){console.error("Failed to load demo data:",l);const c="11111111-1111-1111-1111-111111111111",u=[{id:c,name:"Acme Corp. v. Widget Industries",owner_id:o.id,created_at:new Date().toISOString(),description:"Contract dispute regarding manufacturing components",status:"active"}];We.setState({projects:u,files:[],selectedProjectId:c})}})()},[]);const r=()=>{const a=document.createElement("script");a.src="/reset-app.js",a.onload=()=>{console.log("Reset script loaded and executed"),a.remove()},a.onerror=()=>{console.error("Failed to load reset script"),a.remove()},document.body.appendChild(a)};T.useEffect(()=>{const a=o=>{o.ctrlKey&&o.shiftKey&&o.key==="D"&&e(l=>!l)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[]);const s=T.useMemo(()=>QW(t),[t]);return b.jsxDEV(FW,{client:Eoe,children:b.jsxDEV(dW,{theme:s,children:[b.jsxDEV(hW,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:175,columnNumber:9},this),b.jsxDEV(lH,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:176,columnNumber:9},this),n&&b.jsxDEV(re,{sx:{position:"fixed",bottom:16,right:16,zIndex:9999,display:"flex",flexDirection:"column",gap:1},children:[b.jsxDEV(vt,{variant:"contained",color:"primary",size:"small",onClick:i,sx:{fontWeight:"bold",boxShadow:2,mb:1},children:t==="dark"?"Light Mode":"Dark Mode"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:191,columnNumber:13},this),b.jsxDEV(vt,{variant:"contained",color:"warning",size:"small",onClick:r,startIcon:b.jsxDEV(P1,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:209,columnNumber:26},this),sx:{fontWeight:"bold",boxShadow:2},children:"Reset App"},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:204,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:180,columnNumber:11},this),b.jsxDEV(eoe,{children:b.jsxDEV($q,{children:[b.jsxDEV(ioe,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:222,columnNumber:13},this),b.jsxDEV(Dq,{children:b.jsxDEV(aoe,{children:b.jsxDEV(T.Suspense,{fallback:b.jsxDEV("div",{className:"app-loading",children:"Loading..."},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:225,columnNumber:43},this),children:b.jsxDEV(n4,{children:[b.jsxDEV(is,{path:"/auth/*",element:b.jsxDEV(woe,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:228,columnNumber:52},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:228,columnNumber:21},this),b.jsxDEV(is,{path:"/",element:b.jsxDEV(Zae,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:231,columnNumber:46},this),children:[b.jsxDEV(is,{index:!0,element:b.jsxDEV(cR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:232,columnNumber:45},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:232,columnNumber:23},this),b.jsxDEV(is,{path:"dashboard",element:b.jsxDEV(cR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:233,columnNumber:56},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:233,columnNumber:23},this),b.jsxDEV(is,{path:"messages",element:b.jsxDEV(koe,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:234,columnNumber:55},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:234,columnNumber:23},this),b.jsxDEV(is,{path:"settings",element:b.jsxDEV(dR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:235,columnNumber:55},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:235,columnNumber:23},this),b.jsxDEV(is,{path:"help",element:b.jsxDEV(Doe,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:236,columnNumber:51},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:236,columnNumber:23},this),b.jsxDEV(is,{path:"project/:projectId",element:b.jsxDEV(uR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:237,columnNumber:65},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:237,columnNumber:23},this),b.jsxDEV(is,{path:"profile",element:b.jsxDEV(dR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:238,columnNumber:54},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:238,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:231,columnNumber:21},this),b.jsxDEV(is,{path:"/projects/:projectId/*",element:b.jsxDEV(xoe,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:242,columnNumber:67},this),children:b.jsxDEV(is,{index:!0,element:b.jsxDEV(uR,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:243,columnNumber:45},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:243,columnNumber:23},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:242,columnNumber:21},this),b.jsxDEV(is,{path:"/not-found",element:b.jsxDEV(Soe,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:247,columnNumber:55},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:247,columnNumber:21},this),b.jsxDEV(is,{path:"*",element:b.jsxDEV(i4,{to:"/not-found",replace:!0},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:248,columnNumber:46},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:248,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:226,columnNumber:19},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:225,columnNumber:17},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:224,columnNumber:15},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:223,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:221,columnNumber:11},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:220,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:174,columnNumber:7},this)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/App.tsx",lineNumber:173,columnNumber:5},this)}window.DEMO_MODE=!0;console.log("App starting in demo mode");bW.createRoot(document.getElementById("root")).render(b.jsxDEV(Xr.StrictMode,{children:b.jsxDEV(r4,{children:b.jsxDEV(Noe,{},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/main.tsx",lineNumber:16,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/main.tsx",lineNumber:15,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/kareemhassanein/Desktop/clarity-hub-app/src/main.tsx",lineNumber:14,columnNumber:3},void 0));export{gK as E,We as a,oR as b,PN as c,Foe as d,Gae as e,zoe as f,sae as g,Uoe as h,kP as i,b as j,Loe as k,Voe as m,TN as n,zq as r,Zn as s,Jc as t,AE as u,Wl as v};
//# sourceMappingURL=index-DZp60Vkn.js.map
